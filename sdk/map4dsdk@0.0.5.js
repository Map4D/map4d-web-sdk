var map4d=function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";t.exports=o,t.exports.default=o;var n=i(1);function o(t,e){if(!(this instanceof o))return new o(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function r(t,e,i){if(!i)return e.indexOf(t);for(var n=0;n<e.length;n++)if(i(t,e[n]))return n;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,i,n,o){o||(o=y(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var r,a=e;a<i;a++)r=t.children[a],u(o,t.leaf?n(r):r);return o}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function p(t,e){return t.minY-e.minY}function l(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function d(t,e){var i=Math.max(t.minX,e.minX),n=Math.max(t.minY,e.minY),o=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,o-i)*Math.max(0,r-n)}function g(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function m(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function y(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function A(t,e,i,o,r){for(var a,s=[e,i];s.length;)(i=s.pop())-(e=s.pop())<=o||(a=e+Math.ceil((i-e)/o/2)*o,n(t,a,e,i,r),s.push(e,a,a,i))}o.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],n=this.toBBox;if(!m(t,e))return i;for(var o,r,a,s,u=[];e;){for(o=0,r=e.children.length;o<r;o++)a=e.children[o],m(t,s=e.leaf?n(a):a)&&(e.leaf?i.push(a):g(t,s)?this._all(a,i):u.push(a));e=u.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!m(t,e))return!1;for(var n,o,r,a,s=[];e;){for(n=0,o=e.children.length;n<o;n++)if(r=e.children[n],m(t,a=e.leaf?i(r):r)){if(e.leaf||g(t,a))return!0;s.push(r)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var o=this.data;this.data=n,n=o}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=y([]),this},remove:function(t,e){if(!t)return this;for(var i,n,o,a,s=this.data,u=this.toBBox(t),h=[],p=[];s||h.length;){if(s||(s=h.pop(),n=h[h.length-1],i=p.pop(),a=!0),s.leaf&&-1!==(o=r(t,s.children,e)))return s.children.splice(o,1),h.push(s),this._condense(h),this;a||s.leaf||!g(s,u)?n?(i++,s=n.children[i],a=!1):s=null:(h.push(s),p.push(i),i=0,n=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:h,compareMinY:p,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,n){var o,r=i-e+1,s=this._maxEntries;if(r<=s)return a(o=y(t.slice(e,i+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(r)/Math.log(s)),s=Math.ceil(r/Math.pow(s,n-1))),(o=y([])).leaf=!1,o.height=n;var u,h,p,l,c=Math.ceil(r/s),f=c*Math.ceil(Math.sqrt(s));for(A(t,e,i,f,this.compareMinX),u=e;u<=i;u+=f)for(A(t,u,p=Math.min(u+f-1,i),c,this.compareMinY),h=u;h<=p;h+=c)l=Math.min(h+c-1,p),o.children.push(this._build(t,h,l,n-1));return a(o,this.toBBox),o},_chooseSubtree:function(t,e,i,n){for(var o,r,a,s,u,h,p,c;n.push(e),!e.leaf&&n.length-1!==i;){for(p=c=1/0,o=0,r=e.children.length;o<r;o++)u=l(a=e.children[o]),(h=f(t,a)-u)<c?(c=h,p=u<p?u:p,s=a):h===c&&u<p&&(p=u,s=a);e=s||e.children[0]}return e},_insert:function(t,e,i){var n=this.toBBox,o=i?t:n(t),r=[],a=this._chooseSubtree(o,this.data,e,r);for(a.children.push(t),u(a,o);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(o,r,e)},_split:function(t,e){var i=t[e],n=i.children.length,o=this._minEntries;this._chooseSplitAxis(i,o,n);var r=this._chooseSplitIndex(i,o,n),s=y(i.children.splice(r,i.children.length-r));s.height=i.height,s.leaf=i.leaf,a(i,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(i,s)},_splitRoot:function(t,e){this.data=y([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var n,o,r,a,u,h,p,c;for(h=p=1/0,n=e;n<=i-e;n++)a=d(o=s(t,0,n,this.toBBox),r=s(t,n,i,this.toBBox)),u=l(o)+l(r),a<h?(h=a,c=n,p=u<p?u:p):a===h&&u<p&&(p=u,c=n);return c},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:h,o=t.leaf?this.compareMinY:p;this._allDistMargin(t,e,i,n)<this._allDistMargin(t,e,i,o)&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var o,r,a=this.toBBox,h=s(t,0,e,a),p=s(t,i-e,i,a),l=c(h)+c(p);for(o=e;o<i-e;o++)r=t.children[o],u(h,t.leaf?a(r):r),l+=c(h);for(o=i-e-1;o>=e;o--)r=t.children[o],u(p,t.leaf?a(r):r),l+=c(p);return l},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)u(e[n],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():a(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,i){t.exports=function(){"use strict";function t(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function e(t,e){return t<e?-1:t>e?1:0}return function(i,n,o,r,a){!function e(i,n,o,r,a){for(;r>o;){if(r-o>600){var s=r-o+1,u=n-o+1,h=Math.log(s),p=.5*Math.exp(2*h/3),l=.5*Math.sqrt(h*p*(s-p)/s)*(u-s/2<0?-1:1),c=Math.max(o,Math.floor(n-u*p/s+l)),f=Math.min(r,Math.floor(n+(s-u)*p/s+l));e(i,n,c,f,a)}var d=i[n],g=o,m=r;for(t(i,o,n),a(i[r],d)>0&&t(i,o,r);g<m;){for(t(i,g,m),g++,m--;a(i[g],d)<0;)g++;for(;a(i[m],d)>0;)m--}0===a(i[o],d)?t(i,o,m):t(i,++m,r),m<=n&&(o=m+1),n<=m&&(r=m-1)}}(i,n,o||0,r||i.length-1,a||e)}}()},function(t,e,i){"use strict";i.r(e);var n,o=function(){function t(){}return t.baseTileSize=256,t.minLatitude=-85.0511287798066,t.maxLatitude=85.0511287798066,t.maxLongitude=180,t.minLongitude=-180,t.maxDegrees=360,t.radiusEarthMeters=6378137,t.tileCacheSize=512,t.rasterLayerOrder=1,t.annotationLayerOrder=100,t.flingMinVelocity=-1e4,t.flingMaxVelocity=1e4,t.flingTimeConstant=150,t.flingSpeedMultiply=10,t.minDurationFlyTo=1e3,t.maxDurationFlyTo=13e3,t.maxBearingAngle=720,t.defaultMinZoom=0,t.defaultMaxZoom=22,t.defaultMaxNativeZoom=19,t.tileExtend=4096,t.defaultAnimationDuration=300,t.defaultFlyZoom=17,t.defaultMapUrl="https://mapnik.xinkciti.com/all/2d/{z}/{x}/{y}.png",t.minTilt=0,t.maxTilt=60,t.minTimeMoving=150,t.minTimeDoubleZoom=500,t}(),r=function(){function t(){}return t.rad2Deg=180/Math.PI,t.deg2Rad=Math.PI/180,t.epsilon=1e-6,t.NONE=-1,t}(),a=function(){function t(){}return t.fov=30*r.deg2Rad,t.nearPlane=.1,t.farPlane=1e3,t.height=15.5,t}(),s=function(){function t(){}return t.numTrianglesOnRoundCap=6,t.numTrianglesOnRoundJoin=5,t}(),u=function(){function t(t,e){this.latitude=t,this.longitude=e}return t.prototype.getLatitude=function(){return this.latitude},t.prototype.getLongitude=function(){return this.longitude},t.prototype.distanceTo=function(t){var e=r.deg2Rad*this.latitude,i=r.deg2Rad*this.longitude,n=r.deg2Rad*t.getLatitude(),a=r.deg2Rad*t.getLongitude(),s=Math.sin((n-e)/2),u=Math.sin((a-i)/2);return 2*o.radiusEarthMeters*Math.asin(Math.sqrt(s*s+Math.cos(e)*Math.cos(n)*u*u))},t}(),h=function(){function t(){}return t.markerDefault="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAFe0lEQVRYR6WWaWxUVRTH/+e+6SxdmC7QZaogsgtGCZXaDiatUNNFPhDFD9aIgIImaiKRDyxRBINARDQh6QeMISEBA9EQYou0Fauxu40kUChBVMB22lKVls72Zt495j0y7VBmOjNwP757z//87rlneYQE1n8lT6b7k22VTLQKoMUgOJhJgHmQCOcBrg2o3pPTG35zAeB4pCmeQz1OZ9oUO6qJ8D6IZk1mQ8z9GuQhJUAHc+tbBmPpxwQYWblkqltaPwXRmlhi4fvMskFy8O38uo4rNEk0JgUYWL4oR7Paa8gI+X0siQ5o/nW5ZzovRoOICsAVsy0uyt5NQmwKuWZmBKTEiF+FW1Xh16Tx0EmCkJKUhHSrBWZFAdG4LDGfkm7fekdT11CkK0QFcJUXPwWF2kNqunNvIIgBtweqlBHDYSLCtGQbUi1miHAIqb18ydN6orQJwYmGUQEGqpzHJdFq3SDk3DXqRpD5zgfQEJjPM0EFsIgAB4iEAJCdYkOaxTIGQcznhPvWM9lN3aNxAbgqFk+DktwPkNB9BaXEoMeLUTWg4/gg+UQg6N9e1vXHdV2wcX5+ljJlynsk6C0QZVoUgdyUFFhM488hVc2ZX9/aEhdAb8XTK4ViOhV++xu3DXgNLL+93HapeiOg09y1zhbO/0IIsQEga25qMtLM409BUtuSW9e6Jy4AV6VzMwTt0w9LZtz2+9Hv9oIZw2CuKW2/uCVSEvy4dP4aEuJDEM3MtFmQabVCMR5FD5z8Kq+2ZX1cAP3PF+9iiO0hgFs+P256vLpKH4LaxyWdl2siATQ8mmE3Zed9TUTlGVYzsmy2cQDJ3+TVNb8YF0Bf5bLtJLArBDDs8xs5AOYhKeWBZzt6dkcCaCyYU6aYTPuJxOOZVgsybeMRYMlHHXXN1XEBDFQVvyJJHAnlgDsQRK+eAwyVwUdL2y6ujQRwtnDBTiLxLhHs2ck22K3jlcBS2+Ooa73n6SKWYW95wTxhsvaEAFRNQ99tN1RNY2a+BskflXb2HA6HaCpcUAbCHn1ICUHkSEtFssk01pRYU1c5TnecjCsC+qHequJzgsQTY4moqugf9Rg9gMEjgsUvkvk7QUZUShhURoQc3WOWzYoMq2Xs/RlycNgbfGzBDx3/xA3gKi9aDZNyPGSgSYlhn4qbXj0Zo690ixkZViuSFDHekjXtg9zrI3upu1tvWnetqJ2wxzkvzZ4+tQ5Ey0IW+t09gQCGPD74NO0uIbMQ0EvPqP1Q6d15w6vs5eWOsy3XImFHH0aA6C0vKlUU0RA+XfTho4Nomga/lHpvMG6bJITResMHke6QtOAGr7f/yMymv3wJAeiHr65YYk82m7dBKJsnjXuUTWMS+n3vOBq7jJadMIAxccoL5gYUSwsRZSYCwSxVDsoq11Dgp4Kurnvadkgr5h/RnyWPWG0pedVMypeJAIDl3mCQ9z18pvXfyexiAujGg2WFc6TZdIKJjLKMtYjZJbXgS3nftzdP9jtm5EgsMX2/e+FCc9aMKS+wUI7Gc16ffG5VrZnV2DUc63xcALpIX2XxDAJ2QIjXJhVl+TND2+Sobe+K5TzuCOgHjwPKsvKiFaSIWhApUcWlXOfz9B2LVnYT7eKOgJELJQtTZUr660x0IBIAszzEgcCu/PrOG/HcPqEIhARdVc5SEA4DNH2Ck1GSvDGnrvlYrMQLt0soArrhlYrZlhSa9iYJ5fNwIWa5X/qCnzwUYeA8cBlOFOh7rnAJKcpOKKLyzh5fkKxty69tM/4jE1kJR0AX3wGIN6qcawWR0ZwI2tYc7eZndPp3fyLO7ysHQg7+Xr40S7Gat4B5biDo3zq9/tcLiTp/IADd2FVR9CoJtufUth1MJPHCQf8HoodVPzPKP84AAAAASUVORK5CYII=",t.myPosition="data:image/png;base64,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",t.myPosition2x="data:image/png;base64,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",t.myPosition3x="data:image/png;base64,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",t.zoomOutIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAQAAACR313BAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfiCwEEOA6vGn99AAAAJElEQVQY02NgoCFgZGChSHcCfun/+KRZGH5QoJuA3TT1N2UAAKRCA8m04HhjAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTExLTAxVDA0OjU2OjE0LTA0OjAwAvm1FAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMS0wMVQwNDo1NjoxNC0wNDowMHOkDagAAAAASUVORK5CYII=",t.zoomInIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAQAAACR313BAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAHdElNRQfiCwEENCWvE8kxAAAAwElEQVQY033RPUoEQRAF4G+2mxUWBCNjTyBs4hkMzfQ8u5cxNJTFE2jmCQxM1kgRFIfubYMpcQZ/qoPiva5X1a+af6OLnFRnLjw7cOlKUsdlGWvNu2YdOFLSyYqGghZ8UzOTNqFSlC946kjxaomEpXP7sgfXsNEUbXKKZjOoe3yYydG6KHYW+uF6jj1pND+rA59x48Wb3oljVXLv1tzC3fTFq/C9+t13h11s8g/fs5++xaa2Hj05tA08+pIxat/EJ3JFQ3rCv00IAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTExLTAxVDA0OjUyOjM3LTA0OjAweN8IjgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMS0wMVQwNDo1MjozNy0wNDowMAmCsDIAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stSzZjb29QMEXVGp49AAAAAElFTkSuQmCC",t.tiltUpIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACpSURBVHgBlZC9DcIwEIVfuChO6RE8AT9tJAoU0TMKmQAxAdnEJQ3IVKa0CPMYY1NEFooJedX5fN873QMSOisjrvqxT/1nKYgxUr4U1trNdr26fc/MhkDGchmgUBORDEajoNLdCXDLqMXDdqUMT4Lq/jw4YOgu4UqScaO/8aK7nXeR+CFv2tbVvOnBTxgFGf/iGJGDa+pq0WZxgvhTIem8LMBfDkdMUEbE3zxPNOjkuRmkAAAAAElFTkSuQmCC",t.tiltDownIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAKCAYAAACE2W/HAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACrSURBVHgBrZGxDcIwEEXvzCKZgMglcRWC6DMCG8AEhBHYIGzAAKA0IEqcDTJCeuAOH5KlgAgKUV7l/61nWz6AnuDxXGaIuP5HIoBUJSbMiHjXVWLmzSwa75WE0Y2WrrIdpK1c9HqqL4vLNWBWhauCFs1Oo1D7pPwinujqzpQCQ/1FqhDdXgPVDHOjLcNj9e5A7aRYDm4VhcToXD7AZ0JYfEo/OZzKXEYFQ/MEPtI/ZDp7uSEAAAAASUVORK5CYII=",t.locationIcon="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAAQABAAD/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/hAytodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Nzg4QTJBMjVEMDI1MTFFN0EwQUVDODc5QjYyQkFCMUQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Nzg4QTJBMjZEMDI1MTFFN0EwQUVDODc5QjYyQkFCMUQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3ODhBMkEyM0QwMjUxMUU3QTBBRUM4NzlCNjJCQUIxRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3ODhBMkEyNEQwMjUxMUU3QTBBRUM4NzlCNjJCQUIxRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/bAEMABQMEBAQDBQQEBAUFBQYHDAgHBwcHDwsLCQwRDxISEQ8RERMWHBcTFBoVEREYIRgaHR0fHx8TFyIkIh4kHB4fHv/AAAsIABQAFAEBEQD/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/2gAIAQEAAD8A98+JHjbWrHxHZeCfBOn2N94mvLVr6aa/kKWemWitt+0T7fmbLZVUHUgnOBXmfhHxZ4x8LWeveINO8beF/ino0F7JqGu2emOyX2no+N7W+ZHUxIFJEZwCAdpr6D0fUrLV9Js9W024S5sb2BLi3mXpJG6hlYfUEV8++OvDtt4W+IPivT/EPiXU7bRviLobafZ67qVx5iafeK8p+zF8ARxFZMoCQMArmvOfhL8PLj4EXWueLPFviPRb+7vdNl0zRtG0m5NzPqk0pUIAmASuQvY4zk4xz9F/BD4fXvgv4Z6Poepa7rVxfJbxvcRy3nmJbSFFDQxcfLGpBwPXJ713mr6bp2r6dPpurWFrf2U67Zre5iWSOQejKwINcF8KPhX4G8F6lq+paHoNpHezalPLHcPChktkbH7mJgoKRjsOvJyTXpIr/9k=",t}(),p=function(){function t(){}return t.bgColor="rgba(255,255,255,1)",t.size="29px",t.content="\n.mapgl {\n  overflow: hidden;\n  height: 100%;\n  width: 100%;\n  position: relative;\n  box-sizing: content-box;\n}\n\n.mapgl canvas {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  display: inherit;\n}\n\n.mapgl .ui {\n  width: 25px;\n  position: absolute;\n  right: 20px;\n  bottom: 20px;\n}\n\n.mapgl .ui .button {\n  margin: 3px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: space-around;\n    width: "+t.size+";\n    height: "+t.size+";\n    border-radius: 2px;\n    border: 1px solid darken("+t.bgColor+", 5%);\n    background-color: "+t.bgColor+";\n    cursor: pointer;\n    user-select: none;\n    -moz-user-select: none;\n}\n\n.mapgl .ui .button:hover {\n    background-color: darken("+t.bgColor+", 5%);\n  }\n\n.mapgl .ui .button:active {\n    background-color: darken("+t.bgColor+", 10%);\n  }\n \n .mapgl .ui .zoom-in-icon { \n    background-image: url("+h.zoomInIcon+");   \n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 12px;\n    height: 12px;  \n    opacity: 0.5;\n    z-index: 1;  \n    \n}\n\n.mapgl .ui .zoom-out-icon { \n    background-image: url("+h.zoomOutIcon+"); \n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 12px;\n    height: 12px;  \n    opacity: 0.5;\n    z-index: 1;      \n}\n\n.mapgl .ui .tilt-up-icon { \n    background-image: url("+h.tiltUpIcon+"); \n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 14px;\n    height: 9px; \n    opacity: 1;\n    z-index: 1;  \n    \n}\n.mapgl .ui .tilt-down-icon { \n    background-image: url("+h.tiltDownIcon+"); \n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 14px;\n    height: 10px; \n    opacity: 1;\n    z-index: 1;  \n    \n}\n.mapgl .ui a:hover {\n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 12px;\n    height: 12px;\n    opacity: 1;\n    z-index: 1;\n    \n}\n\n.mapgl .ui .location {\n    background-image: url("+h.locationIcon+");\n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 17px;\n    height: 17px;     \n    position: absolute;\n    opacity: 0.5;\n    z-index: 1;\n}\n",t}(),l=function(){function t(t,e,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),this.red=t,this.green=e,this.blue=i,this.alpha=n}return t.prototype.buffer=function(){return[this.red,this.green,this.blue,this.alpha]},Object.defineProperty(t.prototype,"rgba",{get:function(){return"rgba("+255*this.red+","+255*this.green+","+255*this.blue+",1)"},enumerable:!0,configurable:!0}),t.fromHex=function(e){void 0===e&&(e="000000"),7!=e.length&&9!=e.length||(e=e.substring(1,e.length));var i=parseInt(e,16);return 6==e.length?new t((i>>16)/255,(i>>8&255)/255,(255&i)/255):new t((i>>24&255)/255,(i>>16&255)/255,(i>>8&255)/255,(255&i)/255)},t.fromInt=function(e){return void 0===e&&(e=0),e<0&&(e=0),new t((e>>16&255)/255,(e>>8&255)/255,(255&e)/255)},t.mix=function(e,i,n){return new t(e.red*n+i.red*(1-n),e.green*n+i.green*(1-n),e.blue*n+i.blue*(1-n),e.alpha*n+i.alpha*(1-n))},Object.defineProperty(t.prototype,"code",{get:function(){var t=function(t){var e=(255*t).toString(16);e=(e=1==e.length?"0"+e:e).length>2?e.substr(0,2):e};return"#"+t(this.red)+t(this.green)+t(this.blue)+t(this.alpha)},enumerable:!0,configurable:!0}),t.isValid=function(t){return/^[0-9A-F]{8}$/i.test(t)},t}(),c=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.length,i=0,n=0;return e>0&&(i=this.x/e,n=this.y/e),new t(i,n)},t.prototype.set=function(t){this.x=t.x,this.y=t.y},t.prototype.invert=function(){return new t(-this.x,-this.y)},t.prototype.rotate90=function(){return new t(this.y,-this.x)},t.prototype.add=function(e){return new t(e.x+this.x,e.y+this.y)},t.prototype.subtract=function(e){return e?new t(this.x-e.x,this.y-e.y):this.clone()},t.prototype.multiply=function(e){return new t(e*this.x,e*this.y)},t.prototype.rotateBy=function(e){var i=Math.cos(e*Math.PI/180),n=Math.sin(e*Math.PI/180);return new t(this.x*i-this.y*n,this.x*n+this.y*i)},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y},t.prototype.buffer=function(){return[this.x,this.y]},t.perp=function(e,i){return new t(i[1]-e[1],e[0]-i[0])},t.neg=function(e){return new t(-e.x,-e.y)},t}(),f=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.x=t,this.y=e,this.z=i}return t.prototype.clone=function(){return new t(this.x,this.y,this.z)},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.length,i=0,n=0,o=0;return e>0&&(i=this.x/e,n=this.y/e,o=this.z/e),new t(i,n,o)},t.prototype.set=function(t){this.x=t.x,this.y=t.y,this.z=t.z},t.prototype.invert=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.rotate90=function(){return new t(this.y,-this.x,this.z)},t.prototype.add=function(e){return new t(e.x+this.x,e.y+this.y,e.z+this.z)},t.prototype.subtract=function(e){return e?new t(this.x-e.x,this.y-e.y,this.z-e.z):this.clone()},t.prototype.multiply=function(e){return new t(e*this.x,e*this.y,e*this.z)},t.prototype.rotateBy=function(e){var i=Math.cos(e*Math.PI/180),n=Math.sin(e*Math.PI/180);return new t(this.x*i-this.y*n,this.x*n+this.y*i)},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y+t.z*this.z},t.prototype.buffer=function(){return[this.x,this.y,this.z]},t.perp=function(e,i){return new t(i[1]-e[1],e[0]-i[0])},t.neg=function(e){return new t(-e.x,-e.y,-e.z)},t}(),d=function(){function t(){}return Object.defineProperty(t,"pixelScale",{get:function(){return t._pixelScale},set:function(e){t._pixelScale=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"devicePixelScale",{get:function(){return t._devicePixelScale},set:function(e){t._devicePixelScale=e},enumerable:!0,configurable:!0}),t.getTileSize=function(){return o.baseTileSize*t.pixelScale},t.extendOptions=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=0,o=e;n<o.length;n++){var r=o[n];for(var a in r)t[a]=r[a]}return t},t._pixelScale=1,t._devicePixelScale=1,t}(),g=function(){function t(){}return t.clamp=function(t,e,i){return t<e?e:t>i?i:t},t}(),m=function(){function t(){}return t.projectInternal=function(t,e){var i=g.clamp(t.getLatitude(),o.minLatitude,o.maxLatitude);return new c(o.maxLongitude+t.getLongitude(),o.maxLongitude-r.rad2Deg*Math.log(Math.tan(Math.PI/4+i*Math.PI/o.maxDegrees))).multiply(e/o.maxDegrees)},t.worldSize=function(t){return t*d.getTileSize()},t.getMetersPerPixelAtLatitude=function(t,e){var i=Math.pow(2,e),n=g.clamp(t,o.minLatitude,o.maxLatitude);return Math.cos(n*r.deg2Rad)*Math.PI*2*o.radiusEarthMeters/this.worldSize(i)},t.convertToMeterFromLatLng=function(t){var e=g.clamp(t.getLatitude(),o.minLatitude,o.maxLatitude),i=t.getLongitude(),n=1-1e-15,a=g.clamp(Math.sin(r.deg2Rad*e),-n,n),s=o.radiusEarthMeters*i*r.deg2Rad,u=.5*o.radiusEarthMeters*Math.log((1+a)/(1-a));return new f(u,s,0)},t.convertToLatLngFromMeter=function(t){var e=(2*Math.atan(Math.exp(t.x/o.radiusEarthMeters))-Math.PI/2)*r.rad2Deg,i=t.y*r.rad2Deg/o.radiusEarthMeters;return new u(e,i)},t.projectScale=function(t,e){return this.projectInternal(t,this.worldSize(e))},t.projectZoom=function(t,e){return this.projectInternal(t,1<<e)},t.unproject=function(t,e){var i=t.multiply(o.maxDegrees/this.worldSize(e));return new u(o.maxDegrees/Math.PI*Math.atan(Math.exp((o.maxLongitude-i.y)*r.deg2Rad))-90,i.x-o.maxLongitude)},t}(),y=function(){function t(t,e,i,n,o,r){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n,this.minZoom=o,this.maxZoom=r}return t.fromLatLngBounds=function(e,i,n){var o=m.projectZoom(e.getSouthwest(),n),r=m.projectZoom(e.getNortheast(),n),a=Math.pow(2,n);return new t(Math.floor(o.x),Math.floor(r.x),g.clamp(Math.floor(r.y),0,a),g.clamp(Math.floor(o.y),0,a),i,n)},t.prototype.contains=function(t){var e=t.getX(),i=t.getY(),n=t.getZoom();if(n<=this.maxZoom&&n>=this.minZoom){if(0==n)return!0;var o=this.maxZoom-n,r=this.minX>>o,a=this.maxX>>o,s=this.minY>>o,u=this.maxY>>o;return(this.minX>this.maxX?e>=r||e<=a:e<=a&&e>=r)&&i<=u&&i>=s}return!1},t}(),A=function(){function t(t,e){this.southwest=t,this.northeast=e}return t.prototype.center=function(){return new u((this.northeast.getLatitude()+this.southwest.getLatitude())/2,(this.northeast.getLongitude()+this.southwest.getLongitude())/2)},t.prototype.contains=function(t){var e=t.getZoom();return y.fromLatLngBounds(this,e,e).contains(t)},t.prototype.getNortheast=function(){return this.northeast},t.prototype.getSouthwest=function(){return this.southwest},t}(),v=function(){function t(){}return t.lat=function(t,e){var i=Math.PI-2*Math.PI*e/Math.pow(2,t);return r.rad2Deg*Math.atan(.5*(Math.exp(i)-Math.exp(-i)))},t.lon=function(t,e){return e/Math.pow(2,t)*o.maxDegrees-o.maxLongitude},t.screenCoordinateToNDC=function(t,e){var i=2*t.x/e.x-1,n=1-2*t.y/e.y;return new c(i,n)},t.NDCCoordinateToScreen=function(t,e){var i=e.x*(1+t.x)/2,n=e.y*(1-t.y)/2;return new f(i,n)},t.screenCoordinateToLatLng=function(t,e){return this.screenCoordinateToLatLngZoom(t,e,e.getZoom())},t.screenCoordinateToLatLngZoom=function(t,e,i){var n=e.getScreenSize(),o=e.getInverseViewProjectionMatrix(),r=Math.pow(2,Math.floor(i)),a=this.screenCoordinateToNDC(t,n),s=o.transform(new f(a.x,a.y,-1),1),u=o.transform(new f(a.x,a.y,1),1),h=u.z-s.z,p=s.x-(u.x-s.x)*s.z/h,l=s.y-(u.y-s.y)*s.z/h,d=e.getTarget(),g=Math.pow(2,i),y=m.projectScale(d,g);return m.unproject(new c(p+y.x,y.y-l),r)},t.pixelCoordinateToCameraCoordinate=function(t,e){return this.pixelCoordinateToCameraCoordinateZoom(t,e,e.getZoom())},t.pixelCoordinateToCameraCoordinateZoom=function(t,e,i){var n=Math.pow(2,i),o=m.worldSize(n),r=m.projectScale(e.getTarget(),n);r.x=r.x-o/2,r.y=o/2-r.y;var a=t;return a.x=a.x-o/2,a.y=o/2-a.y,a.x-=r.x,a.y-=r.y,a},t.latLngToScreenCoordinate=function(t,e){var i=m.projectScale(t,e.getScale()),n=this.pixelCoordinateToCameraCoordinate(i,e),o=e.getScreenSize(),r=new c(n.x+o.x/2,o.y/2-n.y);return new c(Math.round(r.x),Math.round(r.y))},t.latLngToScreenCoordinateZoom=function(t,e,i){var n=m.projectZoom(t,Math.pow(2,i)),o=this.pixelCoordinateToCameraCoordinateZoom(n,e,i),r=e.getScreenSize(),a=new c(o.x+r.x/2,r.y/2-o.y);return new c(Math.round(a.x),Math.round(a.y))},t.tileCoordinateToLatLngBounds=function(t){var e=t.getX(),i=t.getY(),n=t.getZoom(),o=new u(this.lat(n,i+1),this.lon(n,e)),r=new u(this.lat(n,i),this.lon(n,e+1));return new A(o,r)},t}();!function(t){t[t.centerWillChanged=0]="centerWillChanged",t[t.boundsChanged=1]="boundsChanged",t[t.centerChanged=2]="centerChanged",t[t.click=3]="click",t[t.dblClick=4]="dblClick",t[t.drag=5]="drag",t[t.dragEnd=6]="dragEnd",t[t.dragStart=7]="dragStart",t[t.idle=8]="idle",t[t.mouseMove=9]="mouseMove",t[t.mouseOut=10]="mouseOut",t[t.mouseOver=11]="mouseOver",t[t.projectionChanged=12]="projectionChanged",t[t.rightClick=13]="rightClick",t[t.tilesLoaded=14]="tilesLoaded",t[t.tiltChanged=15]="tiltChanged",t[t.zoomChanged=16]="zoomChanged"}(n||(n={}));var x,T,M=function(){function t(t){this.events=new Map,this.mapView=t}return t.prototype.convertEventFromName=function(t){switch(t){case"centerWillChanged":return n.centerWillChanged;case"centerChanged":return n.centerChanged;case"click":return n.click;case"dblClick":return n.dblClick;case"drag":return n.drag;case"dragEnd":return n.dragEnd;case"dragStart":return n.dragStart;case"idle":return n.idle;case"mouseMove":return n.mouseMove;case"mouseOut":return n.mouseOut;case"mouseOver":return n.mouseOver;case"rightClick":return n.rightClick;case"tiltChanged":return n.tiltChanged;case"zoomChanged":return n.zoomChanged;default:return console.error("We don't support for this event : "+t),r.NONE}},t.prototype.addEvent=function(t,e){var i=this.convertEventFromName(t);i!=r.NONE&&this.events.set(i,e)},t.prototype.removeEvent=function(t){var e=this.convertEventFromName(t);this.events.has(e)&&this.events.delete(e)},t.prototype.notify=function(t,e){var i=this.events.get(t);if(i){switch(t){case n.click:case n.rightClick:case n.dblClick:case n.dragStart:case n.drag:case n.dragEnd:case n.mouseMove:case n.mouseOut:case n.mouseOver:i({latLng:v.screenCoordinateToLatLng(this.mapView.getMousePositionOnMap(e),this.mapView.mapState),pixel:this.mapView.getMousePositionOnMap(e),xa:e});break;default:i()}}},t}();!function(t){t[t.Down=0]="Down",t[t.Up=1]="Up",t[t.Drag=2]="Drag",t[t.DragEnd=3]="DragEnd",t[t.Wheel=4]="Wheel",t[t.Move=5]="Move",t[t.Over=6]="Over",t[t.Out=7]="Out",t[t.Double=8]="Double",t[t.None=9]="None"}(x||(x={})),function(t){t[t.Left=0]="Left",t[t.Wheel=1]="Wheel",t[t.Right=2]="Right",t[t.None=3]="None"}(T||(T={}));var w=function(){function t(t,e){this.canvas=t,this.mapView=e,this.checkDragStart=!0,t.addEventListener("mousedown",this.mouseDown.bind(this)),t.addEventListener("mousemove",this.mouseMove.bind(this)),t.addEventListener("mouseup",this.mouseUp.bind(this)),t.addEventListener("wheel",this.mouseWheel.bind(this)),t.addEventListener("mouseover",this.mouseOver.bind(this)),t.addEventListener("mouseout",this.mouseOut.bind(this)),t.addEventListener("dblclick",this.doubleClick.bind(this)),t.addEventListener("contextmenu",function(t){return t.preventDefault()})}return t.prototype.drainInertiaBuffer=function(){for(var t=this.inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift()},t.prototype.doubleClick=function(t){var e=new f(t.pageX,t.pageY);this.mapView.mapEvents.notify(n.dblClick,t),this.dispatch({dx:0,dy:0,x:e.x,y:e.y,action:x.Double,button:t.button})},t.prototype.mouseOut=function(t){var e=new f(t.pageX,t.pageY);this.mapView.mapEvents.notify(n.mouseOut,t),this.dispatch({dx:0,dy:0,x:e.x,y:e.y,action:x.Out,button:t.button}),this.mousePosition=null},t.prototype.mouseWheel=function(t){if(0!=t.deltaY){var e=new f(t.pageX,t.pageY);this.dispatch({dx:t.deltaX,dy:t.deltaY,x:e.x,y:e.y,action:x.Wheel,button:t.button})}},t.prototype.mouseDown=function(t){return this.mapView.stopAnimation(),this.mousePosition=new f(t.pageX,t.pageY),this.mouseDownPosition=this.mousePosition,this.mouseDownTime=Date.now(),t.button==T.Right&&(this.lastDragRotatePosition=new c(this.mousePosition.x,this.mousePosition.y),this.inertia=[[Date.now(),this.mapView.mapState.getBearing()]]),this.dispatch({x:this.mousePosition.x,y:this.mousePosition.y,dx:0,dy:0,action:x.Down,button:t.button}),this.preMouseDown=t,!1},t.prototype.mouseMove=function(t){var e=new f(t.pageX,t.pageY),i=null!=this.preMouseDown?this.preMouseDown.button:t.button;if(this.mousePosition){var o=e.subtract(this.mousePosition);if(this.mousePosition=e,0==o.x&&0==o.y)return;this.checkDragStart&&(this.mapView.mapEvents.notify(n.dragStart,t),this.checkDragStart=!1),this.mapView.mapEvents.notify(n.drag,t),this.dispatch({x:e.x,y:e.y,dx:o.x,dy:o.y,action:x.Drag,button:i})}else this.mapView.mapEvents.notify(n.mouseMove,t),this.dispatch({x:e.x,y:e.y,dx:0,dy:0,action:x.Move,button:i});return!1},t.prototype.mouseOver=function(t){var e=new f(t.pageX,t.pageY);this.mapView.mapEvents.notify(n.mouseOver,t),this.dispatch({x:e.x,y:e.y,dx:0,dy:0,action:x.Over,button:t.button})},t.prototype.mouseUp=function(e){var i=new f(e.pageX,e.pageY);this.mouseUpTime=Date.now();var o=i.subtract(this.mouseDownPosition),r=this.mouseUpTime-this.mouseDownTime;return o.length<.01?(this.dispatch({x:i.x,y:i.y,dx:0,dy:0,action:x.Up,button:e.button}),e.button==T.Left?this.mapView.mapEvents.notify(n.click,e):e.button==T.Right&&this.mapView.mapEvents.notify(n.rightClick,e)):(this.dispatch({x:i.x,y:i.y,dx:r<t.TIME_DRAG_DETECT?o.x:0,dy:r<t.TIME_DRAG_DETECT?o.y:0,action:x.DragEnd,button:e.button}),this.mapView.mapEvents.notify(n.dragEnd,e),this.checkDragStart=!0),this.mousePosition=null,this.preMouseDown=null,!1},t.prototype.dispatch=function(t){this.mouseEventHandler(t)},t.prototype.mouseEventHandler=function(t){switch(t.action){case x.Drag:if(t.button==T.Left){var e=new f(-t.dx,t.dy).multiply(d.devicePixelScale);this.mapView.moveBy(e)}if(t.button==T.Right){this.inertia.push([Date.now(),-t.x]);var i=.4*(this.lastDragRotatePosition.x-t.x),n=-.5*(this.lastDragRotatePosition.y-t.y);this.mapView.setBearing(this.mapView.mapState.getBearing()+i),this.mapView.setTilt(this.mapView.mapState.cameraPosition.tilt-n),this.lastDragRotatePosition=new c(t.x,t.y)}break;case x.Wheel:var r=this.mapView.mapState.getZoom();r=t.dy<0?r+1:r-1;var a=new c(t.x,t.y).multiply(d.devicePixelScale);this.mapView.setZoom(r,a);break;case x.DragEnd:if(t.button==T.Left){e=new f(-t.dx,t.dy).multiply(d.devicePixelScale);this.mapView.moveByVelocity(new f(e.x,e.y).multiply(o.flingSpeedMultiply*d.devicePixelScale))}if(t.button==T.Right){if(this.drainInertiaBuffer(),this.inertia.length<2)return;var s=this.inertia,u=s.length,h=s[u-1],p=s[u-2],l=h[1]-p[1]>0?1:-1,g=(i=h[1]-p[1],3*Math.abs(i));Math.abs(g)>360&&(g=360),g*=l;var m=Math.abs(g)/90;m>1&&(m=1),this.mapView.setBearing(this.mapView.mapState.getBearing()+g,m)}break;case x.Double:if(t.button==T.Left){r=this.mapView.mapState.getZoom()+1,a=new c(t.x,t.y).multiply(d.devicePixelScale);this.mapView.setZoom(r,a)}}},t.TIME_DRAG_DETECT=300,t}(),S=function(){function t(){}return t.create=function(t,e,i){var n=window.document.createElement(t);return e&&(n.className=e),i&&i.appendChild(n),n},t}(),E=function(){function t(){}return t.prototype.onMapWillChange=function(t){},t.prototype.onMapIsChanging=function(t){},t.prototype.onMapDidChange=function(t){},t}(),b=function(){function t(){}return t.prototype.notifyCameraWillChange=function(){},t.prototype.notifyCameraIsChanging=function(){},t.prototype.notifyCameraDidChange=function(){},t}(),L=function(){function t(t,e,i,n){void 0===t&&(t=new u(0,0)),void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.target=t,this.tilt=e,this.bearing=i,this.zoom=n}return t.prototype.setTarget=function(t){this.target=t},t.prototype.setTilt=function(t){this.tilt=t},t.prototype.setBearing=function(t){this.bearing=t%o.maxDegrees},t.prototype.getTarget=function(){return this.target},t.prototype.getTilt=function(){return this.tilt},t.prototype.getBearing=function(){return this.bearing},t.prototype.getZoom=function(){return this.zoom},t.prototype.setZoom=function(t){this.zoom=t},t}(),C=function(){function t(t){void 0===t&&(t=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]),this.data=t}return t.translate=function(e,i,n){return void 0===n&&(n=0),new t([[1,0,0,0],[0,1,0,0],[0,0,1,0],[e,i,n,1]])},Object.defineProperty(t.prototype,"position",{get:function(){return new f(this.data[3][0],this.data[3][1],this.data[3][2])},enumerable:!0,configurable:!0}),t.rotateX=function(e){e*=Math.PI/180;var i=Math.sin(e),n=Math.cos(e);return new t([[1,0,0,0],[0,n,i,0],[0,-i,n,0],[0,0,0,1]])},t.rotateY=function(e){e*=Math.PI/180;var i=Math.sin(e),n=Math.cos(e);return new t([[n,0,i,0],[0,1,0,0],[-i,0,n,0],[0,0,0,1]])},t.rotateZ=function(e){e*=Math.PI/180;var i=Math.sin(e),n=Math.cos(e);return new t([[n,i,0,0],[-i,n,0,0],[0,0,1,0],[0,0,0,1]])},t.scale=function(e,i,n){return null==i&&(i=e,n=e),new t([[e,0,0,0],[0,i,0,0],[0,0,n,0],[0,0,0,1]])},t.prototype.concat=function(e){var i=new t([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);if(null==e)return i;for(var n=0;n<4;++n)for(var o=0;o<4;++o)for(var r=0;r<4;++r)i.data[n][r]+=this.data[n][o]*e.data[o][r];return i},t.projection2d=function(e,i,n,o,r,a){return void 0===r&&(r=-100),void 0===a&&(a=100),new t([[2/(i-e),0,0,0],[0,2/(o-n),0,0],[0,0,-2/(a-r),0],[-(e+i)/(i-e),-(o+n)/(o-n),-(r+a)/(r-a),1]])},t.perspective=function(e,i,n,o){var r=Math.tan(e/2)*n,a=r*i;return t.frustum(-a,a,-r,r,n,o)},t.frustum=function(e,i,n,o,r,a){return void 0===r&&(r=-100),void 0===a&&(a=100),new t([[2*r/(i-e),0,0,0],[0,2*r/(o-n),0,0],[(i+e)/(i-e),(o+n)/(o-n),-(a+r)/(a-r),-1],[0,0,-2*r*a/(a-r),0]])},t.prototype.transform=function(t,e){void 0===e&&(e=0);var i=this.data[0][0]*t.x+this.data[1][0]*t.y+this.data[2][0]*t.z+this.data[3][0]*e,n=this.data[0][1]*t.x+this.data[1][1]*t.y+this.data[2][1]*t.z+this.data[3][1]*e,o=this.data[0][2]*t.x+this.data[1][2]*t.y+this.data[2][2]*t.z+this.data[3][2]*e;return 0==(e=this.data[0][3]*t.x+this.data[1][3]*t.y+this.data[2][3]*t.z+this.data[3][3]*e)&&(e=1),new f(i/e,n/e,o/e)},t.prototype.buffer=function(){return this.data[0].concat(this.data[1],this.data[2],this.data[3])},t.prototype.transpose=function(){var e=new t;return e.data[0][0]=this.data[0][0],e.data[0][1]=this.data[1][0],e.data[0][2]=this.data[2][0],e.data[0][3]=this.data[3][0],e.data[1][0]=this.data[0][1],e.data[1][1]=this.data[1][1],e.data[1][2]=this.data[2][1],e.data[1][3]=this.data[3][1],e.data[2][0]=this.data[0][2],e.data[2][1]=this.data[1][2],e.data[2][2]=this.data[2][2],e.data[2][3]=this.data[3][2],e.data[3][0]=this.data[0][3],e.data[3][1]=this.data[1][3],e.data[3][2]=this.data[2][3],e.data[3][3]=this.data[3][3],e},t.lookAt=function(e,i,n,o){void 0===n&&(n=1),void 0===o&&(o=new f(0,0,1));var r=e.subtract(i).normalize(),a=o.cross(r).normalize(),s=r.cross(a).normalize(),u=new t;u.data[0]=[a.x,s.x,r.x,0],u.data[1]=[a.y,s.y,r.y,0],u.data[2]=[a.z,s.z,r.z,0];var h=t.translate(-e.x,-e.y,-e.z),p=t.scale(n);return h.concat(u).concat(p)},t.prototype.inverse=function(){for(var e=this.data.concat(),i=0;i<4;++i)e[i]=e[i].concat();for(var n=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],o=0;o<4;++o){for(i=o;i<4&&0==e[i][o];)++i;if(4==i||0==e[i][o])return console.log("Cannot calculate inverse, determinant is zero"),this;if(i!=o){var r=e[o];e[o]=e[i],e[i]=r,r=n[o],n[o]=n[i],n[i]=r}var a=e[o],s=n[o];for(i=0;i<4;++i){var u=e[i],h=n[i];if(i!=o){if(0!=u[o]){for(var p=-u[o]/a[o],l=o;l<4;++l)u[l]=u[l]+p*a[l];for(l=0;l<4;++l)h[l]=h[l]+p*s[l]}}else{if(0==(p=a[o]))return console.log("Cannot calculate inverse, determinant is zero"),this;for(l=o;l<4;++l)u[l]=u[l]/p;for(l=0;l<4;++l)h[l]=h[l]/p}}}return new t([n[0],n[1],n[2],n[3]])},t}(),R=function(){function t(t){this.zoom=0,this.scale=1,this.willChange=!1,this.zoomIn=!1,this.zoomOut=!1,this.panning=!1,this.flyingTo=!1,this.tilting=!1,this.bearing=!1,this.mapSettings=t,this.cameraPosition=new L}return t.prototype.setScreenSize=function(t,e){this.screenWidth=t,this.screenHeight=e,this.projectionMatrix=C.perspective(a.fov,this.screenWidth/this.screenHeight,a.nearPlane,a.farPlane),this.recalculateMatrices()},t.prototype.matrixFor=function(t){var e=1<<t.getTileCoordinate().getZoom(),i=m.worldSize(this.scale)/e,n=t.toVec3(),o=n.x*i+i/2,r=n.y*i+i/2,a=v.pixelCoordinateToCameraCoordinate(new c(o,r),this),s=C.translate(a.x,a.y,0);return s=C.scale(i/2,i/2,1).concat(s)},t.prototype.recalculateMatrices=function(){this.viewMatrix=this.updateViewMatrix(),this.viewProjectionMatrix=this.viewMatrix.concat(this.projectionMatrix),this.inverseViewProjectionMatrix=this.viewProjectionMatrix.inverse()},t.prototype.updateViewMatrix=function(){var t=d.getTileSize(),e=a.height*Math.tan(a.fov/2)*t/this.screenHeight/(t/2),i=C.rotateX(this.cameraPosition.tilt).transform(new f(0,0,a.height),0),n=C.rotateZ(this.cameraPosition.bearing).transform(i,0);i=C.rotateX(this.cameraPosition.tilt).transform(new f(0,1,0),0);var o=C.rotateZ(this.cameraPosition.bearing).transform(i,0),r=C.lookAt(n,new f(0,0,0),1,o);return r=C.scale(e,e,e).concat(r)},t.prototype.setTarget=function(t){this.cameraPosition.setTarget(t),this.recalculateMatrices()},t.prototype.setTilt=function(t){this.cameraPosition.setTilt(t),this.recalculateMatrices()},t.prototype.setBearing=function(t){this.cameraPosition.setBearing(t),this.recalculateMatrices()},t.prototype.setZoom=function(t){this.zoom=t,this.cameraPosition.setZoom(t),this.scale=Math.pow(2,t),this.recalculateMatrices()},t.prototype.getProjectionMatrix=function(){return this.projectionMatrix},t.prototype.getViewMatrix=function(){return this.viewMatrix},t.prototype.getViewProjectionMatrix=function(){return this.viewProjectionMatrix},t.prototype.getInverseViewProjectionMatrix=function(){return this.inverseViewProjectionMatrix},t.prototype.getScreenSize=function(){return new c(this.screenWidth,this.screenHeight)},t.prototype.getTilt=function(){return this.cameraPosition.getTilt()},t.prototype.getBearing=function(){return this.cameraPosition.getBearing()},t.prototype.getScale=function(){return this.scale},t.prototype.getZoom=function(){return this.zoom},t.prototype.getTarget=function(){return this.cameraPosition.getTarget()},t.prototype.isZoomIn=function(){return this.zoomIn},t.prototype.isZoomOut=function(){return this.zoomOut},t.prototype.isTilting=function(){return this.tilting},t.prototype.isBearing=function(){return this.bearing},t.prototype.isPanning=function(){return this.panning},t.prototype.isFlyingTo=function(){return this.flyingTo},t.prototype.isStartedAnimation=function(){return this.startedAnimation},t.prototype.isMoving=function(){return this.movingTo},t.prototype.getCameraPosition=function(){return this.cameraPosition},t.prototype.isWillChange=function(){return this.willChange},t.prototype.setCameraPosition=function(t){this.cameraPosition=t},t}(),P=function(){function t(t){this.orderedKeys=[],this.size=t,this.tiles=new Map}return t.prototype.setSize=function(t){for(this.size=t;this.orderedKeys.length>t;){var e=this.orderedKeys[0];this.orderedKeys.shift(),this.tiles.delete(e.toString())}},t.prototype.add=function(t,e){if(e.isRenderable()&&this.size){if(this.tiles.set(t.toString(),e)){var i=this.orderedKeys.indexOf(t.toString(),0);i>-1&&this.orderedKeys.splice(i,1)}this.orderedKeys.push(t.toString()),this.orderedKeys.length>this.size-1&&this.pop(this.orderedKeys[0])}},t.prototype.get=function(t){return this.tiles.get(t.toString())},t.prototype.pop=function(t){var e=this.tiles.get(t.toString());if(this.tiles.delete(t)){var i=this.orderedKeys.indexOf(t,0);i>-1&&this.orderedKeys.splice(i,1)}return e},t.prototype.has=function(t){return null!=this.tiles.get(t.toString())},t.prototype.clear=function(){this.orderedKeys=[],this.tiles.clear()},t}(),I=function(){function t(t,e){this.unwrappedTileCoordinate=t,this.tile=e}return t.prototype.clone=function(){return new t(this.unwrappedTileCoordinate,this.tile)},t.prototype.getTile=function(){return this.tile},t.prototype.getUnwrappedTileCoordinate=function(){return this.unwrappedTileCoordinate},t}(),D=function(){function t(t,e,i){this.x=t,this.y=e,this.zoom=i}return t.fromLatLng=function(e,i){var n=m.projectZoom(e,Math.pow(2,i)).multiply(1/d.getTileSize());return new t(Math.floor(n.x),n.y,i)},t.prototype.parent=function(){return new t(this.x/2,this.y/2,this.zoom-1)},t.prototype.children=function(){var e=this.zoom+1,i=2*this.x,n=2*this.y;return[new t(i,n,e),new t(i,n+1,e),new t(i+1,n,e),new t(i+1,n+1,e)]},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getZoom=function(){return this.zoom},t.prototype.equal=function(t){return this.x==t.x&&this.y==t.y&&this.zoom==t.zoom},t.prototype.notEqual=function(t){return this.x!=t.x||this.y!=t.y||this.zoom!=t.zoom},t.prototype.lessThan=function(t){return this.x==t.x?this.y==t.y?this.zoom<t.zoom:this.y<t.y:this.x<t.x},t.prototype.isChildOf=function(t){return 0==t.zoom||t.zoom<this.zoom&&t.x==this.x>>this.zoom-t.zoom&&t.y==this.y>>this.zoom-t.zoom},t.prototype.toString=function(){return"x"+this.getX()+"y"+this.getY()+"z"+this.getZoom()},t}(),O=function(){function t(){}return t.createWithXYZoom=function(e,i,n){var o=new t;return o.wrap=(e<0?e-(1<<n)+1:e)/(1<<n)>>0,o.tileCoordinate=new D(e&(1<<n)-1,i<0?0:Math.min(i,(1<<n)-1),n),o},t.createWithWrapAndTileCoordinate=function(e,i){var n=new t;return n.wrap=e,n.tileCoordinate=i,n},t.fromLatLng=function(e,i){var n=m.projectScale(e,Math.pow(2,i)).multiply(1/d.getTileSize());return t.createWithXYZoom(Math.floor(n.x),Math.floor(n.y),i)},t.prototype.toVec3=function(){var t=this.tileCoordinate.getX()+this.wrap*(1<<this.tileCoordinate.getZoom());return new f(t,this.tileCoordinate.getY(),0)},t.prototype.parent=function(){var e=this.tileCoordinate.zoom-1,i=this.tileCoordinate.x/2>>0,n=this.tileCoordinate.y/2>>0;return t.createWithWrapAndTileCoordinate(this.wrap,new D(i,n,e))},t.prototype.children=function(){var e=this.tileCoordinate.zoom+1,i=2*this.tileCoordinate.x,n=2*this.tileCoordinate.y;return[t.createWithWrapAndTileCoordinate(this.wrap,new D(i,n,e)),t.createWithWrapAndTileCoordinate(this.wrap,new D(i,n+1,e)),t.createWithWrapAndTileCoordinate(this.wrap,new D(i+1,n,e)),t.createWithWrapAndTileCoordinate(this.wrap,new D(i+1,n+1,e))]},t.prototype.getWrap=function(){return this.wrap},t.prototype.getTileCoordinate=function(){return this.tileCoordinate},t.prototype.equal=function(t){return this.wrap==t.getWrap()&&this.tileCoordinate.equal(t.getTileCoordinate())},t.prototype.notEqual=function(t){return this.wrap!=t.getWrap()},t.prototype.lessThan=function(t){return this.wrap==t.getWrap()?this.tileCoordinate.lessThan(t.getTileCoordinate()):this.wrap<t.getWrap()},t}(),B=function(){function t(){}return t.scanTriangle=function(t,e,i,n,o,r){var a=new Z(t,e),s=new Z(e,i),u=new Z(i,t);if(a.dy>s.dy){var h=a;a=s,s=h}if(a.dy>u.dy){h=a;a=u,u=h}if(s.dy>u.dy){h=s;s=u,u=h}a.dy&&k(u,a,n,o,r),s.dy&&k(u,s,n,o,r)},t}(),Z=function(){return function(t,e){if(this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.dx=0,this.dy=0,t.y>e.y){var i=t;t=e,e=i}this.x0=t.x,this.y0=t.y,this.x1=e.x,this.y1=e.y,this.dx=e.x-t.x,this.dy=e.y-t.y}}();function k(t,e,i,n,o){var r=Math.max(i,Math.floor(e.y0)),a=Math.min(n,Math.ceil(e.y1));if(t.x0==e.x0&&t.y0==e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var u=t.dx/t.dy,h=e.dx/e.dy,p=t.dx>0?1:0,l=e.dx<0?1:0,c=r;c<a;++c){var f=u*Math.max(0,Math.min(t.dy,c+p-t.y0))+t.x0,d=h*Math.max(0,Math.min(e.dy,c+l-e.y0))+e.x0;o(Math.floor(d),Math.ceil(f),c)}}var U,N=function(){function t(){}return t.getTileUrl=function(t,e,i,n){for(var o=0,r=0,a="";r<t.length;)if("{"==t[r]){switch(a+=t.substring(o,r),t[r+1]){case"x":a+=e.toString();break;case"y":a+=i.toString();break;case"z":a+=n.toString();break;default:console.log("Invalid map url pattern: "+t)}o=r+=3}else++r;return a+=t.substr(o)},t}(),z=function(){function t(){}return t.generate=function(){return Math.random().toString(36).substring(2)+(new Date).getTime().toString(36)+this.count++},t.count=0,t}();!function(t){t[t.RasterTile=0]="RasterTile",t[t.VectorTile=1]="VectorTile",t[t.TileObject=2]="TileObject",t[t.Texture=3]="Texture"}(U||(U={}));var V=function(){function t(t){this.method="GET",this.params=null,this.id=z.generate(),this.type=t}return t.prototype.cancel=function(){this.worker&&this.worker.cancel(this)},t}(),Y=function(){return function(t){this.id=t,this.success=!1,this.data=null}}(),F=function(){function t(t,e,i,n,r){this.renderTiles=[],this.visibleTiles=[],this.mapView=t,this.tileTaskManager=e,this.mapState=i,this.tileCache=new P(o.tileCacheSize),this.tiles=new Map,this.annotationTiles=new Map,this.finishedLoad=!0,this.mapSettings=n,this.lastZoom=this.mapState.getZoom(),this.tileAreas=new Map,this.tileRequestsMap=new Map,this.createAnnotationTile=r}return t.prototype.isDirty=function(){var t=this.mapState.getZoom(),e=!0;return(this.finishedLoad||this.mapState.isZoomIn()||this.mapState.isZoomOut()||!this.mapState.isFlyingTo()&&(Math.ceil(t-r.epsilon)>t||Math.floor(t+r.epsilon)<t))&&(e=!1),e},t.prototype.update=function(t){this.isDirty()&&(this.updateRenderableTiles(t),this.tileRequestsMap.size||(this.finishedLoad=!0,this.lastZoom=this.mapState.getZoom()))},t.prototype.reload=function(){this.tiles.clear(),this.annotationTiles.clear(),this.renderTiles=[],this.tileCache.clear(),this.finishedLoad=!1,this.mapView.dirty=!0,this.tileRequestsMap.forEach(function(t){t.cancel()}),this.tileRequestsMap.clear()},t.prototype.getRenderTiles=function(){return this.renderTiles},t.prototype.getVisibleTiles=function(){return this.visibleTiles},t.prototype.updateVisibleTilesForZoom=function(t){var e=this;this.mapState.getZoom()>this.mapSettings.getMaxNativeZoom()&&(t=this.mapSettings.getMaxNativeZoom());var i=this.mapState.getScreenSize(),n=Math.pow(2,t),o=m.projectScale(v.screenCoordinateToLatLngZoom(new c(0,0),this.mapState,t),n).multiply(1/d.getTileSize()),r=m.projectScale(v.screenCoordinateToLatLngZoom(new c(i.x,0),this.mapState,t),n).multiply(1/d.getTileSize()),a=m.projectScale(v.screenCoordinateToLatLngZoom(new c(i.x,i.y),this.mapState,t),n).multiply(1/d.getTileSize()),s=m.projectScale(v.screenCoordinateToLatLngZoom(new c(0,i.y),this.mapState,t),n).multiply(1/d.getTileSize()),u=m.projectScale(v.screenCoordinateToLatLngZoom(new c(i.x/2,i.y/2),this.mapState,t),n).multiply(1/d.getTileSize()),h=1<<Math.floor(t),p=[],l=function(t,e,i){if(i>=0&&i<=h)for(var n=t;n<e;++n){var o=n+.5-u.x,r=i+.5-u.y,a={x:n,y:i,sqDist:o*o+r*r};p.push(a)}};B.scanTriangle(o,r,a,0,h,l),B.scanTriangle(a,s,o,0,h,l),p.sort(function(t,e){return t.sqDist==e.sqDist?t.x==e.x?t.y-e.y:t.x-e.x:t.sqDist-e.sqDist}),p.filter(function(t,e,i){return 0==e||t.x!=i[e-1].x||t.y!=i[e-1].y}).forEach(function(i){return e.visibleTiles.push(O.createWithXYZoom(i.x,i.y,t))})},t.prototype.updateVisibleTiles=function(){this.finishedLoad=!1,this.visibleTiles=[];var t=this.mapState.getZoom();this.mapState.isFlyingTo()?(this.updateVisibleTilesForZoom(Math.floor(t)),this.updateVisibleTilesForZoom(Math.ceil(t))):this.mapState.isZoomIn()?this.updateVisibleTilesForZoom(Math.ceil(t)):this.mapState.isZoomOut()?this.updateVisibleTilesForZoom(Math.floor(t)):this.updateVisibleTilesForZoom(t),this.cancelOutdatedTasks()},t.prototype.cancelOutdatedTasks=function(){var t=this;this.tileRequestsMap.forEach(function(e,i,n){t.visibleTiles.some(function(t){return t.getTileCoordinate().equal(i)})||(n.delete(i),e.cancel())})},t.prototype.updateRenderableTiles=function(t){var e=this,i=[],n=[],o=[];if(this.mapState.getZoom()<this.lastZoom&&0!=this.visibleTiles.length){var r=this.visibleTiles[0].getTileCoordinate().getZoom();this.renderTiles.forEach(function(t){t.getUnwrappedTileCoordinate().getTileCoordinate().getZoom()>r&&o.push(t)})}this.renderTiles=[],this.visibleTiles.forEach(function(r){var a=r.getTileCoordinate(),s=e.getTile(a);if(null==s&&(s=e.createTile(a,t)),s.isRenderable())e.renderTiles.push(new I(r,s)),i.push(a);else{if(i.push(a),e.mapState.isFlyingTo())return;if(e.mapState.getZoom()>e.lastZoom)for(var u=r.parent();u.getTileCoordinate().getZoom()>=e.lastZoom;){if(a=u.getTileCoordinate(),null!=(s=e.getTile(a))&&s.isRenderable()){i.some(function(t){return t.equal(a)})||(i.push(a),n.push(new I(u,s)));break}u=u.parent()}else e.mapState.getZoom()<e.lastZoom&&o.forEach(function(t){var n=t.getUnwrappedTileCoordinate();n.getTileCoordinate().isChildOf(r.getTileCoordinate())&&(a=n.getTileCoordinate(),null!=(s=e.getTile(a))&&s.isRenderable()&&(i.some(function(t){return t.equal(a)})||(i.push(a),e.renderTiles.push(new I(n,s)))))})}}),0!=n.length&&(this.renderTiles.forEach(function(t){n.push(t)}),this.renderTiles=n),i.sort(function(t,e){return t.lessThan(e)?-1:t.lessThan(e)?0:1}),i=i.filter(function(t,e,i){return!i.filter(function(i,n){return JSON.stringify(t)==JSON.stringify(i)&&n<e}).length});var a=Array.from(this.tiles),s=Array.from(this.annotationTiles);a.sort(function(t,e){return t[0].lessThan(e[0])?-1:t[0].lessThan(e[0])?0:1}),s.sort(function(t,e){return t[0].lessThan(e[0])?-1:t[0].lessThan(e[0])?0:1});for(var u=0,h=0,p=0;u<this.tiles.size;)if(h==i.length||a[u][0].lessThan(i[h])){this.tileCache.add(a[u][0],a[u][1]),this.tiles.delete(a[u][0]);var l=s[p][1];this.annotationTiles.delete(s[p][0]),l.detroy(),++u,++p}else i[h].lessThan(a[u][0])||(++u,++p),++h},t.prototype.getTile=function(t){for(var e=Array.from(this.tiles),i=!1,n=0;n<e.length&&!i;)e[n][0].toString()==t.toString()&&(i=!0),++n;if(!i){var o=this.tileCache.pop(t.toString());if(null!=o)return this.tiles.set(t,o),this.annotationTiles.set(t,this.createAnnotationTile(t)),o}if(i){var r=new Map;return this.tiles.forEach(function(t,e){r.set(e.toString(),t)}),r.get(t.toString())}return null},t.prototype.createTile=function(t,e){var i=this,n=this.tileCache.pop(t.toString());if(null==n){var o=this.mapSettings.getMapUrl(),r=t.getZoom(),a=!1;this.tileAreas.forEach(function(e){a||r<=e.getMaxZoom()&&r>=e.getMinZoom()&&e.getBounds().contains(t)&&(o=e.getMapUrl(),a=!0)});var s=N.getTileUrl(o,t.getX(),t.getY(),t.getZoom());n=e(t);var u=new V(U.Texture);u.url=s,u.completion=function(e){null!=e.data&&n.init(e.data,function(){i.tileRequestsMap.delete(t)})},this.tileRequestsMap.set(t,u),this.tileTaskManager.postTask(u)}return null!=this.tiles&&this.tiles.set(t,n),this.annotationTiles.set(t,this.createAnnotationTile(t)),n},t.prototype.addTileArea=function(t,e){this.tileAreas.set(t,e),this.reload()},t.prototype.updateTileArea=function(t,e){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.addTileArea(t,e))},t.prototype.removeTileArea=function(t){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.reload())},t}(),j=function(){function t(){}return Object.defineProperty(t,"isWorker",{get:function(){try{return!window.document}catch(t){return!0}},enumerable:!0,configurable:!0}),t}(),X=function(){function t(t){this.maxTask=3,this.numberOfRunningTask=0,this.worker=t}return t.prototype.finishedTask=function(){this.numberOfRunningTask-=1},t.prototype.canExecuteTask=function(){return this.numberOfRunningTask<this.maxTask},t.prototype.executeTask=function(t){if(this.canExecuteTask()){var e={execute:!0,payload:JSON.stringify(t)};this.worker.postMessage(e),this.numberOfRunningTask+=1}},t.prototype.cancel=function(t){var e={execute:!1,payload:JSON.stringify(t)};this.worker.postMessage(e),this.numberOfRunningTask=Math.min(this.numberOfRunningTask-1,0)},t}(),H=function(){function t(t){this.id=t}return t.prototype.abort=function(){null!=this.request&&this.request.abort()},t}(),Q=function(){function t(){}return t.createWorker=function(t){var e=this.workerUrl,i=new Worker(e),n=new X(i);return i.onmessage=function(e){var i=e.data;n.finishedTask(),t(i)},n},Object.defineProperty(t,"workerUrl",{get:function(){for(var t=document.getElementsByTagName("script"),e=[],i=0;i<t.length;++i){var n=t[i];n.src.indexOf("map4dsdk@")>-1&&e.push(n.src)}var o="importScripts("+e.map(function(t){return'"'+t+'"'}).join(",")+");",r=new Blob([o],{type:"application/javascript"});return window.URL.createObjectURL(r)},enumerable:!0,configurable:!0}),t.setupWorkerThread=function(){var t=this;self.onmessage=function(e){var i=e.data;i.execute?t.execute(JSON.parse(i.payload)):t.cancel(JSON.parse(i.payload))}},t.execute=function(t){var e=new H(t.id);if(this.executeTasks.push(e),t.type==U.Texture){var i=new XMLHttpRequest;return i.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE){var e=new Y(t.id);200==i.status&&(e.success=!0,e.data=this.response),postMessage(e)}},i.open("GET",t.url),i.responseType="blob",i.send(),void(e.request=i)}var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState==XMLHttpRequest.DONE){var e=new Y(t.id);200==n.status&&(e.success=!0,e.data=JSON.parse(n.responseText)),postMessage(e)}},n.open(t.method,t.url,!0),null!=t.params&&n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("Accept","application/json"),n.send(t.params),e.request=n},t.cancel=function(t){var e=this.removeTask(t.id);null!=e&&e.abort()},t.removeTask=function(t){var e=this.executeTasks.findIndex(function(e){return e.id==t});if(e>=0){var i=this.executeTasks[e];return this.executeTasks.splice(e,1),i}return null},t.executeTasks=[],t}();j.isWorker&&Q.setupWorkerThread();var W,K=function(){function t(){var t=this;this.maxWorker=3,this.workers=[],this.pendingTasks=[],this.activedTasks=[];for(var e=0;e<this.maxWorker;++e){var i=Q.createWorker(function(e){t.onCompletionTask(e)});this.workers.push(i)}}return t.prototype.postTask=function(t){this.pendingTasks.push(t),this.executeTasks()},t.prototype.executeTasks=function(){for(var t=0,e=this.workers;t<e.length;t++){var i=e[t];if(i.canExecuteTask()&&this.pendingTasks.length>0){var n=this.pendingTasks.pop();this.activedTasks.push(n),n.worker=i,i.executeTask(n)}}},t.prototype.cancelTask=function(t){var e=this.removeTask(t.id);e.cancel(),e.completion&&e.completion(new Y(t.id))},t.prototype.onCompletionTask=function(t){var e=this.activedTasks.findIndex(function(e){return e.id==t.id});if(!(e<0)){var i=this.activedTasks[e];this.activedTasks.splice(e,1),i.completion&&i.completion(t),this.executeTasks()}},t.prototype.removeTask=function(t){var e=this.pendingTasks.findIndex(function(e){return e.id==t});if(e>=0){var i=this.pendingTasks[e];return this.pendingTasks.splice(e,1),i}if((e=this.activedTasks.findIndex(function(e){return e.id==t}))>=0){i=this.activedTasks[e];return this.activedTasks.splice(e,1),i}return null},t}(),_=function(){function t(){this.mapUrl=o.defaultMapUrl,this.minZoom=o.defaultMinZoom,this.maxZoom=o.defaultMaxZoom,this.maxNativeZoom=o.defaultMaxNativeZoom}return t.prototype.setMapUrl=function(t){this.mapUrl=t},t.prototype.setMinZoom=function(t){this.minZoom=t,this.minZoom>this.maxZoom&&(this.minZoom+=this.maxZoom,this.maxZoom=this.minZoom-this.maxZoom,this.minZoom-=this.maxZoom)},t.prototype.setMaxZoom=function(t){this.maxZoom=t,this.minZoom>this.maxZoom&&(this.minZoom+=this.maxZoom,this.maxZoom=this.minZoom-this.maxZoom,this.minZoom-=this.maxZoom)},t.prototype.getMapUrl=function(){return this.mapUrl},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMaxNativeZoom=function(){return this.maxNativeZoom},t.prototype.setMaxNativeZoom=function(t){this.maxNativeZoom=t},t}();!function(t){t[t.RASTER=0]="RASTER",t[t.ANNOTATION=1]="ANNOTATION",t[t.LINE=2]="LINE"}(W||(W={}));var G,J=function(){function t(t,e){void 0===e&&(e=0),this.id=t,this.order=e}return t.prototype.equal=function(t){return this.id==t.id},t.prototype.lessThan=function(t){return this.order==t.order?this.id<t.id:this.order<t.order},t}(),q=function(){function t(t,e,i,n){this.layerId=new J(t,e),this.layerType=i,this.tileManager=n}return t.prototype.getOrder=function(){return this.layerId.order},t.prototype.getLayerId=function(){return this.layerId.id},t.prototype.getLayerType=function(){return this.layerType},t}(),$=function(){return function(t,e,i,n,o){void 0===n&&(n=0),void 0===o&&(o=0),this.name=t,this.buffer=e,this.size=i,this.offset=n,this.stride=o}}(),tt=function(){return function(t,e,i){this.name=t,this.type=e,this.value=i}}(),et=function(){function t(t,e,i){this.gl=t,this.textureUnit=0,this.uniforms={},this.attributes={},this.program=t.createProgram(),this.fragmentShader=this.loadShader(t.FRAGMENT_SHADER,i),this.vertexShader=this.loadShader(t.VERTEX_SHADER,e),t.attachShader(this.program,this.vertexShader),t.attachShader(this.program,this.fragmentShader),t.linkProgram(this.program),t.getProgramParameter(this.program,t.LINK_STATUS)||(console.log("Error linking shader program"),console.log(t.getProgramInfoLog(this.program))),this.loadAttributes(),this.loadUniforms()}return t.prototype.loadAttributes=function(){for(var t=this.gl,e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),i=0;i<e;++i){var n=t.getActiveAttrib(this.program,i).name;this.attributes[n]=t.getAttribLocation(this.program,n)}},t.prototype.loadUniforms=function(){for(var t=this.gl,e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),i=0;i<e;++i){var n=t.getActiveUniform(this.program,i).name;this.uniforms[n]=t.getUniformLocation(this.program,n)}},t.prototype.loadShader=function(t,e){var i=this.gl,n=i.createShader(t);return i.shaderSource(n,e),i.compileShader(n),i.getShaderParameter(n,i.COMPILE_STATUS)||(console.log("Error loading shader"),console.log(e),console.log(i.getShaderInfoLog(n))),n},t.prototype.bind=function(){this.gl.useProgram(this.program),this.resetTextureUnit()},t.prototype.resetTextureUnit=function(){this.textureUnit=0},t.prototype.setAttributes=function(t){for(var e=this.gl,i=null,n=0,o=t;n<o.length;n++){var r=o[n],a=this.attributes[r.name];r.buffer!=i&&(i=r.buffer,e.bindBuffer(e.ARRAY_BUFFER,i)),null!==a&&(e.enableVertexAttribArray(a),e.vertexAttribPointer(a,r.size,e.FLOAT,!1,4*r.stride,4*r.offset))}},t.prototype.setUniforms=function(t){for(var e=this.gl,i=0,n=t;i<n.length;i++){var o=n[i],r=this.uniforms[o.name];if(null!==r)if("matrix"==o.type)e.uniformMatrix4fv(r,!1,new Float32Array(o.value.buffer()));else if("texture"==o.type)e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_2D,o.value.textureId),e.uniform1i(r,this.textureUnit),this.textureUnit+=1;else if("textureCube"==o.type)e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_CUBE_MAP,o.value.textureId),e.uniform1i(r,this.textureUnit),this.textureUnit+=1;else{e["uniform"+o.type](r,o.value)}}},t.prototype.disableAttributes=function(){for(var t in this.attributes)this.gl.disableVertexAttribArray(this.attributes[t])},t.prototype.destroy=function(){this.uniforms={},this.attributes={},this.gl.deleteProgram(this.program),this.gl.deleteShader(this.vertexShader),this.gl.deleteShader(this.fragmentShader)},t}();!function(t){t[t.RASTER=0]="RASTER",t[t.ANNOTAION=1]="ANNOTAION"}(G||(G={}));var it,nt=function(){function t(t,e,i){this.renderable=!1,this.kind=t,this.tileCoordinate=e,this.gl=i}return t.prototype.isRenderable=function(){return this.renderable},t.prototype.getKind=function(){return this.kind},t.prototype.getTileCoordinate=function(){return this.tileCoordinate},t}(),ot=function(){return function(){}}();!function(t){t[t.POLYLINE=0]="POLYLINE",t[t.MARKER=1]="MARKER"}(it||(it={}));var rt,at,st=function(){function t(t){this.shapeType=t}return t.prototype.update=function(t){},t.prototype.getShapeType=function(){return this.shapeType},t}(),ut=function(){function t(t,e,i,n,o,r){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===o&&(o=null),this.gl=t,this.type=e,this.attributeInfos=[],this.uniformInfos=[],i){this.vertices=i.length;for(var a=[],s=0,u=i;s<u.length;s++)for(var h=u[s],p=0,l=n;p<l.length;p++)for(var c=0,f=h[A=l[p]];c<f.length;c++){var d=f[c];a.push(d)}this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(a),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null);for(var g=i[0],m=0,y=0;y<n.length;++y){var A=n[y],v=o[y],x=g[A].length,T=new $(v,this.buffer,x,m,0);this.attributeInfos.push(T),m+=x}for(var M=0,w=this.attributeInfos;M<w.length;M++){(T=w[M]).stride=m}null!=r&&this.setIndices(r)}}return t.prototype.initPolyline=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),null!=this.gl&&null!=e){this.type=this.gl.TRIANGLES;var i=this.gl.createBuffer(),n=e.indices;null!=t?(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,i),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.setIndices(n),this.buffer=i,this.vertices=n.length,this.attributeInfos=[new $("a_position",i,2,0,4),new $("a_extrude",i,2,2,4)]):console.log("Vertices size can not be null")}else console.log("init model polyline no data")},t.prototype.setIndices=function(t){if(t){var e=this.gl;this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Int16Array(t),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.vertices=t.length}},t.tileModel=function(e){var i=new t(e,e.TRIANGLES),n=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),i.vertices=6,i.buffer=n,i.attributeInfos=[new $("a_position",n,3,0,5),new $("a_uv",n,2,3,5)],i},t.markerModel=function(e){var i=new t(e,e.TRIANGLES),n=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),i.vertices=6,i.buffer=n,i.attributeInfos=[new $("a_position",n,3,0,5),new $("a_uv",n,2,3,5)],i},t.prototype.render=function(){var t=this.gl;this.indexBuffer?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(this.type||t.TRIANGLES,this.vertices,t.UNSIGNED_SHORT,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindBuffer(t.ARRAY_BUFFER,null)):(t.drawArrays(this.type||t.TRIANGLES,0,this.vertices),t.bindBuffer(t.ARRAY_BUFFER,null))},t.prototype.setUniform=function(t){this.uniformInfos.push(t)},t.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer),this.indexBuffer&&this.gl.deleteBuffer(this.indexBuffer),this.attributeInfos=[],this.uniformInfos=[]},t}(),ht=function(){function t(){}return t.basicVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n\tgl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n\tv_uv = a_uv;\n}\n   ",t.basicFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}  \n  ",t.polylineVS="\nattribute vec2 a_position;\nattribute vec2 a_extrude;\n\nuniform float u_lineWidth;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n\tvec2 delta = (u_lineWidth / 2.0) * a_extrude;\n\n\tgl_Position = u_mvpMatrix * vec4(a_position + delta, 0.0, 1.0);\n}\n  ",t.polylineFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}  \n  ",t.markerVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n\tgl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n\tv_uv = a_uv;\n}\n  ",t.markerFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n  ",t}();!function(t){t[t.MARKER_SHADER=0]="MARKER_SHADER",t[t.POLYLINE_SHADER=1]="POLYLINE_SHADER",t[t.RASTER_SHADER=2]="RASTER_SHADER"}(rt||(rt={})),function(t){t[t.MARKER_MODEL=0]="MARKER_MODEL",t[t.RASTER_MODEL=1]="RASTER_MODEL"}(at||(at={}));var pt,lt=function(){function t(){this.initialized=!1,this.shaders=new Map,this.models=new Map}return Object.defineProperty(t,"Instance",{get:function(){return this.instance||(this.instance=new this)},enumerable:!0,configurable:!0}),t.prototype.createShader=function(t,e){return new et(this.gl,t,e)},t.prototype.createModel=function(t){var e=this.gl,i=new ut(e,e.TRIANGLES),n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);var o=[new $("a_position",n,3,0,5),new $("a_uv",n,2,3,5)];return i.vertices=6,i.buffer=n,i.attributeInfos=o,i},t.prototype.init=function(t){if(this.gl=t,!this.initialized){this.initialized=!0,this.shaders.set(rt.RASTER_SHADER,this.createShader(ht.basicVS,ht.basicFS)),this.shaders.set(rt.MARKER_SHADER,this.createShader(ht.markerVS,ht.markerFS)),this.shaders.set(rt.POLYLINE_SHADER,this.createShader(ht.polylineVS,ht.polylineFS));this.models.set(at.RASTER_MODEL,this.createModel([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1])),this.models.set(at.MARKER_MODEL,this.createModel([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1]))}},t.prototype.getShader=function(t){return this.shaders.get(t)},t.prototype.getModel=function(t){return this.models.get(t)},t.instance=null,t}(),ct=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ft=function(t){function e(e){var i=t.call(this)||this;return i.gl=e,i}return ct(e,t),e.prototype.render=function(t,e){var i=lt.Instance.getShader(rt.MARKER_SHADER),n=lt.Instance.getModel(at.MARKER_MODEL);if(t.getShapeType()==it.MARKER){var o=t;if(o.isRenderable()){o.hasTexture()||o.initTexture(this.url),i.bind(),i.setAttributes(n.attributeInfos);var r=v.pixelCoordinateToCameraCoordinate(m.projectScale(o.getPosition(),e.getScale()),e),a=C.translate(r.x,r.y,0),s=o.getAnchor();a=C.translate((.5-s.x)*o.getWidth(),(s.y-.5)*o.getHeight(),0).concat(a);var u=(a=C.scale(o.getWidth()/2,o.getHeight()/2,1).concat(a)).concat(e.getViewProjectionMatrix()),h=o.getTexture();i.setUniforms([new tt("u_mvpMatrix","matrix",u),new tt("u_texture","texture",h)]),n.render()}}else console.warn("Shape is not MARKER ...")},e.prototype.enableBlend=function(){this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)},e.prototype.disableBlend=function(){this.gl.disable(this.gl.BLEND)},e}(ot),dt=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),gt=function(){function t(t,e){this.mapState=t,this.layer=e}return t.create=function(t,e){switch(e.getLayerType()){case W.RASTER:return new yt(t,e);case W.ANNOTATION:return new mt(t,e);case W.LINE:return new At(t,e)}},t.prototype.getRenderTiles=function(){return this.layer.tileManager.getRenderTiles()},t.prototype.getVisibleTiles=function(){return this.layer.tileManager.getVisibleTiles()},t}(),mt=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.mapState=e,n.layer=i,n.markerRenderer=new ft(n.layer.tileManager.mapView.gl),n}return dt(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==W.ANNOTATION){var e=this.layer,i=e.shapeAnnotations;if(i.size>0)this.markerRenderer.enableBlend(),i.forEach(function(t){switch(t.getShapeType()){case it.MARKER:}}),this.getVisibleTiles().forEach(function(i){var n=i.getTileCoordinate(),o=v.tileCoordinateToLatLngBounds(n),r={minX:o.getSouthwest().getLongitude(),minY:o.getSouthwest().getLatitude(),maxX:o.getNortheast().getLongitude(),maxY:o.getNortheast().getLatitude()};e.rBushTree.search(r).forEach(function(e){t.markerRenderer.render(e,t.mapState)})}),this.markerRenderer.disableBlend()}},e}(gt),yt=function(t){function e(e,i){return t.call(this,e,i)||this}return dt(e,t),e.prototype.render=function(){var t=this,e=lt.Instance.getShader(rt.RASTER_SHADER),i=lt.Instance.getModel(at.RASTER_MODEL);this.getRenderTiles().forEach(function(n){var o=n.getTile();if(o.getKind()==G.RASTER){var r=t.mapState.getViewProjectionMatrix(),a=t.mapState.matrixFor(n.getUnwrappedTileCoordinate()).concat(r);e.bind(),e.setAttributes(i.attributeInfos);var s=o.getTexture();e.setUniforms([new tt("u_texture","texture",s),new tt("u_mvpMatrix","matrix",a)]),i.render()}else console.log("Tile is not raster tile")})},e}(gt),At=function(t){function e(e,i){return t.call(this,e,i)||this}return dt(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==W.LINE){var e=this.layer;if(0!=e.renderTiles.size){var i=lt.Instance.getShader(rt.POLYLINE_SHADER),n=this.layer.tileManager.mapView.gl;n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),i.bind();var o=m.worldSize(this.mapState.getScale()),r=this.layer.getLayerId();e.renderTiles.forEach(function(n){var a=n.getTile();if(a.getKind()==G.ANNOTAION){var s=a;if(s.hasData(r)){var u=s.getLayerData(r,W.LINE);if(u.getType()==W.LINE){var h=u.getModel();i.setAttributes(h.attributeInfos);var p=s.getTileCoordinate(),l=1<<p.getZoom(),f=o/l,g=f/d.getTileSize(),m=v.pixelCoordinateToCameraCoordinate(new c(p.getX()*f+f/2,p.getY()*f+f/2),t.mapState),y=C.translate(m.x,m.y,0);y=C.scale(g,g,1).concat(y),i.setUniforms([new tt("u_lineWidth","1f",e.strokeWidth),new tt("u_color","4fv",e.strokeColor.buffer()),new tt("u_mvpMatrix","matrix",y.concat(t.mapState.getViewProjectionMatrix()))]),h.render()}else console.warn("ERROR: layerData.getType() != LayerType.LINE .............")}}else console.warn("ERROR: tile.getKind() != Kind.ANNOTAION .............")})}}},e}(gt),vt=function(){function t(t){this.mapState=t,this.layerRenderers=new Map}return t.prototype.render=function(){this.layerRenderers.forEach(function(t){t.render()})},t.prototype.addLayer=function(t){this.layerRenderers.set(new J(t.getLayerId(),t.getOrder()),gt.create(this.mapState,t))},t.prototype.removeLayer=function(t){var e=new J(t,o.annotationLayerOrder);this.layerRenderers.has(e)&&this.layerRenderers.delete(e)},t}(),xt=function(){function t(t,e,i,n){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(n-e)-this.cy,this.ay=1-this.cy-this.by}return t.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},t.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},t.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},t.prototype.solveCurveX=function(t,e){var i,n,o,r,a,s;for(o=t,s=0;s<8;++s){if(r=this.sampleCurveX(o)-t,Math.abs(r)<e)return o;if(a=this.sampleCurveDerivativeX(o),Math.abs(a)<1e-6)break;o-=r/a}if(n=1,(o=t)<(i=0))return i;if(o>n)return n;for(;i<n;){if(r=this.sampleCurveX(o),Math.abs(r-t)<e)return o;t>r?i=o:n=o,o=.5*(n-i)+i}return o},t.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))},t}(),Tt=function(){function t(t){this.dx=0,this.dy=0,this.timeConstant=t,this.initialSpeedRate=0,this.velocityRatioX=0,this.velocityRatioY=0}return t.prototype.getDisplacement=function(t,e,i){return t*e*-Math.expm1(-i/t)},t.prototype.getDuration=function(e,i){return-e*Math.log(t.minTrackSpeed/i)},t.prototype.startFling=function(e,i){(e=g.clamp(e,o.flingMinVelocity,o.flingMaxVelocity),i=g.clamp(i,o.flingMinVelocity,o.flingMaxVelocity),e*=t.secToMs,i*=t.secToMs,this.initialSpeedRate=Math.sqrt(e*e+i*i),this.initialSpeedRate<t.minTrackSpeed)?this.stopFling():(this.flingDuration=this.getDuration(this.timeConstant,this.initialSpeedRate),this.getDisplacement(this.timeConstant,this.initialSpeedRate,this.flingDuration)<t.minDisplacement?this.stopFling():(this.velocityRatioX=e/this.initialSpeedRate,this.velocityRatioY=i/this.initialSpeedRate,this.previousPositionX=0,this.previousPositionY=0,this.flingStart=Date.now()))},t.prototype.stopFling=function(){this.initialSpeedRate=0},t.prototype.isFlingInProgress=function(){return this.initialSpeedRate>0},t.prototype.trackMovement=function(){if(!this.isFlingInProgress())return!1;var t=Date.now()-this.flingStart;if(t>this.flingDuration)return this.stopFling(),!1;var e=this.getDisplacement(this.timeConstant,this.initialSpeedRate,t),i=e*this.velocityRatioX,n=e*this.velocityRatioY;return this.dx=i-this.previousPositionX,this.dy=n-this.previousPositionY,this.previousPositionX=i,this.previousPositionY=n,!0},t.secToMs=.001,t.minTrackSpeed=.01,t.minDisplacement=20,t}(),Mt=function(){return function(){}}(),wt=function(){return function(){this.anchor=null,this.target=null,this.zoom=null,this.tilt=null,this.bearing=null}}(),St=function(){function t(t,e,i){this.onUpdateTransitions=null,this.mapState=t,this.cameraAnimationObserver=e,this.mapSettings=i,this.flingTracker=new Tt(o.flingTimeConstant)}return t.prototype.moveBy=function(t,e){void 0===e&&(e=null),null===e&&(e=new Mt);var i=new wt,n=this.mapState.getTarget(),o=m.getMetersPerPixelAtLatitude(10,this.mapState.getZoom()),r=new f(t.y,t.x).multiply(o);r=r.rotateBy(-this.mapState.cameraPosition.getBearing()),i.target=m.convertToLatLngFromMeter(m.convertToMeterFromLatLng(n).add(r)),this.mapState.movingTo=!0,this.easeTo(i,e)},t.prototype.moveTo=function(t,e,i){var n=new wt;n.target=t,e>=this.mapSettings.getMinZoom()&&(e=g.clamp(e,this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()),n.zoom=e);var o=new Mt;i>0&&(o.duration=i),this.mapState.movingTo=!0,this.easeTo(n,o)},t.prototype.zoom=function(t,e,i){this.mapState.startedZoom=!0,this.flingTracker.stopFling(),i.duration||(i.duration=o.defaultAnimationDuration);var n=new wt;n.zoom=t,n.anchor=e,this.easeTo(n,i)},t.prototype.isAnimated=function(){return this.mapState.panning||this.mapState.zoomIn||this.mapState.zoomOut||this.mapState.flyingTo},t.prototype.moveByVelocity=function(t){this.flingTracker.startFling(t.x,t.y)},t.prototype.setTilt=function(t){var e=new wt,i=new Mt;t=g.clamp(t,o.minTilt,o.maxTilt),e.tilt=t,this.mapState.tilting=!0,this.easeTo(e,i)},t.prototype.setBearing=function(t,e){var i=new wt,n=new Mt;i.bearing=t,e>0&&(n.duration=1e3*e),this.mapState.bearing=!0,this.easeTo(i,n)},t.prototype.easeTo=function(t,e){var i=this,n=this.mapState.getZoom(),o=null!=t.zoom?t.zoom:this.mapState.getZoom(),a=this.mapState.getBearing(),s=this.mapState.getTilt(),h=this.mapState.getTarget(),p=t.bearing,l=t.tilt,c=null!=t.target?t.target:this.mapState.getTarget(),f=t.anchor,d=new u(0,0);f&&(d=v.screenCoordinateToLatLng(f,this.mapState)),this.mapState.zoomIn=o>n&&o-n>r.epsilon,this.mapState.zoomOut=n>o&&n-o>r.epsilon,this.mapState.panning=h!=c;this.startTransition(e,function(t){var e=n*(1-t)+o*t;if(null!=p){var r=a+(p-a)*t;i.mapState.setBearing(r)}if(l){var g=s+(l-s)*t;i.mapState.setTilt(g)}var y=h.getLatitude()*(1-t)+c.getLatitude()*t,A=h.getLongitude()*(1-t)+c.getLongitude()*t,x=new u(y,A);if(i.mapState.setZoom(e),i.mapState.setTarget(x),f){var T=Math.pow(2,e),M=m.projectScale(i.mapState.getTarget(),T),w=m.projectScale(d,T),S=m.projectScale(v.screenCoordinateToLatLng(f,i.mapState),Math.pow(2,Math.floor(e)));i.mapState.setTarget(m.unproject(M.add(w).subtract(S),T))}})},t.prototype.startTransition=function(e,i){var n=this,o=e.duration?e.duration:0,a=0!=o;this.transitionStart=Date.now(),this.transitionDuration=o,this.mapState.isWillChange()||(this.mapState.willChange=!0,this.cameraAnimationObserver.notifyCameraWillChange()),this.mapState.startedAnimation=!0,this.onUpdateTransitions=function(o){var s=a?(o-n.transitionStart)/n.transitionDuration:1;if(s>=1)i(1);else{var u=e.easing?e.easing:t.DEFAULT_TRANSITION_EASE;i(u.solve(s,r.epsilon))}return n.cameraAnimationObserver.notifyCameraIsChanging(),!(s<1)},a||(this.updateTransitions(),this.onUpdateTransitions=null)},t.prototype.stopAnimation=function(){this.mapState.isBearing()&&(this.mapState.bearing=!1,this.onUpdateTransitions=null)},t.prototype.updateTransitions=function(){if(null!=this.onUpdateTransitions){var t=Date.now(),e=this.onUpdateTransitions;this.onUpdateTransitions=null,e&&e(t)?(this.mapState.zoomIn=!1,this.mapState.zoomOut=!1,this.mapState.panning=!1,this.mapState.flyingTo=!1,this.mapState.movingTo=!1,this.mapState.bearing=!1,this.mapState.tilting=!1,e=null,this.mapState.startedAnimation=!1,this.mapState.timeMoving=Date.now(),this.onUpdateTransitions=null):null==this.onUpdateTransitions&&((this.mapState.isZoomIn()||this.mapState.isZoomOut())&&(this.mapState.timeMoving=Date.now()),this.onUpdateTransitions=e)}else if(this.flingTracker.isFlingInProgress())this.flingTracker.trackMovement()&&this.moveBy(new f(this.flingTracker.dx,this.flingTracker.dy));else if(!this.mapState.startedAnimation&&this.mapState.willChange){var i=Date.now()-this.mapState.timeMoving;this.mapState.startedZoom?i>o.minTimeDoubleZoom&&(this.mapState.willChange=!1,this.mapState.setZoom(Math.round(this.mapState.getZoom())),this.updateTransitions(),this.cameraAnimationObserver.notifyCameraDidChange()):i>o.minTimeMoving&&(this.mapState.willChange=!1,this.mapState.setZoom(Math.round(this.mapState.getZoom())),this.updateTransitions(),this.cameraAnimationObserver.notifyCameraDidChange())}},t.prototype.flyTo=function(t,e){var i=this;if(this.flingTracker.stopFling(),!this.isAnimated()){var n=this.mapState.getZoom(),a=t.target,s="zoom"in t?g.clamp(+t.zoom,this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()):n,u=this.mapState.getTarget(),h=m.projectScale(u,this.mapState.getScale()),p=m.projectScale(a,this.mapState.getScale()),l=Math.max(this.mapState.getScreenSize().x,this.mapState.getScreenSize().y),f=l/Math.pow(2,s-n),d=Math.hypot(p.x-h.x,p.y-h.y),y=1.42;if("minZoom"in e){var A=g.clamp(Math.min(e.minZoom,n,s),this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()),v=l/Math.pow(2,A-n);y=Math.sqrt(v/d*2)}var x=y*y,T=function(t){var e=(f*f-l*l+(t?-1:1)*x*x*d*d)/(2*(t?f:l)*x*d);return Math.log(Math.sqrt(e*e+1)-e)},M=T(0),w=function(t){return P(M)/P(M+y*t)},S=function(t){return l*(P(M)*function(t){return R(t)/P(t)}(M+y*t)-R(M))/x/d},E=(T(1)-M)/y;if(Math.abs(d)<r.epsilon||!isFinite(E)){if(Math.abs(l-f)<r.epsilon)return this.easeTo(t,e);var b=f<l?-1:1;E=Math.abs(Math.log(f/l))/y,S=function(){return 0},w=function(t){return Math.exp(b*y*t)}}if("duration"in e)e.duration=+e.duration;else{var L="velocity"in e?+e.velocity/y:1.2;e.duration=1e3*E/L}e.duration>o.maxDurationFlyTo&&(e.duration=o.maxDurationFlyTo);var C=this.mapState.getScale();this.mapState.flyingTo=!0,this.startTransition(e,function(t){var e=t*E,o=1===t?1:S(e),a=new c(h.x*(1-o)+p.x*o,h.y*(1-o)+p.y*o),u=1/w(e),l=1===t?s:n+Math.log(u)/Math.LN2;l=g.clamp(l,i.mapSettings.getMinZoom(),i.mapSettings.getMaxZoom()),Math.abs(t-1)<r.epsilon&&(l=s),l!=l&&(l=s);var f=m.unproject(a,C);i.mapState.setZoom(l),i.mapState.setTarget(f)})}function R(t){return(Math.exp(t)-Math.exp(-t))/2}function P(t){return(Math.exp(t)+Math.exp(-t))/2}},t.DEFAULT_TRANSITION_EASE=new xt(0,0,.25,1),t}();!function(t){t[t.POLYLINE=0]="POLYLINE",t[t.MARKER=1]="MARKER"}(pt||(pt={}));var Et=function(){function t(t){this.annotationType=t}return t.prototype.getAnnotationType=function(){return this.annotationType},t}();function bt(t,e,i,n,o,r){var a=o-i,s=r-n;if(0!==a||0!==s){var u=((t-i)*a+(e-n)*s)/(a*a+s*s);u>1?(i=o,n=r):u>0&&(i+=a*u,n+=s*u)}return(a=t-i)*a+(s=e-n)*s}function Lt(t,e,i,n){var o={id:void 0===t?null:t,type:e,geometry:i,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,i=t.type;if("Point"===i||"MultiPoint"===i||"LineString"===i)Ct(t,e);else if("Polygon"===i||"MultiLineString"===i)for(var n=0;n<e.length;n++)Ct(t,e[n]);else if("MultiPolygon"===i)for(n=0;n<e.length;n++)for(var o=0;o<e[n].length;o++)Ct(t,e[n][o])}(o),o}function Ct(t,e){for(var i=0;i<e.length;i+=3)t.minX=Math.min(t.minX,e[i]),t.minY=Math.min(t.minY,e[i+1]),t.maxX=Math.max(t.maxX,e[i]),t.maxY=Math.max(t.maxY,e[i+1])}function Rt(t,e,i,n){if(e.geometry){var o=e.geometry.coordinates,r=e.geometry.type,a=Math.pow(i.tolerance/((1<<i.maxZoom)*i.extent),2),s=[],u=e.id;if(i.promoteId?u=e.properties[i.promoteId]:i.generateId&&(u=n||0),"Point"===r)Pt(o,s);else if("MultiPoint"===r)for(var h=0;h<o.length;h++)Pt(o[h],s);else if("LineString"===r)It(o,s,a,!1);else if("MultiLineString"===r){if(i.lineMetrics){for(h=0;h<o.length;h++)s=[],It(o[h],s,a,!1),t.push(Lt(u,"LineString",s,e.properties));return}Dt(o,s,a,!1)}else if("Polygon"===r)Dt(o,s,a,!0);else{if("MultiPolygon"!==r){if("GeometryCollection"===r){for(h=0;h<e.geometry.geometries.length;h++)Rt(t,{id:u,geometry:e.geometry.geometries[h],properties:e.properties},i,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(h=0;h<o.length;h++){var p=[];Dt(o[h],p,a,!0),s.push(p)}}t.push(Lt(u,r,s,e.properties))}}function Pt(t,e){e.push(Ot(t[0])),e.push(Bt(t[1])),e.push(0)}function It(t,e,i,n){for(var o,r,a=0,s=0;s<t.length;s++){var u=Ot(t[s][0]),h=Bt(t[s][1]);e.push(u),e.push(h),e.push(0),s>0&&(a+=n?(o*h-u*r)/2:Math.sqrt(Math.pow(u-o,2)+Math.pow(h-r,2))),o=u,r=h}var p=e.length-3;e[2]=1,function t(e,i,n,o){for(var r,a=o,s=n-i>>1,u=n-i,h=e[i],p=e[i+1],l=e[n],c=e[n+1],f=i+3;f<n;f+=3){var d=bt(e[f],e[f+1],h,p,l,c);if(d>a)r=f,a=d;else if(d===a){var g=Math.abs(f-s);g<u&&(r=f,u=g)}}a>o&&(r-i>3&&t(e,i,r,o),e[r+2]=a,n-r>3&&t(e,r,n,o))}(e,0,p,i),e[p+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Dt(t,e,i,n){for(var o=0;o<t.length;o++){var r=[];It(t[o],r,i,n),e.push(r)}}function Ot(t){return t/360+.5}function Bt(t){var e=Math.sin(t*Math.PI/180),i=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return i<0?0:i>1?1:i}function Zt(t,e,i,n,o,r,a,s){if(n/=e,r>=(i/=e)&&a<n)return t;if(a<i||r>=n)return null;for(var u=[],h=0;h<t.length;h++){var p=t[h],l=p.geometry,c=p.type,f=0===o?p.minX:p.minY,d=0===o?p.maxX:p.maxY;if(f>=i&&d<n)u.push(p);else if(!(d<i||f>=n)){var g=[];if("Point"===c||"MultiPoint"===c)kt(l,g,i,n,o);else if("LineString"===c)Ut(l,g,i,n,o,!1,s.lineMetrics);else if("MultiLineString"===c)zt(l,g,i,n,o,!1);else if("Polygon"===c)zt(l,g,i,n,o,!0);else if("MultiPolygon"===c)for(var m=0;m<l.length;m++){var y=[];zt(l[m],y,i,n,o,!0),y.length&&g.push(y)}if(g.length){if(s.lineMetrics&&"LineString"===c){for(m=0;m<g.length;m++)u.push(Lt(p.id,c,g[m],p.tags));continue}"LineString"!==c&&"MultiLineString"!==c||(1===g.length?(c="LineString",g=g[0]):c="MultiLineString"),"Point"!==c&&"MultiPoint"!==c||(c=3===g.length?"Point":"MultiPoint"),u.push(Lt(p.id,c,g,p.tags))}}}return u.length?u:null}function kt(t,e,i,n,o){for(var r=0;r<t.length;r+=3){var a=t[r+o];a>=i&&a<=n&&(e.push(t[r]),e.push(t[r+1]),e.push(t[r+2]))}}function Ut(t,e,i,n,o,r,a){for(var s,u,h=Nt(t),p=0===o?Yt:Ft,l=t.start,c=0;c<t.length-3;c+=3){var f=t[c],d=t[c+1],g=t[c+2],m=t[c+3],y=t[c+4],A=0===o?f:d,v=0===o?m:y,x=!1;a&&(s=Math.sqrt(Math.pow(f-m,2)+Math.pow(d-y,2))),A<i?v>i&&(u=p(h,f,d,m,y,i),a&&(h.start=l+s*u)):A>n?v<n&&(u=p(h,f,d,m,y,n),a&&(h.start=l+s*u)):Vt(h,f,d,g),v<i&&A>=i&&(u=p(h,f,d,m,y,i),x=!0),v>n&&A<=n&&(u=p(h,f,d,m,y,n),x=!0),!r&&x&&(a&&(h.end=l+s*u),e.push(h),h=Nt(t)),a&&(l+=s)}var T=t.length-3;f=t[T],d=t[T+1],g=t[T+2],(A=0===o?f:d)>=i&&A<=n&&Vt(h,f,d,g),T=h.length-3,r&&T>=3&&(h[T]!==h[0]||h[T+1]!==h[1])&&Vt(h,h[0],h[1],h[2]),h.length&&e.push(h)}function Nt(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function zt(t,e,i,n,o,r){for(var a=0;a<t.length;a++)Ut(t[a],e,i,n,o,r,!1)}function Vt(t,e,i,n){t.push(e),t.push(i),t.push(n)}function Yt(t,e,i,n,o,r){var a=(r-e)/(n-e);return t.push(r),t.push(i+(o-i)*a),t.push(1),a}function Ft(t,e,i,n,o,r){var a=(r-i)/(o-i);return t.push(e+(n-e)*a),t.push(r),t.push(1),a}function jt(t,e){for(var i=[],n=0;n<t.length;n++){var o,r=t[n],a=r.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)o=Xt(r.geometry,e);else if("MultiLineString"===a||"Polygon"===a){o=[];for(var s=0;s<r.geometry.length;s++)o.push(Xt(r.geometry[s],e))}else if("MultiPolygon"===a)for(o=[],s=0;s<r.geometry.length;s++){for(var u=[],h=0;h<r.geometry[s].length;h++)u.push(Xt(r.geometry[s][h],e));o.push(u)}i.push(Lt(r.id,a,o,r.tags))}return i}function Xt(t,e){var i=[];i.size=t.size,void 0!==t.start&&(i.start=t.start,i.end=t.end);for(var n=0;n<t.length;n+=3)i.push(t[n]+e,t[n+1],t[n+2]);return i}function Ht(t,e){if(t.transformed)return t;var i,n,o,r=1<<t.z,a=t.x,s=t.y;for(i=0;i<t.features.length;i++){var u=t.features[i],h=u.geometry,p=u.type;if(u.geometry=[],1===p)for(n=0;n<h.length;n+=2)u.geometry.push(Qt(h[n],h[n+1],e,r,a,s));else for(n=0;n<h.length;n++){var l=[];for(o=0;o<h[n].length;o+=2)l.push(Qt(h[n][o],h[n][o+1],e,r,a,s));u.geometry.push(l)}}return t.transformed=!0,t}function Qt(t,e,i,n,o,r){return[Math.round(i*(t*n-o)),Math.round(i*(e*n-r))]}function Wt(t,e,i,n,o){for(var r=e===o.maxZoom?0:o.tolerance/((1<<e)*o.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:i,y:n,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,Kt(a,t[s],r,o);var u=t[s].minX,h=t[s].minY,p=t[s].maxX,l=t[s].maxY;u<a.minX&&(a.minX=u),h<a.minY&&(a.minY=h),p>a.maxX&&(a.maxX=p),l>a.maxY&&(a.maxY=l)}return a}function Kt(t,e,i,n){var o=e.geometry,r=e.type,a=[];if("Point"===r||"MultiPoint"===r)for(var s=0;s<o.length;s+=3)a.push(o[s]),a.push(o[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===r)_t(a,o,t,i,!1,!1);else if("MultiLineString"===r||"Polygon"===r)for(s=0;s<o.length;s++)_t(a,o[s],t,i,"Polygon"===r,0===s);else if("MultiPolygon"===r)for(var u=0;u<o.length;u++){var h=o[u];for(s=0;s<h.length;s++)_t(a,h[s],t,i,!0,0===s)}if(a.length){var p=e.tags||null;if("LineString"===r&&n.lineMetrics){for(var l in p={},e.tags)p[l]=e.tags[l];p.mapbox_clip_start=o.start/o.size,p.mapbox_clip_end=o.end/o.size}var c={geometry:a,type:"Polygon"===r||"MultiPolygon"===r?3:"LineString"===r||"MultiLineString"===r?2:1,tags:p};null!==e.id&&(c.id=e.id),t.features.push(c)}}function _t(t,e,i,n,o,r){var a=n*n;if(n>0&&e.size<(o?a:n))i.numPoints+=e.length/3;else{for(var s=[],u=0;u<e.length;u+=3)(0===n||e[u+2]>a)&&(i.numSimplified++,s.push(e[u]),s.push(e[u+1])),i.numPoints++;o&&function(t,e){for(var i=0,n=0,o=t.length,r=o-2;n<o;r=n,n+=2)i+=(t[n]-t[r])*(t[n+1]+t[r+1]);if(i>0===e)for(n=0,o=t.length;n<o/2;n+=2){var a=t[n],s=t[n+1];t[n]=t[o-2-n],t[n+1]=t[o-1-n],t[o-2-n]=a,t[o-1-n]=s}}(s,r),t.push(s)}}function Gt(t,e){var i=(e=this.options=function(t,e){for(var i in e)t[i]=e[i];return t}(Object.create(this.options),e)).debug;if(i&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(t,e){var i=[];if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)Rt(i,t.features[n],e,n);else"Feature"===t.type?Rt(i,t,e):Rt(i,{geometry:t},e);return i}(t,e);this.tiles={},this.tileCoords=[],i&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(n=function(t,e){var i=e.buffer/e.extent,n=t,o=Zt(t,1,-1-i,i,0,-1,2,e),r=Zt(t,1,1-i,2+i,0,-1,2,e);return(o||r)&&(n=Zt(t,1,-i,1+i,0,-1,2,e)||[],o&&(n=jt(o,1).concat(n)),r&&(n=n.concat(jt(r,-1)))),n}(n,e)).length&&this.splitTile(n,0,0,0),i&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Jt(t,e,i){return 32*((1<<t)*i+e)+t}Gt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gt.prototype.splitTile=function(t,e,i,n,o,r,a){for(var s=[t,e,i,n],u=this.options,h=u.debug;s.length;){n=s.pop(),i=s.pop(),e=s.pop(),t=s.pop();var p=1<<e,l=Jt(e,i,n),c=this.tiles[l];if(!c&&(h>1&&console.time("creation"),c=this.tiles[l]=Wt(t,e,i,n,u),this.tileCoords.push({z:e,x:i,y:n}),h)){h>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,i,n,c.numFeatures,c.numPoints,c.numSimplified),console.timeEnd("creation"));var f="z"+e;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(c.source=t,o){if(e===u.maxZoom||e===o)continue;var d=1<<o-e;if(i!==Math.floor(r/d)||n!==Math.floor(a/d))continue}else if(e===u.indexMaxZoom||c.numPoints<=u.indexMaxPoints)continue;if(c.source=null,0!==t.length){h>1&&console.time("clipping");var g,m,y,A,v,x,T=.5*u.buffer/u.extent,M=.5-T,w=.5+T,S=1+T;g=m=y=A=null,v=Zt(t,p,i-T,i+w,0,c.minX,c.maxX,u),x=Zt(t,p,i+M,i+S,0,c.minX,c.maxX,u),t=null,v&&(g=Zt(v,p,n-T,n+w,1,c.minY,c.maxY,u),m=Zt(v,p,n+M,n+S,1,c.minY,c.maxY,u),v=null),x&&(y=Zt(x,p,n-T,n+w,1,c.minY,c.maxY,u),A=Zt(x,p,n+M,n+S,1,c.minY,c.maxY,u),x=null),h>1&&console.timeEnd("clipping"),s.push(g||[],e+1,2*i,2*n),s.push(m||[],e+1,2*i,2*n+1),s.push(y||[],e+1,2*i+1,2*n),s.push(A||[],e+1,2*i+1,2*n+1)}}},Gt.prototype.getTile=function(t,e,i){var n=this.options,o=n.extent,r=n.debug;if(t<0||t>24)return null;var a=1<<t,s=Jt(t,e=(e%a+a)%a,i);if(this.tiles[s])return Ht(this.tiles[s],o);r>1&&console.log("drilling down to z%d-%d-%d",t,e,i);for(var u,h=t,p=e,l=i;!u&&h>0;)h--,p=Math.floor(p/2),l=Math.floor(l/2),u=this.tiles[Jt(h,p,l)];return u&&u.source?(r>1&&console.log("found parent tile z%d-%d-%d",h,p,l),r>1&&console.time("drilling down"),this.splitTile(u.source,h,p,l,t,e,i),r>1&&console.timeEnd("drilling down"),this.tiles[s]?Ht(this.tiles[s],o):null):null};var qt,$t=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),te=function(t){function e(e){var i=t.call(this,e)||this;return i.normalizeGeometryCoordinates(),i}return $t(e,t),e.prototype.normalizeGeometryCoordinates=function(){for(var t=[],e=0;e<this.geometryCoordinates.length;++e){for(var i=[],n=0;n<this.geometryCoordinates[e].length;++n)i.push([this.geometryCoordinates[e][n][0]/o.tileExtend-.5,.5-this.geometryCoordinates[e][n][1]/o.tileExtend]);t.push(i)}this.geometryCoordinates=t},e}(function(){return function(t){this.geometryCoordinates=[],this.geometryCoordinates=t}}()),ee=function(){function t(t,e){this.id=t,this.layerId=le.annotationLayerId+t.toString(),this.polylineAnnotation=e}return t.prototype.updateLayer=function(t){var e=t.getLayer(this.layerId);null==e&&(e=t.createLayer(this.layerId,W.LINE,o.annotationLayerOrder));var i=e;i.setStrokeColor(this.polylineAnnotation.getStrokeColor()),i.setStrokeOpacity(this.polylineAnnotation.getStrokeOpacity()),i.setStrokeWidth(this.polylineAnnotation.getStrokeWidth())},t.prototype.updateTileData=function(t,e){var i=this;if(!this.geoJsonIndexer){var n,r={maxZoom:o.defaultMaxNativeZoom,buffer:0,extent:o.tileExtend,tolerance:4},a=[];this.polylineAnnotation.getPath().forEach(function(t){a.push([t.getLongitude(),t.getLatitude()])});var s={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:a}}]};n=JSON.stringify(s,null,2),this.geoJsonIndexer=function(t,e){return new Gt(t,e)}(JSON.parse(n),r)}var u=this.geoJsonIndexer.getTile(t.getZoom(),t.getX(),t.getY());if(null!==u&&0!==u.features.length){var h=e.addLayer(this.layerId);u.features.forEach(function(t){var e=t.type,n=new te(t.geometry);h.addFeature(i.id,e,n)})}},t}();!function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon"}(qt||(qt={}));var ie,ne,oe=function(){function t(t,e,i){this.properties=new Map,this.type=t,this.geometries=e,this.properties=i}return t.prototype.getType=function(){return this.type},t.prototype.getGeometries=function(){return this.geometries},t}(),re=function(){function t(t){this.features=[],this.name=t}return t.prototype.featureCount=function(){return this.features.length},t.prototype.getFeature=function(t){return this.features[t]},t.prototype.getName=function(){return this.name},t}(),ae=function(){return function(){}}(),se=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ue=function(t){function e(e,i,n,o){var r=t.call(this,i,n,o)||this;return r.id=e,r}return se(e,t),e}(oe),he=function(t){function e(e){return t.call(this,e)||this}return se(e,t),e.prototype.addFeature=function(t,e,i,n){void 0===n&&(n=new Map),this.features.push(new ue(t,e,i,n))},e}(re),pe=function(t){function e(){var e=t.call(this)||this;return e.layerIds=[],e.layers=new Map,e}return se(e,t),e.prototype.addLayer=function(t){return this.layers.has(t)||(this.layerIds.push(t),this.layers.set(t,new he(t))),this.layers.get(t)},e.prototype.getLayerIds=function(){return this.layerIds},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e}(ae),le=function(){function t(t){this.idCounter=0,this.markerAnnotations=[],this.tiles=[],this.polylineAnnotations=new Map,this.map=t,this.dirty=!1;var e=t.createLayer("annotationLayer",W.ANNOTATION,o.annotationLayerOrder);this.annotationLayer=e}return t.prototype.update=function(){var t=this;this.dirty&&(this.tiles.forEach(function(e){var i=t.getTileData(e.getTileCoordinate());t.updateRenderTile(i,e),e.setData(i)}),this.dirty=!1)},t.prototype.addTile=function(t){var e=this.getTileData(t.getTileCoordinate());this.updateRenderTile(e,t),t.setData(e),this.tiles.push(t)},t.prototype.removeTile=function(t){var e=this,i=t.getTileData();null!=i&&i.getLayerIds().forEach(function(i){var n=e.map.getLayer(i);n.getLayerType()==W.LINE&&n.removeRenderTile(t.getTileCoordinate())});var n=this.tiles.indexOf(t);-1!==n&&this.tiles.splice(n,1)},t.prototype.getTileData=function(t){if(0==this.markerAnnotations.length&&0==this.polylineAnnotations.size)return null;var e=new pe;return this.polylineAnnotations.forEach(function(i){i.updateTileData(t,e)}),e},t.prototype.addAnnotation=function(t){this.dirty=!0;var e=this.idCounter++;return this.addAnnotations(e,t),e},t.prototype.addAnnotations=function(t,e){if(e.getAnnotationType()==pt.POLYLINE){var i=new ee(t,e);i.updateLayer(this.map),this.polylineAnnotations.set(t,i)}else this.markerAnnotations.push(t),this.annotationLayer.addAnnotation(t,e)},t.prototype.removeAnnotation=function(e){this.dirty=!0;var i=this.markerAnnotations.indexOf(e);-1!=i?(this.markerAnnotations.splice(i,1),this.annotationLayer.removeAnnotation(e)):this.polylineAnnotations.has(e)?(this.polylineAnnotations.delete(e),this.map.removeLayer(t.annotationLayerId+e.toString())):console.warn("Not reachable")},t.prototype.updateAnnotation=function(t,e){-1!=this.markerAnnotations.indexOf(t)||this.polylineAnnotations.has(t)?(this.dirty=!0,this.removeAnnotation(t),this.addAnnotations(t,e)):console.warn("#---------------- updateAnnotation() is not update: "+t)},t.prototype.updateMarkerPosition=function(t,e){-1!=this.markerAnnotations.indexOf(t)?(this.dirty=!0,this.annotationLayer.updateMarkerPosition(t,e)):console.warn("#---------------- updateMarkerPosition() is not update market position: "+t)},t.prototype.updateRenderTile=function(t,e){var i=this;if(null!=t){var n=e.getTileCoordinate();t.getLayerIds().forEach(function(t){var o=i.map.getLayer(t);if(o.getLayerType()==W.LINE){var r=new I(O.createWithXYZoom(n.getX(),n.getY(),n.getZoom()),e);o.addRenderTile(e.getTileCoordinate(),r)}})}},t.annotationLayerId="maplink.annotation.layer.",t}(),ce=function(){function t(t){this.idCounter=0,this.tileManager=t,this.tileAreas=new Map}return t.prototype.addTileArea=function(t){var e=this.idCounter++;return this.tileAreas.set(e,t),this.tileManager.addTileArea(e,t),e},t.prototype.updateTileArea=function(t,e){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.tileAreas.set(t,e),this.tileManager.updateTileArea(t,e))},t.prototype.removeTileArea=function(t){this.tileAreas.delete(t),this.tileManager.removeTileArea(t)},t}(),fe=function(){function t(t){this.gl=t,this.init(t)}return t.prototype.init=function(t){this.textureId=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.textureId);var e=new Uint8Array([255,255,255,255]);t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null)},t.prototype.loadImage=function(t,e){var i=this;void 0===e&&(e=null);var n=this.gl,o=new Image;o.crossOrigin="*";var r=window.URL.createObjectURL(t);o.src=r,o.onload=function(){null!=i.textureId&&(n.bindTexture(n.TEXTURE_2D,i.textureId),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,o),n.generateMipmap(n.TEXTURE_2D),n.bindTexture(n.TEXTURE_2D,null)),i.width=o.width,i.height=o.height,e&&e(),window.URL.revokeObjectURL(r)}},t.prototype.loadImageFromUrl=function(t,e){var i=this;void 0===e&&(e=null);var n=this.gl,o=new Image;o.crossOrigin="*",o.src=t,o.onload=function(){null!=i.textureId&&(n.bindTexture(n.TEXTURE_2D,i.textureId),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,o),n.generateMipmap(n.TEXTURE_2D),n.bindTexture(n.TEXTURE_2D,null)),i.width=o.width,i.height=o.height,e&&e(),window.URL.revokeObjectURL(t)}},t.prototype.setFilter=function(t){var e=this.gl;e.bindTexture(e.TEXTURE_2D,this.textureId),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),e.bindTexture(e.TEXTURE_2D,null)},t.prototype.destroy=function(){this.gl.deleteTexture(this.textureId),this.textureId=null},t}(),de=function(){function t(t){this.layerType=t}return t.prototype.getType=function(){return this.layerType},t}(),ge=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),me=function(t){function e(e){var i=t.call(this,W.RASTER)||this;return i.texture=e,i}return ge(e,t),e}(de),ye=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ae=function(t){function e(e,i){return t.call(this,G.RASTER,e,i)||this}return ye(e,t),e.prototype.init=function(t,e){var i=this,n=new fe(this.gl);n.loadImage(t,function(){i.renderable=!0,e()}),this.rasterLayerData=new me(n)},e.prototype.getTexture=function(){return this.rasterLayerData.texture},e}(nt),ve=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),xe=function(t){function e(e,i,n){return t.call(this,e,i,W.RASTER,n)||this}return ve(e,t),e.prototype.update=function(){var t=this;this.tileManager.update(function(e){return new Ae(e,t.tileManager.mapView.gl)})},e}(q),Te=function(){function t(t,e,i){this.width=t,this.height=e,this.url=i}return t.prototype.clone=function(){return new t(this.width,this.height,this.url)},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getUrl=function(){return this.url},t.defaultMarker=new t(32,32,null),t}(),Me=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),we=function(t){function e(e,i,n,o,r,a){void 0===i&&(i=!0),void 0===n&&(n=new c(.5,1)),void 0===o&&(o=Te.defaultMarker),void 0===r&&(r=null),void 0===a&&(a=null);var s=t.call(this,it.MARKER)||this;return s.position=e,s.minX=e.getLongitude(),s.minY=e.getLatitude(),s.maxX=e.getLongitude(),s.maxY=e.getLatitude(),s.visible=i,s.anchor=n,s.url=o.getUrl(),s.width=o.getWidth(),s.height=o.getHeight(),s.gl=r,s.initTexture(s.url,a),s}return Me(e,t),e.prototype.initTexture=function(t,e){void 0===e&&(e=null),this.texture=new fe(this.gl),this.texture.loadImageFromUrl(null==t?h.markerDefault:t,function(){e&&e()})},e.prototype.isRenderable=function(){return this.visible},e.prototype.hasTexture=function(){return null!=this.texture},e.prototype.getTexture=function(){return this.texture},e.prototype.getPosition=function(){return this.position},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e.prototype.getAnchor=function(){return this.anchor},e.prototype.setVisible=function(t){this.visible=t},e.prototype.setPosition=function(t){this.position=t},e}(st),Se=i(0),Ee=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),be=function(t){function e(e,i,n){var o=t.call(this,e,i,W.ANNOTATION,n)||this;return o.shapeAnnotations=new Map,o.rBushTree=Se(),o}return Ee(e,t),e.prototype.update=function(t){this.shapeAnnotations.forEach(function(e){e.update(t)})},e.prototype.addAnnotation=function(t,e){switch(e.getAnnotationType()){case pt.MARKER:var i=e,n=new we(i.getPosition(),i.isVisible(),i.getAnchor(),i.getIcon(),this.tileManager.mapView.gl);this.shapeAnnotations.set(t,n),this.rBushTree.insert(n)}},e.prototype.removeAnnotation=function(t,e){if(void 0===e&&(e=null),this.shapeAnnotations.get(t)){var i=this.shapeAnnotations.get(t);if(i.getShapeType()==it.MARKER){var n=i;this.rBushTree.remove(n)}this.shapeAnnotations.delete(t)}},e.prototype.updateMarkerPosition=function(t,e){var i=this.shapeAnnotations.get(t);i.getShapeType()==it.MARKER&&i.setPosition(e)},e}(q),Le=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ce=function(t){function e(e,i,n){var o=t.call(this,e,i,W.LINE,n)||this;return o.strokeWidth=5,o.strokeColor=new l(0,0,0,1),o.strokeOpacity=1,o.renderTiles=new Map,o}return Le(e,t),e.prototype.update=function(t){},e.prototype.setStrokeWidth=function(t){this.strokeWidth=t},e.prototype.setStrokeColor=function(t){this.strokeColor=null!==t?l.fromHex(t):new l(255,0,0,1)},e.prototype.setStrokeOpacity=function(t){this.strokeOpacity=t},e.prototype.addRenderTile=function(t,e){this.renderTiles.has(t)||this.renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this.renderTiles.delete(t)},e}(q),Re=function(){function t(){}return t.createLayer=function(t,e,i,n){switch(e){case W.RASTER:return new xe(t,n,i);case W.ANNOTATION:return new be(t,n,i);case W.LINE:return new Ce(t,n,i);default:return console.log("Un-support layer type"),null}},t}(),Pe=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ie=function(t){function e(e,i,n,o){void 0===i&&(i=!0),void 0===n&&(n=new c(.5,1)),void 0===o&&(o=Te.defaultMarker);var r=t.call(this,pt.MARKER)||this;return r.position=e,r.visible=i,r.anchor=n,r.icon=o,r}return Pe(e,t),e.prototype.setPosition=function(t){this.position=t},e.prototype.setVisible=function(t){this.visible=t},e.prototype.getPosition=function(){return this.position},e.prototype.getIcon=function(){return this.icon},e.prototype.getAnchor=function(){return this.anchor},e.prototype.isVisible=function(){return this.visible},e}(Et),De=function(){function t(t,e){var i=this;this.watchId=-1,this.userLocationDotId=-1,this.userLocationDot=null,this.lastKnownLocation=null,this.defaultPositionOptions={enableHighAccuracy:!0,maximumAge:0,timeout:6e3},this.mapView=e,this.myLocationButton=S.create("div","button",t),this.myLocationButton.innerHTML="<a class='location'></a>",this.myLocationButton.addEventListener("click",function(){i.onMyLocationButtonClick()})}return t.prototype.onMyLocationButtonClick=function(){-1==this.watchId&&(this.watchId=window.navigator.geolocation.watchPosition(this.onGetCurrentPositionSuccess.bind(this),this.onGetCurrentPositionError.bind(this),this.defaultPositionOptions)),null!=this.lastKnownLocation&&this.mapView.flyTo(this.lastKnownLocation,17)},t.prototype.onGetCurrentPositionSuccess=function(t){var e=new u(t.coords.latitude,t.coords.longitude);if(null==this.lastKnownLocation&&this.mapView.flyTo(e,17),this.lastKnownLocation=e,null==this.userLocationDot){var i=void 0,n=32*d.pixelScale,o=32*d.pixelScale;i=d.pixelScale<1.5?new Te(n,o,h.myPosition):d.pixelScale<2.5?new Te(n,o,h.myPosition2x):new Te(n,o,h.myPosition3x),this.userLocationDot=new Ie(e,!0,new c(.5,.5),i)}else this.userLocationDot.setPosition(e),this.userLocationDot.setVisible(!0);-1==this.userLocationDotId?this.userLocationDotId=this.mapView.addAnnotation(this.userLocationDot):this.mapView.updateAnnotation(this.userLocationDotId,this.userLocationDot)},t.prototype.onGetCurrentPositionError=function(t){1===t.code&&(-1!=this.watchId&&(window.navigator.geolocation.clearWatch(this.watchId),this.watchId=-1),-1!=this.userLocationDotId&&(this.mapView.removeAnnotation(this.userLocationDotId),this.userLocationDotId=-1))},t}();!function(t){t[t.Butt=0]="Butt",t[t.Square=1]="Square",t[t.Round=2]="Round"}(ie||(ie={})),function(t){t[t.Miter=0]="Miter",t[t.Bevel=1]="Bevel",t[t.Round=2]="Round"}(ne||(ne={}));var Oe=function(){function t(t,e,i,n,o){void 0===t&&(t=function(t,e){}),void 0===e&&(e=ie.Butt),void 0===i&&(i=ne.Bevel),void 0===n&&(n=!1),void 0===o&&(o=3),this.indices=[],this.addVertex=t,this.lineCapType=e,this.lineJoinType=i,this.closedPolyline=n,this.miterLimit=o,this.numVertices=0}return t.prototype.buildPolyLine=function(t,e){void 0===e&&(e=null),this.buildPolyLineSegment(t,e)},t.prototype.clear=function(){this.indices=[],this.numVertices=0},t.prototype.buildPolyLineSegment=function(t,e){var i=this.closedPolyline?t.length+2:t.length,n=t.length,o=i-0;if(!(o<2)){var r,a,u,h=t[0],p=t[1];a=new c(p.y-h.y,h.x-p.x).normalize(),this.closedPolyline||this.addCap(h,a,!0),this.addPolyLineVertex(h,a),this.addPolyLineVertex(h,a.multiply(-1));for(var l=1;l<o-1;++l){if((h=p)!=(p=t[(l+0+1)%n])){r=a,a=new c(p.y-h.y,h.x-p.x).normalize();var f=1;0==(u=r.add(a)).x&&0==u.y?u=new c(r.y-a.y,a.x-r.x):f=2/u.dot(u),u=u.multiply(f);var d=this.lineJoinType==ne.Bevel;if(u.length>this.miterLimit&&(d=!0,u=u.multiply(this.miterLimit/u.length)),this.lineJoinType!=ne.Miter||d){var g=d||this.lineJoinType==ne.Bevel?1:s.numTrianglesOnRoundJoin;a.x*r.y-a.y*r.x>0?(this.addPolyLineVertex(h,u),this.addPolyLineVertex(h,r.multiply(-1)),this.addIndices(),this.addFan(h,r.multiply(-1),a.multiply(-1),u,g),this.addPolyLineVertex(h,u),this.addPolyLineVertex(h,a.multiply(-1))):(this.addPolyLineVertex(h,r),this.addPolyLineVertex(h,u.multiply(-1)),this.addIndices(),this.addFan(h,r,a,u.multiply(-1),g),this.addPolyLineVertex(h,a),this.addPolyLineVertex(h,u.multiply(-1)))}else this.addPolyLineVertex(h,u),this.addPolyLineVertex(h,u.multiply(-1)),this.addIndices()}}this.addPolyLineVertex(p,a),this.addPolyLineVertex(p,a.multiply(-1)),this.addIndices(),this.closedPolyline||this.addCap(p,a,!1),e&&e()}},t.prototype.addCap=function(t,e,i){switch(this.lineCapType){case ie.Butt:break;case ie.Square:var n=new c(-e.y,e.x);this.addPolyLineVertex(t,e.add(n)),this.addPolyLineVertex(t,e.multiply(-1).add(n)),i||this.addIndices();break;case ie.Round:var o=e,r=e.multiply(-1),a=new c(0,0);i&&(o=o.multiply(-1),r=r.multiply(-1)),this.addFan(t,o,r,a,s.numTrianglesOnRoundCap);break;default:console.log("Invalid line cap type")}},t.prototype.addPolyLineVertex=function(t,e){++this.numVertices,this.addVertex(t,e)},t.prototype.addIndices=function(){this.indices.push(this.numVertices-4),this.indices.push(this.numVertices-2),this.indices.push(this.numVertices-3),this.indices.push(this.numVertices-3),this.indices.push(this.numVertices-2),this.indices.push(this.numVertices-1)},t.prototype.addFan=function(t,e,i,n,o){var r=e.x*i.y-e.y*i.x,a=Math.atan2(r,e.dot(i)),s=this.numVertices;this.addPolyLineVertex(t,n),this.addPolyLineVertex(t,e);for(var u=e,h=0;h<o;h++){var p=(h+1)/o;u=e.rotateBy(a*p),this.addPolyLineVertex(t,u),this.indices.push(s),this.indices.push(s+h+(a>0?1:2)),this.indices.push(s+h+(a>0?2:1))}},t}(),Be=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ze=function(t){function e(e,i,n){var o=t.call(this,W.LINE)||this;return o.gl=n,o.buildPolyline(e,i),o}return Be(e,t),e.prototype.getModel=function(){return this.lineModel},e.prototype.buildPolyline=function(t,e){var i=[],n=new Oe;n.addVertex=function(t,e){i.push(t.x,t.y,e.x,e.y)},n.lineCapType=ie.Butt,n.lineJoinType=ne.Round;for(var o=d.getTileSize(),r=t.featureCount(),a=0;a<r;++a){var s=t.getFeature(a);if(s.getType()!=qt.LineString)return void console.warn("# buildPolyline ----------- not GeometryType.LineString");for(var u=s.getGeometries().geometryCoordinates,h=0;h<u.length;++h){for(var p=[],l=0;l<u[h].length;++l){var f=new c(u[h][l][0],u[h][l][1]);f.x=f.x*o,f.y=f.y*o,p.push(f)}n.buildPolyLine(p)}return this.lineModel=new ut(this.gl,this.gl.TRIANGLES),void this.lineModel.initPolyline(i,n)}},e}(de),ke=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ue=function(t){function e(e,i,n){var o=t.call(this,e,i,n)||this;return o.gl=n,o.layerDatas=new Map,o}return ke(e,t),e.prototype.getTexture=function(){return null},e.prototype.init=function(t,e){},e.prototype.setData=function(t){this.tileData=t},e.prototype.hasData=function(t){return null!=this.tileData&&null!=this.tileData.getLayer(t)},e.prototype.getLayerData=function(t,e){if(!this.layerDatas.has(t)){var i=this.tileData.getLayer(t);if(null==i)return console.error("getLayerData not reachable"),null;switch(e){case W.LINE:var n=new Ze(i,this.tileCoordinate,this.gl);return this.layerDatas.set(t,n),this.layerDatas.get(t);default:return console.error("getLayerData not reachable"),null}}return this.layerDatas.get(t)},e.prototype.getTileData=function(){return this.tileData},e}(nt),Ne=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ze=function(t){function e(e,i,n){var o=t.call(this,G.ANNOTAION,e,n)||this;return o.annotationManager=i,o.annotationManager.addTile(o),o}return Ne(e,t),e.prototype.detroy=function(){this.annotationManager.removeTile(this)},e}(Ue),Ve=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Ye=function(t){function e(e,i){var n=t.call(this)||this;return n.gl=null,n.mapIsChanging=!1,n.defaultMapOptions={center:[10.773599,106.702835],zoom:o.defaultMinZoom,mapUrl:o.defaultMapUrl,minZoom:o.defaultMinZoom,maxZoom:o.defaultMaxZoom,geolocate:!1},i=d.extendOptions({},n.defaultMapOptions,i),n.setupViews(e,i),n.setupComponents(i),n.addEvents(),n.loop(),n}return Ve(e,t),e.prototype.setOptions=function(t){t=d.extendOptions({},this.defaultMapOptions,t),this.mapState.setTarget(new u(t.center[0],t.center[1])),this.mapState.setZoom(t.zoom),this.mapSettings.setMapUrl(t.mapUrl),this.mapSettings.setMinZoom(t.minZoom),this.mapSettings.setMaxZoom(t.maxZoom),this.reload(),this.tileManager.updateVisibleTiles()},e.prototype.loop=function(){this.resize(),this.dirty&&(this.dirty=!1,this.update(),this.render(),(this.mapIsChanging||this.mapState.isFlyingTo()||this.mapState.isPanning()||this.mapState.isZoomIn()||this.mapState.isZoomOut()||this.mapState.isStartedAnimation()||this.mapState.isMoving())&&(this.dirty=!0),this.dirty||(this.dirty=!this.tileManager.finishedLoad)),requestAnimationFrame(this.loop.bind(this))},e.prototype.update=function(){var t=this;this.cameraAnimation.updateTransitions(),this.annotationManager.update(),this.layers.forEach(function(e){e.update(t.mapState)})},e.prototype.resize=function(){if(null!=this.canvas){d.devicePixelScale=window.devicePixelRatio||1,d.pixelScale=Math.round(d.devicePixelScale);var t=this.canvas.offsetWidth*d.devicePixelScale,e=this.canvas.offsetHeight*d.devicePixelScale;this.width==t&&this.height==e||(this.width=t,this.height=e,this.canvas.width=this.width,this.canvas.height=this.height,this.gl.viewport(0,0,this.width,this.height),this.mapState.setScreenSize(this.width,this.height),this.reload(),this.tileManager.updateVisibleTiles())}},e.prototype.render=function(){var t=this.gl;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.mapRenderer.render()},e.prototype.createLayer=function(t,e,i){if(this.layers.has(t))return console.log("Cannot create layer which layer id already exist"),null;var n=Re.createLayer(t,e,this.tileManager,i);return null!=n?(this.mapRenderer.addLayer(n),this.layers.set(t,n),n):null},e.prototype.removeLayer=function(t){this.mapRenderer.removeLayer(t),this.layers.delete(t)},e.prototype.moveBy=function(t){this.cameraAnimation.moveBy(t)},e.prototype.moveByVelocity=function(t){this.mapState.isPanning()||this.mapState.isZoomIn()||this.mapState.isZoomOut()||this.cameraAnimation.moveByVelocity(t)},e.prototype.getCameraPositionForLatLngBounds=function(t,e,i,n,a){var s=t.getSouthwest(),u=t.getNortheast();if(Math.abs(s.getLatitude()-u.getLatitude())<r.epsilon&&Math.abs(s.getLongitude()-u.getLongitude())<r.epsilon){var h=this.mapState.getCameraPosition();return new L(s,h.getTilt(),h.getBearing(),this.mapSettings.getMaxZoom())}var p=this.mapState.getScreenSize(),l=v.latLngToScreenCoordinateZoom(s,this.mapState,o.defaultMaxZoom),f=v.latLngToScreenCoordinateZoom(u,this.mapState,o.defaultMaxZoom),d=l.x+e,m=f.x-n,y=f.y-i,A=l.y+a,x=v.screenCoordinateToLatLngZoom(new c((d+m)/2,(y+A)/2),this.mapState,o.defaultMaxZoom),T=f.x-l.x,M=l.y-f.y,w=p.x/(T<=0?1:T),S=p.y/(M<=0?1:M);w-=(e+n)/(T<=0?1:T),S-=(i+a)/(M<=0?1:M);var E=o.defaultMaxZoom+Math.log2(Math.min(w,S));E=g.clamp(E,this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()),E=Math.floor(E);var b=this.mapState.getCameraPosition();return new L(x,b.getTilt(),b.getBearing(),E)},e.prototype.setZoom=function(t,e){this.mapIsChanging||(t=g.clamp(t,this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()),this.cameraAnimation.zoom(t,e,new Mt),this.mapEvents.notify(n.zoomChanged))},e.prototype.setTilt=function(t){this.mapEvents.notify(n.tiltChanged),this.cameraAnimation.setTilt(t)},e.prototype.setBearing=function(t,e){void 0===e&&(e=0),this.cameraAnimation.setBearing(t,e)},e.prototype.stopAnimation=function(){this.cameraAnimation.stopAnimation()},e.prototype.setMapUrl=function(t){this.mapSettings.getMapUrl()!=t&&(this.mapSettings.setMapUrl(t),this.tileManager.reload())},e.prototype.getMousePositionOnMap=function(t){return new c(t.clientX-this.canvas.getBoundingClientRect().left,t.clientY-this.canvas.getBoundingClientRect().top)},e.prototype.getMapUrl=function(){return this.mapSettings.getMapUrl()},e.prototype.setMinZoom=function(t){this.mapSettings.setMinZoom(t)},e.prototype.setMaxZoom=function(t){this.mapSettings.setMaxZoom(t)},e.prototype.setMaxNativeZoom=function(t){t=g.clamp(t,o.defaultMinZoom,o.defaultMaxZoom),this.mapSettings.setMaxNativeZoom(t)},e.prototype.addTileArea=function(t){return this.tileAreaManager.addTileArea(t)},e.prototype.removeTileArea=function(t){this.tileAreaManager.removeTileArea(t)},e.prototype.addAnnotation=function(t){return this.annotationManager.addAnnotation(t)},e.prototype.removeAnnotation=function(t){this.annotationManager.removeAnnotation(t)},e.prototype.updateAnnotation=function(t,e){this.annotationManager.updateAnnotation(t,e)},e.prototype.updateMarkerPosition=function(t,e){this.annotationManager.updateMarkerPosition(t,e)},e.prototype.flyTo=function(t,e,i){var n=new wt;n.target=t,n.zoom=e;var o=new Mt;null!=i&&i>=1&&(o.duration=i),this.cameraAnimation.flyTo(n,o)},e.prototype.moveTo=function(t,e,i){this.cameraAnimation.moveTo(t,e,i)},e.prototype.screenCoordinateToLatLng=function(t){return v.screenCoordinateToLatLng(t,this.mapState)},e.prototype.latLngToScreenCoordinate=function(t){return v.latLngToScreenCoordinate(t,this.mapState)},e.prototype.getCenterCamera=function(){return this.mapState.getTarget()},e.prototype.setCenterCamera=function(t){this.mapEvents.notify(n.centerChanged),this.mapState.setTarget(t)},e.prototype.getCameraPosition=function(){return this.mapState.getCameraPosition()},e.prototype.setCameraPosition=function(t){this.mapState.setCameraPosition(t),this.mapEvents.notify(n.centerChanged)},e.prototype.reload=function(){this.tileManager.reload()},e.prototype.setupComponents=function(t){var e=this;t=d.extendOptions({},this.defaultMapOptions,t),lt.Instance.init(this.gl),this.layers=new Map,this.tileTaskManager=new K,this.mapSettings=new _,this.mapState=new R(this.mapSettings),this.mapRenderer=new vt(this.mapState),this.cameraAnimation=new St(this.mapState,this,this.mapSettings),this.dirty=!0,this.mapObserver=new E,this.mapEvents=new M(this),this.mapState.setTarget(new u(t.center[0],t.center[1])),this.mapState.setZoom(t.zoom),this.mapState.setScreenSize(this.width,this.height),this.mapSettings.setMapUrl(t.mapUrl),this.mapSettings.setMinZoom(t.minZoom),this.mapSettings.setMaxZoom(t.maxZoom);this.tileManager=new F(this,this.tileTaskManager,this.mapState,this.mapSettings,function(t){return new ze(t,e.annotationManager,e.gl)}),this.tileAreaManager=new ce(this.tileManager),this.createLayer("rasterLayer",W.RASTER,o.rasterLayerOrder),this.annotationManager=new le(this)},e.prototype.setupViews=function(t,e){var i=S.create("div","mapgl",t);this.canvas=S.create("canvas","",i);var n=S.create("div","ui",i);e.geolocate&&(this.geolocateControl=new De(n,this)),this.gl=this.canvas.getContext("experimental-webgl");var o=l.fromHex("f2efe9");this.gl.clearColor(o.red,o.green,o.blue,o.alpha),d.devicePixelScale=window.devicePixelRatio||1,d.pixelScale=Math.round(d.devicePixelScale),this.width=this.canvas.offsetWidth*d.devicePixelScale,this.height=this.canvas.offsetHeight*d.devicePixelScale;var r=document.createElement("style");r.innerHTML=p.content,document.getElementsByTagName("head")[0].appendChild(r),this.zoomInButton=S.create("div","button",n),this.zoomInButton.innerHTML="<a class='zoom-in-icon'></a>",this.zoomOutButton=S.create("div","button",n),this.zoomOutButton.innerHTML="<a class='zoom-out-icon'></a>",this.tiltUpButton=S.create("div","button",n),this.tiltUpButton.innerHTML="<a class='tilt-up-icon'></a>",this.tiltDownButton=S.create("div","button",n),this.tiltDownButton.innerHTML="<a class='tilt-down-icon'></a>"},e.prototype.addEvents=function(){var t=this;this.mouseEventHandler=new w(this.canvas,this),window.addEventListener("resize",this.resize,!1),this.zoomInButton.addEventListener("click",function(){t.setZoom(t.mapState.zoom+1,new c(t.width/2,t.height/2))}),this.zoomOutButton.addEventListener("click",function(){t.setZoom(t.mapState.zoom-1,new c(t.width/2,t.height/2))}),this.tiltUpButton.addEventListener("click",function(){t.setTilt(t.mapState.cameraPosition.tilt-1)}),this.tiltDownButton.addEventListener("click",function(){t.setTilt(t.mapState.cameraPosition.tilt+1)})},e.prototype.addListener=function(t,e){this.mapEvents.addEvent(t,e)},e.prototype.notifyCameraWillChange=function(){this.dirty=!0,this.mapIsChanging=!0,this.mapEvents.notify(n.centerWillChanged)},e.prototype.notifyCameraIsChanging=function(){this.dirty=!0,this.mapEvents.notify(n.centerChanged),this.tileManager.updateVisibleTiles()},e.prototype.notifyCameraDidChange=function(){this.mapIsChanging=!1,this.mapEvents.notify(n.idle)},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e}(b),Fe=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),je=function(t){function e(e,i,n,o,r,a){void 0===r&&(r=!0),void 0===a&&(a=!1);var s=t.call(this,pt.POLYLINE)||this;return s.path=[],s.path=e,s.strokeWidth=i,s.strokeColor=n,s.strokeOpacity=o,s.visible=r,s.closedPolyLine=a,s}return Fe(e,t),e.prototype.getStrokeWidth=function(){return this.strokeWidth},e.prototype.getStrokeColor=function(){return this.strokeColor},e.prototype.getPath=function(){return this.path},e.prototype.getStrokeOpacity=function(){return this.strokeOpacity},e.prototype.isClosedPolyLine=function(){return this.closedPolyLine},e.prototype.isVisible=function(){return this.visible},e}(Et),Xe=function(){function t(t,e,i,n){this.bounds=t,this.mapUrl=e,this.minZoom=i,this.maxZoom=n}return t.prototype.getBounds=function(){return this.bounds},t.prototype.getMapUrl=function(){return this.mapUrl},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getMaxZoom=function(){return this.maxZoom},t}(),He=function(){function t(t,e){if(null==e.accessKey){var i="Map4D SDK: Missing access key!";throw alert(i),new Error(i)}this.mapView=new Ye(t,e)}return t.prototype.addMarker=function(t){var e=new Ie(t.getPosition(),t.getVisible(),t.getAnchor(),t.getIcon());return this.mapView.addAnnotation(e)},t.prototype.removeMarker=function(t){-1!=t.id&&this.mapView.removeAnnotation(t.id)},t.prototype.addPolyline=function(t){var e=new je(t.getPath(),t.getStrokeWidth(),t.getStrokeColor(),t.getStrokeOpacity(),t.getVisible(),t.getClosedPolyline());return this.mapView.addAnnotation(e)},t.prototype.removePolyline=function(t){-1!=t.id&&this.mapView.removeAnnotation(t.id)},t.prototype.addTileArea=function(t){var e=new Xe(t.getBounds(),t.getMapUrl(),t.getMinZoom(),t.getMaxZoom());return this.mapView.addTileArea(e)},t.prototype.fitBounds=function(t,e,i,o,r){var a=this.getCameraPositionForLatLngBounds(t,e,i,o,r);this.mapView.mapEvents.notify(n.boundsChanged),this.mapView.setCameraPosition(a)},t.prototype.getBounds=function(){},t.prototype.getCenter=function(){return this.mapView.getCenterCamera()},t.prototype.setCenter=function(t){this.mapView.setCenterCamera(t)},t.prototype.setOptions=function(t){this.mapView.setOptions(t)},t.prototype.getZoom=function(){return this.mapView.mapState.getZoom()},t.prototype.setZoom=function(t){this.mapView.mapState.setZoom(t)},t.prototype.getTilt=function(){return this.mapView.mapState.getTilt()},t.prototype.setTilt=function(t){this.mapView.mapState.setTilt(t)},t.prototype.setMapUrl=function(t){this.mapView.setMapUrl(t)},t.prototype.getMapUrl=function(){return this.mapView.getMapUrl()},t.prototype.setMinZoom=function(t){this.mapView.setMinZoom(t)},t.prototype.setMaxZoom=function(t){this.mapView.setMaxZoom(t)},t.prototype.panBy=function(t,e){this.mapView.moveBy(new f(t,e))},t.prototype.panByVelocity=function(t,e){this.mapView.moveByVelocity(new f(t,e))},t.prototype.addAnnotation=function(t){this.mapView.addAnnotation(t)},t.prototype.removeAnnotation=function(t){this.mapView.removeAnnotation(t)},t.prototype.updateAnnotation=function(t,e){this.mapView.updateAnnotation(t,e)},t.prototype.updateMarkerPosition=function(t,e){this.mapView.updateMarkerPosition(t,e)},t.prototype.flyTo=function(t,e,i,n){this.mapView.flyTo(new u(t,e),i,n)},t.prototype.panTo=function(t,e,i,n){this.mapView.moveTo(new u(t,e),i,n)},t.prototype.getCameraPositionForLatLngBounds=function(t,e,i,n,o){return this.mapView.getCameraPositionForLatLngBounds(t,e,i,n,o)},t.prototype.screenCoordinateToLatLng=function(t){return this.mapView.screenCoordinateToLatLng(t)},t.prototype.latLngToScreenCoordinate=function(t){return this.mapView.latLngToScreenCoordinate(t)},t.prototype.addListener=function(t,e){this.mapView.addListener(t,e)},t}(),Qe=function(){function t(t){this.defaultMarker={visible:!0,anchor:new c(.5,1),icon:new Te(32,32,null)};var e={};d.extendOptions(e,this.defaultMarker,t),this._id=-1,this.position=e.position,this.map=e.map,this.visible=e.visible,this.icon=e.icon,null!=this.map&&(this._id=this.map.addMarker(this))}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.getPosition=function(){return this.position},t.prototype.getMap=function(){return this.map},t.prototype.setMap=function(t){null!=this.map&&(this.map.removeMarker(this),this._id=-1),this.map=t,null!=this.map&&(this._id=this.map.addMarker(this))},t.prototype.getVisible=function(){return this.visible},t.prototype.setVisible=function(t){this.visible=t},t.prototype.getAnchor=function(){return this.anchor},t.prototype.setAnchor=function(t){this.anchor=t},t.prototype.getIcon=function(){return this.icon},t.prototype.setIcon=function(t){this.icon=t},t}(),We=function(){function t(t){this.defaultPolyline={strokeWidth:3,strokeColor:"#f44f0d",strokeOpacity:1,visible:!0,closedPolyline:!1};var e={};d.extendOptions(e,this.defaultPolyline,t),this._id=-1,this.path=e.path,this.strokeWidth=e.strokeWidth,this.strokeColor=e.strokeColor,this.strokeOpacity=e.strokeOpacity,this.visible=e.visible,this.closedPolyLine=e.closedPolyLine,this.map=e.map,null!=this.map&&(this._id=this.map.addPolyline(this))}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.getPath=function(){return this.path},t.prototype.setPath=function(t){this.path=t},t.prototype.getMap=function(){return this.map},t.prototype.setMap=function(t){null!=this.map&&(this.map.removePolyline(this),this._id=-1),this.map=t,null!=this.map&&(this._id=this.map.addPolyline(this))},t.prototype.getStrokeWidth=function(){return this.strokeWidth},t.prototype.getStrokeColor=function(){return this.strokeColor},t.prototype.getStrokeOpacity=function(){return this.strokeOpacity},t.prototype.getVisible=function(){return this.visible},t.prototype.setVisible=function(t){this.visible=t},t.prototype.getClosedPolyline=function(){return this.closedPolyLine},t}(),Ke=function(){function t(t){this.defaultTileArea={};var e={};d.extendOptions(e,this.defaultTileArea,t),this._id=-1,this.bounds=e.bounds,this.mapUrl=e.mapUrl,this.minZoom=e.minZoom,this.maxZoom=e.maxZoom,this.map=e.map,null!=this.map&&(this._id=this.map.addTileArea(this))}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),t.prototype.getBounds=function(){return this.bounds},t.prototype.setBounds=function(t){this.bounds=t},t.prototype.getMapUrl=function(){return this.mapUrl},t.prototype.setMapUrl=function(t){this.mapUrl=t},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.setMinZoom=function(t){this.minZoom=t},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setMaxZoom=function(t){this.maxZoom=t},t}(),_e=function(){function t(t){this.map=t}return t.prototype.fromLatLngToScreen=function(t){return this.map.latLngToScreenCoordinate(t)},t.prototype.fromScreenToLatLng=function(t){return this.map.screenCoordinateToLatLng(t)},t}(),Ge=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Je=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ge(e,t),e}(c),qe=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),$e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qe(e,t),e.prototype.equals=function(t){return this.getLatitude()==t.getLatitude()&&this.getLongitude()==t.getLongitude()},e.prototype.lat=function(){return this.getLatitude()},e.prototype.long=function(){return this.getLongitude()},e.prototype.toString=function(){return this.getLatitude()+","+this.getLongitude()},e.prototype.toUrlValue=function(t){return this.getLatitude()+","+this.getLongitude()},e}(u),ti=function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ei=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return ti(e,t),e}(A);i.d(e,"Map",function(){return He}),i.d(e,"MFMarker",function(){return Qe}),i.d(e,"MFPolyline",function(){return We}),i.d(e,"MFTileArea",function(){return Ke}),i.d(e,"MFProjection",function(){return _e}),i.d(e,"MLVec2",function(){return Je}),i.d(e,"MFLatLng",function(){return $e}),i.d(e,"MFLatLngBounds",function(){return ei})}]);
//# sourceMappingURL=map4dsdk@0.0.5.production.js.map