var map4d=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e,n){"use strict";function i(t,e){this.x=t,this.y=e}t.exports=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,o=n*this.x+e*this.y;return this.x=i,this.y=o,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),o=e.x+n*(this.x-e.x)-i*(this.y-e.y),r=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=o,this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t}},function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i,s,u,l,h,f,g,m=e&&e.length,y=m?e[0]*n:t.length,v=o(t,0,y,n,!0),x=[];if(!v||v.next===v.prev)return x;if(m&&(v=function(t,e,n,i){var a,s,u,l,h,f=[];for(a=0,s=e.length;a<s;a++)u=e[a]*i,l=a<s-1?e[a+1]*i:t.length,(h=o(t,u,l,i,!1))===h.next&&(h.steiner=!0),f.push(d(h));for(f.sort(c),a=0;a<f.length;a++)p(f[a],n),n=r(n,n.next);return n}(t,e,v,n)),t.length>80*n){i=u=t[0],s=l=t[1];for(var A=n;A<y;A+=n)h=t[A],f=t[A+1],h<i&&(i=h),f<s&&(s=f),h>u&&(u=h),f>l&&(l=f);g=0!==(g=Math.max(u-i,l-s))?1/g:0}return a(v,x,n,i,s,g),x}function o(t,e,n,i,o){var r,a;if(o===_(t,e,n,i)>0)for(r=e;r<n;r+=i)a=T(r,t[r],t[r+1],a);else for(r=n-i;r>=e;r-=i)a=T(r,t[r],t[r+1],a);return a&&v(a,a.next)&&(w(a),a=a.next),a}function r(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!v(i,i.next)&&0!==y(i.prev,i,i.next))i=i.next;else{if(w(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function a(t,e,n,i,o,c,p){if(t){!p&&c&&function(t,e,n,i){var o=t;do{null===o.z&&(o.z=f(o.x,o.y,e,n,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,n,i,o,r,a,s,u,l=1;do{for(n=t,t=null,r=null,a=0;n;){for(a++,i=n,s=0,e=0;e<l&&(s++,i=i.nextZ);e++);for(u=l;s>0||u>0&&i;)0!==s&&(0===u||!i||n.z<=i.z)?(o=n,n=n.nextZ,s--):(o=i,i=i.nextZ,u--),r?r.nextZ=o:t=o,o.prevZ=r,r=o;n=i}r.nextZ=null,l*=2}while(a>1)}(o)}(t,i,o,c);for(var d,g,m=t;t.prev!==t.next;)if(d=t.prev,g=t.next,c?u(t,i,o,c):s(t))e.push(d.i/n),e.push(t.i/n),e.push(g.i/n),w(t),t=g.next,m=g.next;else if((t=g)===m){p?1===p?a(t=l(t,e,n),e,n,i,o,c,2):2===p&&h(t,e,n,i,o,c):a(r(t),e,n,i,o,c,1);break}}}function s(t){var e=t.prev,n=t,i=t.next;if(y(e,n,i)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(g(e.x,e.y,n.x,n.y,i.x,i.y,o.x,o.y)&&y(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function u(t,e,n,i){var o=t.prev,r=t,a=t.next;if(y(o,r,a)>=0)return!1;for(var s=o.x<r.x?o.x<a.x?o.x:a.x:r.x<a.x?r.x:a.x,u=o.y<r.y?o.y<a.y?o.y:a.y:r.y<a.y?r.y:a.y,l=o.x>r.x?o.x>a.x?o.x:a.x:r.x>a.x?r.x:a.x,h=o.y>r.y?o.y>a.y?o.y:a.y:r.y>a.y?r.y:a.y,c=f(s,u,e,n,i),p=f(l,h,e,n,i),d=t.prevZ,m=t.nextZ;d&&d.z>=c&&m&&m.z<=p;){if(d!==t.prev&&d!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,m!==t.prev&&m!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,m.x,m.y)&&y(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;d&&d.z>=c;){if(d!==t.prev&&d!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;m&&m.z<=p;){if(m!==t.prev&&m!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,m.x,m.y)&&y(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function l(t,e,n){var i=t;do{var o=i.prev,r=i.next.next;!v(o,r)&&x(o,i,i.next,r)&&A(o,r)&&A(r,o)&&(e.push(o.i/n),e.push(i.i/n),e.push(r.i/n),w(i),w(i.next),i=t=r),i=i.next}while(i!==t);return i}function h(t,e,n,i,o,s){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&m(u,l)){var h=M(u,l);return u=r(u,u.next),h=r(h,h.next),a(u,e,n,i,o,s),void a(h,e,n,i,o,s)}l=l.next}u=u.next}while(u!==t)}function c(t,e){return t.x-e.x}function p(t,e){if(e=function(t,e){var n,i=e,o=t.x,r=t.y,a=-1/0;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){var s=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=o&&s>a){if(a=s,s===o){if(r===i.y)return i;if(r===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(o===a)return n.prev;var u,l=n,h=n.x,c=n.y,p=1/0;i=n.next;for(;i!==l;)o>=i.x&&i.x>=h&&o!==i.x&&g(r<c?o:a,r,h,c,r<c?a:o,r,i.x,i.y)&&((u=Math.abs(r-i.y)/(o-i.x))<p||u===p&&i.x>n.x)&&A(i,t)&&(n=i,p=u),i=i.next;return n}(t,e)){var n=M(e,t);r(n,n.next)}}function f(t,e,n,i,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*o)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function g(t,e,n,i,o,r,a,s){return(o-a)*(e-s)-(t-a)*(r-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(r-s)-(o-a)*(i-s)>=0}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&x(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&A(t,e)&&A(e,t)&&function(t,e){var n=t,i=!1,o=(t.x+e.x)/2,r=(t.y+e.y)/2;do{n.y>r!=n.next.y>r&&n.next.y!==n.y&&o<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)}function y(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function x(t,e,n,i){return!!(v(t,e)&&v(n,i)||v(t,i)&&v(n,e))||y(t,e,n)>0!=y(t,e,i)>0&&y(n,i,t)>0!=y(n,i,e)>0}function A(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function M(t,e){var n=new b(t.i,t.x,t.y),i=new b(e.i,e.x,e.y),o=t.next,r=e.prev;return t.next=e,e.prev=t,n.next=o,o.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function T(t,e,n,i){var o=new b(t,e,n);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function w(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function b(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _(t,e,n,i){for(var o=0,r=e,a=n-i;r<n;r+=i)o+=(t[a]-t[r])*(t[r+1]+t[a+1]),a=r;return o}t.exports=i,t.exports.default=i,i.deviation=function(t,e,n,i){var o=e&&e.length,r=o?e[0]*n:t.length,a=Math.abs(_(t,0,r,n));if(o)for(var s=0,u=e.length;s<u;s++){var l=e[s]*n,h=s<u-1?e[s+1]*n:t.length;a-=Math.abs(_(t,l,h,n))}var c=0;for(s=0;s<i.length;s+=3){var p=i[s]*n,f=i[s+1]*n,d=i[s+2]*n;c+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,o=0;o<t.length;o++){for(var r=0;r<t[o].length;r++)for(var a=0;a<e;a++)n.vertices.push(t[o][r][a]);o>0&&(i+=t[o-1].length,n.holes.push(i))}return n}},function(t,e,n){"use strict";t.exports=o,t.exports.default=o;var i=n(5);function o(t,e){if(!(this instanceof o))return new o(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function r(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,o){o||(o=y(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var r,a=e;a<n;a++)r=t.children[a],u(o,t.leaf?i(r):r);return o}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function d(t,e){var n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),o=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,o-n)*Math.max(0,r-i)}function g(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function m(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function y(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,n,o,r){for(var a,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=o||(a=e+Math.ceil((n-e)/o/2)*o,i(t,a,e,n,r),s.push(e,a,a,n))}o.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!m(t,e))return n;for(var o,r,a,s,u=[];e;){for(o=0,r=e.children.length;o<r;o++)a=e.children[o],m(t,s=e.leaf?i(a):a)&&(e.leaf?n.push(a):g(t,s)?this._all(a,n):u.push(a));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!m(t,e))return!1;for(var i,o,r,a,s=[];e;){for(i=0,o=e.children.length;i<o;i++)if(r=e.children[i],m(t,a=e.leaf?n(r):r)){if(e.leaf||g(t,a))return!0;s.push(r)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var o=this.data;this.data=i,i=o}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=y([]),this},remove:function(t,e){if(!t)return this;for(var n,i,o,a,s=this.data,u=this.toBBox(t),l=[],h=[];s||l.length;){if(s||(s=l.pop(),i=l[l.length-1],n=h.pop(),a=!0),s.leaf&&-1!==(o=r(t,s.children,e)))return s.children.splice(o,1),l.push(s),this._condense(l),this;a||s.leaf||!g(s,u)?i?(n++,s=i.children[n],a=!1):s=null:(l.push(s),h.push(n),n=0,i=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:l,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var o,r=n-e+1,s=this._maxEntries;if(r<=s)return a(o=y(t.slice(e,n+1)),this.toBBox),o;i||(i=Math.ceil(Math.log(r)/Math.log(s)),s=Math.ceil(r/Math.pow(s,i-1))),(o=y([])).leaf=!1,o.height=i;var u,l,h,c,p=Math.ceil(r/s),f=p*Math.ceil(Math.sqrt(s));for(v(t,e,n,f,this.compareMinX),u=e;u<=n;u+=f)for(v(t,u,h=Math.min(u+f-1,n),p,this.compareMinY),l=u;l<=h;l+=p)c=Math.min(l+p-1,h),o.children.push(this._build(t,l,c,i-1));return a(o,this.toBBox),o},_chooseSubtree:function(t,e,n,i){for(var o,r,a,s,u,l,h,p;i.push(e),!e.leaf&&i.length-1!==n;){for(h=p=1/0,o=0,r=e.children.length;o<r;o++)u=c(a=e.children[o]),(l=f(t,a)-u)<p?(p=l,h=u<h?u:h,s=a):l===p&&u<h&&(h=u,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,o=n?t:i(t),r=[],a=this._chooseSubtree(o,this.data,e,r);for(a.children.push(t),u(a,o);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(o,r,e)},_split:function(t,e){var n=t[e],i=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,i);var r=this._chooseSplitIndex(n,o,i),s=y(n.children.splice(r,n.children.length-r));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=y([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,o,r,a,u,l,h,p;for(l=h=1/0,i=e;i<=n-e;i++)a=d(o=s(t,0,i,this.toBBox),r=s(t,i,n,this.toBBox)),u=c(o)+c(r),a<l?(l=a,p=i,h=u<h?u:h):a===l&&u<h&&(h=u,p=i);return p},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:l,o=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,o)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var o,r,a=this.toBBox,l=s(t,0,e,a),h=s(t,n-e,n,a),c=p(l)+p(h);for(o=e;o<n-e;o++)r=t.children[o],u(l,t.leaf?a(r):r),c+=p(l);for(o=n-e-1;o>=e;o--)r=t.children[o],u(h,t.leaf?a(r):r),c+=p(h);return c},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)u(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():a(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,n){"use strict";t.exports=function(t){return new l(t||d,null)};var i=0,o=1;function r(t,e,n,i,o,r){this._color=t,this.key=e,this.value=n,this.left=i,this.right=o,this._count=r}function a(t){return new r(t._color,t.key,t.value,t.left,t.right,t._count)}function s(t,e){return new r(t,e.key,e.value,e.left,e.right,e._count)}function u(t){t._count=1+(t.left?t.left._count:0)+(t.right?t.right._count:0)}function l(t,e){this._compare=t,this.root=e}var h=l.prototype;function c(t,e){this.tree=t,this._stack=e}Object.defineProperty(h,"keys",{get:function(){var t=[];return this.forEach(function(e,n){t.push(e)}),t}}),Object.defineProperty(h,"values",{get:function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t}}),Object.defineProperty(h,"length",{get:function(){return this.root?this.root._count:0}}),h.insert=function(t,e){for(var n=this._compare,a=this.root,h=[],c=[];a;){var p=n(t,a.key);h.push(a),c.push(p),a=p<=0?a.left:a.right}h.push(new r(i,t,e,null,null,1));for(var f=h.length-2;f>=0;--f){a=h[f];c[f]<=0?h[f]=new r(a._color,a.key,a.value,h[f+1],a.right,a._count+1):h[f]=new r(a._color,a.key,a.value,a.left,h[f+1],a._count+1)}for(f=h.length-1;f>1;--f){var d=h[f-1];a=h[f];if(d._color===o||a._color===o)break;var g=h[f-2];if(g.left===d)if(d.left===a){if(!(m=g.right)||m._color!==i){if(g._color=i,g.left=d.right,d._color=o,d.right=g,h[f-2]=d,h[f-1]=a,u(g),u(d),f>=3)(y=h[f-3]).left===g?y.left=d:y.right=d;break}d._color=o,g.right=s(o,m),g._color=i,f-=1}else{if(!(m=g.right)||m._color!==i){if(d.right=a.left,g._color=i,g.left=a.right,a._color=o,a.left=d,a.right=g,h[f-2]=a,h[f-1]=d,u(g),u(d),u(a),f>=3)(y=h[f-3]).left===g?y.left=a:y.right=a;break}d._color=o,g.right=s(o,m),g._color=i,f-=1}else if(d.right===a){if(!(m=g.left)||m._color!==i){if(g._color=i,g.right=d.left,d._color=o,d.left=g,h[f-2]=d,h[f-1]=a,u(g),u(d),f>=3)(y=h[f-3]).right===g?y.right=d:y.left=d;break}d._color=o,g.left=s(o,m),g._color=i,f-=1}else{var m;if(!(m=g.left)||m._color!==i){var y;if(d.left=a.right,g._color=i,g.right=a.left,a._color=o,a.right=d,a.left=g,h[f-2]=a,h[f-1]=d,u(g),u(d),u(a),f>=3)(y=h[f-3]).right===g?y.right=a:y.left=a;break}d._color=o,g.left=s(o,m),g._color=i,f-=1}}return h[0]._color=o,new l(n,h[0])},h.forEach=function(t,e,n){if(this.root)switch(arguments.length){case 1:return function t(e,n){var i;if(n.left&&(i=t(e,n.left)))return i;return(i=e(n.key,n.value))||(n.right?t(e,n.right):void 0)}(t,this.root);case 2:return function t(e,n,i,o){if(n(e,o.key)<=0){var r;if(o.left&&(r=t(e,n,i,o.left)))return r;if(r=i(o.key,o.value))return r}if(o.right)return t(e,n,i,o.right)}(e,this._compare,t,this.root);case 3:if(this._compare(e,n)>=0)return;return function t(e,n,i,o,r){var a,s=i(e,r.key),u=i(n,r.key);if(s<=0){if(r.left&&(a=t(e,n,i,o,r.left)))return a;if(u>0&&(a=o(r.key,r.value)))return a}if(u>0&&r.right)return t(e,n,i,o,r.right)}(e,n,this._compare,t,this.root)}},Object.defineProperty(h,"begin",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.left;return new c(this,t)}}),Object.defineProperty(h,"end",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.right;return new c(this,t)}}),h.at=function(t){if(t<0)return new c(this,[]);for(var e=this.root,n=[];;){if(n.push(e),e.left){if(t<e.left._count){e=e.left;continue}t-=e.left._count}if(!t)return new c(this,n);if(t-=1,!e.right)break;if(t>=e.right._count)break;e=e.right}return new c(this,[])},h.ge=function(t){for(var e=this._compare,n=this.root,i=[],o=0;n;){var r=e(t,n.key);i.push(n),r<=0&&(o=i.length),n=r<=0?n.left:n.right}return i.length=o,new c(this,i)},h.gt=function(t){for(var e=this._compare,n=this.root,i=[],o=0;n;){var r=e(t,n.key);i.push(n),r<0&&(o=i.length),n=r<0?n.left:n.right}return i.length=o,new c(this,i)},h.lt=function(t){for(var e=this._compare,n=this.root,i=[],o=0;n;){var r=e(t,n.key);i.push(n),r>0&&(o=i.length),n=r<=0?n.left:n.right}return i.length=o,new c(this,i)},h.le=function(t){for(var e=this._compare,n=this.root,i=[],o=0;n;){var r=e(t,n.key);i.push(n),r>=0&&(o=i.length),n=r<0?n.left:n.right}return i.length=o,new c(this,i)},h.find=function(t){for(var e=this._compare,n=this.root,i=[];n;){var o=e(t,n.key);if(i.push(n),0===o)return new c(this,i);n=o<=0?n.left:n.right}return new c(this,[])},h.remove=function(t){var e=this.find(t);return e?e.remove():this},h.get=function(t){for(var e=this._compare,n=this.root;n;){var i=e(t,n.key);if(0===i)return n.value;n=i<=0?n.left:n.right}};var p=c.prototype;function f(t,e){t.key=e.key,t.value=e.value,t.left=e.left,t.right=e.right,t._color=e._color,t._count=e._count}function d(t,e){return t<e?-1:t>e?1:0}Object.defineProperty(p,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(p,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),p.clone=function(){return new c(this.tree,this._stack.slice())},p.remove=function(){var t=this._stack;if(0===t.length)return this.tree;var e=new Array(t.length),n=t[t.length-1];e[e.length-1]=new r(n._color,n.key,n.value,n.left,n.right,n._count);for(var h=t.length-2;h>=0;--h){(n=t[h]).left===t[h+1]?e[h]=new r(n._color,n.key,n.value,e[h+1],n.right,n._count):e[h]=new r(n._color,n.key,n.value,n.left,e[h+1],n._count)}if((n=e[e.length-1]).left&&n.right){var c=e.length;for(n=n.left;n.right;)e.push(n),n=n.right;var p=e[c-1];e.push(new r(n._color,p.key,p.value,n.left,n.right,n._count)),e[c-1].key=n.key,e[c-1].value=n.value;for(h=e.length-2;h>=c;--h)n=e[h],e[h]=new r(n._color,n.key,n.value,n.left,e[h+1],n._count);e[c-1].left=e[c]}if((n=e[e.length-1])._color===i){var d=e[e.length-2];d.left===n?d.left=null:d.right===n&&(d.right=null),e.pop();for(h=0;h<e.length;++h)e[h]._count--;return new l(this.tree._compare,e[0])}if(n.left||n.right){n.left?f(n,n.left):n.right&&f(n,n.right),n._color=o;for(h=0;h<e.length-1;++h)e[h]._count--;return new l(this.tree._compare,e[0])}if(1===e.length)return new l(this.tree._compare,null);for(h=0;h<e.length;++h)e[h]._count--;var g=e[e.length-2];return function(t){for(var e,n,r,l,h=t.length-1;h>=0;--h){if(e=t[h],0===h)return void(e._color=o);if((n=t[h-1]).left===e){if((r=n.right).right&&r.right._color===i)return l=(r=n.right=a(r)).right=a(r.right),n.right=r.left,r.left=n,r.right=l,r._color=n._color,e._color=o,n._color=o,l._color=o,u(n),u(r),h>1&&((c=t[h-2]).left===n?c.left=r:c.right=r),void(t[h-1]=r);if(r.left&&r.left._color===i)return l=(r=n.right=a(r)).left=a(r.left),n.right=l.left,r.left=l.right,l.left=n,l.right=r,l._color=n._color,n._color=o,r._color=o,e._color=o,u(n),u(r),u(l),h>1&&((c=t[h-2]).left===n?c.left=l:c.right=l),void(t[h-1]=l);if(r._color===o){if(n._color===i)return n._color=o,void(n.right=s(i,r));n.right=s(i,r);continue}r=a(r),n.right=r.left,r.left=n,r._color=n._color,n._color=i,u(n),u(r),h>1&&((c=t[h-2]).left===n?c.left=r:c.right=r),t[h-1]=r,t[h]=n,h+1<t.length?t[h+1]=e:t.push(e),h+=2}else{if((r=n.left).left&&r.left._color===i)return l=(r=n.left=a(r)).left=a(r.left),n.left=r.right,r.right=n,r.left=l,r._color=n._color,e._color=o,n._color=o,l._color=o,u(n),u(r),h>1&&((c=t[h-2]).right===n?c.right=r:c.left=r),void(t[h-1]=r);if(r.right&&r.right._color===i)return l=(r=n.left=a(r)).right=a(r.right),n.left=l.right,r.right=l.left,l.right=n,l.left=r,l._color=n._color,n._color=o,r._color=o,e._color=o,u(n),u(r),u(l),h>1&&((c=t[h-2]).right===n?c.right=l:c.left=l),void(t[h-1]=l);if(r._color===o){if(n._color===i)return n._color=o,void(n.left=s(i,r));n.left=s(i,r);continue}var c;r=a(r),n.left=r.right,r.right=n,r._color=n._color,n._color=i,u(n),u(r),h>1&&((c=t[h-2]).right===n?c.right=r:c.left=r),t[h-1]=r,t[h]=n,h+1<t.length?t[h+1]=e:t.push(e),h+=2}}}(e),g.left===n?g.left=null:g.right=null,new l(this.tree._compare,e[0])},Object.defineProperty(p,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(p,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(p,"index",{get:function(){var t=0,e=this._stack;if(0===e.length){var n=this.tree.root;return n?n._count:0}e[e.length-1].left&&(t=e[e.length-1].left._count);for(var i=e.length-2;i>=0;--i)e[i+1]===e[i].right&&(++t,e[i].left&&(t+=e[i].left._count));return t},enumerable:!0}),p.next=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.right)for(e=e.right;e;)t.push(e),e=e.left;else for(t.pop();t.length>0&&t[t.length-1].right===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(p,"hasNext",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].right)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].left===t[e])return!0;return!1}}),p.update=function(t){var e=this._stack;if(0===e.length)throw new Error("Can't update empty node!");var n=new Array(e.length),i=e[e.length-1];n[n.length-1]=new r(i._color,i.key,t,i.left,i.right,i._count);for(var o=e.length-2;o>=0;--o)(i=e[o]).left===e[o+1]?n[o]=new r(i._color,i.key,i.value,n[o+1],i.right,i._count):n[o]=new r(i._color,i.key,i.value,i.left,n[o+1],i._count);return new l(this.tree._compare,n[0])},p.prev=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.left)for(e=e.left;e;)t.push(e),e=e.right;else for(t.pop();t.length>0&&t[t.length-1].left===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(p,"hasPrev",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].left)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].right===t[e])return!0;return!1}})},function(t,e,n){!function(){"use strict";var e=Math.PI,n=Math.sin,i=Math.cos,o=Math.tan,r=Math.asin,a=Math.atan2,s=Math.acos,u=e/180,l=864e5,h=2440588,c=2451545;function p(t){return new Date((t+.5-h)*l)}function f(t){return function(t){return t.valueOf()/l-.5+h}(t)-c}var d=23.4397*u;function g(t,e){return a(n(t)*i(d)-o(e)*n(d),i(t))}function m(t,e){return r(n(e)*i(d)+i(e)*n(d)*n(t))}function y(t,e,r){return a(n(t),i(t)*n(e)-o(r)*i(e))}function v(t,e,o){return r(n(e)*n(o)+i(e)*i(o)*i(t))}function x(t,e){return u*(280.16+360.9856235*t)-e}function A(t){return u*(357.5291+.98560028*t)}function M(t){return t+u*(1.9148*n(t)+.02*n(2*t)+3e-4*n(3*t))+102.9372*u+e}function T(t){var e=M(A(t));return{dec:m(e,0),ra:g(e,0)}}var w={getPosition:function(t,e,n){var i=u*-n,o=u*e,r=f(t),a=T(r),s=x(r,i)-a.ra;return{azimuth:y(s,o,a.dec),altitude:v(s,o,a.dec)}}},b=w.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];w.addTime=function(t,e,n){b.push([t,e,n])};var _=9e-4;function S(t,n,i){return _+(t+n)/(2*e)+i}function E(t,e,i){return c+t+.0053*n(e)-.0069*n(2*i)}function C(t,e,o,r,a,u,l){return E(S(function(t,e,o){return s((n(t)-n(e)*n(o))/(i(e)*i(o)))}(t,o,r),e,a),u,l)}function L(t){var e=u*(134.963+13.064993*t),o=u*(93.272+13.22935*t),r=u*(218.316+13.176396*t)+6.289*u*n(e),a=5.128*u*n(o),s=385001-20905*i(e);return{ra:g(r,a),dec:m(r,a),dist:s}}function R(t,e){return new Date(t.valueOf()+e*l/24)}w.getTimes=function(t,n,i){var o,r,a,s,l,h=u*-i,c=u*n,d=function(t,n){return Math.round(t-_-n/(2*e))}(f(t),h),g=S(0,h,d),y=A(g),v=M(y),x=m(v,0),T=E(g,y,v),w={solarNoon:p(T),nadir:p(T-.5)};for(o=0,r=b.length;o<r;o+=1)l=T-((s=C((a=b[o])[0]*u,h,c,x,d,y,v))-T),w[a[1]]=p(l),w[a[2]]=p(s);return w},w.getMoonPosition=function(t,e,r){var s=u*-r,l=u*e,h=f(t),c=L(h),p=x(h,s)-c.ra,d=v(p,l,c.dec),g=a(n(p),o(l)*i(c.dec)-n(c.dec)*i(p));return d+=function(t){return t<0&&(t=0),2967e-7/Math.tan(t+.00312536/(t+.08901179))}(d),{azimuth:y(p,l,c.dec),altitude:d,distance:c.dist,parallacticAngle:g}},w.getMoonIllumination=function(t){var e=f(t||new Date),o=T(e),r=L(e),u=s(n(o.dec)*n(r.dec)+i(o.dec)*i(r.dec)*i(o.ra-r.ra)),l=a(149598e3*n(u),r.dist-149598e3*i(u)),h=a(i(o.dec)*n(o.ra-r.ra),n(o.dec)*i(r.dec)-i(o.dec)*n(r.dec)*i(o.ra-r.ra));return{fraction:(1+i(l))/2,phase:.5+.5*l*(h<0?-1:1)/Math.PI,angle:h}},w.getMoonTimes=function(t,e,n,i){var o=new Date(t);i?o.setUTCHours(0,0,0,0):o.setHours(0,0,0,0);for(var r,a,s,l,h,c,p,f,d,g,m,y,v,x=.133*u,A=w.getMoonPosition(o,e,n).altitude-x,M=1;M<=24&&(r=w.getMoonPosition(R(o,M),e,n).altitude-x,f=((h=(A+(a=w.getMoonPosition(R(o,M+1),e,n).altitude-x))/2-r)*(p=-(c=(a-A)/2)/(2*h))+c)*p+r,g=0,(d=c*c-4*h*r)>=0&&(m=p-(v=Math.sqrt(d)/(2*Math.abs(h))),y=p+v,Math.abs(m)<=1&&g++,Math.abs(y)<=1&&g++,m<-1&&(m=y)),1===g?A<0?s=M+m:l=M+m:2===g&&(s=M+(f<0?y:m),l=M+(f<0?m:y)),!s||!l);M+=2)A=a;var T={};return s&&(T.rise=R(o,s)),l&&(T.set=R(o,l)),s||l||(T[f>0?"alwaysUp":"alwaysDown"]=!0),T},t.exports=w}()},function(t,e,n){t.exports=function(){"use strict";function t(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function e(t,e){return t<e?-1:t>e?1:0}return function(n,i,o,r,a){!function e(n,i,o,r,a){for(;r>o;){if(r-o>600){var s=r-o+1,u=i-o+1,l=Math.log(s),h=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*h*(s-h)/s)*(u-s/2<0?-1:1),p=Math.max(o,Math.floor(i-u*h/s+c)),f=Math.min(r,Math.floor(i+(s-u)*h/s+c));e(n,i,p,f,a)}var d=n[i],g=o,m=r;for(t(n,o,i),a(n[r],d)>0&&t(n,o,r);g<m;){for(t(n,g,m),g++,m--;a(n[g],d)<0;)g++;for(;a(n[m],d)>0;)m--}0===a(n[o],d)?t(n,o,m):t(n,++m,r),m<=i&&(o=m+1),i<=m&&(r=m-1)}}(n,i,o||0,r||n.length-1,a||e)}}()},function(t,e,n){"use strict";n.r(e);var i,o=function(){function t(){}return t.baseTileSize=256,t.minLatitude=-85.0511287798066,t.maxLatitude=85.0511287798066,t.maxLongitude=180,t.minLongitude=-180,t.maxDegrees=360,t.radiusEarthMeters=6378137,t.halfEarthCircumFerenceInMeter=t.radiusEarthMeters*Math.PI,t.earthCircumFerenceInMeter=2*t.halfEarthCircumFerenceInMeter,t.tileCacheSize=512,t.rasterLayerOrder=1,t.buildingLayerOrder=2,t.annotationLayerOrder=100,t.markerAnnotationLayerOrder=101,t.flingMinVelocity=-1e4,t.flingMaxVelocity=1e4,t.flingTimeConstant=150,t.flingSpeedMultiply=15,t.zoomSpeedMouseWheel=15,t.minDurationFlyTo=1e3,t.maxDurationFlyTo=13e3,t.maxBearingAngle=720,t.defaultMinZoom=0,t.defaultMinZoom3d=17,t.defaultMaxZoom=22,t.defaultMaxNativeZoom=19,t.tileExtend=4096,t.defaultAnimationDuration=300,t.defaultFlyZoom=17,t.baseMapUrl="https://api.map4d.vn/v2/api/tile/{z}/{x}/{y}",t.baseModelRequestUrl="https://api.map4d.vn/v2/api/Model/objs/{s}?key={k}",t.baseTextureRequestUrl="https://api.map4d.vn/v2/api/Model/images/{s}?key={k}",t.defaultMap2dUrl="2d/{z}/{x}/{y}.png",t.defaultMap3dUrl="3d/{z}/{x}/{y}.png",t.minTilt=0,t.maxTilt=60,t.minTimeMoving=150,t.minTimeDoubleZoom=500,t.minTimeSpanTo=500,t.maxTimeSpanTo=4e3,t.metersPerPixelAtLatitude=10,t}(),r=function(){function t(){}return t.rad2Deg=180/Math.PI,t.deg2Rad=Math.PI/180,t.epsilon=1e-6,t}(),a=function(){function t(){}return t.fov=30*r.deg2Rad,t.nearPlane=.1,t.farPlane=1e3,t.height=15.5,t}(),s=function(){function t(){}return t.numTrianglesOnRoundCap=6,t.numTrianglesOnRoundJoin=5,t.numTrianglesPerCircle=50,t}(),u=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=n}return t.prototype.clone=function(){return new t(this.x,this.y,this.z)},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.length,n=0,i=0,o=0;return e>0&&(n=this.x/e,i=this.y/e,o=this.z/e),new t(n,i,o)},t.prototype.set=function(t){this.x=t.x,this.y=t.y,this.z=t.z},t.prototype.invert=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.rotate90=function(){return new t(this.y,-this.x,this.z)},t.prototype.add=function(e){return new t(e.x+this.x,e.y+this.y,e.z+this.z)},t.prototype.subtract=function(e){return e?new t(this.x-e.x,this.y-e.y,this.z-e.z):this.clone()},t.prototype.multiply=function(e){return new t(e*this.x,e*this.y,e*this.z)},t.prototype.rotateBy=function(e){var n=Math.cos(e*Math.PI/180),i=Math.sin(e*Math.PI/180);return new t(this.x*n-this.y*i,this.x*i+this.y*n)},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y+t.z*this.z},t.prototype.buffer=function(){return[this.x,this.y,this.z]},t.perp=function(e,n){return new t(n[1]-e[1],e[0]-n[0])},t.neg=function(e){return new t(-e.x,-e.y,-e.z)},t}(),l=function(){function t(t,e){this._lat=t,this._lng=e}return t.prototype.equals=function(t){return this._lat==t._lat&&this._lng==t._lng},t.prototype.lat=function(){return this._lat},t.prototype.lng=function(){return this._lng},t.prototype.toString=function(){return"("+this._lat+", "+this._lng+")"},t.convert=function(e){if(e instanceof t)return e;if(Array.isArray(e)&&2===e.length)return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e&&"lat"in e&&"lng"in e)return new t(Number(e.lat),Number(e.lng));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lat: <lat>, lng: <lng>}, or an array of [<lat>, <lng>]")},t.prototype.distanceTo=function(t){var e=r.deg2Rad*this._lat,n=r.deg2Rad*this._lng,i=r.deg2Rad*t.lat(),a=r.deg2Rad*t.lng(),s=Math.sin((i-e)/2),u=Math.sin((a-n)/2);return 2*o.radiusEarthMeters*Math.asin(Math.sqrt(s*s+Math.cos(e)*Math.cos(i)*u*u))},t.prototype.toMeter=function(){var t=Math.log(Math.tan(this._lat*Math.PI/360+Math.PI/4))/Math.PI;t*=o.halfEarthCircumFerenceInMeter;var e=this._lng*o.halfEarthCircumFerenceInMeter/180;return new u(e,t)},t}(),h=function(){function t(){}return t.markerDefault="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAFe0lEQVRYR6WWaWxUVRTH/+e+6SxdmC7QZaogsgtGCZXaDiatUNNFPhDFD9aIgIImaiKRDyxRBINARDQh6QeMISEBA9EQYou0Fauxu40kUChBVMB22lKVls72Zt495j0y7VBmOjNwP757z//87rlneYQE1n8lT6b7k22VTLQKoMUgOJhJgHmQCOcBrg2o3pPTG35zAeB4pCmeQz1OZ9oUO6qJ8D6IZk1mQ8z9GuQhJUAHc+tbBmPpxwQYWblkqltaPwXRmlhi4fvMskFy8O38uo4rNEk0JgUYWL4oR7Paa8gI+X0siQ5o/nW5ZzovRoOICsAVsy0uyt5NQmwKuWZmBKTEiF+FW1Xh16Tx0EmCkJKUhHSrBWZFAdG4LDGfkm7fekdT11CkK0QFcJUXPwWF2kNqunNvIIgBtweqlBHDYSLCtGQbUi1miHAIqb18ydN6orQJwYmGUQEGqpzHJdFq3SDk3DXqRpD5zgfQEJjPM0EFsIgAB4iEAJCdYkOaxTIGQcznhPvWM9lN3aNxAbgqFk+DktwPkNB9BaXEoMeLUTWg4/gg+UQg6N9e1vXHdV2wcX5+ljJlynsk6C0QZVoUgdyUFFhM488hVc2ZX9/aEhdAb8XTK4ViOhV++xu3DXgNLL+93HapeiOg09y1zhbO/0IIsQEga25qMtLM409BUtuSW9e6Jy4AV6VzMwTt0w9LZtz2+9Hv9oIZw2CuKW2/uCVSEvy4dP4aEuJDEM3MtFmQabVCMR5FD5z8Kq+2ZX1cAP3PF+9iiO0hgFs+P256vLpKH4LaxyWdl2siATQ8mmE3Zed9TUTlGVYzsmy2cQDJ3+TVNb8YF0Bf5bLtJLArBDDs8xs5AOYhKeWBZzt6dkcCaCyYU6aYTPuJxOOZVgsybeMRYMlHHXXN1XEBDFQVvyJJHAnlgDsQRK+eAwyVwUdL2y6ujQRwtnDBTiLxLhHs2ck22K3jlcBS2+Ooa73n6SKWYW95wTxhsvaEAFRNQ99tN1RNY2a+BskflXb2HA6HaCpcUAbCHn1ICUHkSEtFssk01pRYU1c5TnecjCsC+qHequJzgsQTY4moqugf9Rg9gMEjgsUvkvk7QUZUShhURoQc3WOWzYoMq2Xs/RlycNgbfGzBDx3/xA3gKi9aDZNyPGSgSYlhn4qbXj0Zo690ixkZViuSFDHekjXtg9zrI3upu1tvWnetqJ2wxzkvzZ4+tQ5Ey0IW+t09gQCGPD74NO0uIbMQ0EvPqP1Q6d15w6vs5eWOsy3XImFHH0aA6C0vKlUU0RA+XfTho4Nomga/lHpvMG6bJITResMHke6QtOAGr7f/yMymv3wJAeiHr65YYk82m7dBKJsnjXuUTWMS+n3vOBq7jJadMIAxccoL5gYUSwsRZSYCwSxVDsoq11Dgp4Kurnvadkgr5h/RnyWPWG0pedVMypeJAIDl3mCQ9z18pvXfyexiAujGg2WFc6TZdIKJjLKMtYjZJbXgS3nftzdP9jtm5EgsMX2/e+FCc9aMKS+wUI7Gc16ffG5VrZnV2DUc63xcALpIX2XxDAJ2QIjXJhVl+TND2+Sobe+K5TzuCOgHjwPKsvKiFaSIWhApUcWlXOfz9B2LVnYT7eKOgJELJQtTZUr660x0IBIAszzEgcCu/PrOG/HcPqEIhARdVc5SEA4DNH2Ck1GSvDGnrvlYrMQLt0soArrhlYrZlhSa9iYJ5fNwIWa5X/qCnzwUYeA8cBlOFOh7rnAJKcpOKKLyzh5fkKxty69tM/4jE1kJR0AX3wGIN6qcawWR0ZwI2tYc7eZndPp3fyLO7ysHQg7+Xr40S7Gat4B5biDo3zq9/tcLiTp/IADd2FVR9CoJtufUth1MJPHCQf8HoodVPzPKP84AAAAASUVORK5CYII=",t.myPosition="data:image/png;base64,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",t.myPosition2x="data:image/png;base64,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",t.myPosition3x="data:image/png;base64,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",t.zoomOutIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAQAAACR313BAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfiCwEEOA6vGn99AAAAJElEQVQY02NgoCFgZGChSHcCfun/+KRZGH5QoJuA3TT1N2UAAKRCA8m04HhjAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTExLTAxVDA0OjU2OjE0LTA0OjAwAvm1FAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMS0wMVQwNDo1NjoxNC0wNDowMHOkDagAAAAASUVORK5CYII=",t.zoomInIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAQAAACR313BAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAHdElNRQfiCwEENCWvE8kxAAAAwElEQVQY033RPUoEQRAF4G+2mxUWBCNjTyBs4hkMzfQ8u5cxNJTFE2jmCQxM1kgRFIfubYMpcQZ/qoPiva5X1a+af6OLnFRnLjw7cOlKUsdlGWvNu2YdOFLSyYqGghZ8UzOTNqFSlC946kjxaomEpXP7sgfXsNEUbXKKZjOoe3yYydG6KHYW+uF6jj1pND+rA59x48Wb3oljVXLv1tzC3fTFq/C9+t13h11s8g/fs5++xaa2Hj05tA08+pIxat/EJ3JFQ3rCv00IAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTExLTAxVDA0OjUyOjM3LTA0OjAweN8IjgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMS0wMVQwNDo1MjozNy0wNDowMAmCsDIAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stSzZjb29QMEXVGp49AAAAAElFTkSuQmCC",t.tiltUpIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACpSURBVHgBlZC9DcIwEIVfuChO6RE8AT9tJAoU0TMKmQAxAdnEJQ3IVKa0CPMYY1NEFooJedX5fN873QMSOisjrvqxT/1nKYgxUr4U1trNdr26fc/MhkDGchmgUBORDEajoNLdCXDLqMXDdqUMT4Lq/jw4YOgu4UqScaO/8aK7nXeR+CFv2tbVvOnBTxgFGf/iGJGDa+pq0WZxgvhTIem8LMBfDkdMUEbE3zxPNOjkuRmkAAAAAElFTkSuQmCC",t.tiltDownIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAKCAYAAACE2W/HAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACrSURBVHgBrZGxDcIwEEXvzCKZgMglcRWC6DMCG8AEhBHYIGzAAKA0IEqcDTJCeuAOH5KlgAgKUV7l/61nWz6AnuDxXGaIuP5HIoBUJSbMiHjXVWLmzSwa75WE0Y2WrrIdpK1c9HqqL4vLNWBWhauCFs1Oo1D7pPwinujqzpQCQ/1FqhDdXgPVDHOjLcNj9e5A7aRYDm4VhcToXD7AZ0JYfEo/OZzKXEYFQ/MEPtI/ZDp7uSEAAAAASUVORK5CYII=",t.locationIcon="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAAQABAAD/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/hAytodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Nzg4QTJBMjVEMDI1MTFFN0EwQUVDODc5QjYyQkFCMUQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Nzg4QTJBMjZEMDI1MTFFN0EwQUVDODc5QjYyQkFCMUQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3ODhBMkEyM0QwMjUxMUU3QTBBRUM4NzlCNjJCQUIxRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3ODhBMkEyNEQwMjUxMUU3QTBBRUM4NzlCNjJCQUIxRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/bAEMABQMEBAQDBQQEBAUFBQYHDAgHBwcHDwsLCQwRDxISEQ8RERMWHBcTFBoVEREYIRgaHR0fHx8TFyIkIh4kHB4fHv/AAAsIABQAFAEBEQD/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/2gAIAQEAAD8A98+JHjbWrHxHZeCfBOn2N94mvLVr6aa/kKWemWitt+0T7fmbLZVUHUgnOBXmfhHxZ4x8LWeveINO8beF/ino0F7JqGu2emOyX2no+N7W+ZHUxIFJEZwCAdpr6D0fUrLV9Js9W024S5sb2BLi3mXpJG6hlYfUEV8++OvDtt4W+IPivT/EPiXU7bRviLobafZ67qVx5iafeK8p+zF8ARxFZMoCQMArmvOfhL8PLj4EXWueLPFviPRb+7vdNl0zRtG0m5NzPqk0pUIAmASuQvY4zk4xz9F/BD4fXvgv4Z6Poepa7rVxfJbxvcRy3nmJbSFFDQxcfLGpBwPXJ713mr6bp2r6dPpurWFrf2U67Zre5iWSOQejKwINcF8KPhX4G8F6lq+paHoNpHezalPLHcPChktkbH7mJgoKRjsOvJyTXpIr/9k=",t}(),c=function(){function t(){}return t.bgColor="rgba(255,255,255,1)",t.size="29px",t.content="\n.mf-mapgl {\n  overflow: hidden;\n  height: 100%;\n  width: 100%;\n  position: relative;\n  box-sizing: content-box;\n}\n\n.mf-mapgl canvas {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  display: inherit;\n}\n\n.mf-mapgl .mf-ui {\n  position: fixed;\n  width: 25px;\n}\n\n.mf-ui.mf-ui-top-left {\n  top: 20px;\n  left: 20px;\n}\n.mf-ui.mf-ui-top-right {\n  top: 20px;\n  right: 20px;\n}\n.mf-ui.mf-ui-bottom-right {\n  right: 20px;\n  bottom: 20px;\n}\n.mf-ui.mf-ui-bottom-left {\n  left: 20px;\n  bottom: 20px;\n}\n\n\n.mf-mapgl .mf-ui .mf-button {\n  margin: 3px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: space-around;\n    width: "+t.size+";\n    height: "+t.size+";\n    border-radius: 2px;\n    border: 1px solid darken("+t.bgColor+", 5%);\n    background-color: "+t.bgColor+";\n    cursor: pointer;\n    user-select: none;\n    -moz-user-select: none;\n}\n\n.mf-mapgl .mf-ui .mf-button:hover {\n    background-color: darken("+t.bgColor+", 5%);\n  }\n\n.mf-mapgl .mf-ui .mf-button:active {\n    background-color: darken("+t.bgColor+", 10%);\n  }\n \n.mf-mapgl .mf-ui .mf-zoom-in-icon { \n  background-image: url("+h.zoomInIcon+");   \n  background-position: center !important;\n  background-repeat: no-repeat !important;\n  background-size: cover !important;\n  width: 12px;\n  height: 12px;  \n  opacity: 0.5;\n  z-index: 1;  \n    \n}\n\n.mf-mapgl .mf-ui .mf-zoom-out-icon { \n    background-image: url("+h.zoomOutIcon+"); \n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 12px;\n    height: 12px;  \n    opacity: 0.5;\n    z-index: 1;      \n}\n\n.mf-mapgl .mf-ui a:hover {\n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 12px;\n    height: 12px;\n    opacity: 1;\n    z-index: 1;\n    \n}\n\n.mf-mapgl .mf-ui .mf-location {\n    background-image: url("+h.locationIcon+");\n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 17px;\n    height: 17px;     \n    position: absolute;\n    opacity: 0.5;\n    z-index: 1;\n}\n.mf-mapgl .mf-ui .mf-button-mode {\n  position: fixed;\n  bottom: 130px;\n  right :13px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: space-around;\n    width: "+t.size+";\n    height: "+t.size+";\n    border-radius: 2px;\n    border: 1px solid darken("+t.bgColor+", 5%);\n    background-color: "+t.bgColor+";\n    cursor: pointer;\n    user-select: none;\n    -moz-user-select: none;\n}\n",t}(),p=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),this.red=t,this.green=e,this.blue=n,this.alpha=i}return t.prototype.buffer=function(){return[this.red,this.green,this.blue,this.alpha]},Object.defineProperty(t.prototype,"rgba",{get:function(){return"rgba("+255*this.red+","+255*this.green+","+255*this.blue+",1)"},enumerable:!0,configurable:!0}),t.fromHex=function(e){void 0===e&&(e="000000"),7!=e.length&&9!=e.length||(e=e.substring(1,e.length));var n=parseInt(e,16);return 6==e.length?new t((n>>16)/255,(n>>8&255)/255,(255&n)/255):new t((n>>24&255)/255,(n>>16&255)/255,(n>>8&255)/255,(255&n)/255)},t.fromInt=function(e){return void 0===e&&(e=0),e<0&&(e=0),new t((e>>16&255)/255,(e>>8&255)/255,(255&e)/255)},t.mix=function(e,n,i){return new t(e.red*i+n.red*(1-i),e.green*i+n.green*(1-i),e.blue*i+n.blue*(1-i),e.alpha*i+n.alpha*(1-i))},Object.defineProperty(t.prototype,"code",{get:function(){var t=function(t){var e=(255*t).toString(16);e=(e=1==e.length?"0"+e:e).length>2?e.substr(0,2):e};return"#"+t(this.red)+t(this.green)+t(this.blue)+t(this.alpha)},enumerable:!0,configurable:!0}),t.isValid=function(t){return/^[0-9A-F]{8}$/i.test(t)},t}(),f=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.length,n=0,i=0;return e>0&&(n=this.x/e,i=this.y/e),new t(n,i)},t.prototype.set=function(t){this.x=t.x,this.y=t.y},t.prototype.invert=function(){return new t(-this.x,-this.y)},t.prototype.rotate90=function(){return new t(this.y,-this.x)},t.prototype.add=function(e){return new t(e.x+this.x,e.y+this.y)},t.prototype.subtract=function(e){return e?new t(this.x-e.x,this.y-e.y):this.clone()},t.prototype.multiply=function(e){return new t(e*this.x,e*this.y)},t.prototype.rotateBy=function(e){var n=Math.cos(e*Math.PI/180),i=Math.sin(e*Math.PI/180);return new t(this.x*n-this.y*i,this.x*i+this.y*n)},t.prototype.rotateByRadian=function(e){var n=Math.cos(e),i=Math.sin(e);return new t(this.x*n-this.y*i,this.x*i+this.y*n)},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y},t.prototype.buffer=function(){return[this.x,this.y]},t.perp=function(e,n){return new t(n[1]-e[1],e[0]-n[0])},t.neg=function(e){return new t(-e.x,-e.y)},t}(),d=function(){function t(){}return t.clamp=function(t,e,n){return t<e?e:t>n?n:t},t}(),g=function(){function t(){}return Object.defineProperty(t,"pixelScale",{get:function(){return t._pixelScale},set:function(e){t._pixelScale=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"devicePixelScale",{get:function(){return t._devicePixelScale},set:function(e){t._devicePixelScale=e},enumerable:!0,configurable:!0}),t.getTileSize=function(){return o.baseTileSize*t.pixelScale},t.extendOptions=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0,o=e;i<o.length;i++){var r=o[i];for(var a in r)t[a]=r[a]}return t},t.getTimePanTo=function(t,e,n){var i=t.distanceTo(e)/500;return i*=n<10?.01:n<14?.5:1.5,i=d.clamp(i,o.minTimeSpanTo,o.maxTimeSpanTo),Math.round(i)},t._pixelScale=1,t._devicePixelScale=1,t}(),m=function(){function t(){}return t.projectInternal=function(t,e){var n=d.clamp(t.lat(),o.minLatitude,o.maxLatitude);return new f(o.maxLongitude+t.lng(),o.maxLongitude-r.rad2Deg*Math.log(Math.tan(Math.PI/4+n*Math.PI/o.maxDegrees))).multiply(e/o.maxDegrees)},t.worldSize=function(t){return t*g.getTileSize()},t.getMetersPerPixelAtLatitude=function(t,e){var n=Math.pow(2,e),i=d.clamp(t,o.minLatitude,o.maxLatitude);return Math.cos(i*r.deg2Rad)*Math.PI*2*o.radiusEarthMeters/this.worldSize(n)},t.convertToMeterFromLatLng=function(t){var e=d.clamp(t.lat(),o.minLatitude,o.maxLatitude),n=t.lng(),i=1-1e-15,a=d.clamp(Math.sin(r.deg2Rad*e),-i,i),s=o.radiusEarthMeters*n*r.deg2Rad,u=.5*o.radiusEarthMeters*Math.log((1+a)/(1-a));return new f(u,s)},t.convertToLatLngFromMeter=function(t){var e=(2*Math.atan(Math.exp(t.x/o.radiusEarthMeters))-Math.PI/2)*r.rad2Deg,n=t.y*r.rad2Deg/o.radiusEarthMeters;return new l(e,n)},t.projectScale=function(t,e){return this.projectInternal(t,this.worldSize(e))},t.projectZoom=function(t,e){return this.projectInternal(t,1<<e)},t.unproject=function(t,e){var n=t.multiply(o.maxDegrees/this.worldSize(e));return new l(o.maxDegrees/Math.PI*Math.atan(Math.exp((o.maxLongitude-n.y)*r.deg2Rad))-90,n.x-o.maxLongitude)},t}(),y=function(){function t(t,e){if(!t)throw new Error("Invalid argument for LatLngBounds");e?(this.southwest=t instanceof l?new l(t.lat(),t.lng()):l.convert(t),this.northeast=e instanceof l?new l(e.lat(),e.lng()):l.convert(e)):4===t.length?(this.southwest=l.convert([t[0],t[1]]),this.northeast=l.convert([t[2],t[3]])):(this.southwest=t[0]instanceof l?new l(t[0].lat(),t[0].lng()):l.convert(t[0]),this.northeast=t[1]instanceof l?new l(t[1].lat(),t[1].lng()):l.convert(t[1]))}return t.prototype.getCenter=function(){return new l((this.northeast.lat()+this.southwest.lat())/2,(this.northeast.lng()+this.southwest.lng())/2)},t.prototype.getNortheast=function(){return this.northeast},t.prototype.getSouthwest=function(){return this.southwest},t.convert=function(e){return e instanceof t?e:new t(e)},t}(),v=function(){function t(){}return t.lat=function(t,e){var n=Math.PI-2*Math.PI*e/Math.pow(2,t);return r.rad2Deg*Math.atan(.5*(Math.exp(n)-Math.exp(-n)))},t.lon=function(t,e){return e/Math.pow(2,t)*o.maxDegrees-o.maxLongitude},t.screenCoordinateToNDC=function(t,e){var n=2*t.x/e.x-1,i=1-2*t.y/e.y;return new f(n,i)},t.NDCCoordinateToScreen=function(t,e){var n=e.x*(1+t.x)/2,i=e.y*(1-t.y)/2;return new f(n,i)},t.screenCoordinateToLatLng=function(t,e){return this.screenCoordinateToLatLngZoom(t,e,e.getZoom())},t.screenCoordinateToLatLngZoom=function(e,n,i){var o=n.getScreenSize(),r=n.getInverseViewProjectionMatrix(),a=Math.pow(2,i),s=t.screenCoordinateToNDC(e,o),l=r.transform(new u(s.x,s.y,-1),1),h=r.transform(new u(s.x,s.y,1),1),c=h.z-l.z,p=l.x-(h.x-l.x)*l.z/c,d=l.y-(h.y-l.y)*l.z/c,g=n.getTarget(),y=Math.pow(2,i),v=m.projectScale(g,y);return m.unproject(new f(p+v.x,v.y-d),a)},t.pixelCoordinateToCameraCoordinate=function(e,n){return t.pixelCoordinateToCameraCoordinateZoom(e,n,n.getZoom())},t.pixelCoordinateToCameraCoordinateZoom=function(t,e,n){var i=Math.pow(2,n),o=m.worldSize(i),r=m.projectScale(e.getTarget(),i);r.x=r.x-o/2,r.y=o/2-r.y;var a=t;return a.x=a.x-o/2,a.y=o/2-a.y,a.x-=r.x,a.y-=r.y,a},t.latLngToScreenCoordinate=function(t,e,n){return this.latLngToScreenCoordinateZoom(t,e,n,n.getZoom())},t.latLngToScreenCoordinateZoom=function(t,e,n,i){i<0&&(i=n.getZoom());var o=Math.pow(2,i),r=m.projectScale(t,o),a=this.pixelCoordinateToCameraCoordinateZoom(r,n,i),s=new u(a.x,a.y,e),l=n.getViewProjectionMatrix().transform(s,1),h=n.getScreenSize(),c=(l.x+1)*h.x/2,p=h.y-(l.y+1)*h.y/2;return new f(c,p)},t.tileCoordinateToLatLngBounds=function(e){var n=e.getX(),i=e.getY(),o=e.getZoom(),r=new l(t.lat(o,i+1),t.lon(o,n)),a=new l(t.lat(o,i),t.lon(o,n+1));return new y(r,a)},t.pixelCoordinateToVectorTileCoordinate=function(t,e,n,i){var o=g.getTileSize()*i,r=t.x-e*o,a=t.y-n*o;return new f(r=r/o-.5,a=.5-a/o)},t.getElevationPixelFromMeter=function(e,n){return n.is3dMode()?t.getPixelFromMeter(e,n):0},t.getPixelFromMeter=function(t,e){return t/m.getMetersPerPixelAtLatitude(e.getTarget().lat(),e.getZoom())},t}(),x=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},t.prototype.toString=function(){return"("+String(this.x)+","+String(this.y)+")"},t.convert=function(e){if(e instanceof t)return e;if(Array.isArray(e)&&2===e.length)return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e&&"x"in e&&"y"in e)return new t(Number(e.x),Number(e.y));throw new Error("`PointLike` argument must be specified as a Point instance, an object {x: <x>, y: <y>}, or an array of [<x>, <y>]")},t}(),A=function(){function t(){this._id=null,this._map=null}return t.prototype.getMap=function(){return this._map},t}(),M=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),T=function(t){function e(e){var n=t.call(this)||this;n.defaultPolylineOptions={strokeWidth:0,strokeColor:"#0000ff",strokeOpacity:1,visible:!0,closed:!1};var i={};return g.extendOptions(i,n.defaultPolylineOptions,e),n._path=i.path.map(function(t){return l.convert(t)}),n._strokeWidth=i.strokeWidth,n._strokeColor=i.strokeColor,n._strokeOpacity=i.strokeOpacity,n._visible=i.visible,n._closed=i._closed,n}return M(e,t),e.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&(this._map.mapView.removeAnnotation(this._id),this._id=-1),this._map=t,null!=this._map&&(this._id=this._map.mapView.addAnnotation(this)))},e.prototype.setPath=function(t){this._path=t.map(function(t){return l.convert(t)}),null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0)},e.prototype.setStrokeWidth=function(t){this._strokeWidth!=t&&(this._strokeWidth=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setStrokeColor=function(t){this._strokeColor!=t&&(this._strokeColor=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setStrokeOpacity=function(t){this._strokeOpacity!=t&&(this._strokeOpacity=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setVisible=function(t){this._visible!=t&&(this._visible=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.getPath=function(){return this._path.slice(0)},e.prototype.getStrokeWidth=function(){return this._strokeWidth},e.prototype.getStrokeColor=function(){return this._strokeColor},e.prototype.getStrokeOpacity=function(){return this._strokeOpacity},e.prototype.isVisible=function(){return this._visible},e.prototype.isClosed=function(){return this._closed},e}(A),w=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),b=function(t){function e(e){var n=t.call(this)||this;n.defaultPolygonOptions={fillColor:"#0000ff",fillOpacity:1,visible:!0};var i={};return g.extendOptions(i,n.defaultPolygonOptions,e),n._paths=i.paths.map(function(t){return t.map(function(t){return l.convert(t)})}),n._fillColor=i.fillColor,n._fillOpacity=i.fillOpacity,n._visible=i.visible,n}return w(e,t),e.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&(this._map.mapView.removeAnnotation(this._id),this._id=-1),this._map=t,null!=this._map&&(this._id=this._map.mapView.addAnnotation(this)))},e.prototype.setPaths=function(t){this._paths=t.map(function(t){return t.map(function(t){return l.convert(t)})}),null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0)},e.prototype.setFillColor=function(t){this._fillColor!=t&&(this._fillColor=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setFillOpacity=function(t){this._fillOpacity!=t&&(this._fillOpacity=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setVisible=function(t){this._visible!==t&&(this._visible=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.getPaths=function(){return this._paths.slice(0)},e.prototype.getFillColor=function(){return this._fillColor},e.prototype.getFillOpacity=function(){return this._fillOpacity},e.prototype.isVisible=function(){return this._visible},e}(A),_=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),S=function(t){function e(e){var n=t.call(this)||this;n.defaultCircleOptions={radius:0,fillColor:"#0000ff",fillOpacity:1,visible:!0};var i={};return g.extendOptions(i,n.defaultCircleOptions,e),n._center=l.convert(i.center),n._radius=i.radius,n._fillColor=i.fillColor,n._fillOpacity=i.fillOpacity,n._visible=i.visible,n}return _(e,t),e.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&(this._map.mapView.removeAnnotation(this._id),this._id=-1),this._map=t,null!=this._map&&(this._id=this._map.mapView.addAnnotation(this)))},e.prototype.setCenter=function(t){var e=l.convert(t);this._center.equals(e)||(this._center=e,null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0))},e.prototype.setRadius=function(t){this._radius!=t&&(this._radius=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0))},e.prototype.setFillColor=function(t){this._fillColor!=t&&(this._fillColor=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setFillOpacity=function(t){this._fillOpacity!=t&&(this._fillOpacity=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setVisible=function(t){this._visible!==t&&(this._visible=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.getCenter=function(){return new l(this._center.lat(),this._center.lng())},e.prototype.getRadius=function(){return this._radius},e.prototype.getFillColor=function(){return this._fillColor},e.prototype.getFillOpacity=function(){return this._fillOpacity},e.prototype.isVisible=function(){return this._visible},e}(A);!function(t){t[t.centerWillChanged=0]="centerWillChanged",t[t.boundsChanged=1]="boundsChanged",t[t.centerChanged=2]="centerChanged",t[t.click=3]="click",t[t.dblClick=4]="dblClick",t[t.drag=5]="drag",t[t.dragEnd=6]="dragEnd",t[t.dragStart=7]="dragStart",t[t.idle=8]="idle",t[t.mouseMove=9]="mouseMove",t[t.mouseOut=10]="mouseOut",t[t.mouseOver=11]="mouseOver",t[t.projectionChanged=12]="projectionChanged",t[t.rightClick=13]="rightClick",t[t.tilesLoaded=14]="tilesLoaded",t[t.tiltChanged=15]="tiltChanged",t[t.zoomChanged=16]="zoomChanged",t[t.markerClick=17]="markerClick",t[t.buildingClick=18]="buildingClick",t[t.polygonClick=19]="polygonClick",t[t.polylineClick=20]="polylineClick",t[t.circleClick=21]="circleClick"}(i||(i={}));var E,C,L=function(){function t(t,e){this._id=t,this._eventCallback=e}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventCallBack",{get:function(){return this._eventCallback},enumerable:!0,configurable:!0}),t}(),R=function(){function t(t){this.eventIdCounter=0,this.events=new Map,this.mapView=t}return t.convertEventFromName=function(t){switch(t){case"centerWillChanged":return i.centerWillChanged;case"centerChanged":return i.centerChanged;case"click":return i.click;case"dblClick":return i.dblClick;case"drag":return i.drag;case"dragEnd":return i.dragEnd;case"dragStart":return i.dragStart;case"idle":return i.idle;case"mouseMove":return i.mouseMove;case"mouseOut":return i.mouseOut;case"mouseOver":return i.mouseOver;case"rightClick":return i.rightClick;case"tiltChanged":return i.tiltChanged;case"zoomChanged":return i.zoomChanged;case"markerClick":return i.markerClick;case"buildingClick":return i.buildingClick;case"polylineClick":return i.polylineClick;case"polygonClick":return i.polygonClick;case"circleClick":return i.circleClick;default:throw new Error("Event not supported: "+t)}},t.prototype.addEvent=function(e,n){var i=t.convertEventFromName(e),o=this.eventIdCounter++;this.events.has(i)?this.events.get(i).push(new L(o,n)):this.events.set(i,[new L(o,n)]);var r=this.events;return new(function(){function t(){}return t.prototype.remove=function(){if(r.has(i)){var t=r.get(i),e=t.findIndex(function(t){return t.id==o});e>=0&&t.splice(e,1),0===t.length&&r.delete(i)}},t}())},t.prototype.removeEvent=function(e){var n=t.convertEventFromName(e);this.events.has(n)&&this.events.delete(n)},t.prototype.onClickEvent=function(t){var e=this.events.get(i.markerClick);if(null!=e&&0!=e.length){var n=this.mapView.queryMarkerAnnotation(t);if(null!=n&&null!=n.getMap())return e.forEach(function(t){return t.eventCallBack({marker:n})}),!0}var o=this.events.get(i.buildingClick);if(null!=o&&0!=o.length&&this.mapView.mapState.is3dMode()){var r=this.mapView.queryBuildingInfo(t);if(null!=r)return o.forEach(function(t){return t.eventCallBack({object:r})}),!0}var a=this.events.get(i.polylineClick),s=this.events.get(i.polygonClick),u=this.events.get(i.circleClick);if(null!=a&&0!=a.length||null!=s&&0!=s.length||null!=u&&0!=u.length){var l=this.mapView.queryShapeAnnotation(t);if(null!=l)if(l instanceof T){if(null!=a&&0!=a.length)return a.forEach(function(t){return t.eventCallBack({polyline:l})}),!0}else if(l instanceof b){if(null!=s&&0!=s.length)return s.forEach(function(t){return t.eventCallBack({polygon:l})}),!0}else if(l instanceof S&&null!=u&&0!=u.length)return u.forEach(function(t){return t.eventCallBack({circle:l})}),!0}return!1},t.prototype.notify=function(t,e){var n=this,o=this.events.get(t);if(o&&Array.isArray(o)&&0!==o.length)switch(t){case i.click:case i.rightClick:case i.dblClick:case i.dragStart:case i.drag:case i.dragEnd:case i.mouseMove:case i.mouseOut:case i.mouseOver:var r=this.mapView.getCurrentMousePosition(e);o.forEach(function(t){return t.eventCallBack({latLng:v.screenCoordinateToLatLng(r,n.mapView.mapState),pixel:new x(r.x,r.y),xa:e})});break;case i.centerChanged:case i.centerWillChanged:case i.idle:var a=this.mapView.getCameraPosition().getTarget();o.forEach(function(t){return t.eventCallBack({center:new l(a.lat(),a.lng()),zoom:n.mapView.mapState.getZoom(),bearing:n.mapView.mapState.getBearing(),tilt:n.mapView.mapState.getTilt()})});break;case i.tiltChanged:o.forEach(function(t){return t.eventCallBack({tilt:n.mapView.getCameraPosition().getTilt()})});break;case i.zoomChanged:o.forEach(function(t){return t.eventCallBack({zoom:n.mapView.getCameraPosition().getZoom()})});break;default:o.forEach(function(t){return t.eventCallBack()})}},t}();!function(t){t[t.Down=0]="Down",t[t.Up=1]="Up",t[t.Drag=2]="Drag",t[t.DragEnd=3]="DragEnd",t[t.Wheel=4]="Wheel",t[t.Move=5]="Move",t[t.Over=6]="Over",t[t.Out=7]="Out",t[t.Double=8]="Double",t[t.None=9]="None"}(E||(E={})),function(t){t[t.Left=0]="Left",t[t.Wheel=1]="Wheel",t[t.Right=2]="Right",t[t.None=3]="None"}(C||(C={}));var I=function(){function t(t,e){this.canvas=t,this.mapView=e,this.checkDragStart=!0,t.addEventListener("mousedown",this.mouseDown.bind(this)),t.addEventListener("mousemove",this.mouseMove.bind(this)),t.addEventListener("mouseup",this.mouseUp.bind(this)),t.addEventListener("wheel",this.mouseWheel.bind(this)),t.addEventListener("mouseover",this.mouseOver.bind(this)),t.addEventListener("mouseout",this.mouseOut.bind(this)),t.addEventListener("dblclick",this.doubleClick.bind(this)),t.addEventListener("contextmenu",function(t){return t.preventDefault()})}return t.prototype.drainInertiaBuffer=function(){for(var t=this.inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift()},t.prototype.doubleClick=function(t){var e=new f(t.pageX,t.pageY);this.mapView.mapsEventManager.notify(i.dblClick,t),this.dispatch({dx:0,dy:0,x:e.x,y:e.y,action:E.Double,button:t.button})},t.prototype.mouseOut=function(t){var e=new f(t.pageX,t.pageY);this.mapView.mapsEventManager.notify(i.mouseOut,t),this.dispatch({dx:0,dy:0,x:e.x,y:e.y,action:E.Out,button:t.button}),this.mousePosition=null},t.prototype.mouseWheel=function(t){if(0!=t.deltaY){var e=new f(t.pageX,t.pageY);this.dispatch({dx:t.deltaX,dy:t.deltaY,x:e.x,y:e.y,action:E.Wheel,button:t.button})}},t.prototype.mouseDown=function(t){return this.mapView.stopAnimation(),this.mousePosition=new f(t.pageX,t.pageY),this.mouseDownPosition=this.mousePosition,this.mouseDownTime=Date.now(),t.button==C.Right&&(this.lastDragRotatePosition=new f(this.mousePosition.x,this.mousePosition.y),this.inertia=[[Date.now(),this.mapView.mapState.getBearing()]]),this.dispatch({x:this.mousePosition.x,y:this.mousePosition.y,dx:0,dy:0,action:E.Down,button:t.button}),this.preMouseDown=t,!1},t.prototype.mouseMove=function(t){var e=new f(t.pageX,t.pageY),n=null!=this.preMouseDown?this.preMouseDown.button:t.button;if(this.mousePosition){var o=e.subtract(this.mousePosition);if(this.mousePosition=e,0==o.x&&0==o.y)return;this.checkDragStart&&(this.mapView.mapsEventManager.notify(i.dragStart,t),this.checkDragStart=!1),this.mapView.mapsEventManager.notify(i.drag,t),this.dispatch({x:e.x,y:e.y,dx:o.x,dy:o.y,action:E.Drag,button:n})}else this.mapView.mapsEventManager.notify(i.mouseMove,t),this.dispatch({x:e.x,y:e.y,dx:0,dy:0,action:E.Move,button:n});return!1},t.prototype.mouseOver=function(t){var e=new f(t.pageX,t.pageY);this.mapView.mapsEventManager.notify(i.mouseOver,t),this.dispatch({x:e.x,y:e.y,dx:0,dy:0,action:E.Over,button:t.button})},t.prototype.mouseUp=function(e){var n=new f(e.pageX,e.pageY);this.mouseUpTime=Date.now();var o=n.subtract(this.mouseDownPosition),r=this.mouseUpTime-this.mouseDownTime;if(o.length<.01)if(this.dispatch({x:n.x,y:n.y,dx:0,dy:0,action:E.Up,button:e.button}),e.button==C.Left){var a=this.mapView.getCurrentMousePosition(e);this.mapView.mapsEventManager.onClickEvent(a)||this.mapView.mapsEventManager.notify(i.click,e)}else e.button==C.Right&&this.mapView.mapsEventManager.notify(i.rightClick,e);else this.dispatch({x:n.x,y:n.y,dx:r<t.TIME_DRAG_DETECT?o.x:0,dy:r<t.TIME_DRAG_DETECT?o.y:0,action:E.DragEnd,button:e.button}),this.mapView.mapsEventManager.notify(i.dragEnd,e),this.checkDragStart=!0;return this.mousePosition=null,this.preMouseDown=null,!1},t.prototype.dispatch=function(t){this.mouseEventHandler(t)},t.prototype.mouseEventHandler=function(e){switch(e.action){case E.Drag:if(e.button==C.Left){var n=new x(-e.dx*g.devicePixelScale,e.dy*g.devicePixelScale);this.mapView.moveBy(n)}if(e.button==C.Right){this.inertia.push([Date.now(),-e.x]);var i=.4*(this.lastDragRotatePosition.x-e.x),r=-.5*(this.lastDragRotatePosition.y-e.y);this.mapView.setBearing(this.mapView.mapState.getBearing()+i),this.mapView.setTilt(this.mapView.mapState.cameraPosition.tilt-r),this.lastDragRotatePosition=new f(e.x,e.y)}break;case E.Wheel:var a=this.mapView.mapState.getZoom(),s=e.dy*o.zoomSpeedMouseWheel/1e3;if(e.dy<0){if(e.dy>t.oldWheelMouseDy)return;t.oldWheelMouseDy=e.dy,a=Math.ceil(a),a-=s,a=Math.ceil(a)}else{if(e.dy<t.oldWheelMouseDy)return;t.oldWheelMouseDy=e.dy,a=Math.round(a),a-=s,a=Math.round(a-.5)}var u=new f(e.x,e.y).multiply(g.devicePixelScale);this.mapView.setZoom(a,u,500);break;case E.DragEnd:if(t.oldWheelMouseDy=0,e.button==C.Left){n=new f(-e.dx,e.dy).multiply(g.devicePixelScale);this.mapView.moveByVelocity(new f(n.x,n.y).multiply(o.flingSpeedMultiply*g.devicePixelScale))}if(e.button==C.Right){if(this.drainInertiaBuffer(),this.inertia.length<2)return;var l=this.inertia,h=l.length,c=l[h-1],p=l[h-2],d=c[1]-p[1]>0?1:-1,m=(i=c[1]-p[1],3*Math.abs(i));Math.abs(m)>360&&(m=360),m*=d;var y=Math.abs(m)/90;y>1&&(y=1),this.mapView.setBearing(this.mapView.mapState.getBearing()+m,y)}break;case E.Double:if(e.button==C.Left){a=this.mapView.mapState.getZoom()+1,u=new f(e.x,e.y).multiply(g.devicePixelScale);this.mapView.setZoom(a,u)}}},t.TIME_DRAG_DETECT=300,t}(),P=function(){function t(){}return t.create=function(t,e,n){var i=window.document.createElement(t);return e&&(i.className=e),n&&n.appendChild(i),i},t}(),O=function(){function t(){}return t.prototype.onMapWillChange=function(t){},t.prototype.onMapIsChanging=function(t){},t.prototype.onMapDidChange=function(t){},t}(),D=function(){function t(){}return t.prototype.notifyCameraWillChange=function(){},t.prototype.notifyCameraIsChanging=function(){},t.prototype.notifyCameraDidChange=function(){},t}(),B=function(){function t(t,e,n,i){void 0===t&&(t=new l(0,0)),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.target=t,this.tilt=e,this.bearing=n,this.zoom=i}return t.prototype.setTarget=function(t){this.target=t},t.prototype.setTilt=function(t){this.tilt=t},t.prototype.setBearing=function(t){this.bearing=t%o.maxDegrees},t.prototype.getTarget=function(){return this.target},t.prototype.getTilt=function(){return this.tilt},t.prototype.getBearing=function(){return this.bearing},t.prototype.getZoom=function(){return this.zoom},t.prototype.setZoom=function(t){this.zoom=t},t}(),k=function(){function t(t){void 0===t&&(t=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]]),this.data=t}return t.translate=function(e,n,i){return void 0===i&&(i=0),new t([[1,0,0,0],[0,1,0,0],[0,0,1,0],[e,n,i,1]])},Object.defineProperty(t.prototype,"position",{get:function(){return new u(this.data[3][0],this.data[3][1],this.data[3][2])},enumerable:!0,configurable:!0}),t.rotateX=function(e){e*=Math.PI/180;var n=Math.sin(e),i=Math.cos(e);return new t([[1,0,0,0],[0,i,n,0],[0,-n,i,0],[0,0,0,1]])},t.rotateY=function(e){e*=Math.PI/180;var n=Math.sin(e),i=Math.cos(e);return new t([[i,0,n,0],[0,1,0,0],[-n,0,i,0],[0,0,0,1]])},t.rotateZ=function(e){e*=Math.PI/180;var n=Math.sin(e),i=Math.cos(e);return new t([[i,n,0,0],[-n,i,0,0],[0,0,1,0],[0,0,0,1]])},t.scale=function(e,n,i){return null==n&&(n=e,i=e),new t([[e,0,0,0],[0,n,0,0],[0,0,i,0],[0,0,0,1]])},t.prototype.concat=function(e){var n=new t([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]);if(null==e)return n;for(var i=0;i<4;++i)for(var o=0;o<4;++o)for(var r=0;r<4;++r)n.data[i][r]+=this.data[i][o]*e.data[o][r];return n},t.ortho=function(e,n,i,o,r,a){return void 0===r&&(r=-100),void 0===a&&(a=100),new t([[2/(n-e),0,0,0],[0,2/(o-i),0,0],[0,0,-2/(a-r),0],[-(e+n)/(n-e),-(o+i)/(o-i),-(r+a)/(r-a),1]])},t.perspective=function(e,n,i,o){var r=Math.tan(e/2)*i,a=r*n;return t.frustum(-a,a,-r,r,i,o)},t.frustum=function(e,n,i,o,r,a){return void 0===r&&(r=-100),void 0===a&&(a=100),new t([[2*r/(n-e),0,0,0],[0,2*r/(o-i),0,0],[(n+e)/(n-e),(o+i)/(o-i),-(a+r)/(a-r),-1],[0,0,-2*r*a/(a-r),0]])},t.prototype.transform=function(t,e){void 0===e&&(e=0);var n=this.data[0][0]*t.x+this.data[1][0]*t.y+this.data[2][0]*t.z+this.data[3][0]*e,i=this.data[0][1]*t.x+this.data[1][1]*t.y+this.data[2][1]*t.z+this.data[3][1]*e,o=this.data[0][2]*t.x+this.data[1][2]*t.y+this.data[2][2]*t.z+this.data[3][2]*e;return 0==(e=this.data[0][3]*t.x+this.data[1][3]*t.y+this.data[2][3]*t.z+this.data[3][3]*e)&&(e=1),new u(n/e,i/e,o/e)},t.prototype.buffer=function(){return this.data[0].concat(this.data[1],this.data[2],this.data[3])},t.prototype.transpose=function(){var e=new t;return e.data[0][0]=this.data[0][0],e.data[0][1]=this.data[1][0],e.data[0][2]=this.data[2][0],e.data[0][3]=this.data[3][0],e.data[1][0]=this.data[0][1],e.data[1][1]=this.data[1][1],e.data[1][2]=this.data[2][1],e.data[1][3]=this.data[3][1],e.data[2][0]=this.data[0][2],e.data[2][1]=this.data[1][2],e.data[2][2]=this.data[2][2],e.data[2][3]=this.data[3][2],e.data[3][0]=this.data[0][3],e.data[3][1]=this.data[1][3],e.data[3][2]=this.data[2][3],e.data[3][3]=this.data[3][3],e},t.lookAt=function(e,n,i,o){void 0===i&&(i=1),void 0===o&&(o=new u(0,0,1));var r=e.subtract(n).normalize(),a=o.cross(r).normalize(),s=r.cross(a).normalize(),l=new t;l.data[0]=[a.x,s.x,r.x,0],l.data[1]=[a.y,s.y,r.y,0],l.data[2]=[a.z,s.z,r.z,0];var h=t.translate(-e.x,-e.y,-e.z),c=t.scale(i);return h.concat(l).concat(c)},t.prototype.inverse=function(){for(var e=this.data.concat(),n=0;n<4;++n)e[n]=e[n].concat();for(var i=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],o=0;o<4;++o){for(n=o;n<4&&0==e[n][o];)++n;if(4==n||0==e[n][o])return console.log("Cannot calculate inverse, determinant is zero"),this;if(n!=o){var r=e[o];e[o]=e[n],e[n]=r,r=i[o],i[o]=i[n],i[n]=r}var a=e[o],s=i[o];for(n=0;n<4;++n){var u=e[n],l=i[n];if(n!=o){if(0!=u[o]){for(var h=-u[o]/a[o],c=o;c<4;++c)u[c]=u[c]+h*a[c];for(c=0;c<4;++c)l[c]=l[c]+h*s[c]}}else{if(0==(h=a[o]))return console.log("Cannot calculate inverse, determinant is zero"),this;for(c=o;c<4;++c)u[c]=u[c]/h;for(c=0;c<4;++c)l[c]=l[c]/h}}}return new t([i[0],i[1],i[2],i[3]])},t}(),Z=function(){function t(t){this.prefered2d=!1,this.scale=1,this.willChange=!1,this.zoomIn=!1,this.zoomOut=!1,this.panning=!1,this.flyingTo=!1,this.tilting=!1,this.bearing=!1,this.mapSettings=t,this.cameraPosition=new B}return t.prototype.setScreenSize=function(t,e){this.screenWidth=t,this.screenHeight=e,this.projectionMatrix=k.perspective(a.fov,this.screenWidth/this.screenHeight,a.nearPlane,a.farPlane),this.recalculateMatrices()},t.prototype.matrixFor=function(t){var e=1<<t.getTileCoordinate().getZoom(),n=m.worldSize(this.scale)/e,i=t.toVec2(),o=i.x*n+n/2,r=i.y*n+n/2,a=v.pixelCoordinateToCameraCoordinate(new f(o,r),this),s=k.translate(a.x,a.y,0);return s=k.scale(n/2,n/2,1).concat(s)},t.prototype.recalculateMatrices=function(){this.viewMatrix=this.updateViewMatrix(),this.viewProjectionMatrix=this.viewMatrix.concat(this.projectionMatrix),this.inverseViewProjectionMatrix=this.viewProjectionMatrix.inverse()},t.prototype.updateViewMatrix=function(){var t=g.getTileSize(),e=a.height*Math.tan(a.fov/2)*t/this.screenHeight/(t/2),n=k.rotateX(this.cameraPosition.tilt).transform(new u(0,0,a.height),0),i=k.rotateZ(this.cameraPosition.bearing).transform(n,0);n=k.rotateX(this.cameraPosition.tilt).transform(new u(0,1,0),0);var o=k.rotateZ(this.cameraPosition.bearing).transform(n,0),r=k.lookAt(i,new u(0,0,0),1,o);return r=k.scale(e,e,e).concat(r)},t.prototype.setTarget=function(t){this.cameraPosition.setTarget(t),this.recalculateMatrices()},t.prototype.setTilt=function(t){this.cameraPosition.setTilt(t),this.recalculateMatrices()},t.prototype.setBearing=function(t){this.cameraPosition.setBearing(t),this.recalculateMatrices()},t.prototype.setZoom=function(t){var e=this.getZoom();this.cameraPosition.setZoom(t),this.scale=Math.pow(2,t),e!=this.getZoom()&&(this.prefered2d=this.getZoom()>=o.defaultMinZoom3d&&!this.is3dMode()),this.recalculateMatrices()},t.prototype.enable3dMode=function(t){return this.mapSettings.enable3dMode(t)},t.prototype.getProjectionMatrix=function(){return this.projectionMatrix},t.prototype.getViewMatrix=function(){return this.viewMatrix},t.prototype.getViewProjectionMatrix=function(){return this.viewProjectionMatrix},t.prototype.getViewOrthoProjectionMatrix=function(){return k.ortho(0,this.screenWidth,this.screenHeight,0)},t.prototype.getInverseViewProjectionMatrix=function(){return this.inverseViewProjectionMatrix},t.prototype.getScreenSize=function(){return new f(this.screenWidth,this.screenHeight)},t.prototype.getTilt=function(){return this.cameraPosition.getTilt()},t.prototype.getBearing=function(){return this.cameraPosition.getBearing()},t.prototype.getScale=function(){return this.scale},t.prototype.getZoom=function(){return this.cameraPosition.getZoom()},t.prototype.getTarget=function(){return this.cameraPosition.getTarget()},t.prototype.isZoomIn=function(){return this.zoomIn},t.prototype.isZoomOut=function(){return this.zoomOut},t.prototype.isTilting=function(){return this.tilting},t.prototype.isBearing=function(){return this.bearing},t.prototype.isPanning=function(){return this.panning},t.prototype.isFlyingTo=function(){return this.flyingTo},t.prototype.isStartedAnimation=function(){return this.startedAnimation},t.prototype.isMoving=function(){return this.movingTo},t.prototype.getCameraPosition=function(){return this.cameraPosition},t.prototype.isWillChange=function(){return this.willChange},t.prototype.setCameraPosition=function(t){this.cameraPosition=t},t.prototype.getMaxNativeZoom=function(){return this.mapSettings.getMaxNativeZoom()},t.prototype.is3dMode=function(){return this.mapSettings.is3dMode()},t.prototype.setSwitchMode=function(t){this.mapSettings.setSwitchMode(t)},t.prototype.handleSwitchMode=function(){switch(this.mapSettings.getSwitchMode()){case en.Auto3DTo2D:this.getZoom()<o.defaultMinZoom3d&&this.enable3dMode(!1);break;case en.Auto2DTo3D:Math.round(this.getZoom())!=o.defaultMinZoom3d||this.prefered2d||this.enable3dMode(!0);break;case en.Auto:this.prefered2d||this.enable3dMode(Math.round(this.getZoom())==o.defaultMinZoom3d)}},t}(),N=function(){function t(){this.map2dUrl=o.baseMapUrl+"?tileUrl="+o.defaultMap2dUrl+"&key=",this.map3dUrl=o.baseMapUrl+"?tileUrl="+o.defaultMap3dUrl+"&mode=3d&key=",this.minZoom=o.defaultMinZoom,this.maxZoom=o.defaultMaxZoom,this.maxNativeZoom=o.defaultMaxNativeZoom,this._3dMode=!1,this.switchMode=en.Auto3DTo2D}return t.prototype.setMapUrl=function(t,e){e?this.map3dUrl=o.baseMapUrl+"?tileUrl="+t+"&mode=3d&key=":this.map2dUrl=o.baseMapUrl+"?tileUrl="+t+"&key="},t.prototype.setMinZoom=function(t){this.minZoom=t,this.minZoom>this.maxZoom&&(this.minZoom+=this.maxZoom,this.maxZoom=this.minZoom-this.maxZoom,this.minZoom-=this.maxZoom)},t.prototype.setMaxZoom=function(t){this.maxZoom=t,this.minZoom>this.maxZoom&&(this.minZoom+=this.maxZoom,this.maxZoom=this.minZoom-this.maxZoom,this.minZoom-=this.maxZoom)},t.prototype.getMapUrl=function(){return(this._3dMode?this.map3dUrl:this.map2dUrl)+t.accessKey},t.prototype.getPreferMinZoom=function(){var t=this.minZoom,e=0;switch(this.switchMode){case en.Auto:case en.Auto3DTo2D:t=this.minZoom>o.defaultMinZoom?this.minZoom:o.defaultMinZoom;break;default:e=this.is3dMode()?o.defaultMinZoom3d:o.defaultMinZoom,t=this.minZoom>e?this.minZoom:e}return t},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMaxNativeZoom=function(){return this.maxNativeZoom},t.prototype.setTime=function(t){this.time=t},t.prototype.getTime=function(){return this.time},t.prototype.setMaxNativeZoom=function(t){this.maxNativeZoom=t},t.getAccessKey=function(){return this.accessKey},t.setAccessKey=function(t){this.accessKey=t},t.prototype.enable3dMode=function(t){return t!=this._3dMode&&(this._3dMode=t,!0)},t.prototype.is3dMode=function(){return this._3dMode},t.prototype.setSwitchMode=function(t){this.switchMode=t},t.prototype.getSwitchMode=function(){return this.switchMode},t.accessKey="98fd21346d83bee24dc734231f7609c9",t}(),U=function(){function t(t){this.orderedKeys=[],this.size=t,this.tiles=new Map}return t.prototype.setSize=function(t){for(this.size=t;this.orderedKeys.length>t;){var e=this.orderedKeys[0];this.orderedKeys.shift(),this.tiles.delete(e.toString())}},t.prototype.add=function(t,e){if(e.isRenderable()&&this.size){if(this.tiles.has(t)){var n=this.orderedKeys.indexOf(t,0);n>-1&&this.orderedKeys.splice(n,1);var i=this.tiles.get(t);i!=e&&i.destroy()}if(this.tiles.set(t,e),this.orderedKeys.push(t),this.orderedKeys.length>this.size-1)this.pop(this.orderedKeys[0]).destroy()}else e.destroy()},t.prototype.get=function(t){return this.tiles.get(t)},t.prototype.pop=function(t){var e=this.tiles.get(t);if(this.tiles.delete(t)){var n=this.orderedKeys.indexOf(t,0);n>-1&&this.orderedKeys.splice(n,1)}return e},t.prototype.has=function(t){return null!=this.tiles.get(t)},t.prototype.clear=function(){this.orderedKeys=[],this.tiles.forEach(function(t){t.destroy()}),this.tiles.clear()},t}(),F=function(){function t(t,e){this.unwrappedTileCoordinate=t,this.tile=e}return t.prototype.clone=function(){return new t(this.unwrappedTileCoordinate,this.tile)},t.prototype.getTile=function(){return this.tile},t.prototype.getUnwrappedTileCoordinate=function(){return this.unwrappedTileCoordinate},t}(),V=function(){function t(t,e,n,i){void 0===i&&(i=!1),this.x=t,this.y=e,this.zoom=n,this.mode3D=i}return t.fromLatLng=function(e,n,i){var o=m.projectScale(e,Math.pow(2,n)).multiply(1/g.getTileSize());return new t(Math.floor(o.x),Math.floor(o.y),n,i)},t.prototype.parent=function(){return new t(this.x/2,this.y/2,this.zoom-1,this.mode3D)},t.prototype.children=function(){var e=this.zoom+1,n=2*this.x,i=2*this.y;return[new t(n,i,e,this.mode3D),new t(n,i+1,e,this.mode3D),new t(n+1,i,e,this.mode3D),new t(n+1,i+1,e,this.mode3D)]},t.prototype.set3DMode=function(t){this.mode3D=t},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getZoom=function(){return this.zoom},t.prototype.is3DMode=function(){return this.mode3D},t.prototype.equal=function(t){return this.x==t.x&&this.y==t.y&&this.zoom==t.zoom&&this.mode3D==t.mode3D},t.prototype.notEqual=function(t){return this.x!=t.x||this.y!=t.y||this.zoom!=t.zoom||this.mode3D!=t.mode3D},t.prototype.lessThan=function(t){return this.x==t.x?this.y==t.y?this.zoom<t.zoom:this.y<t.y:this.x<t.x},t.prototype.isChildOf=function(t){return this.mode3D==t.mode3D&&(0==t.zoom||t.zoom<this.zoom&&t.x==this.x>>this.zoom-t.zoom&&t.y==this.y>>this.zoom-t.zoom)},t.prototype.toString=function(){return'{"x":'+this.getX()+',"y":'+this.getY()+',"z":'+this.getZoom()+',"mode3D":'+this.mode3D+"}"},t}(),z=function(){function t(){}return t.createWithXYZoom=function(e,n,i,o){void 0===o&&(o=!1);var r=new t;return r.wrap=(e<0?e-(1<<i)+1:e)/(1<<i)>>0,r.tileCoordinate=new V(e&(1<<i)-1,n<0?0:Math.min(n,(1<<i)-1),i,o),r},t.createWithWrapAndTileCoordinate=function(e,n){var i=new t;return i.wrap=e,i.tileCoordinate=n,i},t.fromLatLng=function(e,n){var i=m.projectScale(e,Math.pow(2,n)).multiply(1/g.getTileSize());return t.createWithXYZoom(Math.floor(i.x),Math.floor(i.y),n)},t.prototype.toVec2=function(){var t=this.tileCoordinate.getX()+this.wrap*(1<<this.tileCoordinate.getZoom());return new f(t,this.tileCoordinate.getY())},t.prototype.parent=function(){var e=this.tileCoordinate.zoom-1,n=this.tileCoordinate.x/2>>0,i=this.tileCoordinate.y/2>>0;return t.createWithWrapAndTileCoordinate(this.wrap,new V(n,i,e,this.tileCoordinate.is3DMode()))},t.prototype.children=function(){var e=this.tileCoordinate.zoom+1,n=2*this.tileCoordinate.x,i=2*this.tileCoordinate.y;return[t.createWithWrapAndTileCoordinate(this.wrap,new V(n,i,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new V(n,i+1,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new V(n+1,i,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new V(n+1,i+1,e,this.tileCoordinate.is3DMode()))]},t.prototype.getWrap=function(){return this.wrap},t.prototype.getTileCoordinate=function(){return this.tileCoordinate},t.prototype.equal=function(t){return this.wrap==t.getWrap()&&this.tileCoordinate.equal(t.getTileCoordinate())},t.prototype.notEqual=function(t){return this.wrap!=t.getWrap()},t.prototype.lessThan=function(t){return this.wrap==t.getWrap()?this.tileCoordinate.lessThan(t.getTileCoordinate()):this.wrap<t.getWrap()},t}(),j=function(){function t(){}return t.scanTriangle=function(t,e,n,i,o,r){var a=new Y(t,e),s=new Y(e,n),u=new Y(n,t);if(a.dy>s.dy){var l=a;a=s,s=l}if(a.dy>u.dy){l=a;a=u,u=l}if(s.dy>u.dy){l=s;s=u,u=l}a.dy&&X(u,a,i,o,r),s.dy&&X(u,s,i,o,r)},t}(),Y=function(){return function(t,e){if(this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.dx=0,this.dy=0,t.y>e.y){var n=t;t=e,e=n}this.x0=t.x,this.y0=t.y,this.x1=e.x,this.y1=e.y,this.dx=e.x-t.x,this.dy=e.y-t.y}}();function X(t,e,n,i,o){var r=Math.max(n,Math.floor(e.y0)),a=Math.min(i,Math.ceil(e.y1));if(t.x0==e.x0&&t.y0==e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var u=t.dx/t.dy,l=e.dx/e.dy,h=t.dx>0?1:0,c=e.dx<0?1:0,p=r;p<a;++p){var f=u*Math.max(0,Math.min(t.dy,p+h-t.y0))+t.x0,d=l*Math.max(0,Math.min(e.dy,p+c-e.y0))+e.x0;o(Math.floor(d),Math.ceil(f),p)}}var H,G=function(){function t(){}return t.getTileUrl=function(t,e,n,i){for(var o=0,r=0,a="";r<t.length;)if("{"==t[r]){switch(a+=t.substring(o,r),t[r+1]){case"x":a+=e.toString();break;case"y":a+=n.toString();break;case"z":a+=i.toString();break;default:console.log("Invalid map url pattern: "+t)}o=r+=3}else++r;return a+=t.substr(o)},t.getBuildingDataUrl=function(t,e,n){for(var i=0,o=0,r="";o<t.length;)if("{"==t[o]){switch(r+=t.substring(i,o),t[o+1]){case"s":r+=e;break;case"k":r+=n;break;default:console.log("Invalid Model url pattern: "+t)}i=o+=3}else++o;return r+=t.substr(i)},t}(),W=function(){function t(){}return t.generate=function(){return Math.random().toString(36).substring(2)+(new Date).getTime().toString(36)+this.count++},t.count=0,t}();!function(t){t[t.RasterTile=0]="RasterTile",t[t.Model=1]="Model",t[t.Texture=2]="Texture",t[t.MAX=3]="MAX"}(H||(H={}));var Q,q=function(){return function(t){this.method="GET",this.params=null,this.id=W.generate(),this.type=t}}(),K=function(){return function(t){this.id=t,this.success=!1,this.data=null}}(),J=function(){function t(t,e,n,i,o,r){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i,this.minZoom=o,this.maxZoom=r}return t.fromLatLngBounds=function(e,n,i){var o=m.projectZoom(e.getSouthwest(),i),r=m.projectZoom(e.getNortheast(),i),a=Math.pow(2,i);return new t(Math.floor(o.x),Math.floor(r.x),d.clamp(Math.floor(r.y),0,a),d.clamp(Math.floor(o.y),0,a),n,i)},t.prototype.contains=function(t){var e=t.getX(),n=t.getY(),i=t.getZoom();if(i<=this.maxZoom&&i>=this.minZoom){if(0==i)return!0;var o=this.maxZoom-i,r=this.minX>>o,a=this.maxX>>o,s=this.minY>>o,u=this.maxY>>o;return(this.minX>this.maxX?e>=r||e<=a:e<=a&&e>=r)&&n<=u&&n>=s}return!1},t}(),$=function(){function t(){}return t.prototype.setModel=function(t){this.model=t},t.prototype.setTexture=function(t){this.texture=t},t.prototype.getModel=function(){return this.model},t.prototype.getTexture=function(){return this.texture},t.prototype.getModelMatrix=function(){return this.modelMatrix},t.prototype.getMvpMatrix=function(){return this.mvpMatrix},t}(),tt=function(){var t=function(e,n){return(t=$.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?$.create(n):(i.prototype=n.prototype,new i)}}(),et=function(t){function e(){var e=t.call(this)||this;return e.location=new l(0,0),e.scale=new u(1,1,1),e.bearing=0,e.name="Unknown name",e.elevation=0,e.selectionCode=0,e}return tt(e,t),e.prototype.getId=function(){return this.id},e.prototype.setId=function(t){this.id=t},e.prototype.getName=function(){return this.name},e.prototype.setName=function(t){this.name=t},e.prototype.setPlaces=function(t){this.places=t},e.prototype.getPlaces=function(){return this.places},e.prototype.getScale=function(){return this.scale},e.prototype.setScale=function(t){this.scale=t},e.prototype.setBearing=function(t){this.bearing=t},e.prototype.getBearing=function(){return this.bearing},e.prototype.setLocation=function(t){this.location=l.convert(t)},e.prototype.getLocation=function(){return this.location},e.prototype.getElevation=function(){return this.elevation},e.prototype.setElevation=function(t){this.elevation=t},e.prototype.setHeightScale=function(t){this.heightScale=t},e.prototype.getHeightScale=function(){return this.heightScale},e.prototype.setCamera=function(t){this.camera=t},e.prototype.getCamera=function(){return this.camera},e.prototype.setTypes=function(t){this.types=t},e.prototype.getTypes=function(){return this.types},e.prototype.setVerified=function(t){this._isVerified=t},e.prototype.isVerified=function(){return this._isVerified},e.prototype.setMinZoom=function(t){this.minZoom=t},e.prototype.getMinZoom=function(){return this.minZoom},e.prototype.setMaxZoom=function(t){this.maxZoom=t},e.prototype.getMaxZoom=function(){return this.maxZoom},e.prototype.setStartDate=function(t){this.startDate=t},e.prototype.getStartDate=function(){return this.startDate},e.prototype.setEndDate=function(t){this.endDate=t},e.prototype.getEndDate=function(){return this.endDate},e.prototype.getTextureName=function(){return this.textureName},e.prototype.setTextureName=function(t){this.textureName=t},e.prototype.getObjName=function(){return this.objName},e.prototype.setObjName=function(t){this.objName=t},e.prototype.getDistance=function(){return this.distance},e.prototype.setDistance=function(t){this.distance=t},e.prototype.getBuildingType=function(){return this.buildingType},e.prototype.setBuildingType=function(t){this.buildingType=t},e.prototype.getSelectionCode=function(){return this.selectionCode},e.prototype.setSelectionCode=function(t){this.selectionCode=t},e.prototype.updateMatrices=function(t){var n=1/m.getMetersPerPixelAtLatitude(t.getTarget().lat(),t.getZoom()),i=m.projectScale(this.location,t.getScale()),o=v.pixelCoordinateToCameraCoordinate(new f(i.x,i.y),t),r=v.getElevationPixelFromMeter(this.getElevation(),t);this.modelMatrix=k.translate(o.x,o.y,r),this.modelMatrix=k.scale(this.scale.x*n,this.scale.y*n,this.scale.z*n).concat(this.modelMatrix),this.modelMatrix=k.rotateZ(this.bearing).concat(this.modelMatrix),this.modelMatrix=k.rotateX(e.buildingRotationX).concat(this.modelMatrix),this.mvpMatrix=this.modelMatrix.concat(t.getViewProjectionMatrix())},e.buildingRotationX=90,e}($);!function(t){t[t.Texture=0]="Texture",t[t.Color=1]="Color",t[t.Polygon=2]="Polygon"}(Q||(Q={}));var nt=n(1),it=n.n(nt),ot=function(){function t(){}return t.extrudePolygon=function(e,n){if(!(0==e.length||e[0].length<=2)){var i=[],o=[];t.convertToClockwise(e[0]);var r=[];e[0].forEach(function(t){r.push(t.x),r.push(t.y)});var a=it()(r),s=e[0],l=s.length,h=l;a.length;6*(h-0)*1,2*(2*(h-0));for(var c=0,p=0;p<s.length;++p)i.push([-s[p].y,n,-s[p].x,0,0,0,0,0]);for(p=0;p<a.length;++p)o.push(c+a[p]);var f=h-0,d=2*f;c=i.length;for(var g=0;g<2;++g){var m=0==g?n:0;for(p=0;p<f;++p)for(var y=0;y<2;++y){var v=(p+y)%f+0;i.push([-s[v].y,m,-s[v].x,0,0,0,0,0])}}for(p=0;p<f;++p)for(var x=0;x<6;++x){y=(t.quadToTriangle[x][0]+2*p)%d;var A=t.quadToTriangle[x][1]+1;o.push((A-1)*d+y+c)}for(var M=0;M<o.length;){var T=o[M++],w=o[M++],b=o[M++],_=new u(i[T][0],i[T][1],i[T][2]),S=new u(i[w][0],i[w][1],i[w][2]),E=new u(i[b][0],i[b][1],i[b][2]),C=_.subtract(S),L=S.subtract(E);A=C.cross(L);i[T][5]=i[T][5]+A.x,i[T][6]=i[T][6]+A.y,i[T][7]=i[T][7]+A.z,i[w][5]=i[w][5]+A.x,i[w][6]=i[w][6]+A.y,i[w][7]=i[w][7]+A.z,i[b][5]=i[b][5]+A.x,i[b][6]=i[b][6]+A.y,i[b][7]=i[b][7]+A.z}for(p=0;p<i.length;++p){var R=new u(i[p][5],i[p][6],i[p][7]);R=R.normalize(),i[p][5]=R.x,i[p][6]=R.y,i[p][7]=R.z}return{vertices:i,indices:o}}},t.convertToClockwise=function(e){t.calculatePolygonArea(e)>0&&t.reversePoints(e)},t.calculatePolygonArea=function(t){var e=t.length;if(!(e<3)){for(var n=0,i=0,o=e-1;i<e;){var r=t[o].x,a=t[o].y,s=t[i].x,u=t[i].y;o=i,i+=1,n+=r*u-s*a}return n}},t.reversePoints=function(t){for(var e=t.length,n=e/2,i=0;i<n;++i){var o=t[i];t[i]=t[e-i-1],t[e-i-1]=o}},t.quadToTriangle=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]],t}(),rt=function(){function t(t,e,n,i,r,a,s){this.renderTiles=[],this.visibleTiles=[],this.mapView=t,this.tileTaskManager=e,this.mapState=n,this.tileCache=new U(o.tileCacheSize),this.tiles=new Map,this.annotationTiles=new Map,this.finishedLoad=!0,this.mapSettings=i,this.lastZoom=this.mapState.getZoom(),this.tileAreas=new Map,this.tileRequestsMap=new Map,this.buildingResourceManager=r,this.createAnnotationTile=a,this.requestRender=s}return t.prototype.isDirty=function(){var t=this.mapState.getZoom(),e=!0;return(this.finishedLoad||this.mapState.isZoomIn()||this.mapState.isZoomOut()||!this.mapState.isFlyingTo()&&(Math.ceil(t-r.epsilon)>t||Math.floor(t+r.epsilon)<t))&&(e=!1),e},t.prototype.update=function(t){this.isDirty()&&(this.updateRenderableTiles(t),this.tileRequestsMap.size||(this.finishedLoad=!0,this.lastZoom=this.mapState.getZoom()))},t.prototype.reload=function(){var t=this;this.tiles.forEach(function(t){t.tile.destroy()}),this.annotationTiles.forEach(function(t){t.tile.destroy()}),this.tiles.clear(),this.annotationTiles.clear(),this.renderTiles=[],this.tileCache.clear(),this.finishedLoad=!1,this.mapView.dirty=!0,this.tileRequestsMap.forEach(function(e){t.tileTaskManager.cancelTask(e)}),this.tileRequestsMap.clear()},t.prototype.getRenderTiles=function(){return this.renderTiles},t.prototype.getVisibleTiles=function(){return this.visibleTiles},t.prototype.updateVisibleTilesForZoom=function(t){var e=this;this.mapState.getZoom()>this.mapSettings.getMaxNativeZoom()&&(t=this.mapSettings.getMaxNativeZoom());var n=this.mapState.getScreenSize(),i=Math.pow(2,t),o=m.projectScale(v.screenCoordinateToLatLngZoom(new f(0,0),this.mapState,t),i).multiply(1/g.getTileSize()),r=m.projectScale(v.screenCoordinateToLatLngZoom(new f(n.x,0),this.mapState,t),i).multiply(1/g.getTileSize()),a=m.projectScale(v.screenCoordinateToLatLngZoom(new f(n.x,n.y),this.mapState,t),i).multiply(1/g.getTileSize()),s=m.projectScale(v.screenCoordinateToLatLngZoom(new f(0,n.y),this.mapState,t),i).multiply(1/g.getTileSize()),u=m.projectScale(v.screenCoordinateToLatLngZoom(new f(n.x/2,n.y/2),this.mapState,t),i).multiply(1/g.getTileSize()),l=1<<Math.floor(t),h=[],c=function(t,e,n){if(n>=0&&n<=l)for(var i=t;i<e;++i){var o=i+.5-u.x,r=n+.5-u.y,a={x:i,y:n,sqDist:o*o+r*r};h.push(a)}};j.scanTriangle(o,r,a,0,l,c),j.scanTriangle(a,s,o,0,l,c),h.sort(function(t,e){return t.sqDist==e.sqDist?t.x==e.x?t.y-e.y:t.x-e.x:t.sqDist-e.sqDist}),h.filter(function(t,e,n){return 0==e||t.x!=n[e-1].x||t.y!=n[e-1].y}).forEach(function(n){return e.visibleTiles.push(z.createWithXYZoom(n.x,n.y,t,e.mapState.is3dMode()))})},t.prototype.updateVisibleTiles=function(){this.finishedLoad=!1,this.visibleTiles=[];var t=this.mapState.getZoom();this.mapState.isFlyingTo()?(this.updateVisibleTilesForZoom(Math.floor(t)),this.updateVisibleTilesForZoom(Math.ceil(t))):this.mapState.isZoomIn()?this.updateVisibleTilesForZoom(Math.ceil(t)):this.mapState.isZoomOut()?this.updateVisibleTilesForZoom(Math.floor(t)):this.updateVisibleTilesForZoom(t),this.cancelOutdatedTasks()},t.prototype.cancelOutdatedTasks=function(){var t=this;this.tileRequestsMap.forEach(function(e,n,i){t.visibleTiles.some(function(t){return t.getTileCoordinate().toString()==n})||(i.delete(n),t.tileTaskManager.cancelTask(e))})},t.prototype.updateRenderableTiles=function(t){var e=this,n=[],i=[],o=[];if(this.mapState.getZoom()<this.lastZoom&&0!=this.visibleTiles.length){var r=this.visibleTiles[0].getTileCoordinate().getZoom();this.renderTiles.forEach(function(t){t.getUnwrappedTileCoordinate().getTileCoordinate().getZoom()>r&&o.push(t)})}this.renderTiles=[],this.visibleTiles.forEach(function(r){var a=r.getTileCoordinate(),s=e.getTile(a);if(null==s&&(a.set3DMode(e.mapState.is3dMode()),s=e.createTile(a,t)),s.isRenderable())e.renderTiles.push(new F(r,s)),n.push(a);else{if(n.push(a),e.mapState.isFlyingTo())return;if(e.mapState.getZoom()>e.lastZoom)for(var u=r.parent();u.getTileCoordinate().getZoom()>=e.lastZoom;){if(a=u.getTileCoordinate(),null!=(s=e.getTile(a))&&s.isRenderable()){n.some(function(t){return t.equal(a)})||(n.push(a),i.push(new F(u,s)));break}u=u.parent()}else e.mapState.getZoom()<e.lastZoom&&o.forEach(function(t){var i=t.getUnwrappedTileCoordinate();i.getTileCoordinate().isChildOf(r.getTileCoordinate())&&(a=i.getTileCoordinate(),null!=(s=e.getTile(a))&&s.isRenderable()&&(n.some(function(t){return t.equal(a)})||(n.push(a),e.renderTiles.push(new F(i,s)))))})}}),0!=i.length&&(this.renderTiles.forEach(function(t){i.push(t)}),this.renderTiles=i),n.sort(function(t,e){return t.lessThan(e)?-1:t.lessThan(e)?0:1});for(var a=[],s=0;s<n.length-1;++s)n[s]!==n[s+1]&&a.push(n[s]);a.push(n[n.length-1]),n=a;var u=Array.from(this.tiles),l=Array.from(this.annotationTiles);u.sort(function(t,e){return t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?-1:t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?0:1}),l.sort(function(t,e){return t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?-1:t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?0:1});for(var h=0,c=0,p=0;h<this.tiles.size;)if(c==n.length||u[h][1].tileCoordinate.lessThan(n[c])){u[h][1].tile.getBuildings().forEach(function(t){e.buildingResourceManager.decreaseBuildingReference(t.id)}),this.tileCache.add(u[h][0],u[h][1].tile),this.tiles.delete(u[h][0].toString());var f=l[p][1].tile;this.annotationTiles.delete(l[p][0]),f.destroy(),++h,++p}else n[c].lessThan(u[h][1].tileCoordinate)||(++h,++p),++c},t.prototype.getTile=function(t){if(!this.tiles.has(t.toString())){var e=this.tileCache.pop(t.toString());if(null!=e){var n=e;return this.addBuildings(n.getBuildings(),n),this.tiles.set(t.toString(),{tileCoordinate:t,tile:e}),this.annotationTiles.set(t.toString(),{tileCoordinate:t,tile:this.createAnnotationTile(t)}),e}return null}return this.tiles.get(t.toString()).tile},t.prototype.clearTileCache=function(){this.tileCache.clear()},t.prototype.createTile=function(t,e){var n=this,i=this.tileCache.pop(t.toString());if(null==i){var r=this.mapSettings.getMapUrl(),a=t.getZoom(),s=!1;this.tileAreas.forEach(function(e){s||a<=e.getMaxZoom()&&a>=e.getMinZoom()&&J.fromLatLngBounds(e.getBounds(),a,a).contains(t)&&(r=o.baseMapUrl+"?tileUrl="+e.getUrl(),n.mapSettings.is3dMode()&&(r+="&mode=3d"),r+="&key="+N.getAccessKey(),s=!0)});var u=G.getTileUrl(r,t.getX(),t.getY(),t.getZoom());i=e(t);var l=new q(H.RasterTile);l.url=u,l.completion=function(e){if(null!=e.data){i.init(e.data.result,function(){n.requestRender(),n.tileRequestsMap.delete(t.toString())});var o=e.data.result.objects||[],r=n.mapView.mapSettings.getTime();null==r&&(r=Date.now());for(var a=o.length;a--;){var s=o[a],u=null!=s.startDate?s.startDate:Number.NEGATIVE_INFINITY,l=null!=s.endDate?s.endDate:Number.POSITIVE_INFINITY;(u>r||l<r)&&o.splice(a,1)}n.addBuildings(o,i),i.addBuildings(o)}},this.tileRequestsMap.set(t.toString(),l),this.tileTaskManager.postTask(l)}return null!=this.tiles&&this.tiles.set(t.toString(),{tileCoordinate:t,tile:i}),this.annotationTiles.set(t.toString(),{tileCoordinate:t,tile:this.createAnnotationTile(t)}),i},t.prototype.addTileArea=function(t,e){this.tileAreas.set(t,e),this.reload()},t.prototype.updateTileArea=function(t,e){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.addTileArea(t,e))},t.prototype.removeTileArea=function(t){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.reload())},t.prototype.addBuildings=function(t,e){var n=this;t.forEach(function(t){if(n.buildingResourceManager.hasBuilding(t.id))n.buildingResourceManager.increaseBuildingReference(t.id);else{var e=new et;if(e.setId(t.id),null==t.name?e.setName("Unknown name"):e.setName(t.name),e.setPlaces(t.places),e.setScale(new u(t.scale,t.scale,t.scale*t.heightScale)),e.setBearing(t.bearing),e.setLocation(t.location),e.setElevation(t.elevation),e.setHeightScale(t.heightScale),e.setCamera(t.camera),e.setTypes(t.types),e.setVerified(t.isVerified),e.setMinZoom(t.minZoom),e.setMaxZoom(t.maxZoom),e.setStartDate(t.startDate),e.setEndDate(t.endDate),e.setObjName(t.model.objName),e.setTextureName(t.model.textureName),e.setBuildingType(n.getBuildingType(t.model)),e.getBuildingType()==Q.Polygon){for(var i=m.convertToMeterFromLatLng(e.getLocation()),o=[],r=[],a=0;a<t.model.coordinates.length;++a){var s=t.model.coordinates[a],h=m.convertToMeterFromLatLng(l.convert(s));r.push(new x(h.x-i.x,i.y-h.y))}o.push(r);var c=ot.extrudePolygon(o,1);n.buildingResourceManager.addBuildingWithData(t.id,e,c.vertices,c.indices)}else n.buildingResourceManager.addBuilding(t.id,e)}})},t.prototype.getBuildingType=function(t){var e=t.type;return"Object"==e?"boxtexture.png"==t.textureName?Q.Color:Q.Texture:"Polygon"==e?Q.Polygon:void 0},t}(),at=function(){function t(){}return Object.defineProperty(t,"isWorker",{get:function(){try{return!window.document}catch(t){return!0}},enumerable:!0,configurable:!0}),t}(),st=function(){function t(t){this.maxTask=3,this.numberOfRunningTask=0,this.worker=t}return t.prototype.finishedTask=function(){this.numberOfRunningTask-=1},t.prototype.canExecuteTask=function(){return this.numberOfRunningTask<this.maxTask},t.prototype.executeTask=function(t){if(this.canExecuteTask()){var e={execute:!0,payload:JSON.stringify(t)};this.worker.postMessage(e),this.numberOfRunningTask+=1}},t.prototype.cancel=function(t){var e={execute:!1,payload:JSON.stringify(t)};this.worker.postMessage(e),this.numberOfRunningTask=Math.min(this.numberOfRunningTask-1,0)},t}(),ut=function(){return function(){this.numberOfVertices=0,this.data=[]}}(),lt=function(){function t(){}return t.loadModel=function(t){for(var e=t.split("\n").map(function(t){return t.trim().toLowerCase().split(" ").filter(function(t){return""!==t})}),n=[new u],i=[new u],o=[new f],r=[],a=null,s=0,l=e;s<l.length;s++){var h=l[s],c=h[0];if("v"==c){var p=+h[1]||0,d=+h[2]||0,g=+h[3]||0;n.push(new u(p,d,g))}else if("vn"==c){p=+h[1]||0,d=+h[2]||0,g=+h[3]||0;i.push(new u(p,d,g))}else if("vt"==c){p=+h[1]||0,d=+h[2]||0;o.push(new f(p,d))}else if("f"==c)for(var m=0;m<3;m++){var y=h[m+1].split("/"),v=n[+y[0]||0],x=o[+y[1]||0],A=i[+y[2]||0];a||(a=new ut,r.push(a)),a.data.push(v.x),a.data.push(v.y),a.data.push(v.z),a.data.push(x.x),a.data.push(x.y),a.data.push(A.x),a.data.push(A.y),a.data.push(A.z),a.numberOfVertices++}}return r},t}(),ht=function(){function t(t){this.id=t}return t.prototype.abort=function(){null!=this.request&&this.request.abort()},t}(),ct=function(){function t(){}return t.createWorker=function(t){var e=this.workerUrl,n=new Worker(e),i=new st(n);return n.onmessage=function(e){var n=e.data;i.finishedTask(),t(n)},i},Object.defineProperty(t,"workerUrl",{get:function(){for(var t=document.getElementsByTagName("script"),e=[],n=0;n<t.length;++n){var i=t[n];i.src.indexOf("map4dsdk@")>-1&&e.push(i.src)}var o="importScripts("+e.map(function(t){return'"'+t+'"'}).join(",")+");",r=new Blob([o],{type:"application/javascript"});return window.URL.createObjectURL(r)},enumerable:!0,configurable:!0}),t.setupWorkerThread=function(){var t=this;self.onmessage=function(e){var n=e.data;n.execute?t.execute(JSON.parse(n.payload)):t.cancel(JSON.parse(n.payload))}},t.execute=function(t){var e=new ht(t.id);if(this.executeTasks.push(e),t.type==H.Texture){var n=new XMLHttpRequest;return n.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE){var e=new K(t.id);200==n.status&&(e.success=!0,e.data=this.response),postMessage(e)}},n.open("GET",t.url),n.responseType="blob",n.send(),void(e.request=n)}if(t.type==H.Model){var i=new XMLHttpRequest;return i.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE){var e=new K(t.id);200==i.status&&(e.success=!0,e.data=lt.loadModel(this.responseText)),postMessage(e)}},i.open("GET",t.url),i.send(),void(e.request=i)}var o=new XMLHttpRequest;o.onreadystatechange=function(){if(o.readyState==XMLHttpRequest.DONE){var e=new K(t.id);200==o.status&&(e.success=!0,e.data=JSON.parse(o.responseText)),postMessage(e)}},o.open(t.method,t.url,!0),null!=t.params&&o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","application/json"),o.send(t.params),e.request=o},t.cancel=function(t){var e=this.removeTask(t.id);null!=e&&e.abort()},t.removeTask=function(t){var e=this.executeTasks.findIndex(function(e){return e.id==t});if(e>=0){var n=this.executeTasks[e];return this.executeTasks.splice(e,1),n}return null},t.executeTasks=[],t}();at.isWorker&&ct.setupWorkerThread();var pt,ft=function(){function t(){var t=this;this.maxConcurrentRequest=5,this.maxWorker=3,this.workers=[],this.pendingTasks=[],this.activedTasks=[];for(var e=0;e<this.maxWorker;++e){var n=ct.createWorker(function(e){t.onCompletionTask(e)});this.workers.push(n)}for(e=0;e<H.MAX;e++)this.pendingTasks.push([])}return t.prototype.postTask=function(t){this.pendingTasks[t.type].unshift(t),this.executeTasks()},t.prototype.executeTasks=function(){if(!(this.activedTasks.length>this.maxConcurrentRequest))for(var t=0,e=this.workers;t<e.length;t++){var n=e[t];if(n.canExecuteTask()&&this.hasTask()){var i=this.getTask();this.activedTasks.push(i),i.worker=n,n.executeTask(i)}}},t.prototype.hasTask=function(){for(var t=0;t<H.MAX;t++)if(this.pendingTasks[t].length>0)return!0;return!1},t.prototype.getTask=function(){for(var t=0;t<H.MAX;t++)if(this.pendingTasks[t].length>0)return this.pendingTasks[t].pop();return null},t.prototype.cancelTask=function(t){var e=this.removeTask(t.id);null!=e&&(e.worker&&e.worker.cancel(e),e.completion&&e.completion(new K(t.id)))},t.prototype.onCompletionTask=function(t){var e=this.activedTasks.findIndex(function(e){return e.id==t.id});if(!(e<0)){var n=this.activedTasks[e];this.activedTasks.splice(e,1),n.completion&&n.completion(t),this.executeTasks()}},t.prototype.removeTask=function(t){for(var e=0;e<H.MAX;e++){var n=this.pendingTasks[e].findIndex(function(e){return e.id==t});if(n>=0){var i=this.pendingTasks[e][n];return this.pendingTasks[e].splice(n,1),i}}var o=this.activedTasks.findIndex(function(e){return e.id==t});if(o>=0){i=this.activedTasks[o];return this.activedTasks.splice(o,1),i}return null},t}(),dt=n(3),gt=n.n(dt);!function(t){t[t.RASTER=0]="RASTER",t[t.BUILDING=1]="BUILDING",t[t.ANNOTATION=2]="ANNOTATION",t[t.LINE=3]="LINE",t[t.FILL=4]="FILL",t[t.CIRCLE=5]="CIRCLE"}(pt||(pt={}));var mt=function(){function t(t,e){void 0===e&&(e=0),this.id=t,this.order=e}return t.prototype.equal=function(t){return this.id==t.id},t.prototype.lessThan=function(t){return this.order==t.order?this.id<t.id:this.order<t.order},t}();function yt(t,e){return t.order==e.order?t.id==e.id?0:t.id>e.id:t.order>e.order}var vt,xt,At=function(){function t(t,e,n,i){this.layerId=new mt(t,e),this.layerType=n,this.tileManager=i}return t.prototype.getOrder=function(){return this.layerId.order},t.prototype.getLayerId=function(){return this.layerId.id},t.prototype.getLayerType=function(){return this.layerType},t}(),Mt=function(){return function(t,e,n,i,o){void 0===i&&(i=0),void 0===o&&(o=0),this.name=t,this.buffer=e,this.size=n,this.offset=i,this.stride=o}}(),Tt=function(){return function(t,e,n){this.name=t,this.type=e,this.value=n}}(),wt=function(){function t(t,e,n){this.gl=t,this.textureUnit=0,this.uniforms={},this.attributes={},this.program=t.createProgram(),this.fragmentShader=this.loadShader(t.FRAGMENT_SHADER,n),this.vertexShader=this.loadShader(t.VERTEX_SHADER,e),t.attachShader(this.program,this.vertexShader),t.attachShader(this.program,this.fragmentShader),t.linkProgram(this.program),t.getProgramParameter(this.program,t.LINK_STATUS)||(console.log("Error linking shader program"),console.log(t.getProgramInfoLog(this.program))),this.loadAttributes(),this.loadUniforms()}return t.prototype.loadAttributes=function(){for(var t=this.gl,e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),n=0;n<e;++n){var i=t.getActiveAttrib(this.program,n).name;this.attributes[i]=t.getAttribLocation(this.program,i)}},t.prototype.loadUniforms=function(){for(var t=this.gl,e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),n=0;n<e;++n){var i=t.getActiveUniform(this.program,n).name;this.uniforms[i]=t.getUniformLocation(this.program,i)}},t.prototype.loadShader=function(t,e){var n=this.gl,i=n.createShader(t);return n.shaderSource(i,e),n.compileShader(i),n.getShaderParameter(i,n.COMPILE_STATUS)||(console.log("Error loading shader"),console.log(e),console.log(n.getShaderInfoLog(i))),i},t.prototype.bind=function(){this.gl.useProgram(this.program),this.resetTextureUnit()},t.prototype.resetTextureUnit=function(){this.textureUnit=0},t.prototype.setAttributes=function(t){for(var e=this.gl,n=null,i=0,o=t;i<o.length;i++){var r=o[i],a=this.attributes[r.name];r.buffer!=n&&(n=r.buffer,e.bindBuffer(e.ARRAY_BUFFER,n)),null!=a&&(e.enableVertexAttribArray(a),e.vertexAttribPointer(a,r.size,e.FLOAT,!1,4*r.stride,4*r.offset))}},t.prototype.setUniforms=function(t){for(var e=this.gl,n=0,i=t;n<i.length;n++){var o=i[n],r=this.uniforms[o.name];if(null!==r)if("matrix"==o.type)e.uniformMatrix4fv(r,!1,new Float32Array(o.value.buffer()));else if("texture"==o.type)e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_2D,o.value.textureId),e.uniform1i(r,this.textureUnit),this.textureUnit+=1;else if("textureCube"==o.type)e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_CUBE_MAP,o.value.textureId),e.uniform1i(r,this.textureUnit),this.textureUnit+=1;else if("3f"==o.type)e.uniform3f(r,o.value.x,o.value.y,o.value.z);else{e["uniform"+o.type](r,o.value)}}},t.prototype.disableAttributes=function(){for(var t in this.attributes)this.gl.disableVertexAttribArray(this.attributes[t])},t.prototype.destroy=function(){this.uniforms={},this.attributes={},this.gl.deleteProgram(this.program),this.gl.deleteShader(this.vertexShader),this.gl.deleteShader(this.fragmentShader)},t}(),bt=function(){function t(t,e,n,i,o,r){if(void 0===n&&(n=null),void 0===i&&(i=null),void 0===o&&(o=null),this.gl=t,this.type=e,this.attributeInfos=[],this.uniformInfos=[],n){this.vertices=n.length;for(var a=[],s=0,u=n;s<u.length;s++)for(var l=u[s],h=0,c=i;h<c.length;h++)for(var p=0,f=l[v=c[h]];p<f.length;p++){var d=f[p];a.push(d)}this.buffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(a),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null);for(var g=n[0],m=0,y=0;y<i.length;++y){var v=i[y],x=o[y],A=g[v].length,M=new Mt(x,this.buffer,A,m,0);this.attributeInfos.push(M),m+=A}for(var T=0,w=this.attributeInfos;T<w.length;T++){(M=w[T]).stride=m}null!=r&&this.setIndices(r)}}return t.prototype.init=function(t,e,n){var i=this;if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null),null!=this.gl&&null!=t&&null!=n&&null!=e){this.type=this.gl.TRIANGLES;var o=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,o),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.setIndices(n),this.buffer=o,this.vertices=n.length,e.forEach(function(t){return t.buffer=i.buffer}),this.attributeInfos=e}else console.log("GL or data or dicies is missing")},t.prototype.initBuilding=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),null!=this.gl){this.type=this.gl.TRIANGLES;var n=this.gl.createBuffer();if(null!=t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.buffer=n;null!=e?this.setIndices(e):this.vertices=t.length/8,this.attributeInfos=[new Mt("a_position",n,3,0,8),new Mt("a_uv",n,2,3,8),new Mt("a_normal",n,3,5,8)]}else console.log("Vertices size can not be null")}else console.log("init model Building no data")},t.prototype.setIndices=function(t){if(t){var e=this.gl;this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Int16Array(t),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.vertices=t.length}},t.tileModel=function(e){var n=new t(e,e.TRIANGLES),i=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),n.vertices=6,n.buffer=i,n.attributeInfos=[new Mt("a_position",i,3,0,5),new Mt("a_uv",i,2,3,5)],n},t.markerModel=function(e){var n=new t(e,e.TRIANGLES),i=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1]),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null),n.vertices=6,n.buffer=i,n.attributeInfos=[new Mt("a_position",i,3,0,5),new Mt("a_uv",i,2,3,5)],n},t.prototype.render=function(){var t=this.gl;this.indexBuffer?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(this.type||t.TRIANGLES,this.vertices,t.UNSIGNED_SHORT,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindBuffer(t.ARRAY_BUFFER,null)):this.vertices>0&&(t.drawArrays(this.type||t.TRIANGLES,0,this.vertices),t.bindBuffer(t.ARRAY_BUFFER,null))},t.prototype.setUniform=function(t){this.uniformInfos.push(t)},t.prototype.destroy=function(){this.buffer&&(this.gl.deleteBuffer(this.buffer),this.buffer=null),this.indexBuffer&&(this.gl.deleteBuffer(this.indexBuffer),this.indexBuffer=null),this.attributeInfos=[],this.uniformInfos=[]},t}(),_t=function(){function t(){}return t.basicVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n\tgl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n\tv_uv = a_uv;\n}\n   ",t.basicFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}  \n  ",t.polylineVS="\nattribute vec2 a_position;\nattribute vec2 a_extrude;\n\nuniform float u_lineWidth;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n\tvec2 delta = (u_lineWidth / 2.0) * a_extrude;\n\n\tgl_Position = u_mvpMatrix * vec4(a_position + delta, 0.0, 1.0);\n}\n  ",t.polylineFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}  \n  ",t.fillVS="\nattribute vec2 a_position;\n\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n\tgl_Position = u_mvpMatrix * vec4(a_position, 0.0, 1.0);\n}\n  ",t.fillFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n  ",t.circleVS="\nattribute vec2 a_extrude;\n\nuniform float u_radius;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(u_radius * a_extrude, 0.0, 1.0);\n}\n  ",t.circleFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n  ",t.markerVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n\tgl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n\tv_uv = a_uv;\n}\n  ",t.markerFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n  ",t.buildingVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\nattribute vec3 a_normal;\n\nuniform mat4 u_modelMatrix;\nuniform mat4 u_mvpMatrix;\nuniform vec3 u_cameraPosition;\n\nvarying vec2 v_uv;\nvarying vec3 v_normal;\nvarying vec3 v_toEye;\n\nvoid main() {\n    gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n    v_uv = a_uv;\n    // Convert normal vector to world space (make sure that we don't translate it)\n    v_normal = normalize(vec3((u_modelMatrix * vec4(a_normal, 0.0)).xyz));\n    // Calculate eye vector\n    v_toEye =  normalize(u_cameraPosition - (u_modelMatrix * vec4(a_position, 1.0)).xyz);\n}\n  ",t.buildingFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform vec3 u_light_position;\nuniform vec3 u_light_color;\n\nvarying vec3 v_toEye;\nvarying vec2 v_uv;\nvarying vec3 v_normal;\n\nconst vec4 fogColor = vec4(1.0);\n\nvoid main() {\n    // initialize\n    float ambientCoefficient  = 0.5;\n    \n    vec3 normal = normalize(v_normal);\n    vec4 materialColor = texture2D(u_texture, v_uv);\n    vec3 light = normalize(u_light_position);\n\n    // diffuse\n    float diffuseCoefficient = max(0.0, dot(normal, light));\n    vec3 diffuse = diffuseCoefficient * materialColor.rgb * u_light_color;\n    // ambient\n    vec3 ambient = ambientCoefficient * materialColor.rgb;\n    vec3 linearColor = ambient + diffuse;\n    gl_FragColor = vec4(mix(materialColor.rgb, linearColor, 0.2), materialColor.a); \n    if (gl_FragColor.a < 0.3) {\n      discard;\n    }\n}\n  ",t.buildingSelectionVS="\nattribute vec3 a_position;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n    gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n}\n  ",t.buildingSelectionFS="\nprecision mediump float;\nuniform vec3 u_color;\n\nvoid main() {\n    gl_FragColor = vec4(u_color, 1.0);\n}\n  ",t.debugSelectionVS="\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n    \n    varying vec2 v_uv;\n    \n    void main() {\n      gl_Position = vec4(a_position, 1.0);\n      v_uv = a_uv;\n    }\n  ",t.debugSelectionFS="\n    precision mediump float;\n    \n    uniform sampler2D u_texture;\n    varying vec2 v_uv;\n    \n    void main() {\n        gl_FragColor = texture2D(u_texture, vec2(v_uv.x , 1.0 - v_uv.y));\n    }\n\n  ",t}();!function(t){t[t.Butt=0]="Butt",t[t.Square=1]="Square",t[t.Round=2]="Round"}(vt||(vt={})),function(t){t[t.Miter=0]="Miter",t[t.Bevel=1]="Bevel",t[t.Round=2]="Round"}(xt||(xt={}));var St=function(){return function(t){void 0===t&&(t=function(t){}),this.indices=[],this.addVertex=t}}();var Et=function(){return function(t){void 0===t&&(t=function(t){}),this.indices=[],this.addVertex=t}}();function Ct(t,e){var n=[],i=[];t.forEach(function(t,o){0!=o&&i.push(n.length/2),t.forEach(function(t){n.push(t.x),n.push(t.y),e.addVertex(t)})}),e.indices=it()(n,i)}var Lt,Rt,It,Pt=function(){function t(t,e,n,i,o){void 0===t&&(t=function(t,e){}),void 0===e&&(e=vt.Butt),void 0===n&&(n=xt.Bevel),void 0===i&&(i=!1),void 0===o&&(o=3),this.indices=[],this.addVertex=t,this.lineCapType=e,this.lineJoinType=n,this.closedPolyline=i,this.miterLimit=o,this.numVertices=0}return t.prototype.buildPolyLine=function(t,e){void 0===e&&(e=null),this.buildPolyLineSegment(t,e)},t.prototype.clear=function(){this.indices=[],this.numVertices=0},t.prototype.buildPolyLineSegment=function(t,e){var n=this.closedPolyline?t.length+2:t.length,i=t.length,o=n-0;if(!(o<2)){var r,a,u,l=t[0],h=t[1];a=new f(h.y-l.y,l.x-h.x).normalize(),this.closedPolyline||this.addCap(l,a,!0),this.addPolyLineVertex(l,a),this.addPolyLineVertex(l,a.multiply(-1));for(var c=1;c<o-1;++c){if((l=h)!=(h=t[(c+0+1)%i])){r=a,a=new f(h.y-l.y,l.x-h.x).normalize();var p=1;0==(u=r.add(a)).x&&0==u.y?u=new f(r.y-a.y,a.x-r.x):p=2/u.dot(u),u=u.multiply(p);var d=this.lineJoinType==xt.Bevel;if(u.length>this.miterLimit&&(d=!0,u=u.multiply(this.miterLimit/u.length)),this.lineJoinType!=xt.Miter||d){var g=d||this.lineJoinType==xt.Bevel?1:s.numTrianglesOnRoundJoin;a.x*r.y-a.y*r.x>0?(this.addPolyLineVertex(l,u),this.addPolyLineVertex(l,r.multiply(-1)),this.addIndices(),this.addFan(l,r.multiply(-1),a.multiply(-1),u,g),this.addPolyLineVertex(l,u),this.addPolyLineVertex(l,a.multiply(-1))):(this.addPolyLineVertex(l,r),this.addPolyLineVertex(l,u.multiply(-1)),this.addIndices(),this.addFan(l,r,a,u.multiply(-1),g),this.addPolyLineVertex(l,a),this.addPolyLineVertex(l,u.multiply(-1)))}else this.addPolyLineVertex(l,u),this.addPolyLineVertex(l,u.multiply(-1)),this.addIndices()}}this.addPolyLineVertex(h,a),this.addPolyLineVertex(h,a.multiply(-1)),this.addIndices(),this.closedPolyline||this.addCap(h,a,!1),e&&e()}},t.prototype.addCap=function(t,e,n){switch(this.lineCapType){case vt.Butt:break;case vt.Square:var i=new f(-e.y,e.x);this.addPolyLineVertex(t,e.add(i)),this.addPolyLineVertex(t,e.multiply(-1).add(i)),n||this.addIndices();break;case vt.Round:var o=e,r=e.multiply(-1),a=new f(0,0);n&&(o=o.multiply(-1),r=r.multiply(-1)),this.addFan(t,o,r,a,s.numTrianglesOnRoundCap);break;default:console.log("Invalid line cap type")}},t.prototype.addPolyLineVertex=function(t,e){++this.numVertices,this.addVertex(t,e)},t.prototype.addIndices=function(){this.indices.push(this.numVertices-4),this.indices.push(this.numVertices-2),this.indices.push(this.numVertices-3),this.indices.push(this.numVertices-3),this.indices.push(this.numVertices-2),this.indices.push(this.numVertices-1)},t.prototype.addFan=function(t,e,n,i,o){var r=e.x*n.y-e.y*n.x,a=Math.atan2(r,e.dot(n)),s=this.numVertices;this.addPolyLineVertex(t,i),this.addPolyLineVertex(t,e);for(var u=e,l=0;l<o;l++){var h=(l+1)/o;u=e.rotateByRadian(a*h),this.addPolyLineVertex(t,u),this.indices.push(s),this.indices.push(s+l+(a>0?1:2)),this.indices.push(s+l+(a>0?2:1))}},t}(),Ot=function(){return function(t,e){this.min=t,this.mag=e}}(),Dt=function(){return function(t,e){this.wraps=t,this.wrapt=e}}(),Bt=function(){return function(t,e,n,i,o,r){this.target=t,this.internalFormat=e,this.format=n,this.type=i,this.filtering=o,this.wrapping=r}}(),kt=function(){function t(t,e){void 0===e&&(e=null),this.gl=t,this.options=e,null==e&&this.initDefault()}return t.prototype.initDefault=function(){var t=this.gl;this.textureId=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.textureId);var e=new Uint8Array([255,255,255,255]);t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null)},t.prototype.initWithSize=function(t,e){var n=this.gl;this.width=t,this.height=e,this.textureId=n.createTexture(),n.bindTexture(this.options.target,this.textureId),this.setTextureParameter(this.gl.TEXTURE_MAG_FILTER,this.options.filtering.mag),this.setTextureParameter(this.gl.TEXTURE_MIN_FILTER,this.options.filtering.min),this.setTextureParameter(this.gl.TEXTURE_WRAP_S,this.options.wrapping.wraps),this.setTextureParameter(this.gl.TEXTURE_WRAP_T,this.options.wrapping.wrapt),n.texImage2D(this.options.target,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,null),n.bindTexture(n.TEXTURE_2D,null)},t.prototype.bind=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.textureId)},t.prototype.unbind=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,null)},t.prototype.loadImage=function(t,e){var n=this;void 0===e&&(e=null);var i=this.gl,o=new Image;o.src="data:image;base64,"+t,o.onload=function(){null!=n.textureId&&(i.bindTexture(i.TEXTURE_2D,n.textureId),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,o),i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null)),n.width=o.width,n.height=o.height,e&&e()}},t.prototype.loadImageFromBlob=function(t,e){var n=this;void 0===e&&(e=null);var i=this.gl,o=new Image;o.crossOrigin="*";var r=window.URL.createObjectURL(t);o.src=r,o.onload=function(){null!=n.textureId&&(i.bindTexture(i.TEXTURE_2D,n.textureId),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,o),i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null)),n.width=o.width,n.height=o.height,e&&e(),window.URL.revokeObjectURL(r)}},t.prototype.loadImageFromUrl=function(t,e){var n=this;void 0===e&&(e=null);var i=this.gl,o=new Image;o.crossOrigin="*",o.src=t,o.onload=function(){null!=n.textureId&&(i.bindTexture(i.TEXTURE_2D,n.textureId),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,o),i.generateMipmap(i.TEXTURE_2D),i.bindTexture(i.TEXTURE_2D,null)),n.width=o.width,n.height=o.height,e&&e()}},t.prototype.setFilter=function(t){var e=this.gl;e.bindTexture(e.TEXTURE_2D,this.textureId),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),e.bindTexture(e.TEXTURE_2D,null)},t.prototype.destroy=function(){this.textureId&&(this.gl.deleteTexture(this.textureId),this.textureId=null)},t.prototype.setTextureParameter=function(t,e){null!=t&&this.gl.texParameteri(this.options.target,t,e)},t}();!function(t){t[t.MARKER_SHADER=0]="MARKER_SHADER",t[t.POLYLINE_SHADER=1]="POLYLINE_SHADER",t[t.FILL_SHADER=2]="FILL_SHADER",t[t.RASTER_SHADER=3]="RASTER_SHADER",t[t.CIRCLE_SHADER=4]="CIRCLE_SHADER",t[t.BUILDING_SHADER=5]="BUILDING_SHADER",t[t.BUILDING_SELECTION_SHARDER=6]="BUILDING_SELECTION_SHARDER",t[t.DEBUG_SELECTION_SHARDER=7]="DEBUG_SELECTION_SHARDER"}(Lt||(Lt={})),function(t){t[t.MARKER_MODEL=0]="MARKER_MODEL",t[t.RASTER_MODEL=1]="RASTER_MODEL",t[t.CIRCLE_MODEL=2]="CIRCLE_MODEL",t[t.POLYLINE_SHADER=3]="POLYLINE_SHADER",t[t.BUILDING_MODEL=4]="BUILDING_MODEL",t[t.SELECTION_DEBUG_MODEL=5]="SELECTION_DEBUG_MODEL"}(Rt||(Rt={})),function(t){t[t.WHITE_TEXTURE=0]="WHITE_TEXTURE"}(It||(It={}));var Zt,Nt=function(){function t(){this.initialized=!1,this.shaders=new Map,this.models=new Map,this.textures=new Map}return Object.defineProperty(t,"Instance",{get:function(){return this.instance||(this.instance=new this)},enumerable:!0,configurable:!0}),t.prototype.createShader=function(t,e){return new wt(this.gl,t,e)},t.prototype.createModel=function(t){var e=this.gl,n=new bt(e,e.TRIANGLES),i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);var o=[new Mt("a_position",i,3,0,5),new Mt("a_uv",i,2,3,5)];return n.vertices=6,n.buffer=i,n.attributeInfos=o,n},t.prototype.init=function(t){if(this.gl=t,!this.initialized){this.initialized=!0,this.shaders.set(Lt.RASTER_SHADER,this.createShader(_t.basicVS,_t.basicFS)),this.shaders.set(Lt.MARKER_SHADER,this.createShader(_t.markerVS,_t.markerFS)),this.shaders.set(Lt.POLYLINE_SHADER,this.createShader(_t.polylineVS,_t.polylineFS)),this.shaders.set(Lt.FILL_SHADER,this.createShader(_t.fillVS,_t.fillFS)),this.shaders.set(Lt.CIRCLE_SHADER,this.createShader(_t.circleVS,_t.circleFS)),this.shaders.set(Lt.BUILDING_SHADER,this.createShader(_t.buildingVS,_t.buildingFS)),this.shaders.set(Lt.BUILDING_SELECTION_SHARDER,this.createShader(_t.buildingSelectionVS,_t.buildingSelectionFS)),this.shaders.set(Lt.DEBUG_SELECTION_SHARDER,this.createShader(_t.debugSelectionVS,_t.debugSelectionFS));var e=[],n=new St;n.addVertex=function(t){e.push(t.x,t.y)},function(t){var e=s.numTrianglesPerCircle,n=2*Math.PI;t.addVertex(new f(0,0));for(var i=0;i<e;++i)t.addVertex(new f(Math.cos(i*n/e),Math.sin(i*n/e)).normalize()),0!=i&&(t.indices.push(0),t.indices.push(0+i),t.indices.push(0+i+1));t.indices.push(0),t.indices.push(e),t.indices.push(1)}(n);var i=new bt(this.gl,this.gl.TRIANGLES);i.init(e,[new Mt("a_extrude",null,2,0,2)],n.indices),this.models.set(Rt.RASTER_MODEL,this.createModel([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1])),this.models.set(Rt.MARKER_MODEL,this.createModel([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1])),this.models.set(Rt.CIRCLE_MODEL,i),this.models.set(Rt.SELECTION_DEBUG_MODEL,this.createModel([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1]));var o=new kt(this.gl);this.textures.set(It.WHITE_TEXTURE,o)}},t.prototype.getShader=function(t){return this.shaders.get(t)},t.prototype.getModel=function(t){return this.models.get(t)},t.prototype.getTexture=function(t){return this.textures.get(t)},t.instance=null,t}();!function(t){t[t.RASTER=0]="RASTER",t[t.ANNOTAION=1]="ANNOTAION"}(Zt||(Zt={}));var Ut,Ft=function(){function t(t,e,n){this.renderable=!1,this.kind=t,this.tileCoordinate=e,this.gl=n}return t.prototype.isRenderable=function(){return this.renderable},t.prototype.getKind=function(){return this.kind},t.prototype.getTileCoordinate=function(){return this.tileCoordinate},t}(),Vt=function(){function t(t,e){this.mapState=t,this.layer=e,this.selectionCode=0}return t.prototype.renderSelection=function(){},t.prototype.getRenderTiles=function(){return this.layer.tileManager.getRenderTiles()},t.prototype.getVisibleTiles=function(){return this.layer.tileManager.getVisibleTiles()},t.prototype.getSelectionCode=function(){return this.selectionCode++,(this.selectionCode<t.MIN_SELECTION_CODE||this.selectionCode>t.MAX_SELECTION_CODE)&&(this.selectionCode=t.MIN_SELECTION_CODE),this.selectionCode},t.prototype.resetSelectionCode=function(){this.selectionCode=0},t.MIN_SELECTION_CODE=1,t.MAX_SELECTION_CODE=16777215,t}(),zt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),jt=function(t){function e(e,n){return t.call(this,e,n)||this}return zt(e,t),e.prototype.render=function(){var t=this,e=Nt.Instance.getShader(Lt.RASTER_SHADER),n=Nt.Instance.getModel(Rt.RASTER_MODEL);this.getRenderTiles().forEach(function(i){var o=i.getTile();if(o.getKind()==Zt.RASTER){var r=t.mapState.getViewProjectionMatrix(),a=t.mapState.matrixFor(i.getUnwrappedTileCoordinate()).concat(r);e.bind(),e.setAttributes(n.attributeInfos);var s=o.getTexture();e.setUniforms([new Tt("u_texture","texture",s),new Tt("u_mvpMatrix","matrix",a)]),n.render()}else console.log("Tile is not raster tile")})},e}(Vt),Yt=function(){return function(){}}();!function(t){t[t.MARKER=0]="MARKER"}(Ut||(Ut={}));var Xt=function(){function t(t){this.shapeType=t}return t.prototype.update=function(t){},t.prototype.getShapeType=function(){return this.shapeType},t}(),Ht=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Gt=function(t){function e(e){var n=t.call(this)||this;return n.gl=e,n}return Ht(e,t),e.prototype.render=function(t,e){var n=Nt.Instance.getShader(Lt.MARKER_SHADER),i=Nt.Instance.getModel(Rt.MARKER_MODEL);if(t.getShapeType()==Ut.MARKER){var o=t;if(o.isVisible()){o.hasTexture()||o.initTexture(this.url),n.bind(),n.setAttributes(i.attributeInfos);var r=o.getTexture(),a=o.getWidth(),s=o.getHeight(),u=v.latLngToScreenCoordinate(o.getPosition(),o.getElevation(),e),l=k.translate(u.x,u.y,0),h=o.getAnchor();l=k.translate((.5-h.x)*a,(.5-h.y)*s,0).concat(l);var c=(l=k.scale(a/2,s/2,1).concat(l)).concat(e.getViewOrthoProjectionMatrix());n.setUniforms([new Tt("u_mvpMatrix","matrix",c),new Tt("u_texture","texture",r)]),i.render()}}else console.warn("Shape is not MARKER ...")},e.prototype.enableBlend=function(){this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)},e.prototype.disableBlend=function(){this.gl.disable(this.gl.BLEND)},e}(Yt),Wt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Qt=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.mapState=e,i.layer=n,i.markerRenderer=new Gt(i.layer.tileManager.mapView.gl),i}return Wt(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==pt.ANNOTATION){var e=this.layer,n=e.markerAnnotations;n.size>0&&(this.markerRenderer.enableBlend(),n.forEach(function(t){switch(t.getShapeType()){case Ut.MARKER:}}),e.getVisibleMarkers().forEach(function(e){return t.markerRenderer.render(e,t.mapState)}),this.markerRenderer.disableBlend())}},e}(Vt),qt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Kt=function(t){function e(e,n){return t.call(this,e,n)||this}return qt(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==pt.LINE){var e=this.layer;if(0!=e.renderTiles.size&&e.isVisible()){var n=Nt.Instance.getShader(Lt.POLYLINE_SHADER),i=this.layer.tileManager.mapView.gl;i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),n.bind();var o=m.worldSize(this.mapState.getScale()),r=this.layer.getLayerId();e.renderTiles.forEach(function(i){var a=i.getTile();if(a.getKind()==Zt.ANNOTAION){var s=a;if(s.hasData(r)){var u=s.getLayerData(r,pt.LINE);if(u.getType()==pt.LINE){var l=u.getModel();n.setAttributes(l.attributeInfos);var h=s.getTileCoordinate(),c=1<<h.getZoom(),p=o/c,d=p/g.getTileSize(),m=v.pixelCoordinateToCameraCoordinate(new f(h.getX()*p+p/2,h.getY()*p+p/2),t.mapState),y=k.translate(m.x,m.y,0);y=k.scale(d,d,1).concat(y),n.setUniforms([new Tt("u_lineWidth","1f",e.getStrokeWidth()),new Tt("u_color","4fv",e.getStrokeColor().buffer()),new Tt("u_mvpMatrix","matrix",y.concat(t.mapState.getViewProjectionMatrix()))]),l.render()}else console.warn("ERROR: layerData.getType() != LayerType.LINE .............")}}else console.warn("ERROR: tile.getKind() != Kind.ANNOTAION .............")})}}},e}(Vt),Jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),$t=function(t){function e(e,n){return t.call(this,e,n)||this}return Jt(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==pt.FILL){var e=this.layer;if(0!=e.renderTiles.size&&e.visible){var n=Nt.Instance.getShader(Lt.FILL_SHADER),i=this.layer.tileManager.mapView.gl;i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),n.bind();var o=m.worldSize(this.mapState.getScale()),r=this.layer.getLayerId();e.renderTiles.forEach(function(i){var a=i.getTile();if(a.getKind()==Zt.ANNOTAION){var s=a;if(s.hasData(r)){var u=s.getLayerData(r,pt.FILL);if(u.getType()==pt.FILL){var l=u.getModel();n.setAttributes(l.attributeInfos);var h=s.getTileCoordinate(),c=1<<h.getZoom(),p=o/c,d=p/g.getTileSize(),m=v.pixelCoordinateToCameraCoordinate(new f(h.getX()*p+p/2,h.getY()*p+p/2),t.mapState),y=k.translate(m.x,m.y,0);y=k.scale(d,d,1).concat(y),n.setUniforms([new Tt("u_color","4fv",e.fillColor.buffer()),new Tt("u_mvpMatrix","matrix",y.concat(t.mapState.getViewProjectionMatrix()))]),l.render()}else console.warn("ERROR: layerData.getType() != LayerType.FILL .............")}}else console.warn("ERROR: tile.getKind() != Kind.Annotation.............")})}}else console.log("Invalid layer type")},e}(Vt),te=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ee=function(t){function e(e,n){return t.call(this,e,n)||this}return te(e,t),e.prototype.render=function(){if(this.layer.getLayerType()==pt.CIRCLE){var t=this.layer;if(0!=t.renderTiles.size&&t.visible){var e=Nt.Instance.getShader(Lt.CIRCLE_SHADER),n=this.layer.tileManager.mapView.gl;n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),e.bind();var i=Nt.Instance.getModel(Rt.CIRCLE_MODEL),o=this.mapState.cameraPosition.getTarget(),r=m.getMetersPerPixelAtLatitude(o.lat(),this.mapState.getZoom()),a=t.radius/r,s=v.pixelCoordinateToCameraCoordinate(m.projectScale(t.center,this.mapState.scale),this.mapState),u=k.translate(s.x,s.y,0);e.setUniforms([new Tt("u_color","4fv",t.fillColor.buffer()),new Tt("u_radius","1f",a),new Tt("u_mvpMatrix","matrix",u.concat(this.mapState.getViewProjectionMatrix()))]),e.setAttributes(i.attributeInfos),i.render()}}else console.log("Invalid layer type")},e}(Vt),ne=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ie=function(t){function e(e,n,i){var o=t.call(this,n,i)||this;return o.gl=e,o}return ne(e,t),e.prototype.render=function(){if(this.mapState.is3dMode())if(this.layer.getLayerType()==pt.BUILDING){var t=this.layer;if(0!=t.colorBuildingGroups.size||0!=t.textureBuildingGroups.size||0!=t.extrudeBuildings.length){var e=Nt.Instance;this.gl.enable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.CULL_FACE);var n=e.getShader(Lt.BUILDING_SHADER);n.bind();var i=t.lightManager.sunLight;n.setUniforms([new Tt("u_light_position","3f",i.lightPosition),new Tt("u_light_color","3f",i.lightColor)]);var o=e.getTexture(It.WHITE_TEXTURE);if(0!=t.textureBuildingGroups.size&&t.textureBuildingGroups.forEach(function(t){var e=t.getModel();0!=e.attributeInfos.length&&(n.setAttributes(e.attributeInfos),t.buildings.forEach(function(t){var i=t.getTexture();null==i&&(i=o),n.setUniforms([new Tt("u_modelMatrix","matrix",t.getModelMatrix()),new Tt("u_mvpMatrix","matrix",t.getMvpMatrix()),new Tt("u_texture","texture",i)]),e.render(),n.resetTextureUnit()}))}),0!=t.colorBuildingGroups.size&&(n.setUniforms([new Tt("u_texture","texture",o)]),t.colorBuildingGroups.forEach(function(t){var e=t.getModel();0!=e.attributeInfos.length&&(n.setAttributes(e.attributeInfos),t.buildings.forEach(function(t){n.setUniforms([new Tt("u_modelMatrix","matrix",t.getModelMatrix()),new Tt("u_mvpMatrix","matrix",t.getMvpMatrix())]),e.render(),n.resetTextureUnit()}))})),0!=t.extrudeBuildings.length){n.setUniforms([new Tt("u_texture","texture",o)]);for(var r=0,a=t.extrudeBuildings;r<a.length;r++){var s=a[r],u=s.getModel();null!=u&&(n.setAttributes(u.attributeInfos),n.setUniforms([new Tt("u_modelMatrix","matrix",s.getModelMatrix()),new Tt("u_mvpMatrix","matrix",s.getMvpMatrix())]),u.render(),n.resetTextureUnit())}}this.gl.disable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.CULL_FACE),n.disableAttributes()}}else console.warn("This layer is not building !")},e.prototype.renderSelection=function(){var t=this;if(this.mapState.is3dMode())if(this.layer.getLayerType()==pt.BUILDING){var e=this.layer;if(0!=e.colorBuildingGroups.size||0!=e.textureBuildingGroups.size||0!=e.extrudeBuildings.length){var n=Nt.Instance;this.gl.enable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.CULL_FACE),this.gl.disable(this.gl.BLEND);var i=n.getShader(Lt.BUILDING_SELECTION_SHARDER);i.bind(),this.resetSelectionCode(),0!=e.textureBuildingGroups.size&&e.textureBuildingGroups.forEach(function(e){var n=e.getModel();0!=n.attributeInfos.length&&(i.setAttributes(n.attributeInfos),e.buildings.forEach(function(e){var o=t.getSelectionCode();e.setSelectionCode(o);var r=p.fromInt(o);i.setUniforms([new Tt("u_color","3f",new u(r.red,r.green,r.blue)),new Tt("u_mvpMatrix","matrix",e.getMvpMatrix())]),n.render(),i.resetTextureUnit()}))}),0!=e.colorBuildingGroups.size&&e.colorBuildingGroups.forEach(function(e){var n=e.getModel();0!=n.attributeInfos.length&&(i.setAttributes(n.attributeInfos),e.buildings.forEach(function(e){var o=t.getSelectionCode();e.setSelectionCode(o);var r=p.fromInt(o);i.setUniforms([new Tt("u_color","3f",new u(r.red,r.green,r.blue)),new Tt("u_mvpMatrix","matrix",e.getMvpMatrix())]),n.render(),i.resetTextureUnit()}))}),0!=e.extrudeBuildings.length&&e.extrudeBuildings.forEach(function(e){var n=e.getModel();i.setAttributes(n.attributeInfos);var o=t.getSelectionCode();e.setSelectionCode(o);var r=p.fromInt(o);i.setUniforms([new Tt("u_color","3f",new u(r.red,r.green,r.blue)),new Tt("u_mvpMatrix","matrix",e.getMvpMatrix())]),n.render(),i.resetTextureUnit()}),this.gl.disable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.CULL_FACE),i.disableAttributes()}}else console.warn("This layer is not building !")},e}(Vt),oe=function(){function t(){}return t.create=function(t,e,n){switch(n.getLayerType()){case pt.RASTER:return new jt(e,n);case pt.BUILDING:return new ie(t,e,n);case pt.ANNOTATION:return new Qt(e,n);case pt.LINE:return new Kt(e,n);case pt.FILL:return new $t(e,n);case pt.CIRCLE:return new ee(e,n);default:console.log("Invalid layer type")}},t}(),re=function(){function t(t,e){this.mapState=e,this.gl=t,this.layerRenderers=gt()(yt)}return t.prototype.render=function(){this.layerRenderers.forEach(function(t,e){e.render()})},t.prototype.renderSelection=function(){this.layerRenderers.forEach(function(t,e){e.renderSelection()})},t.prototype.addLayer=function(t){this.layerRenderers=this.layerRenderers.insert(new mt(t.getLayerId(),t.getOrder()),oe.create(this.gl,this.mapState,t))},t.prototype.removeLayer=function(t){var e=new mt(t,o.annotationLayerOrder);this.layerRenderers=this.layerRenderers.remove(e)},t}(),ae=function(){function t(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by}return t.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},t.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},t.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},t.prototype.solveCurveX=function(t,e){var n,i,o,r,a,s;for(o=t,s=0;s<8;++s){if(r=this.sampleCurveX(o)-t,Math.abs(r)<e)return o;if(a=this.sampleCurveDerivativeX(o),Math.abs(a)<1e-6)break;o-=r/a}if(i=1,(o=t)<(n=0))return n;if(o>i)return i;for(;n<i;){if(r=this.sampleCurveX(o),Math.abs(r-t)<e)return o;t>r?n=o:i=o,o=.5*(i-n)+n}return o},t.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))},t}(),se=function(){function t(t){this.dx=0,this.dy=0,this.timeConstant=t,this.initialSpeedRate=0,this.velocityRatioX=0,this.velocityRatioY=0}return t.prototype.getDisplacement=function(t,e,n){return t*e*-Math.expm1(-n/t)},t.prototype.getDuration=function(e,n){return-e*Math.log(t.minTrackSpeed/n)},t.prototype.startFling=function(e,n){(e=d.clamp(e,o.flingMinVelocity,o.flingMaxVelocity),n=d.clamp(n,o.flingMinVelocity,o.flingMaxVelocity),e*=t.secToMs,n*=t.secToMs,this.initialSpeedRate=Math.sqrt(e*e+n*n),this.initialSpeedRate<t.minTrackSpeed)?this.stopFling():(this.flingDuration=this.getDuration(this.timeConstant,this.initialSpeedRate),this.getDisplacement(this.timeConstant,this.initialSpeedRate,this.flingDuration)<t.minDisplacement?this.stopFling():(this.velocityRatioX=e/this.initialSpeedRate,this.velocityRatioY=n/this.initialSpeedRate,this.previousPositionX=0,this.previousPositionY=0,this.flingStart=Date.now()))},t.prototype.stopFling=function(){this.initialSpeedRate=0},t.prototype.isFlingInProgress=function(){return this.initialSpeedRate>0},t.prototype.trackMovement=function(){if(!this.isFlingInProgress())return!1;var t=Date.now()-this.flingStart;if(t>this.flingDuration)return this.stopFling(),!1;var e=this.getDisplacement(this.timeConstant,this.initialSpeedRate,t),n=e*this.velocityRatioX,i=e*this.velocityRatioY;return this.dx=n-this.previousPositionX,this.dy=i-this.previousPositionY,this.previousPositionX=n,this.previousPositionY=i,!0},t.secToMs=.001,t.minTrackSpeed=.01,t.minDisplacement=20,t}(),ue=function(){return function(){}}(),le=function(){return function(){this.anchor=null,this.target=null,this.zoom=null,this.tilt=null,this.bearing=null}}();var he,ce=function(t,e,n,i){var o=new ae(t,e,n,i);return function(t){return o.solve(t,r.epsilon)}}(0,0,.25,1),pe=function(){function t(t,e,n){this.onUpdateTransitions=null,this.mapState=t,this.cameraAnimationObserver=e,this.mapSettings=n,this.flingTracker=new se(o.flingTimeConstant)}return t.prototype.moveBy=function(t,e){void 0===e&&(e=null);var n=new le,i=this.mapState.getTarget(),r=m.getMetersPerPixelAtLatitude(o.metersPerPixelAtLatitude,this.mapState.getZoom()),a=new f(t.y,t.x).multiply(r);a=a.rotateBy(-this.mapState.cameraPosition.getBearing()),n.target=m.convertToLatLngFromMeter(m.convertToMeterFromLatLng(i).add(a)),null==e?e=new ue:null==e.duration&&(e.duration=g.getTimePanTo(this.mapState.getTarget(),n.target,this.mapState.getZoom())),this.mapState.movingTo=!0,this.easeTo(n,e)},t.prototype.moveTo=function(t,e,n){void 0===n&&(n=null),null==n&&(n=new ue);var i=new le;i.target=t,e>=this.mapSettings.getPreferMinZoom()&&(e=d.clamp(e,this.mapSettings.getPreferMinZoom(),this.mapSettings.getMaxZoom()),i.zoom=e),this.mapState.movingTo=!0,this.easeTo(i,n)},t.prototype.zoom=function(t,e,n){this.mapState.startedZoom=!0,this.flingTracker.stopFling(),n.duration||(n.duration=o.defaultAnimationDuration);var i=new le;i.zoom=t,i.anchor=e,this.easeTo(i,n)},t.prototype.isAnimated=function(){return this.mapState.panning||this.mapState.zoomIn||this.mapState.zoomOut||this.mapState.flyingTo},t.prototype.moveByVelocity=function(t){this.flingTracker.startFling(t.x,t.y)},t.prototype.setTilt=function(t){var e=new le,n=new ue;t=d.clamp(t,o.minTilt,o.maxTilt),e.tilt=t,this.mapState.tilting=!0,this.easeTo(e,n)},t.prototype.setBearing=function(t,e){var n=new le,i=new ue;n.bearing=t,e>0&&(i.duration=1e3*e),this.mapState.bearing=!0,this.easeTo(n,i)},t.prototype.easeTo=function(t,e){var n=this,i=this.mapState.getZoom(),a=null!=t.zoom?t.zoom:this.mapState.getZoom();a=Math.round(a);var s=this.mapState.getBearing(),u=this.mapState.getTilt(),h=this.mapState.getTarget(),c=t.bearing,p=t.tilt,f=null!=t.target?t.target:this.mapState.getTarget(),d=t.anchor,g=new l(0,0);d&&(g=v.screenCoordinateToLatLng(d,this.mapState)),this.mapState.zoomIn=a>i&&a-i>r.epsilon,this.mapState.zoomOut=i>a&&i-a>r.epsilon,this.mapState.panning=h!=f;this.startTransition(e,function(t){var e=i*(1-t)+a*t;if(null!=c){var r=s+(c-s)*t;n.mapState.setBearing(r)}if(p){var y=u+(p-u)*t;n.mapState.setTilt(y)}var x=h.lat()*(1-t)+f.lat()*t,A=h.lng()*(1-t)+f.lng()*t,M=new l(x,A);if(n.mapState.setZoom(e),n.mapState.setTarget(M),Math.round(n.mapState.getZoom())<=o.defaultMinZoom3d&&(n.mapState.isZoomIn()||n.mapState.isZoomOut())&&n.mapState.handleSwitchMode(),d){var T=Math.pow(2,e),w=m.projectScale(n.mapState.getTarget(),T),b=m.projectScale(g,T),_=m.projectScale(v.screenCoordinateToLatLng(d,n.mapState),Math.pow(2,e));n.mapState.setTarget(m.unproject(w.add(b).subtract(_),T))}})},t.prototype.startTransition=function(t,e){var n=this,i=t.duration?t.duration:0,o=t.easing?t.easing:ce,r=0!=i;this.transitionStart=Date.now(),this.transitionDuration=i,this.mapState.isWillChange()||(this.mapState.willChange=!0,this.cameraAnimationObserver.notifyCameraWillChange()),this.mapState.startedAnimation=!0,this.onUpdateTransitions=function(t){var i=r?(t-n.transitionStart)/n.transitionDuration:1;return e(i>=1?1:o(i)),n.cameraAnimationObserver.notifyCameraIsChanging(),!(i<1)},r||(this.updateTransitions(),this.onUpdateTransitions=null)},t.prototype.stopAnimation=function(){this.mapState.isBearing()&&(this.mapState.bearing=!1,this.onUpdateTransitions=null)},t.prototype.updateTransitions=function(){if(null!=this.onUpdateTransitions){var t=Date.now(),e=this.onUpdateTransitions;this.onUpdateTransitions=null,e&&e(t)?(this.mapState.zoomIn=!1,this.mapState.zoomOut=!1,this.mapState.panning=!1,this.mapState.flyingTo=!1,this.mapState.movingTo=!1,this.mapState.bearing=!1,this.mapState.tilting=!1,e=null,this.mapState.startedAnimation=!1,this.mapState.timeMoving=Date.now(),this.onUpdateTransitions=null):null==this.onUpdateTransitions&&((this.mapState.isZoomIn()||this.mapState.isZoomOut())&&(this.mapState.timeMoving=Date.now()),this.onUpdateTransitions=e)}else if(this.flingTracker.isFlingInProgress())this.flingTracker.trackMovement()&&this.moveBy(new x(this.flingTracker.dx,this.flingTracker.dy));else if(!this.mapState.startedAnimation&&this.mapState.willChange){var n=Date.now()-this.mapState.timeMoving;this.mapState.startedZoom?n>o.minTimeDoubleZoom&&(I.oldWheelMouseDy=0,this.mapState.willChange=!1,this.mapState.setZoom(Math.round(this.mapState.getZoom())),this.updateTransitions(),this.cameraAnimationObserver.notifyCameraDidChange()):n>o.minTimeMoving&&(this.mapState.willChange=!1,this.mapState.setZoom(Math.round(this.mapState.getZoom())),this.updateTransitions(),this.cameraAnimationObserver.notifyCameraDidChange(),I.oldWheelMouseDy=0)}},t.prototype.flyTo=function(t,e){var n=this;if(this.flingTracker.stopFling(),!this.isAnimated()){var i=this.mapState.getZoom(),a=t.target,s="zoom"in t?d.clamp(+t.zoom,this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()):i,u=this.mapState.getTarget(),l=m.projectScale(u,this.mapState.getScale()),h=m.projectScale(a,this.mapState.getScale()),c=Math.max(this.mapState.getScreenSize().x,this.mapState.getScreenSize().y),p=c/Math.pow(2,s-i),g=Math.hypot(h.x-l.x,h.y-l.y),y=1.42;if("minZoom"in e){var v=d.clamp(Math.min(e.minZoom,i,s),this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()),x=c/Math.pow(2,v-i);y=Math.sqrt(x/g*2)}var A=y*y,M=function(t){var e=(p*p-c*c+(t?-1:1)*A*A*g*g)/(2*(t?p:c)*A*g);return Math.log(Math.sqrt(e*e+1)-e)},T=M(0),w=function(t){return R(T)/R(T+y*t)},b=function(t){return c*(R(T)*function(t){return L(t)/R(t)}(T+y*t)-L(T))/A/g},_=(M(1)-T)/y;if(Math.abs(g)<r.epsilon||!isFinite(_)){if(Math.abs(c-p)<r.epsilon)return this.easeTo(t,e);var S=p<c?-1:1;_=Math.abs(Math.log(p/c))/y,b=function(){return 0},w=function(t){return Math.exp(S*y*t)}}if("duration"in e&&null!=e.duration)e.duration=+e.duration;else{var E="velocity"in e?+e.velocity/y:1.2;e.duration=1e3*_/E}e.duration>o.maxDurationFlyTo&&(e.duration=o.maxDurationFlyTo);var C=this.mapState.getScale();this.mapState.flyingTo=!0,this.startTransition(e,function(t){var e=t*_,a=1===t?1:b(e),u=new f(l.x*(1-a)+h.x*a,l.y*(1-a)+h.y*a),c=1/w(e),p=1===t?s:i+Math.log(c)/Math.LN2;p=d.clamp(p,n.mapSettings.getMinZoom(),n.mapSettings.getMaxZoom()),Math.abs(t-1)<r.epsilon&&(p=s),p!=p&&(p=s);var g=m.unproject(u,C);n.mapState.setZoom(p),n.mapState.setTarget(g),Math.round(n.mapState.getZoom())<=o.defaultMinZoom3d&&n.mapState.handleSwitchMode()})}function L(t){return(Math.exp(t)-Math.exp(-t))/2}function R(t){return(Math.exp(t)+Math.exp(-t))/2}},t}(),fe=n(2),de=n(0),ge=n.n(de);!function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon"}(he||(he={}));var me=function(){function t(t,e,n){this.properties=new Map,this.type=t,this.geometries=e,this.properties=n}return t.prototype.getType=function(){return this.type},t.prototype.getGeometries=function(){return this.geometries},t}(),ye=function(){function t(t){this.features=[],this.name=t}return t.prototype.featureCount=function(){return this.features.length},t.prototype.getFeature=function(t){return this.features[t]},t.prototype.getName=function(){return this.name},t}(),ve=function(){return function(){}}(),xe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ae=function(t){function e(e,n,i,o){var r=t.call(this,n,i,o)||this;return r._id=e,r}return xe(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),e}(me),Me=function(t){function e(e){return t.call(this,e)||this}return xe(e,t),e.prototype.addFeature=function(t,e,n,i){void 0===i&&(i=new Map),this.features.push(new Ae(t,e,n,i))},e}(ye),Te=function(t){function e(){var e=t.call(this)||this;return e.layerIds=[],e.layers=new Map,e}return xe(e,t),e.prototype.addLayer=function(t){return this.layers.has(t)||(this.layerIds.push(t),this.layers.set(t,new Me(t))),this.layers.get(t)},e.prototype.getLayerIds=function(){return this.layerIds},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e}(ve),we=function(){function t(t,e){this._id=t,this._layerId=cn.annotationLayerId+t.toString(),this._circleAnnotation=e,this.updateBounds()}return t.prototype.updateLayer=function(t){var e=t.getLayer(this._layerId);null==e&&(e=t.createLayer(this._layerId,pt.CIRCLE,o.annotationLayerOrder));var n=e;n.setCenter(this._circleAnnotation.getCenter()),n.setRadius(this._circleAnnotation.getRadius()),n.setFillColor(this._circleAnnotation.getFillColor()),n.setFillOpacity(this._circleAnnotation.getFillOpacity()),n.setVisible(this._circleAnnotation.isVisible())},t.prototype.updateBounds=function(){var t=this._circleAnnotation.getCenter(),e=this._circleAnnotation.getRadius(),n=m.convertToMeterFromLatLng(t),i=new f(n.x-e,n.y-e),o=new f(n.x+e,n.y+e),r=new y(m.convertToLatLngFromMeter(i),m.convertToLatLngFromMeter(o));this._minX=r.getSouthwest().lat(),this._minY=r.getSouthwest().lng(),this._maxX=r.getNortheast().lng(),this._maxY=r.getNortheast().lng()},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layerId",{get:function(){return this._layerId},enumerable:!0,configurable:!0}),t.prototype.getAnnotation=function(){return this._circleAnnotation},Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t}(),be=function(){function t(){}return t.pointIntersectsBox=function(t,e){return t.x<=e.max.x&&t.y<=e.max.y&&t.x>=e.min.x&&t.y>=e.min.y},t.polygonIntersectsPolygon=function(e,n){for(var i=0;i<e.length;i++)if(t.polygonContainsPoint(n,e[i]))return!0;for(i=0;i<n.length;i++)if(t.polygonContainsPoint(e,n[i]))return!0;return!!t.lineIntersectsLine(e,n)},t.multiPolygonIntersectsBufferedPoint=function(e,n,i){for(var o=0;o<e.length;o++){var r=e[o];if(t.polygonContainsPoint(r,n))return!0;if(t.pointIntersectsBufferedLine(n,r,i))return!0}return!1},t.multiPolygonIntersectsBufferedMultiPoint=function(e,n,i){for(var o=0;o<n.length;o++)for(var r=n[o],a=0;a<r.length;a++)if(t.multiPolygonIntersectsBufferedPoint(e,r[a],i))return!0;return!1},t.multiPolygonIntersectsMultiPolygon=function(e,n){if(1===e.length&&1===e[0].length)return t.multiPolygonContainsPoint(n,e[0][0]);for(var i=0;i<n.length;i++)for(var o=n[i],r=0;r<o.length;r++)if(t.multiPolygonContainsPoint(e,o[r]))return!0;for(var a=0;a<e.length;a++){for(var s=e[a],u=0;u<s.length;u++)if(t.multiPolygonContainsPoint(n,s[u]))return!0;for(var l=0;l<n.length;l++)if(t.lineIntersectsLine(s,n[l]))return!0}return!1},t.multiPolygonIntersectsBufferedMultiLine=function(e,n,i){for(var o=0;o<n.length;o++)for(var r=n[o],a=0;a<e.length;a++){var s=e[a];if(s.length>=3)for(var u=0;u<r.length;u++)if(t.polygonContainsPoint(s,r[u]))return!0;if(t.lineIntersectsBufferedLine(s,r,i))return!0}return!1},t.lineIntersectsBufferedLine=function(e,n,i){if(e.length>1){if(t.lineIntersectsLine(e,n))return!0;for(var o=0;o<n.length;o++)if(t.pointIntersectsBufferedLine(n[o],e,i))return!0}for(var r=0;r<e.length;r++)if(t.pointIntersectsBufferedLine(e[r],n,i))return!0;return!1},t.lineIntersectsLine=function(e,n){if(0===e.length||0===n.length)return!1;for(var i=0;i<e.length-1;i++)for(var o=e[i],r=e[i+1],a=0;a<n.length-1;a++){var s=n[a],u=n[a+1];if(t.lineSegmentIntersectsLineSegment(o,r,s,u))return!0}return!1},t.lineSegmentIntersectsLineSegment=function(e,n,i,o){return t.isCounterClockwise(e,i,o)!==t.isCounterClockwise(n,i,o)&&t.isCounterClockwise(e,n,i)!==t.isCounterClockwise(e,n,o)},t.pointIntersectsBufferedMultiLine=function(e,n,i){return n.some(function(n){return t.pointIntersectsBufferedLine(e,n,i)})},t.pointIntersectsBufferedLine=function(e,n,i){var o=i*i;if(1===n.length)return e.distSqr(n[0])<o;for(var r=1;r<n.length;r++){var a=n[r-1],s=n[r];if(t.distToSegmentSquared(e,a,s)<o)return!0}return!1},t.pointIntersectsCircle=function(t,e,n){return t.distSqr(e)<=n*n},t.multiPolygonContainsPoint=function(t,e){for(var n,i,o,r=!1,a=0;a<t.length;a++)for(var s=0,u=(n=t[a]).length-1;s<n.length;u=s++)i=n[s],o=n[u],i.y>e.y!=o.y>e.y&&e.x<(o.x-i.x)*(e.y-i.y)/(o.y-i.y)+i.x&&(r=!r);return r},t.polygonContainsPoint=function(t,e){for(var n=!1,i=0,o=t.length-1;i<t.length;o=i++){var r=t[i],a=t[o];r.y>e.y!=a.y>e.y&&e.x<(a.x-r.x)*(e.y-r.y)/(a.y-r.y)+r.x&&(n=!n)}return n},t.isCounterClockwise=function(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)},t.distToSegmentSquared=function(t,e,n){var i=e.distSqr(n);if(0===i)return t.distSqr(e);var o=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;return o<0?t.distSqr(e):o>1?t.distSqr(n):t.distSqr(n.sub(e)._mult(o)._add(e))},t}(),_e=function(){function t(t,e){this._min=t,this._max=e}return Object.defineProperty(t.prototype,"min",{get:function(){return this._min},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},enumerable:!0,configurable:!0}),t}(),Se=function(){function t(t,e,n){this.width=t,this.height=e,this.url=n}return t.prototype.clone=function(){return new t(this.width,this.height,this.url)},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getUrl=function(){return this.url},t.defaultMarker=new t(33,32,null),t}(),Ee=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ce=function(t){function e(e){var n=t.call(this)||this;n.defaultMarkerOptions={visible:!0,anchor:new x(.5,1),icon:new Se(32,32,null),elevation:0};var i={};return g.extendOptions(i,n.defaultMarkerOptions,e),n._position=l.convert(i.position),n._anchor=x.convert(i.anchor),n._visible=i.visible,n._icon=i.icon,n._elevation=i.elevation,n}return Ee(e,t),e.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&(this._map.mapView.removeAnnotation(this._id),this._id=-1),this._map=t,null!=this._map&&(this._id=this._map.mapView.addAnnotation(this)))},e.prototype.setPosition=function(t){var e=l.convert(t);this._position.equals(e)||(this._position=e,null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0))},e.prototype.setVisible=function(t){this._visible!==t&&(this._visible=t,null!=this._map&&(this._map.mapView.dirty=!0))},e.prototype.setAnchor=function(t){var e=x.convert(t);this._anchor.equals(e)||(this._anchor=e,null!=this._map&&(this._map.mapView.dirty=!0))},e.prototype.setIcon=function(t){this._icon=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id)},e.prototype.setElevation=function(t){this._elevation=t,null!=this._map&&(this._map.mapView.dirty=!0)},e.prototype.getPosition=function(){return new l(this._position.lat(),this._position.lng())},e.prototype.isVisible=function(){return this._visible},e.prototype.getAnchor=function(){return new x(this._anchor.x,this._anchor.y)},e.prototype.getIcon=function(){return this._icon instanceof Se?new Se(this._icon.width,this._icon.height,this._icon.url):this._icon},e.prototype.getElevation=function(){return this._elevation},e.prototype.getMap=function(){return this._map},e}(A);function Le(t,e,n,i,o,r){var a=o-n,s=r-i;if(0!==a||0!==s){var u=((t-n)*a+(e-i)*s)/(a*a+s*s);u>1?(n=o,i=r):u>0&&(n+=a*u,i+=s*u)}return(a=t-n)*a+(s=e-i)*s}function Re(t,e,n,i){var o={id:void 0===t?null:t,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)Ie(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<e.length;i++)Ie(t,e[i]);else if("MultiPolygon"===n)for(i=0;i<e.length;i++)for(var o=0;o<e[i].length;o++)Ie(t,e[i][o])}(o),o}function Ie(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function Pe(t,e,n,i){if(e.geometry){var o=e.geometry.coordinates,r=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],u=e.id;if(n.promoteId?u=e.properties[n.promoteId]:n.generateId&&(u=i||0),"Point"===r)Oe(o,s);else if("MultiPoint"===r)for(var l=0;l<o.length;l++)Oe(o[l],s);else if("LineString"===r)De(o,s,a,!1);else if("MultiLineString"===r){if(n.lineMetrics){for(l=0;l<o.length;l++)s=[],De(o[l],s,a,!1),t.push(Re(u,"LineString",s,e.properties));return}Be(o,s,a,!1)}else if("Polygon"===r)Be(o,s,a,!0);else{if("MultiPolygon"!==r){if("GeometryCollection"===r){for(l=0;l<e.geometry.geometries.length;l++)Pe(t,{id:u,geometry:e.geometry.geometries[l],properties:e.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(l=0;l<o.length;l++){var h=[];Be(o[l],h,a,!0),s.push(h)}}t.push(Re(u,r,s,e.properties))}}function Oe(t,e){e.push(ke(t[0])),e.push(Ze(t[1])),e.push(0)}function De(t,e,n,i){for(var o,r,a=0,s=0;s<t.length;s++){var u=ke(t[s][0]),l=Ze(t[s][1]);e.push(u),e.push(l),e.push(0),s>0&&(a+=i?(o*l-u*r)/2:Math.sqrt(Math.pow(u-o,2)+Math.pow(l-r,2))),o=u,r=l}var h=e.length-3;e[2]=1,function t(e,n,i,o){for(var r,a=o,s=i-n>>1,u=i-n,l=e[n],h=e[n+1],c=e[i],p=e[i+1],f=n+3;f<i;f+=3){var d=Le(e[f],e[f+1],l,h,c,p);if(d>a)r=f,a=d;else if(d===a){var g=Math.abs(f-s);g<u&&(r=f,u=g)}}a>o&&(r-n>3&&t(e,n,r,o),e[r+2]=a,i-r>3&&t(e,r,i,o))}(e,0,h,n),e[h+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function Be(t,e,n,i){for(var o=0;o<t.length;o++){var r=[];De(t[o],r,n,i),e.push(r)}}function ke(t){return t/360+.5}function Ze(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Ne(t,e,n,i,o,r,a,s){if(i/=e,r>=(n/=e)&&a<i)return t;if(a<n||r>=i)return null;for(var u=[],l=0;l<t.length;l++){var h=t[l],c=h.geometry,p=h.type,f=0===o?h.minX:h.minY,d=0===o?h.maxX:h.maxY;if(f>=n&&d<i)u.push(h);else if(!(d<n||f>=i)){var g=[];if("Point"===p||"MultiPoint"===p)Ue(c,g,n,i,o);else if("LineString"===p)Fe(c,g,n,i,o,!1,s.lineMetrics);else if("MultiLineString"===p)ze(c,g,n,i,o,!1);else if("Polygon"===p)ze(c,g,n,i,o,!0);else if("MultiPolygon"===p)for(var m=0;m<c.length;m++){var y=[];ze(c[m],y,n,i,o,!0),y.length&&g.push(y)}if(g.length){if(s.lineMetrics&&"LineString"===p){for(m=0;m<g.length;m++)u.push(Re(h.id,p,g[m],h.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===g.length?(p="LineString",g=g[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===g.length?"Point":"MultiPoint"),u.push(Re(h.id,p,g,h.tags))}}}return u.length?u:null}function Ue(t,e,n,i,o){for(var r=0;r<t.length;r+=3){var a=t[r+o];a>=n&&a<=i&&(e.push(t[r]),e.push(t[r+1]),e.push(t[r+2]))}}function Fe(t,e,n,i,o,r,a){for(var s,u,l=Ve(t),h=0===o?Ye:Xe,c=t.start,p=0;p<t.length-3;p+=3){var f=t[p],d=t[p+1],g=t[p+2],m=t[p+3],y=t[p+4],v=0===o?f:d,x=0===o?m:y,A=!1;a&&(s=Math.sqrt(Math.pow(f-m,2)+Math.pow(d-y,2))),v<n?x>n&&(u=h(l,f,d,m,y,n),a&&(l.start=c+s*u)):v>i?x<i&&(u=h(l,f,d,m,y,i),a&&(l.start=c+s*u)):je(l,f,d,g),x<n&&v>=n&&(u=h(l,f,d,m,y,n),A=!0),x>i&&v<=i&&(u=h(l,f,d,m,y,i),A=!0),!r&&A&&(a&&(l.end=c+s*u),e.push(l),l=Ve(t)),a&&(c+=s)}var M=t.length-3;f=t[M],d=t[M+1],g=t[M+2],(v=0===o?f:d)>=n&&v<=i&&je(l,f,d,g),M=l.length-3,r&&M>=3&&(l[M]!==l[0]||l[M+1]!==l[1])&&je(l,l[0],l[1],l[2]),l.length&&e.push(l)}function Ve(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function ze(t,e,n,i,o,r){for(var a=0;a<t.length;a++)Fe(t[a],e,n,i,o,r,!1)}function je(t,e,n,i){t.push(e),t.push(n),t.push(i)}function Ye(t,e,n,i,o,r){var a=(r-e)/(i-e);return t.push(r),t.push(n+(o-n)*a),t.push(1),a}function Xe(t,e,n,i,o,r){var a=(r-n)/(o-n);return t.push(e+(i-e)*a),t.push(r),t.push(1),a}function He(t,e){for(var n=[],i=0;i<t.length;i++){var o,r=t[i],a=r.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)o=Ge(r.geometry,e);else if("MultiLineString"===a||"Polygon"===a){o=[];for(var s=0;s<r.geometry.length;s++)o.push(Ge(r.geometry[s],e))}else if("MultiPolygon"===a)for(o=[],s=0;s<r.geometry.length;s++){for(var u=[],l=0;l<r.geometry[s].length;l++)u.push(Ge(r.geometry[s][l],e));o.push(u)}n.push(Re(r.id,a,o,r.tags))}return n}function Ge(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function We(t,e){if(t.transformed)return t;var n,i,o,r=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var u=t.features[n],l=u.geometry,h=u.type;if(u.geometry=[],1===h)for(i=0;i<l.length;i+=2)u.geometry.push(Qe(l[i],l[i+1],e,r,a,s));else for(i=0;i<l.length;i++){var c=[];for(o=0;o<l[i].length;o+=2)c.push(Qe(l[i][o],l[i][o+1],e,r,a,s));u.geometry.push(c)}}return t.transformed=!0,t}function Qe(t,e,n,i,o,r){return[Math.round(n*(t*i-o)),Math.round(n*(e*i-r))]}function qe(t,e,n,i,o){for(var r=e===o.maxZoom?0:o.tolerance/((1<<e)*o.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,Ke(a,t[s],r,o);var u=t[s].minX,l=t[s].minY,h=t[s].maxX,c=t[s].maxY;u<a.minX&&(a.minX=u),l<a.minY&&(a.minY=l),h>a.maxX&&(a.maxX=h),c>a.maxY&&(a.maxY=c)}return a}function Ke(t,e,n,i){var o=e.geometry,r=e.type,a=[];if("Point"===r||"MultiPoint"===r)for(var s=0;s<o.length;s+=3)a.push(o[s]),a.push(o[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===r)Je(a,o,t,n,!1,!1);else if("MultiLineString"===r||"Polygon"===r)for(s=0;s<o.length;s++)Je(a,o[s],t,n,"Polygon"===r,0===s);else if("MultiPolygon"===r)for(var u=0;u<o.length;u++){var l=o[u];for(s=0;s<l.length;s++)Je(a,l[s],t,n,!0,0===s)}if(a.length){var h=e.tags||null;if("LineString"===r&&i.lineMetrics){for(var c in h={},e.tags)h[c]=e.tags[c];h.mapbox_clip_start=o.start/o.size,h.mapbox_clip_end=o.end/o.size}var p={geometry:a,type:"Polygon"===r||"MultiPolygon"===r?3:"LineString"===r||"MultiLineString"===r?2:1,tags:h};null!==e.id&&(p.id=e.id),t.features.push(p)}}function Je(t,e,n,i,o,r){var a=i*i;if(i>0&&e.size<(o?a:i))n.numPoints+=e.length/3;else{for(var s=[],u=0;u<e.length;u+=3)(0===i||e[u+2]>a)&&(n.numSimplified++,s.push(e[u]),s.push(e[u+1])),n.numPoints++;o&&function(t,e){for(var n=0,i=0,o=t.length,r=o-2;i<o;r=i,i+=2)n+=(t[i]-t[r])*(t[i+1]+t[r+1]);if(n>0===e)for(i=0,o=t.length;i<o/2;i+=2){var a=t[i],s=t[i+1];t[i]=t[o-2-i],t[i+1]=t[o-1-i],t[o-2-i]=a,t[o-1-i]=s}}(s,r),t.push(s)}}function $e(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)Pe(n,t.features[i],e,i);else"Feature"===t.type?Pe(n,t,e):Pe(n,{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(t,e){var n=e.buffer/e.extent,i=t,o=Ne(t,1,-1-n,n,0,-1,2,e),r=Ne(t,1,1-n,2+n,0,-1,2,e);return(o||r)&&(i=Ne(t,1,-n,1+n,0,-1,2,e)||[],o&&(i=He(o,1).concat(i)),r&&(i=i.concat(He(r,-1)))),i}(i,e)).length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function tn(t,e,n){return 32*((1<<t)*n+e)+t}$e.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},$e.prototype.splitTile=function(t,e,n,i,o,r,a){for(var s=[t,e,n,i],u=this.options,l=u.debug;s.length;){i=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var h=1<<e,c=tn(e,n,i),p=this.tiles[c];if(!p&&(l>1&&console.time("creation"),p=this.tiles[c]=qe(t,e,n,i,u),this.tileCoords.push({z:e,x:n,y:i}),l)){l>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var f="z"+e;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(p.source=t,o){if(e===u.maxZoom||e===o)continue;var d=1<<o-e;if(n!==Math.floor(r/d)||i!==Math.floor(a/d))continue}else if(e===u.indexMaxZoom||p.numPoints<=u.indexMaxPoints)continue;if(p.source=null,0!==t.length){l>1&&console.time("clipping");var g,m,y,v,x,A,M=.5*u.buffer/u.extent,T=.5-M,w=.5+M,b=1+M;g=m=y=v=null,x=Ne(t,h,n-M,n+w,0,p.minX,p.maxX,u),A=Ne(t,h,n+T,n+b,0,p.minX,p.maxX,u),t=null,x&&(g=Ne(x,h,i-M,i+w,1,p.minY,p.maxY,u),m=Ne(x,h,i+T,i+b,1,p.minY,p.maxY,u),x=null),A&&(y=Ne(A,h,i-M,i+w,1,p.minY,p.maxY,u),v=Ne(A,h,i+T,i+b,1,p.minY,p.maxY,u),A=null),l>1&&console.timeEnd("clipping"),s.push(g||[],e+1,2*n,2*i),s.push(m||[],e+1,2*n,2*i+1),s.push(y||[],e+1,2*n+1,2*i),s.push(v||[],e+1,2*n+1,2*i+1)}}},$e.prototype.getTile=function(t,e,n){var i=this.options,o=i.extent,r=i.debug;if(t<0||t>24)return null;var a=1<<t,s=tn(t,e=(e%a+a)%a,n);if(this.tiles[s])return We(this.tiles[s],o);r>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var u,l=t,h=e,c=n;!u&&l>0;)l--,h=Math.floor(h/2),c=Math.floor(c/2),u=this.tiles[tn(l,h,c)];return u&&u.source?(r>1&&console.log("found parent tile z%d-%d-%d",l,h,c),r>1&&console.time("drilling down"),this.splitTile(u.source,l,h,c,t,e,n),r>1&&console.timeEnd("drilling down"),this.tiles[s]?We(this.tiles[s],o):null):null};var en,nn,on=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),rn=function(t){function e(e){var n=t.call(this,e)||this;return n.normalizeGeometryCoordinates(),n}return on(e,t),e.prototype.normalizeGeometryCoordinates=function(){for(var t=[],e=0;e<this.geometryCoordinates.length;++e){for(var n=[],i=0;i<this.geometryCoordinates[e].length;++i)n.push([this.geometryCoordinates[e][i][0]/o.tileExtend-.5,.5-this.geometryCoordinates[e][i][1]/o.tileExtend]);t.push(n)}this.geometryCoordinates=t},e}(function(){return function(t){this.geometryCoordinates=[],this.geometryCoordinates=t}}()),an=function(){function t(t){this.id=t,this.layerId=cn.annotationLayerId+t.toString()}return t.prototype.reloadLayout=function(){this.geoJsonIndexer=null},t.prototype.updateTileData=function(t,e){var n=this;if(!this.geoJsonIndexer){var i={maxZoom:o.defaultMaxNativeZoom,buffer:0,extent:o.tileExtend,tolerance:4};this.geoJsonIndexer=function(t,e){return new $e(t,e)}(this.getFeatures(),i)}var r=this.geoJsonIndexer.getTile(t.getZoom(),t.getX(),t.getY());if(null!=r&&0!==r.features.length){var a=e.addLayer(this.layerId);r.features.forEach(function(t){var e=t.type,i=new rn(t.geometry);a.addFeature(n.id,e,i)})}},t.prototype.getLayerId=function(){return this.layerId},t}(),sn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),un=function(t){function e(e,n){var i=t.call(this,e)||this;return i.polygonAnnotation=n,i}return sn(e,t),e.prototype.getAnnotation=function(){return this.polygonAnnotation},e.prototype.updateLayer=function(t){var e=this.getLayerId(),n=t.getLayer(e);null==n&&(n=t.createLayer(e,pt.FILL,o.annotationLayerOrder));var i=n;i.setFillColor(this.polygonAnnotation.getFillColor()),i.setFillOpacity(this.polygonAnnotation.getFillOpacity()),i.setVisible(this.polygonAnnotation.isVisible())},e.prototype.getFeatures=function(){var t,e=[];this.polygonAnnotation.getPaths().forEach(function(t){var n=[];t.forEach(function(t){return n.push([t.lng(),t.lat()])}),e.push(n)});var n={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:e}}]};return t=JSON.stringify(n,null,2),JSON.parse(t)},e}(an),ln=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),hn=function(t){function e(e,n){var i=t.call(this,e)||this;return i.polylineAnnotation=n,i}return ln(e,t),e.prototype.getAnnotation=function(){return this.polylineAnnotation},e.prototype.updateLayer=function(t){var e=this.getLayerId(),n=t.getLayer(e);null==n&&(n=t.createLayer(e,pt.LINE,o.annotationLayerOrder));var i=n;i.setStrokeColor(this.polylineAnnotation.getStrokeColor()),i.setStrokeOpacity(this.polylineAnnotation.getStrokeOpacity()),i.setStrokeWidth(this.polylineAnnotation.getStrokeWidth()),i.setVisible(this.polylineAnnotation.isVisible())},e.prototype.getFeatures=function(){var t,e=[];this.polylineAnnotation.getPath().forEach(function(t){e.push([t.lng(),t.lat()])});var n={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e}}]};return t=JSON.stringify(n,null,2),JSON.parse(t)},e}(an),cn=function(){function t(t){this.idCounter=0,this.markerAnnotations=[],this.tiles=new Map,this.shapeAnnotations=new Map,this.map=t,this.dirty=!1;var e=t.createLayer("annotationLayer",pt.ANNOTATION,o.markerAnnotationLayerOrder);this.annotationLayer=e,this.circleTree=fe(),this.circleAnnotations=new Map}return t.prototype.update=function(){var t=this;this.dirty&&(this.tiles.forEach(function(e){var n=t.getTileData(e.getTileCoordinate());t.updateRenderTile(n,e),e.setData(n)}),this.dirty=!1)},t.prototype.addTile=function(t){var e=t.getTileCoordinate(),n=this.getTileData(e);this.updateRenderTile(n,t),t.setData(n),this.tiles.set(e.toString(),t)},t.prototype.removeTile=function(t){var e=this,n=t.getTileData();null!=n&&n.getLayerIds().forEach(function(n){var i=e.map.getLayer(n),o=i.getLayerType();if(o==pt.LINE)i.removeRenderTile(t.getTileCoordinate());else if(o==pt.FILL){i.removeRenderTile(t.getTileCoordinate())}else if(o==pt.CIRCLE){i.removeRenderTile(t.getTileCoordinate())}});this.tiles.delete(t.getTileCoordinate().toString())},t.prototype.getTileData=function(t){if(0==this.markerAnnotations.length&&0==this.shapeAnnotations.size&&0==this.circleAnnotations.size)return null;var e=new Te;this.shapeAnnotations.forEach(function(n){n.updateTileData(t,e)});var n=v.tileCoordinateToLatLngBounds(t),i={minX:n.getSouthwest().lng(),minY:n.getSouthwest().lng(),maxX:n.getNortheast().lat(),maxY:n.getNortheast().lng()};return this.circleTree.search(i).forEach(function(t){return e.addLayer(t.layerId)}),e},t.prototype.addAnnotation=function(t){this.dirty=!0;var e=this.idCounter++;return this.idCounter<0&&(this.idCounter=0),this.addAnnotationInternal(e,t),e},t.prototype.addAnnotationInternal=function(t,e){if(e instanceof Ce)this.markerAnnotations.push(t),this.annotationLayer.addAnnotation(t,e);else if(e instanceof T){var n=new hn(t,e);n.updateLayer(this.map),this.shapeAnnotations.set(t,n)}else if(e instanceof b){var i=new un(t,e);i.updateLayer(this.map),this.shapeAnnotations.set(t,i)}else if(e instanceof S){var o=new we(t,e);o.updateLayer(this.map),this.circleAnnotations.set(t,o),this.circleTree.insert(o)}},t.prototype.updateAnnotation=function(e,n){if(-1!=this.markerAnnotations.indexOf(e))this.annotationLayer.updateAnnotation(e,n);else if(this.shapeAnnotations.has(e)){var i=this.shapeAnnotations.get(e);if(n){var o=t.annotationLayerId+e.toString();i.reloadLayout(),this.tiles.forEach(function(t){return t.removeLayerData(o)}),this.dirty=!0}i.updateLayer(this.map)}else if(this.circleAnnotations.has(e)){var r=this.circleAnnotations.get(e);r.updateLayer(this.map),n&&(r.updateBounds(),this.circleTree.remove(r),this.circleTree.insert(r),this.dirty=!0)}},t.prototype.removeAnnotation=function(e){this.dirty=!0;var n=this.markerAnnotations.indexOf(e);-1!=n?(this.markerAnnotations.splice(n,1),this.annotationLayer.removeAnnotation(e)):this.shapeAnnotations.has(e)?(this.shapeAnnotations.delete(e),this.map.removeLayer(t.annotationLayerId+e.toString())):this.circleAnnotations.has(e)?(this.circleTree.remove(this.circleAnnotations.get(e)),this.circleAnnotations.delete(e),this.map.removeLayer(t.annotationLayerId+e.toString())):console.error("Invalid annotation's id: "+e)},t.prototype.updateRenderTile=function(t,e){var n=this;if(null!=t){var i=e.getTileCoordinate();t.getLayerIds().forEach(function(t){var o=n.map.getLayer(t),r=o.getLayerType(),a=new F(z.createWithXYZoom(i.getX(),i.getY(),i.getZoom()),e);if(r==pt.LINE)o.addRenderTile(e.getTileCoordinate(),a);else if(r==pt.FILL){o.addRenderTile(e.getTileCoordinate(),a)}else if(r==pt.CIRCLE){o.addRenderTile(e.getTileCoordinate(),a)}})}},t.prototype.queryMarkerAnnotation=function(t){var e=this.annotationLayer.getVisibleMarkers();e=e.reverse();for(var n=0;n<e.length;++n){var i=e[n],o=i.getWidth(),r=i.getHeight(),a=i.getAnchor(),s=v.latLngToScreenCoordinate(i.getPosition(),i.getElevation(),this.map.mapState),u=new f(s.x+(.5-a.x)*o,s.y+(.5-a.y)*r),l=new _e(new ge.a(u.x-o/2,u.y-r/2),new ge.a(u.x+o/2,u.y+r/2));if(be.pointIntersectsBox(new ge.a(t.x,t.y),l))return i.getMarker()}return null},t.prototype.queryShapeAnnotation=function(t){var e=this.map.mapState,n=V.fromLatLng(v.screenCoordinateToLatLng(t,e),e.getZoom(),e.is3dMode()),i=1,o=e.getMaxNativeZoom();if(e.getZoom()>o&&(n=V.fromLatLng(v.screenCoordinateToLatLng(t,e),e.getMaxNativeZoom(),e.is3dMode()),i=Math.pow(2,Math.round(e.getZoom())-o)),this.tiles.has(n.toString())){var r=this.tiles.get(n.toString()).getTileData();if(null==r||0==r.getLayerIds().length)return null;for(var a=e.scale,s=n.getX(),u=n.getY(),l=v.pixelCoordinateToVectorTileCoordinate(m.projectScale(v.screenCoordinateToLatLng(t,e),a),s,u,i),h=this.queryShapeAnnotationInternal(new ge.a(l.x,l.y),r),c=h.clickedAnnotation,p=h.clickedAnnotationId,f=v.tileCoordinateToLatLngBounds(n),d={minX:f.getSouthwest().lng(),minY:f.getSouthwest().lng(),maxX:f.getNortheast().lat(),maxY:f.getNortheast().lng()},g=this.circleTree.search(d),y=0;y<g.length;++y){var x=g[y],A=x.getAnnotation(),M=A.getCenter(),T=A.getRadius()/m.getMetersPerPixelAtLatitude(e.getCameraPosition().getTarget().lat(),e.getZoom()),w=v.latLngToScreenCoordinate(M,0,e);be.pointIntersectsCircle(new ge.a(t.x,t.y),new ge.a(w.x,w.y),T)&&(null==c||null!=c&&p<x.id)&&(c=this.circleAnnotations.get(x.id).getAnnotation(),p=x.id)}return c}return null},t.prototype.queryShapeAnnotationInternal=function(t,e){for(var n=g.getTileSize(),i=e.getLayerIds(),o=e.getLayerIds().length,r=null,a=null,s=0;s<o;++s)for(var u=i[s],l=e.getLayer(u),h=function(e){var i=l.getFeature(e);if(!(i instanceof Ae))return"continue";var o=i,s=o.getGeometries().geometryCoordinates,h=c.map.getLayer(u);if(null==h)return console.error("There is problem while querying shape annotation"),{value:null};var p=h.getLayerType();if(p==pt.LINE){var f=h.getStrokeWidth()/2,d=c.map.mapState;d.getZoom()>d.getMaxNativeZoom()&&(f/=Math.pow(2,Math.round(d.getZoom())-d.getMaxNativeZoom()));var g=[];s.forEach(function(t){var e=[];t.forEach(function(t){return e.push(new ge.a(t[0],t[1]))}),g.push(e)}),be.pointIntersectsBufferedMultiLine(t,g,f/n)&&(null==r||null!=r&&a<o.id)&&(r=c.shapeAnnotations.get(o.id).getAnnotation(),a=o.id)}else if(p==pt.FILL){for(var m=!1,y=function(e){var n=[];if(s[e].forEach(function(t){return n.push(new ge.a(t[0],t[1]))}),0==e){if(!(m=be.polygonIntersectsPolygon([t],n)))return"break"}else if(be.polygonIntersectsPolygon([t],n))return m=!1,"break"},v=0;v<s.length;++v){if("break"===y(v))break}m&&(null==r||null!=r&&a<o.id)&&(r=c.shapeAnnotations.get(o.id).getAnnotation(),a=o.id)}},c=this,p=0;p<l.featureCount();++p){var f=h(p);if("object"==typeof f)return f.value}return{clickedAnnotation:r,clickedAnnotationId:a}},t.annotationLayerId="maplink.annotation.layer.",t}(),pn=function(){function t(t){this.idCounter=0,this.tileManager=t,this.tileAreas=new Map}return t.prototype.addTileArea=function(t){var e=this.idCounter++;return this.tileAreas.set(e,t),this.tileManager.addTileArea(e,t),e},t.prototype.updateTileArea=function(t,e){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.tileAreas.set(t,e),this.tileManager.updateTileArea(t,e))},t.prototype.removeTileArea=function(t){this.tileAreas.delete(t),this.tileManager.removeTileArea(t)},t}(),fn=function(){function t(t){this.layerType=t}return t.prototype.getType=function(){return this.layerType},t}(),dn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),gn=function(t){function e(e){var n=t.call(this,pt.RASTER)||this;return n.texture=e,n}return dn(e,t),e.prototype.destroy=function(){this.texture&&this.texture.destroy()},e}(fn),mn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),yn=function(t){function e(e,n){var i=t.call(this,Zt.RASTER,e,n)||this;return i.buildings=[],i}return mn(e,t),e.prototype.init=function(t,e){var n=this,i=new kt(this.gl);i.loadImage(t.rasterTile,function(){n.renderable=!0,e()}),this.rasterLayerData=new gn(i)},e.prototype.getTexture=function(){return this.rasterLayerData?this.rasterLayerData.texture:null},e.prototype.addBuildings=function(t){this.buildings=t},e.prototype.getBuildings=function(){return this.buildings},e.prototype.destroy=function(){this.rasterLayerData&&this.rasterLayerData.destroy()},e}(Ft),vn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),xn=function(t){function e(e,n,i){return t.call(this,e,n,pt.RASTER,i)||this}return vn(e,t),e.prototype.update=function(){var t=this;this.tileManager.update(function(e){return new yn(e,t.tileManager.mapView.gl)})},e}(At),An=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Mn=function(t){function e(e,n,i){void 0===n&&(n=null),void 0===i&&(i=null);var o=t.call(this,Ut.MARKER)||this;return o.marker=e,o.gl=n,o.updateBounds(),o.updateIcon(),o}return An(e,t),e.prototype.initTexture=function(t,e){void 0===e&&(e=null),null!=this.texture&&this.texture.destroy(),this.texture=new kt(this.gl),this.texture.loadImageFromUrl(null==t?h.markerDefault:t,function(){e&&e()})},e.prototype.updateIcon=function(){var t=this.marker.getIcon();t instanceof Se?(this.url=t.getUrl(),this.width=t.getWidth(),this.height=t.getHeight()):(this.url=t,this.width=null,this.height=null),this.initTexture(this.url,null)},e.prototype.updateBounds=function(){var t=this.marker.getPosition();this.minX=t.lng(),this.minY=t.lat(),this.maxX=t.lng(),this.maxY=t.lat()},e.prototype.destroy=function(){this.texture&&this.texture.destroy()},e.prototype.getMarker=function(){return this.marker},e.prototype.hasTexture=function(){return null!=this.texture},e.prototype.getTexture=function(){return this.texture},e.prototype.isVisible=function(){return this.marker.isVisible()},e.prototype.getPosition=function(){return this.marker.getPosition()},e.prototype.getAnchor=function(){return this.marker.getAnchor()},e.prototype.getElevation=function(){return this.marker.getElevation()},e.prototype.getWidth=function(){return null==this.width?this.texture.width:this.width},e.prototype.getHeight=function(){return null==this.height?this.texture.height:this.height},e}(Xt),Tn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),wn=function(t){function e(e,n,i){var o=t.call(this,e,n,pt.ANNOTATION,i)||this;return o.markerAnnotations=new Map,o.rBushTree=fe(),o}return Tn(e,t),e.prototype.update=function(t){this.markerAnnotations.forEach(function(e){e.update(t)})},e.prototype.addAnnotation=function(t,e){if(e instanceof Ce){var n=new Mn(e,this.tileManager.mapView.gl);this.markerAnnotations.set(t,n),this.rBushTree.insert(n)}else console.error("Invalid annotation type: "+e)},e.prototype.updateAnnotation=function(t,e){if(this.markerAnnotations.has(t)){var n=this.markerAnnotations.get(t);if(n.getShapeType()==Ut.MARKER){var i=n;e?(i.updateBounds(),this.rBushTree.remove(i),this.rBushTree.insert(i)):i.updateIcon()}}},e.prototype.removeAnnotation=function(t,e){if(void 0===e&&(e=null),this.markerAnnotations.has(t)){var n=this.markerAnnotations.get(t);if(n.getShapeType()==Ut.MARKER){var i=n;this.rBushTree.remove(i),i.destroy()}this.markerAnnotations.delete(t)}},e.prototype.getVisibleMarkers=function(){var t=this,e=[];return this.tileManager.getVisibleTiles().forEach(function(n){var i=n.getTileCoordinate(),o=v.tileCoordinateToLatLngBounds(i),r={minX:o.getSouthwest().lng(),minY:o.getSouthwest().lat(),maxX:o.getNortheast().lng(),maxY:o.getNortheast().lat()};t.rBushTree.search(r).forEach(function(t){e.push(t)})}),e},e}(At),bn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),_n=function(t){function e(e,n,i){var o=t.call(this,e,n,pt.LINE,i)||this;return o._strokeWidth=5,o._strokeColor=new p(0,0,0,1),o._strokeOpacity=1,o.renderTiles=new Map,o}return bn(e,t),e.prototype.update=function(t){},e.prototype.setStrokeWidth=function(t){this._strokeWidth=t},e.prototype.setStrokeColor=function(t){null!==t?(this._strokeColor=p.fromHex(t),this._strokeColor.alpha=this._strokeOpacity):this._strokeColor=new p(255,0,0,this._strokeOpacity)},e.prototype.setStrokeOpacity=function(t){this._strokeOpacity=t,this._strokeColor.alpha=this._strokeOpacity},e.prototype.setVisible=function(t){this._visible=t},e.prototype.getStrokeWidth=function(){return this._strokeWidth},e.prototype.getStrokeColor=function(){return this._strokeColor},e.prototype.getStrokeOpacity=function(){return this._strokeOpacity},e.prototype.isVisible=function(){return this._visible},e.prototype.addRenderTile=function(t,e){this.renderTiles.has(t)||this.renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this.renderTiles.delete(t)},e}(At),Sn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),En=function(t){function e(e,n,i){var o=t.call(this,e,n,pt.FILL,i)||this;return o._fillColor=new p(0,0,0,1),o._fillOpacity=1,o._visible=!0,o._renderTiles=new Map,o}return Sn(e,t),e.prototype.update=function(t){},e.prototype.setFillColor=function(t){null!==t?(this._fillColor=p.fromHex(t),this._fillColor.alpha=this._fillOpacity):this._fillColor=new p(255,0,0,this._fillOpacity)},e.prototype.setFillOpacity=function(t){this._fillOpacity=t,this._fillColor.alpha=this._fillOpacity},e.prototype.setVisible=function(t){this._visible=t},e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this._renderTiles.delete(t)},Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColor",{get:function(){return this._fillColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillOpacity",{get:function(){return this._fillOpacity},enumerable:!0,configurable:!0}),e}(At),Cn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ln=function(t){function e(e,n,i){var o=t.call(this,e,n,pt.CIRCLE,i)||this;return o._center=new l(0,0),o._radius=0,o._fillColor=new p(0,0,0,1),o._fillOpacity=1,o._visible=!0,o._renderTiles=new Map,o}return Cn(e,t),e.prototype.update=function(t){},e.prototype.setCenter=function(t){this._center=t},e.prototype.setRadius=function(t){this._radius=t},e.prototype.setFillColor=function(t){null!==t?(this._fillColor=p.fromHex(t),this.fillColor.alpha=this.fillOpacity):this._fillColor=new p(255,0,0,this.fillOpacity)},e.prototype.setFillOpacity=function(t){this._fillOpacity=t,this.fillColor.alpha=this.fillOpacity},e.prototype.setVisible=function(t){this._visible=t},Object.defineProperty(e.prototype,"center",{get:function(){return this._center},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColor",{get:function(){return this._fillColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillOpacity",{get:function(){return this._fillOpacity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this._renderTiles.delete(t)},e}(At),Rn=function(){function t(t){this.buildings=[],this.id=t}return t.prototype.addBuilding=function(t){this.buildings.push(t)},t.prototype.getModel=function(){return 0==this.buildings.length?null:this.buildings[0].getModel()},t}(),In=function(){function t(){}return t.calculateDistanceBetweenPointToLineBy2Point=function(t,e,n){return 100},t.calculateDistanceBetweenPointToLine=function(t,e){return 100},t}(),Pn=n(4),On=n.n(Pn),Dn=function(){function t(t){this._lightColor=t}return Object.defineProperty(t.prototype,"lightColor",{get:function(){return this._lightColor},set:function(t){this._lightColor=t},enumerable:!0,configurable:!0}),t}(),Bn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),kn=function(t){function e(e,n){var i=t.call(this,e)||this;return i._lightPosition=n,i}return Bn(e,t),Object.defineProperty(e.prototype,"lightPosition",{get:function(){return this._lightPosition},set:function(t){this._lightPosition=t},enumerable:!0,configurable:!0}),e}(Dn),Zn=function(){function t(){this._lastUpdateTime=0,this._sunLight=new kn(new u(1,1,1),new u(0,0,1))}return t.prototype.update=function(t){var e=(new Date).getTime();if(!(e-this._lastUpdateTime<6e4)){this._lastUpdateTime=e;var n=On.a.getPosition(new Date,t.lat(),t.lng());this._sunLight.lightPosition=new u(Math.cos(n.altitude)*Math.sin(n.azimuth),Math.cos(n.altitude)*Math.cos(n.azimuth),Math.sin(n.altitude))}},Object.defineProperty(t.prototype,"sunLight",{get:function(){return this._sunLight},enumerable:!0,configurable:!0}),t}(),Nn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Un=function(t){function e(e,n,i){var o=t.call(this,e,n,pt.BUILDING,i)||this;return o.extrudeBuildings=[],o.dirty=!0,o.colorBuildingGroups=new Map,o.textureBuildingGroups=new Map,o.lightManager=new Zn,o}return Nn(e,t),e.prototype.update=function(t){var e=this;if(t.is3dMode()&&(this.buildingResourceManager.update(),this.dirty)){this.dirty=!1;var n=t.getZoom(),i=t.getScale(),o=t.getScreenSize(),r=m.projectScale(v.screenCoordinateToLatLngZoom(new f(o.x,o.y),t,n),i),a=m.projectScale(v.screenCoordinateToLatLngZoom(new f(0,o.y),t,n),i);this.colorBuildingGroups.clear(),this.textureBuildingGroups.clear(),this.extrudeBuildings=[];var s=[];s.push([a.x,a.y]),s.push([r.x,r.y]),this.buildingResourceManager.buildings.forEach(function(n){var o=n.building;o.updateMatrices(t),o.setDistance(In.calculateDistanceBetweenPointToLine(m.projectScale(o.getLocation(),i),s));var r=o.getObjName();if(o.getBuildingType()==Q.Color){var a=e.colorBuildingGroups.get(r);if(null==a)(u=new Rn(r)).addBuilding(o),e.colorBuildingGroups.set(r,u);else a.addBuilding(o)}else if(o.getBuildingType()==Q.Polygon)e.extrudeBuildings.push(o);else{var u,l=e.textureBuildingGroups.get(r);if(null==l)(u=new Rn(r)).addBuilding(o),e.textureBuildingGroups.set(r,u);else l.addBuilding(o)}}),this.lightManager.update(t.getCameraPosition().target)}},e.prototype.setDirty=function(){this.dirty=!0},e.prototype.getBuildingResourceManager=function(){return this.buildingResourceManager},e.prototype.setBuildingResourceManager=function(t){var e=this;this.buildingResourceManager=t,this.buildingResourceManager.setBuildingLayerDirty=function(){e.setDirty()}},e.prototype.clear=function(){this.colorBuildingGroups.clear(),this.textureBuildingGroups.clear(),this.extrudeBuildings=[]},e}(At),Fn=function(){function t(){}return t.createLayer=function(t,e,n,i){switch(e){case pt.RASTER:return new xn(t,i,n);case pt.BUILDING:return new Un(t,i,n);case pt.ANNOTATION:return new wn(t,i,n);case pt.LINE:return new _n(t,i,n);case pt.FILL:return new En(t,i,n);case pt.CIRCLE:return new Ln(t,i,n);default:return console.log("Un-support layer type"),null}},t}(),Vn=function(){function t(t,e){var n=this;this.watchId=-1,this.userLocationDotId=-1,this.userLocationDot=null,this.lastKnownLocation=null,this.defaultPositionOptions={enableHighAccuracy:!0,maximumAge:0,timeout:6e3},this.mapView=e,this.myLocationButton=P.create("div","mf-button",t),this.myLocationButton.innerHTML="<a class='mf-location'></a>",this.myLocationButton.addEventListener("click",function(){n.onMyLocationButtonClick()})}return t.prototype.onMyLocationButtonClick=function(){-1==this.watchId&&(this.watchId=window.navigator.geolocation.watchPosition(this.onGetCurrentPositionSuccess.bind(this),this.onGetCurrentPositionError.bind(this),this.defaultPositionOptions)),null!=this.lastKnownLocation&&this.mapView.flyTo(this.lastKnownLocation,17,{animate:!0})},t.prototype.onGetCurrentPositionSuccess=function(t){var e=new l(t.coords.latitude,t.coords.longitude);if(null==this.lastKnownLocation&&this.mapView.flyTo(e,17,{animate:!0}),this.lastKnownLocation=e,null==this.userLocationDot){var n=void 0,i=32*g.pixelScale,o=32*g.pixelScale;n=g.pixelScale<1.5?new Se(i,o,h.myPosition):g.pixelScale<2.5?new Se(i,o,h.myPosition2x):new Se(i,o,h.myPosition3x),this.userLocationDot=new Ce({position:e,visible:!0,anchor:new x(.5,.5),icon:n}),this.userLocationDotId=this.mapView.addAnnotation(this.userLocationDot)}else this.userLocationDot.setPosition(e),this.userLocationDot.setVisible(!0)},t.prototype.onGetCurrentPositionError=function(t){1===t.code&&(-1!=this.watchId&&(window.navigator.geolocation.clearWatch(this.watchId),this.watchId=-1),-1!=this.userLocationDotId&&(this.mapView.removeAnnotation(this.userLocationDotId),this.userLocationDotId=-1,this.userLocationDot=null))},t}(),zn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),jn=function(t){function e(e,n){var i=t.call(this,pt.LINE)||this;return i.gl=n,i.buildPolyline(e),i}return zn(e,t),e.prototype.getModel=function(){return this.lineModel},e.prototype.buildPolyline=function(t){var e=[],n=new Pt;n.addVertex=function(t,n){e.push(t.x,t.y,n.x,n.y)},n.lineCapType=vt.Butt,n.lineJoinType=xt.Round;for(var i=g.getTileSize(),o=t.featureCount(),r=0;r<o;++r){var a=t.getFeature(r);if(a.getType()!=he.LineString)return void console.warn("# buildPolyline ----------- not GeometryType.LineString");for(var s=a.getGeometries().geometryCoordinates,u=0;u<s.length;++u){for(var l=[],h=0;h<s[u].length;++h){var c=new f(s[u][h][0],s[u][h][1]);c.x=c.x*i,c.y=c.y*i,l.push(c)}n.buildPolyLine(l)}return this.lineModel=new bt(this.gl,this.gl.TRIANGLES),void this.lineModel.init(e,[new Mt("a_position",null,2,0,4),new Mt("a_extrude",null,2,2,4)],n.indices)}},e.prototype.destroy=function(){this.lineModel&&this.lineModel.destroy()},e}(fn),Yn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Xn=function(t){function e(e,n){var i=t.call(this,pt.FILL)||this;return i.gl=n,i.buildPolygon(e),i}return Yn(e,t),e.prototype.getModel=function(){return this.fillModel},e.prototype.buildPolygon=function(t){var e=[],n=new Et;n.addVertex=function(t){e.push(t.x,t.y)};for(var i=g.getTileSize(),o=t.featureCount(),r=0;r<o;++r){var a=t.getFeature(r);if(a.getType()!=he.Polygon)return void console.warn("# buildPolygon ----------- not GeometryType.Polygon");for(var s=a.getGeometries().geometryCoordinates,u=[],l=0;l<s.length;++l){for(var h=[],c=0;c<s[l].length;++c){var p=new f(s[l][c][0],s[l][c][1]);p.x=p.x*i,p.y=p.y*i,h.push(p)}u.push(h)}return Ct(u,n),this.fillModel=new bt(this.gl,this.gl.TRIANGLES),void this.fillModel.init(e,[new Mt("a_position",null,2,0,2)],n.indices)}},e.prototype.destroy=function(){this.fillModel&&this.fillModel.destroy()},e}(fn),Hn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Gn=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.gl=i,o.layerDatas=new Map,o.tileData=null,o}return Hn(e,t),e.prototype.getTexture=function(){return null},e.prototype.init=function(t,e){},e.prototype.setData=function(t){this.tileData=t},e.prototype.hasData=function(t){return null!=this.tileData&&null!=this.tileData.getLayer(t)},e.prototype.removeLayerData=function(t){var e=this.layerDatas.get(t);e&&(e.destroy(),this.layerDatas.delete(t))},e.prototype.getLayerData=function(t,e){if(!this.layerDatas.has(t)){var n=this.tileData.getLayer(t);if(null==n)return console.error("getLayerData not reachable"),null;switch(e){case pt.LINE:var i=new jn(n,this.gl);return this.layerDatas.set(t,i),this.layerDatas.get(t);case pt.FILL:var o=new Xn(n,this.gl);return this.layerDatas.set(t,o),this.layerDatas.get(t);default:return console.error("getLayerData not reachable"),null}}return this.layerDatas.get(t)},e.prototype.getTileData=function(){return this.tileData},e}(Ft),Wn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Qn=function(t){function e(e,n,i){var o=t.call(this,Zt.ANNOTAION,e,i)||this;return o.annotationManager=n,o.annotationManager.addTile(o),o}return Wn(e,t),e.prototype.destroy=function(){this.layerDatas.forEach(function(t){return t.destroy()}),this.annotationManager.removeTile(this)},e}(Gn),qn=function(){return function(t,e){this.building=t,this.reference=e}}(),Kn=function(){return function(t,e){this.model=t,this.reference=e}}(),Jn=function(){return function(t,e){this.texture=t,this.reference=e}}(),$n=function(){function t(t,e,n){this.gl=t,this.buildings=new Map,this.models=new Map,this.textures=new Map,this.buildingTaskManager=e,this.modelRequestsMap=new Map,this.textureRequestsMap=new Map,this.setBuildingLayerDirty=function(){},this.requestRender=n}return t.prototype.hasBuilding=function(t){return this.buildings.has(t)},t.prototype.getBuilding=function(t){return this.buildings.has(t)?this.buildings.get(t).building:null},t.prototype.addBuildingWithData=function(t,e,n,i){if(e.getBuildingType()==Q.Polygon&&!this.buildings.has(t)){var o=new bt(this.gl,this.gl.TRIANGLES),r=[].concat.apply([],n);o.initBuilding(r,i),e.setModel(o),this.buildings.set(t,new qn(e,1)),this.setBuildingLayerDirty()}},t.prototype.addBuilding=function(t,e){var n=this;if(e.getBuildingType()!=Q.Polygon&&!this.buildings.has(t)){var i=e.getObjName(),r=this.models.get(i);if(null!=r)++r.reference,e.setModel(r.model);else{var a=new bt(this.gl,this.gl.TRIANGLES);this.models.set(i,new Kn(a,1)),e.setModel(a);var s=G.getBuildingDataUrl(o.baseModelRequestUrl,i,N.getAccessKey());(c=new q(H.Model)).url=s,c.completion=function(t){null!=t.data&&(a.initBuilding(t.data[0].data),n.modelRequestsMap.delete(i),n.requestRender())},this.modelRequestsMap.set(i,c),this.buildingTaskManager.postTask(c)}var u=e.getTextureName(),l=this.textures.get(u);if(null!=l)++l.reference,e.setTexture(l.texture);else{var h=new kt(this.gl);this.textures.set(u,new Jn(h,1)),e.setTexture(h);var c,p=G.getBuildingDataUrl(o.baseTextureRequestUrl,u,N.getAccessKey());(c=new q(H.Texture)).url=p,c.completion=function(t){if(null!=t.data){h.loadImageFromBlob(t.data,function(){n.textureRequestsMap.delete(u),n.requestRender()})}},this.textureRequestsMap.set(u,c),this.buildingTaskManager.postTask(c)}this.buildings.set(t,new qn(e,1)),this.setBuildingLayerDirty()}},t.prototype.removeAllResources=function(){var t=this;this.models.forEach(function(t){return t.model.destroy()}),this.textures.forEach(function(t){return t.texture.destroy()}),this.buildings.clear(),this.models.clear(),this.textures.clear(),this.modelRequestsMap.forEach(function(e){t.buildingTaskManager.cancelTask(e)}),this.modelRequestsMap.clear(),this.textureRequestsMap.forEach(function(e){t.buildingTaskManager.cancelTask(e)}),this.textureRequestsMap.clear()},t.prototype.increaseBuildingReference=function(t){var e=this.buildings.get(t);null!=e?++e.reference:console.warn("Can not find any building with id: "+t+" to increase reference !")},t.prototype.decreaseBuildingReference=function(t){var e=this.buildings.get(t);if(null!=e){if(!--e.reference){if(e.building.getBuildingType()!=Q.Polygon){var n=e.building.getObjName(),i=this.models.get(n);if(null==i)return void console.warn("Can not find model with id: "+n+" for building !");if(i.reference-=1,!i.reference){var o=this.modelRequestsMap.get(n);null!=o&&(this.buildingTaskManager.cancelTask(o),this.modelRequestsMap.delete(n)),i.model&&i.model.destroy(),this.models.delete(n)}var r=e.building.getTextureName(),a=this.textures.get(r);if(null==a)return void console.warn("Can not find texture with id: "+r+" for building !");if(a.reference-=1,!a.reference){var s=this.textureRequestsMap.get(r);s&&(this.buildingTaskManager.cancelTask(s),this.textureRequestsMap.delete(r)),a.texture.destroy(),this.textures.delete(r)}}this.buildings.delete(t)}this.setBuildingLayerDirty()}else console.warn("Can not find any building with id: "+t+" to decrease reference !")},t.prototype.update=function(){},t}(),ti=function(){function t(t){this.gl=t,this.init()}return t.prototype.init=function(){var t=this.gl;this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight;var e=new Ot(t.NEAREST,t.NEAREST),n=new Dt(t.CLAMP_TO_EDGE,t.CLAMP_TO_EDGE),i=new Bt(t.TEXTURE_2D,t.RGB,t.RGB,t.UNSIGNED_BYTE,e,n);this.colorTexture=new kt(t,i),this.colorTexture.initWithSize(this.width,this.height),this.depthBuffer=this.gl.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.depthBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.height),t.bindRenderbuffer(t.RENDERBUFFER,null),this.frameBufferId=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBufferId),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.colorTexture.textureId,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer);var o=t.checkFramebufferStatus(t.FRAMEBUFFER);if(o!=t.FRAMEBUFFER_COMPLETE){switch(o){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.warn("FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.warn("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.warn("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case t.FRAMEBUFFER_UNSUPPORTED:console.warn("FRAMEBUFFER_UNSUPPORTED");break;default:console.warn("Unknown framebuffer issue")}return t.bindFramebuffer(t.FRAMEBUFFER,null),!1}return t.bindFramebuffer(t.FRAMEBUFFER,null),!0},t.prototype.bind=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.frameBufferId)},t.prototype.unbind=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)},t.prototype.drawDebug=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT);var t=Nt.Instance.getShader(Lt.DEBUG_SELECTION_SHARDER),e=Nt.Instance.getModel(Rt.SELECTION_DEBUG_MODEL);t.bind(),t.setAttributes(e.attributeInfos),t.setUniforms([new Tt("u_texture","texture",this.colorTexture)]),e.render(),t.resetTextureUnit()},t.prototype.destroy=function(){this.colorTexture&&this.colorTexture.destroy(),this.gl.deleteRenderbuffer(this.depthBuffer)},t}(),ei=function(){function t(){}return t.prototype.initWithBuildingObject=function(t){this.id=t.getId(),this.name=t.getName(),this.places=t.getPlaces(),this.scale=t.getScale(),this.bearing=t.getBearing(),this.location=t.getLocation(),this.elevation=t.getElevation(),this.heightScale=t.getHeightScale(),this.camera=t.getCamera(),this.types=t.getTypes(),this._isVerified=t.isVerified(),this.minZoom=t.getMinZoom(),this.maxZoom=t.getMaxZoom(),this.startDate=new Date(t.getStartDate()),this.endDate=new Date(t.getEndDate())},t.prototype.setId=function(t){this.id=t},t.prototype.getId=function(){return this.id},t.prototype.getName=function(){return this.name},t.prototype.setName=function(t){this.name=t},t.prototype.setPlaces=function(t){this.places=t},t.prototype.getPlaces=function(){return this.places},t.prototype.setScale=function(t){this.scale=t},t.prototype.getScale=function(){return this.scale},t.prototype.setBearing=function(t){this.bearing=t},t.prototype.getBearing=function(){return this.bearing},t.prototype.setLocation=function(t){this.location=t},t.prototype.getLocation=function(){return this.location},t.prototype.setElevation=function(t){this.elevation=t},t.prototype.getElevation=function(){return this.elevation},t.prototype.setHeightScale=function(t){this.heightScale=t},t.prototype.getHeightScale=function(){return this.heightScale},t.prototype.setCamera=function(t){this.camera=t},t.prototype.getCamera=function(){return this.camera},t.prototype.setTypes=function(t){this.types=t},t.prototype.getTypes=function(){return this.types},t.prototype.setVerified=function(t){this._isVerified=t},t.prototype.isVerified=function(){return this._isVerified},t.prototype.setMinZoom=function(t){this.minZoom=t},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.setMaxZoom=function(t){this.maxZoom=t},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.setStartDate=function(t){this.startDate=t},t.prototype.getStartDate=function(){return this.startDate},t.prototype.setEndDate=function(t){this.endDate=t},t.prototype.getEndDate=function(){return this.endDate},t}(),ni=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ii=function(t){function e(e,n){var i=t.call(this)||this;i.gl=null,i.mapIsChanging=!1,i.defaultMapOptions={center:[-1,-1],zoom:12,minZoom:o.defaultMinZoom,maxZoom:o.defaultMaxZoom,geolocate:!1,mapControls:!1,mapControlOptions:nn.BOTTOM_RIGHT,tilt:0},i.defaultAnimationOptions={duration:null,easing:null,animate:!1},i.defaultPaddingOptions={top:0,bottom:0,left:0,right:0};var r={};return g.extendOptions(r,i.defaultMapOptions,n),i.options=r,i.setupViews(e,r),i.setupComponents(r),i.addEvents(),i.loop(),i.frameBuffer=new ti(i.gl),i}return ni(e,t),e.prototype.setOptions=function(t){var e={};g.extendOptions(e,this.defaultMapOptions,t),this.options=e,this.mapState.setTarget(l.convert(e.center)),this.mapState.setZoom(e.zoom),this.mapState.setTilt(e.tilt),this.mapSettings.setMinZoom(e.minZoom),this.mapSettings.setMaxZoom(e.maxZoom),this.cameraAnimation=new pe(this.mapState,this,this.mapSettings);var n=document.getElementsByClassName("mf-ui");n.length>0&&n[0].remove();var i=P.create("div","mf-ui "+this.getClassNameZoomControlOptions(e.zoomControlOptions),this.canvasContainer);if(e.mapControls){var o=P.create("div","mf-ui "+this.getClassNameZoomControlOptions(t.mapControlOptions),i);e.geolocate&&(this.geolocateControl=new Vn(o,this)),this.zoomInButton=P.create("div","mf-button",o),this.zoomInButton.innerHTML="<a class='mf-zoom-in-icon'></a>",this.zoomOutButton=P.create("div","mf-button",o),this.zoomOutButton.innerHTML="<a class='mf-zoom-out-icon'></a>"}this.addEvents(),this.reload(),this.tileManager.updateVisibleTiles()},e.prototype.loop=function(){this.resize(),this.dirty&&(this.dirty=!1,this.update(),this.render(),(this.mapIsChanging||this.mapState.isFlyingTo()||this.mapState.isPanning()||this.mapState.isZoomIn()||this.mapState.isZoomOut()||this.mapState.isStartedAnimation()||this.mapState.isMoving())&&(this.dirty=!0)),requestAnimationFrame(this.loop.bind(this))},e.prototype.update=function(){var t=this;this.cameraAnimation.updateTransitions(),this.annotationManager.update(),this.layers.forEach(function(e){e.update(t.mapState)})},e.prototype.resize=function(){if(null!=this.canvas){g.devicePixelScale=window.devicePixelRatio||1,g.pixelScale=Math.round(g.devicePixelScale);var t=this.canvas.offsetWidth*g.devicePixelScale,e=this.canvas.offsetHeight*g.devicePixelScale;this.width==t&&this.height==e||(this.width=t,this.height=e,this.canvas.width=this.width,this.canvas.height=this.height,this.gl.viewport(0,0,this.width,this.height),this.mapState.setScreenSize(this.width,this.height),this.reload(),this.tileManager.updateVisibleTiles(),this.buildingLayer.setDirty())}},e.prototype.render=function(){var t=this.gl;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.mapRenderer.render()},e.prototype.renderSelection=function(){var t=this.gl;t.clearColor(1,1,1,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.mapRenderer.renderSelection()},e.prototype.getSelectionCode=function(t){if(null!=this.frameBuffer){this.frameBuffer.bind(),this.renderSelection();var e=new Uint8Array([0,0,0,0]);this.gl.readPixels(t.x,this.height-t.y,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);var n=e[0],i=e[1],o=e[2];return this.frameBuffer.unbind(),n<<16|i<<8|o}return-1},e.prototype.createLayer=function(t,e,n){if(this.layers.has(t))return console.log("Cannot create layer which layer id already exist"),null;var i=Fn.createLayer(t,e,this.tileManager,n);return null!=i?(this.mapRenderer.addLayer(i),this.layers.set(t,i),i):null},e.prototype.removeLayer=function(t){this.mapRenderer.removeLayer(t),this.layers.delete(t)},e.createCameraAnimationOptions=function(t){var e=new ue;if(t.animate){if(null!=t.duration&&t.duration<0)throw new Error("Animation duration must be greater or equal to 0");e.easing=t.easing}return e.duration=t.duration,e},e.prototype.panBy=function(t,n){n=g.extendOptions({},this.defaultAnimationOptions,n),this.cameraAnimation.moveBy(t,e.createCameraAnimationOptions(n))},e.prototype.panTo=function(t,n){null==(n=g.extendOptions({},this.defaultAnimationOptions,n)).duration&&(n.duration=g.getTimePanTo(this.mapState.getTarget(),t,this.mapState.getZoom())),this.cameraAnimation.moveTo(t,this.mapState.getZoom(),e.createCameraAnimationOptions(n))},e.prototype.flyTo=function(t,n,i){var r=new le;r.target=t,r.zoom=n,r.zoom<o.defaultMinZoom3d&&this.mapSettings.is3dMode()&&this.mapState.enable3dMode(!1)&&this.tileManager.clearTileCache(),i=g.extendOptions({},this.defaultAnimationOptions,i),this.cameraAnimation.flyTo(r,e.createCameraAnimationOptions(i))},e.prototype.moveTo=function(t,n,i){n<o.defaultMinZoom3d&&this.mapSettings.is3dMode()&&this.mapState.enable3dMode(!1)&&this.tileManager.clearTileCache(),i=g.extendOptions({},this.defaultAnimationOptions,i),this.cameraAnimation.moveTo(t,n,e.createCameraAnimationOptions(i))},e.prototype.fitBounds=function(t,e,n){if((e=g.extendOptions({},this.defaultPaddingOptions,e)).top<0||e.bottom<0||e.left<0||e.right<0)throw new Error("Padding value must be greater or equal to 0");var i=this.getCameraPositionForLatLngBounds(t,e.left,e.top,e.right,e.bottom);this.flyTo(i.getTarget(),i.getZoom(),n)},e.prototype.moveBy=function(t){this.cameraAnimation.moveBy(t)},e.prototype.moveByVelocity=function(t){this.mapState.isPanning()||this.mapState.isZoomIn()||this.mapState.isZoomOut()||this.cameraAnimation.moveByVelocity(t)},e.prototype.getCameraPositionForLatLngBounds=function(t,e,n,i,a){var s=t.getSouthwest(),u=t.getNortheast();if(Math.abs(s.lat()-u.lat())<r.epsilon&&Math.abs(s.lng()-u.lng())<r.epsilon){var l=this.mapState.getCameraPosition();return new B(s,l.getTilt(),l.getBearing(),this.mapSettings.getMaxZoom())}var h=this.mapState.getScreenSize(),c=v.latLngToScreenCoordinateZoom(s,0,this.mapState,o.defaultMaxZoom),p=v.latLngToScreenCoordinateZoom(u,0,this.mapState,o.defaultMaxZoom),g=c.x+e,m=p.x-i,y=p.y-n,x=c.y+a,A=v.screenCoordinateToLatLngZoom(new f((g+m)/2,(y+x)/2),this.mapState,o.defaultMaxZoom),M=p.x-c.x,T=c.y-p.y,w=h.x/(M<=0?1:M),b=h.y/(T<=0?1:T);w-=(e+i)/(M<=0?1:M),b-=(n+a)/(T<=0?1:T);var _=o.defaultMaxZoom+Math.log2(Math.min(w,b));_=d.clamp(_,this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()),_=Math.floor(_);var S=this.mapState.getCameraPosition();return new B(A,S.getTilt(),S.getBearing(),_)},e.prototype.setZoom=function(t,e,n){void 0===n&&(n=0);var o=new ue;o.duration=n,t=d.clamp(t,this.mapSettings.getPreferMinZoom(),this.mapSettings.getMaxZoom()),this.cameraAnimation.zoom(t,e,o),this.mapsEventManager.notify(i.zoomChanged)},e.prototype.setTilt=function(t){this.mapsEventManager.notify(i.tiltChanged),this.cameraAnimation.setTilt(t)},e.prototype.setBearing=function(t,e){void 0===e&&(e=0),this.cameraAnimation.setBearing(t,e)},e.prototype.stopAnimation=function(){this.cameraAnimation.stopAnimation()},e.prototype.setMapUrl=function(t,e){void 0===e&&(e=!1),this.mapSettings.getMapUrl()!=t&&(this.mapSettings.setMapUrl(t,e),e&&this.mapSettings.is3dMode()&&(this.buildingResourceManager.removeAllResources(),this.buildingLayer.clear()),this.tileManager.reload())},e.prototype.enable3dMode=function(t){if(t!=this.mapState.is3dMode()&&this.mapState.enable3dMode(t))if(this.tileManager.reload(),t){var e=d.clamp(this.mapState.getZoom(),o.defaultMinZoom3d,this.mapSettings.getMaxZoom());this.moveTo(this.mapState.getTarget(),e)}else this.buildingResourceManager.removeAllResources(),this.buildingLayer.clear()},e.prototype.getCurrentMousePosition=function(t){return new f((t.clientX-this.canvas.getBoundingClientRect().left)*g.devicePixelScale,(t.clientY-this.canvas.getBoundingClientRect().top)*g.devicePixelScale)},e.prototype.getMapUrl=function(){return this.mapSettings.getMapUrl()},e.prototype.setMinZoom=function(t){this.mapSettings.setMinZoom(t)},e.prototype.setMaxZoom=function(t){this.mapSettings.setMaxZoom(t)},e.prototype.setMaxNativeZoom=function(t){t=d.clamp(t,o.defaultMinZoom,o.defaultMaxZoom),this.mapSettings.setMaxNativeZoom(t)},e.prototype.addTileArea=function(t){return this.tileAreaManager.addTileArea(t)},e.prototype.removeTileArea=function(t){this.tileAreaManager.removeTileArea(t)},e.prototype.addAnnotation=function(t){return this.dirty=!0,this.annotationManager.addAnnotation(t)},e.prototype.updateAnnotation=function(t,e){void 0===e&&(e=!1),this.dirty=!0,this.annotationManager.updateAnnotation(t,e)},e.prototype.removeAnnotation=function(t){this.dirty=!0,this.annotationManager.removeAnnotation(t)},e.prototype.screenCoordinateToLatLng=function(t){return v.screenCoordinateToLatLng(t,this.mapState)},e.prototype.latLngToScreenCoordinate=function(t){return v.latLngToScreenCoordinate(t,0,this.mapState)},e.prototype.getCenterCamera=function(){return this.mapState.getTarget()},e.prototype.setCenterCamera=function(t){this.mapsEventManager.notify(i.centerChanged),this.buildingLayer.setDirty(),this.mapState.setTarget(t)},e.prototype.getCameraPosition=function(){return this.mapState.getCameraPosition()},e.prototype.setCameraPosition=function(t){this.mapState.setCameraPosition(t),this.mapsEventManager.notify(i.centerChanged)},e.prototype.setSwitchMode=function(t){this.mapState.setSwitchMode(t)},e.prototype.reload=function(){this.tileManager.reload()},e.prototype.setupComponents=function(t){var e=this,n={};g.extendOptions(n,this.defaultMapOptions,t),Nt.Instance.init(this.gl),this.layers=new Map,this.httpTaskManager=new ft,this.mapSettings=new N,this.mapState=new Z(this.mapSettings),this.mapRenderer=new re(this.gl,this.mapState),this.cameraAnimation=new pe(this.mapState,this,this.mapSettings),this.dirty=!0,this.mapObserver=new O,this.mapsEventManager=new R(this),d.clamp(n.tilt,0,45),this.mapState.setTarget(l.convert(n.center)),this.mapState.setZoom(n.zoom),this.mapState.setTilt(n.tilt),this.mapState.setScreenSize(this.width,this.height),this.mapSettings.setMinZoom(n.minZoom),this.mapSettings.setMaxZoom(n.maxZoom);var i=function(){e.dirty=!0};this.buildingResourceManager=new $n(this.gl,this.httpTaskManager,i),this.tileManager=new rt(this,this.httpTaskManager,this.mapState,this.mapSettings,this.buildingResourceManager,function(t){return new Qn(t,e.annotationManager,e.gl)},i),this.tileAreaManager=new pn(this.tileManager),this.createLayer("1.rasterLayer",pt.RASTER,o.rasterLayerOrder),this.buildingLayer=this.createLayer("2.buildingLayer",pt.BUILDING,o.buildingLayerOrder),this.buildingLayer.setBuildingResourceManager(this.buildingResourceManager),this.annotationManager=new cn(this)},e.prototype.setupViews=function(t,e){var n=P.create("div","mf-mapgl",t);this.canvasContainer=n,this.canvas=P.create("canvas","",n),this.gl=this.canvas.getContext("experimental-webgl");var i=p.fromHex("f2efe9");this.gl.clearColor(i.red,i.green,i.blue,i.alpha),g.devicePixelScale=window.devicePixelRatio||1,g.pixelScale=Math.round(g.devicePixelScale),this.width=this.canvas.offsetWidth*g.devicePixelScale,this.height=this.canvas.offsetHeight*g.devicePixelScale;var o=document.createElement("style");o.innerHTML=c.content,document.getElementsByTagName("head")[0].appendChild(o);var r=P.create("div","mf-ui",n);if(e.mapControls){var a=P.create("div","mf-ui "+this.getClassNameZoomControlOptions(e.mapControlOptions),r);e.geolocate&&(this.geolocateControl=new Vn(a,this)),this.zoomInButton=P.create("div","mf-button",a),this.zoomInButton.innerHTML="<a class='mf-zoom-in-icon'></a>",this.zoomOutButton=P.create("div","mf-button",a),this.zoomOutButton.innerHTML="<a class='mf-zoom-out-icon'></a>"}},e.prototype.getClassNameZoomControlOptions=function(t){switch(t){case nn.TOP_LEFT:return"mf-ui-top-left";case nn.TOP_RIGHT:return"mf-ui-top-right";case nn.BOTTOM_LEFT:return"mf-ui-bottom-left";case nn.BOTTOM_RIGHT:return"mf-ui-bottom-right"}},e.prototype.addEvents=function(){var t=this;this.mouseEventHandler=new I(this.canvas,this),window.addEventListener("resize",this.resize,!1),this.options.mapControls&&(this.zoomInButton.addEventListener("click",function(){t.setZoom(t.mapState.getZoom()+1,new f(t.width/2,t.height/2))}),this.zoomOutButton.addEventListener("click",function(){t.setZoom(t.mapState.getZoom()-1,new f(t.width/2,t.height/2))}))},e.prototype.addListener=function(t,e){return this.mapsEventManager.addEvent(t,e)},e.prototype.notifyCameraWillChange=function(){this.dirty=!0,this.mapIsChanging=!0,this.mapsEventManager.notify(i.centerWillChanged)},e.prototype.notifyCameraIsChanging=function(){this.dirty=!0,this.mapsEventManager.notify(i.centerChanged),this.buildingLayer.setDirty(),this.tileManager.updateVisibleTiles()},e.prototype.notifyCameraDidChange=function(){this.mapIsChanging=!1,this.mapsEventManager.notify(i.idle)},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e.prototype.queryMarkerAnnotation=function(t){return this.annotationManager.queryMarkerAnnotation(t)},e.prototype.queryShapeAnnotation=function(t){return this.annotationManager.queryShapeAnnotation(t)},e.prototype.queryBuildingInfo=function(t){var e=this.getSelectionCode(t),n=this.buildingLayer;if(0==n.colorBuildingGroups.size&&0==n.textureBuildingGroups.size&&0==n.extrudeBuildings.length)return null;var i=new ei,o=!1;return 0!=n.textureBuildingGroups.size&&n.textureBuildingGroups.forEach(function(t){t.buildings.forEach(function(t){if(t.getSelectionCode()==e)return i.initWithBuildingObject(t),void(o=!0)})}),0==n.colorBuildingGroups.size||o||n.colorBuildingGroups.forEach(function(t){t.buildings.forEach(function(t){if(t.getSelectionCode()==e)return i.initWithBuildingObject(t),void(o=!0)})}),0==n.extrudeBuildings.length||o||n.extrudeBuildings.forEach(function(t){if(t.getSelectionCode()==e)return i.initWithBuildingObject(t),void(o=!0)}),o?i:null},e.prototype.setTime=function(t){this.mapSettings.setTime(t.getTime()),this.reload(),this.mapSettings.is3dMode()&&(this.buildingResourceManager.removeAllResources(),this.buildingLayer.clear())},e}(D);!function(t){t[t.Auto2DTo3D=0]="Auto2DTo3D",t[t.Auto3DTo2D=1]="Auto3DTo2D",t[t.Auto=2]="Auto",t[t.Manual=3]="Manual"}(en||(en={})),function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_LEFT=2]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=3]="BOTTOM_RIGHT"}(nn||(nn={}));var oi=function(){function t(t,e){if(null==e.accessKey){var n="Map4D SDK: Missing access key!";throw alert(n),new Error(n)}this._mapView=new ii(t,e)}return Object.defineProperty(t.prototype,"mapView",{get:function(){return this._mapView},enumerable:!0,configurable:!0}),t.prototype.enable3dMode=function(t){this.mapView.enable3dMode(t)},t.prototype.getBounds=function(){},t.prototype.getCenter=function(){return this.mapView.getCenterCamera()},t.prototype.setCenter=function(t){this.mapView.setCenterCamera(t)},t.prototype.getZoom=function(){return this.mapView.mapState.getZoom()},t.prototype.setZoom=function(t){this.mapView.mapState.setZoom(t)},t.prototype.getTilt=function(){return this.mapView.mapState.getTilt()},t.prototype.setTilt=function(t){this.mapView.mapState.setTilt(t)},t.prototype.setMapUrl=function(t){this.mapView.setMapUrl(t)},t.prototype.getMapUrl=function(){return this.mapView.getMapUrl()},t.prototype.setMinZoom=function(t){this.mapView.setMinZoom(t)},t.prototype.setMaxZoom=function(t){this.mapView.setMaxZoom(t)},t.prototype.panBy=function(t,e){this.mapView.panBy(x.convert(t),e)},t.prototype.panTo=function(t,e){this.mapView.panTo(l.convert(t),e)},t.prototype.flyTo=function(t,e,n){this.mapView.flyTo(l.convert(t),e,n)},t.prototype.moveTo=function(t,e,n){this.mapView.moveTo(l.convert(t),e,n)},t.prototype.fitBounds=function(t,e,n){this._mapView.fitBounds(y.convert(t),e,n)},t.prototype.setSwitchMode=function(t){this.mapView.setSwitchMode(t)},t.prototype.addListener=function(t,e){return this.mapView.addListener(t,e)},t.prototype.setTime=function(t){this.mapView.setTime(t)},t}(),ri=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ai=function(t){function e(e){var n=t.call(this)||this;n.defaultTileArea={url:o.baseMapUrl,minZoom:o.defaultMinZoom,maxZoom:o.defaultMaxZoom};var i={};return g.extendOptions(i,n.defaultTileArea,e),n._bounds=y.convert(i.bounds),n._url=i.url,n._minZoom=i.minZoom,n._maxZoom=i.maxZoom,n}return ri(e,t),e.prototype.getBounds=function(){return this._bounds},e.prototype.getUrl=function(){return this._url},e.prototype.getMinZoom=function(){return this._minZoom},e.prototype.getMaxZoom=function(){return this._maxZoom},e.prototype.setBounds=function(t){this._bounds=y.convert(t),null!=this._map&&this._map.mapView.reload()},e.prototype.setMinZoom=function(t){this._minZoom!=t&&(this._minZoom=t,null!=this._map&&this._map.mapView.reload())},e.prototype.setMaxZoom=function(t){this._maxZoom!=t&&(this._maxZoom=t,null!=this._map&&this._map.mapView.reload())},e.prototype.setUrl=function(t){this._url!=t&&(this._url=t,null!=this._map&&this._map.mapView.reload())},e.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&(this._map.mapView.removeTileArea(this._id),this._id=-1),this._map=t,null!=this._map&&(this._id=this._map.mapView.addTileArea(this)))},e}(A),si=function(){function t(t){this.map=t}return t.prototype.fromLatLngToScreen=function(t){var e=this.map.mapView.latLngToScreenCoordinate(t);return new x(e.x,e.y)},t.prototype.fromScreenToLatLng=function(t){var e=x.convert(t);return this.map.mapView.screenCoordinateToLatLng(new f(e.x,e.y))},t}();n.d(e,"Map",function(){return oi}),n.d(e,"ControlOptions",function(){return nn}),n.d(e,"Marker",function(){return Ce}),n.d(e,"Polyline",function(){return T}),n.d(e,"Polygon",function(){return b}),n.d(e,"Circle",function(){return S}),n.d(e,"TileArea",function(){return ai}),n.d(e,"Projection",function(){return si}),n.d(e,"LatLng",function(){return l}),n.d(e,"LatLngBounds",function(){return y}),n.d(e,"Icon",function(){return Se}),n.d(e,"Point",function(){return x}),n.d(e,"CameraPosition",function(){return B}),n.d(e,"SwitchMode",function(){return en})}]);
//# sourceMappingURL=map4dsdk@0.0.5.production.js.map