var map4d=function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){"use strict";t.exports=o,t.exports.default=o;var i=n(6);function o(t,e){if(!(this instanceof o))return new o(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function r(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function a(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,o){o||(o=y(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var r,a=e;a<n;a++)r=t.children[a],u(o,t.leaf?i(r):r);return o}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function h(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function d(t,e){var n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),o=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,o-n)*Math.max(0,r-i)}function g(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function m(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function y(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,e,n,o,r){for(var a,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=o||(a=e+Math.ceil((n-e)/o/2)*o,i(t,a,e,n,r),s.push(e,a,a,n))}o.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!m(t,e))return n;for(var o,r,a,s,u=[];e;){for(o=0,r=e.children.length;o<r;o++)a=e.children[o],m(t,s=e.leaf?i(a):a)&&(e.leaf?n.push(a):g(t,s)?this._all(a,n):u.push(a));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!m(t,e))return!1;for(var i,o,r,a,s=[];e;){for(i=0,o=e.children.length;i<o;i++)if(r=e.children[i],m(t,a=e.leaf?n(r):r)){if(e.leaf||g(t,a))return!0;s.push(r)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var o=this.data;this.data=i,i=o}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=y([]),this},remove:function(t,e){if(!t)return this;for(var n,i,o,a,s=this.data,u=this.toBBox(t),l=[],h=[];s||l.length;){if(s||(s=l.pop(),i=l[l.length-1],n=h.pop(),a=!0),s.leaf&&-1!==(o=r(t,s.children,e)))return s.children.splice(o,1),l.push(s),this._condense(l),this;a||s.leaf||!g(s,u)?i?(n++,s=i.children[n],a=!1):s=null:(l.push(s),h.push(n),n=0,i=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:l,compareMinY:h,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var o,r=n-e+1,s=this._maxEntries;if(r<=s)return a(o=y(t.slice(e,n+1)),this.toBBox),o;i||(i=Math.ceil(Math.log(r)/Math.log(s)),s=Math.ceil(r/Math.pow(s,i-1))),(o=y([])).leaf=!1,o.height=i;var u,l,h,c,p=Math.ceil(r/s),f=p*Math.ceil(Math.sqrt(s));for(v(t,e,n,f,this.compareMinX),u=e;u<=n;u+=f)for(v(t,u,h=Math.min(u+f-1,n),p,this.compareMinY),l=u;l<=h;l+=p)c=Math.min(l+p-1,h),o.children.push(this._build(t,l,c,i-1));return a(o,this.toBBox),o},_chooseSubtree:function(t,e,n,i){for(var o,r,a,s,u,l,h,p;i.push(e),!e.leaf&&i.length-1!==n;){for(h=p=1/0,o=0,r=e.children.length;o<r;o++)u=c(a=e.children[o]),(l=f(t,a)-u)<p?(p=l,h=u<h?u:h,s=a):l===p&&u<h&&(h=u,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,o=n?t:i(t),r=[],a=this._chooseSubtree(o,this.data,e,r);for(a.children.push(t),u(a,o);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(o,r,e)},_split:function(t,e){var n=t[e],i=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,i);var r=this._chooseSplitIndex(n,o,i),s=y(n.children.splice(r,n.children.length-r));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=y([t,e]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,o,r,a,u,l,h,p;for(l=h=1/0,i=e;i<=n-e;i++)a=d(o=s(t,0,i,this.toBBox),r=s(t,i,n,this.toBBox)),u=c(o)+c(r),a<l?(l=a,p=i,h=u<h?u:h):a===l&&u<h&&(h=u,p=i);return p},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:l,o=t.leaf?this.compareMinY:h;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,o)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var o,r,a=this.toBBox,l=s(t,0,e,a),h=s(t,n-e,n,a),c=p(l)+p(h);for(o=e;o<n-e;o++)r=t.children[o],u(l,t.leaf?a(r):r),c+=p(l);for(o=n-e-1;o>=e;o--)r=t.children[o],u(h,t.leaf?a(r):r),c+=p(h);return c},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)u(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():a(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,n){"use strict";function i(t,e){this.x=t,this.y=e}t.exports=i,i.prototype={clone:function(){return new i(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=e,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,o=n*this.x+e*this.y;return this.x=i,this.y=o,this},_rotateAround:function(t,e){var n=Math.cos(t),i=Math.sin(t),o=e.x+n*(this.x-e.x)-i*(this.y-e.y),r=e.y+i*(this.x-e.x)+n*(this.y-e.y);return this.x=o,this.y=r,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(t){return t instanceof i?t:Array.isArray(t)?new i(t[0],t[1]):t}},function(t,e,n){"use strict";function i(t,e,n){n=n||2;var i,s,u,l,h,f,g,m=e&&e.length,y=m?e[0]*n:t.length,v=o(t,0,y,n,!0),A=[];if(!v||v.next===v.prev)return A;if(m&&(v=function(t,e,n,i){var a,s,u,l,h,f=[];for(a=0,s=e.length;a<s;a++)u=e[a]*i,l=a<s-1?e[a+1]*i:t.length,(h=o(t,u,l,i,!1))===h.next&&(h.steiner=!0),f.push(d(h));for(f.sort(c),a=0;a<f.length;a++)p(f[a],n),n=r(n,n.next);return n}(t,e,v,n)),t.length>80*n){i=u=t[0],s=l=t[1];for(var w=n;w<y;w+=n)h=t[w],f=t[w+1],h<i&&(i=h),f<s&&(s=f),h>u&&(u=h),f>l&&(l=f);g=0!==(g=Math.max(u-i,l-s))?1/g:0}return a(v,A,n,i,s,g),A}function o(t,e,n,i,o){var r,a;if(o===T(t,e,n,i)>0)for(r=e;r<n;r+=i)a=x(r,t[r],t[r+1],a);else for(r=n-i;r>=e;r-=i)a=x(r,t[r],t[r+1],a);return a&&v(a,a.next)&&(_(a),a=a.next),a}function r(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!v(i,i.next)&&0!==y(i.prev,i,i.next))i=i.next;else{if(_(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function a(t,e,n,i,o,c,p){if(t){!p&&c&&function(t,e,n,i){var o=t;do{null===o.z&&(o.z=f(o.x,o.y,e,n,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,function(t){var e,n,i,o,r,a,s,u,l=1;do{for(n=t,t=null,r=null,a=0;n;){for(a++,i=n,s=0,e=0;e<l&&(s++,i=i.nextZ);e++);for(u=l;s>0||u>0&&i;)0!==s&&(0===u||!i||n.z<=i.z)?(o=n,n=n.nextZ,s--):(o=i,i=i.nextZ,u--),r?r.nextZ=o:t=o,o.prevZ=r,r=o;n=i}r.nextZ=null,l*=2}while(a>1)}(o)}(t,i,o,c);for(var d,g,m=t;t.prev!==t.next;)if(d=t.prev,g=t.next,c?u(t,i,o,c):s(t))e.push(d.i/n),e.push(t.i/n),e.push(g.i/n),_(t),t=g.next,m=g.next;else if((t=g)===m){p?1===p?a(t=l(t,e,n),e,n,i,o,c,2):2===p&&h(t,e,n,i,o,c):a(r(t),e,n,i,o,c,1);break}}}function s(t){var e=t.prev,n=t,i=t.next;if(y(e,n,i)>=0)return!1;for(var o=t.next.next;o!==t.prev;){if(g(e.x,e.y,n.x,n.y,i.x,i.y,o.x,o.y)&&y(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function u(t,e,n,i){var o=t.prev,r=t,a=t.next;if(y(o,r,a)>=0)return!1;for(var s=o.x<r.x?o.x<a.x?o.x:a.x:r.x<a.x?r.x:a.x,u=o.y<r.y?o.y<a.y?o.y:a.y:r.y<a.y?r.y:a.y,l=o.x>r.x?o.x>a.x?o.x:a.x:r.x>a.x?r.x:a.x,h=o.y>r.y?o.y>a.y?o.y:a.y:r.y>a.y?r.y:a.y,c=f(s,u,e,n,i),p=f(l,h,e,n,i),d=t.prevZ,m=t.nextZ;d&&d.z>=c&&m&&m.z<=p;){if(d!==t.prev&&d!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,m!==t.prev&&m!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,m.x,m.y)&&y(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;d&&d.z>=c;){if(d!==t.prev&&d!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,d.x,d.y)&&y(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;m&&m.z<=p;){if(m!==t.prev&&m!==t.next&&g(o.x,o.y,r.x,r.y,a.x,a.y,m.x,m.y)&&y(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function l(t,e,n){var i=t;do{var o=i.prev,r=i.next.next;!v(o,r)&&A(o,i,i.next,r)&&w(o,r)&&w(r,o)&&(e.push(o.i/n),e.push(i.i/n),e.push(r.i/n),_(i),_(i.next),i=t=r),i=i.next}while(i!==t);return i}function h(t,e,n,i,o,s){var u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&m(u,l)){var h=M(u,l);return u=r(u,u.next),h=r(h,h.next),a(u,e,n,i,o,s),void a(h,e,n,i,o,s)}l=l.next}u=u.next}while(u!==t)}function c(t,e){return t.x-e.x}function p(t,e){if(e=function(t,e){var n,i=e,o=t.x,r=t.y,a=-1/0;do{if(r<=i.y&&r>=i.next.y&&i.next.y!==i.y){var s=i.x+(r-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=o&&s>a){if(a=s,s===o){if(r===i.y)return i;if(r===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(o===a)return n.prev;var u,l=n,h=n.x,c=n.y,p=1/0;i=n.next;for(;i!==l;)o>=i.x&&i.x>=h&&o!==i.x&&g(r<c?o:a,r,h,c,r<c?a:o,r,i.x,i.y)&&((u=Math.abs(r-i.y)/(o-i.x))<p||u===p&&i.x>n.x)&&w(i,t)&&(n=i,p=u),i=i.next;return n}(t,e)){var n=M(e,t);r(n,n.next)}}function f(t,e,n,i,o){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*o)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*o)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function g(t,e,n,i,o,r,a,s){return(o-a)*(e-s)-(t-a)*(r-s)>=0&&(t-a)*(i-s)-(n-a)*(e-s)>=0&&(n-a)*(r-s)-(o-a)*(i-s)>=0}function m(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&A(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&w(t,e)&&w(e,t)&&function(t,e){var n=t,i=!1,o=(t.x+e.x)/2,r=(t.y+e.y)/2;do{n.y>r!=n.next.y>r&&n.next.y!==n.y&&o<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)}function y(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function v(t,e){return t.x===e.x&&t.y===e.y}function A(t,e,n,i){return!!(v(t,e)&&v(n,i)||v(t,i)&&v(n,e))||y(t,e,n)>0!=y(t,e,i)>0&&y(n,i,t)>0!=y(n,i,e)>0}function w(t,e){return y(t.prev,t,t.next)<0?y(t,e,t.next)>=0&&y(t,t.prev,e)>=0:y(t,e,t.prev)<0||y(t,t.next,e)<0}function M(t,e){var n=new b(t.i,t.x,t.y),i=new b(e.i,e.x,e.y),o=t.next,r=e.prev;return t.next=e,e.prev=t,n.next=o,o.prev=n,i.next=n,n.prev=i,r.next=i,i.prev=r,i}function x(t,e,n,i){var o=new b(t,e,n);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function _(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function b(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,n,i){for(var o=0,r=e,a=n-i;r<n;r+=i)o+=(t[a]-t[r])*(t[r+1]+t[a+1]),a=r;return o}t.exports=i,t.exports.default=i,i.deviation=function(t,e,n,i){var o=e&&e.length,r=o?e[0]*n:t.length,a=Math.abs(T(t,0,r,n));if(o)for(var s=0,u=e.length;s<u;s++){var l=e[s]*n,h=s<u-1?e[s+1]*n:t.length;a-=Math.abs(T(t,l,h,n))}var c=0;for(s=0;s<i.length;s+=3){var p=i[s]*n,f=i[s+1]*n,d=i[s+2]*n;c+=Math.abs((t[p]-t[d])*(t[f+1]-t[p+1])-(t[p]-t[f])*(t[d+1]-t[p+1]))}return 0===a&&0===c?0:Math.abs((c-a)/a)},i.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,o=0;o<t.length;o++){for(var r=0;r<t[o].length;r++)for(var a=0;a<e;a++)n.vertices.push(t[o][r][a]);o>0&&(i+=t[o-1].length,n.holes.push(i))}return n}},function(t,e,n){"use strict";var i=n(7);function o(t){return{type:"Feature",geometry:i.tileToGeoJSON(t),properties:{}}}function r(t,e){var n,o,r=t.coordinates,s=e.max_zoom,c={},p=[];if("Point"===t.type)return[i.pointToTile(r[0],r[1],s)];if("MultiPoint"===t.type)for(n=0;n<r.length;n++)c[h((o=i.pointToTile(r[n][0],r[n][1],s))[0],o[1],o[2])]=!0;else if("LineString"===t.type)u(c,r,s);else if("MultiLineString"===t.type)for(n=0;n<r.length;n++)u(c,r[n],s);else if("Polygon"===t.type)a(c,p,r,s);else{if("MultiPolygon"!==t.type)throw new Error("Geometry type not implemented");for(n=0;n<r.length;n++)a(c,p,r[n],s)}if(e.min_zoom!==s){var f=p.length;for(l(c,p),n=0;n<f;n++){var d=p[n];c[h(d[0],d[1],d[2])]=!0}return function(t,e,n){for(var i=[],o=n.max_zoom;o>n.min_zoom;o--){for(var r={},a=[],s=0;s<e.length;s++){var u=e[s];if(u[0]%2==0&&u[1]%2==0){var l=h(u[0]+1,u[1],o),c=h(u[0],u[1]+1,o),p=h(u[0]+1,u[1]+1,o);if(t[l]&&t[c]&&t[p]){t[h(u[0],u[1],u[2])]=!1,t[l]=!1,t[c]=!1,t[p]=!1;var f=[u[0]/2,u[1]/2,o-1];o-1===n.min_zoom?i.push(f):(r[h(u[0]/2,u[1]/2,o-1)]=!0,a.push(f))}}}for(s=0;s<e.length;s++)u=e[s],t[h(u[0],u[1],u[2])]&&i.push(u);t=r,e=a}return i}(c,p,e)}return l(c,p),p}function a(t,e,n,i){for(var o=[],r=0;r<n.length;r++){var a=[];u(t,n[r],i,a);for(var l=0,c=a.length,p=c-1;l<c;p=l++){var f=(l+1)%c,d=a[l][1];(d>a[p][1]||d>a[f][1])&&(d<a[p][1]||d<a[f][1])&&d!==a[f][1]&&o.push(a[l])}}for(o.sort(s),r=0;r<o.length;r+=2){d=o[r][1];for(var g=o[r][0]+1;g<o[r+1][0];g++){t[h(g,d,i)]||e.push([g,d,i])}}}function s(t,e){return t[1]-e[1]||t[0]-e[0]}function u(t,e,n,o){for(var r,a,s=0;s<e.length-1;s++){var u=i.pointToTileFraction(e[s][0],e[s][1],n),l=i.pointToTileFraction(e[s+1][0],e[s+1][1],n),c=u[0],p=u[1],f=l[0]-c,d=l[1]-p;if(0!==d||0!==f){var g=f>0?1:-1,m=d>0?1:-1,y=Math.floor(c),v=Math.floor(p),A=0===f?1/0:Math.abs(((f>0?1:0)+y-c)/f),w=0===d?1/0:Math.abs(((d>0?1:0)+v-p)/d),M=Math.abs(g/f),x=Math.abs(m/d);for(y===r&&v===a||(t[h(y,v,n)]=!0,o&&v!==a&&o.push([y,v]),r=y,a=v);A<1||w<1;)A<w?(A+=M,y+=g):(w+=x,v+=m),t[h(y,v,n)]=!0,o&&v!==a&&o.push([y,v]),r=y,a=v}}o&&v===o[0][1]&&o.pop()}function l(t,e){for(var n=Object.keys(t),i=0;i<n.length;i++)e.push(c(+n[i]))}function h(t,e,n){return 32*(2*(1<<n)*e+t)+n}function c(t){var e=t%32,n=2*(1<<e),i=(t-e)/32,o=i%n;return[o,(i-o)/n%n,e]}e.geojson=function(t,e){return{type:"FeatureCollection",features:r(t,e).map(o)}},e.tiles=r,e.indexes=function(t,e){return r(t,e).map(i.tileToQuadkey)}},function(t,e,n){"use strict";t.exports=function(t){return new l(t||d,null)};var i=0,o=1;function r(t,e,n,i,o,r){this._color=t,this.key=e,this.value=n,this.left=i,this.right=o,this._count=r}function a(t){return new r(t._color,t.key,t.value,t.left,t.right,t._count)}function s(t,e){return new r(t,e.key,e.value,e.left,e.right,e._count)}function u(t){t._count=1+(t.left?t.left._count:0)+(t.right?t.right._count:0)}function l(t,e){this._compare=t,this.root=e}var h=l.prototype;function c(t,e){this.tree=t,this._stack=e}Object.defineProperty(h,"keys",{get:function(){var t=[];return this.forEach(function(e,n){t.push(e)}),t}}),Object.defineProperty(h,"values",{get:function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t}}),Object.defineProperty(h,"length",{get:function(){return this.root?this.root._count:0}}),h.insert=function(t,e){for(var n=this._compare,a=this.root,h=[],c=[];a;){var p=n(t,a.key);h.push(a),c.push(p),a=p<=0?a.left:a.right}h.push(new r(i,t,e,null,null,1));for(var f=h.length-2;f>=0;--f){a=h[f];c[f]<=0?h[f]=new r(a._color,a.key,a.value,h[f+1],a.right,a._count+1):h[f]=new r(a._color,a.key,a.value,a.left,h[f+1],a._count+1)}for(f=h.length-1;f>1;--f){var d=h[f-1];a=h[f];if(d._color===o||a._color===o)break;var g=h[f-2];if(g.left===d)if(d.left===a){if(!(m=g.right)||m._color!==i){if(g._color=i,g.left=d.right,d._color=o,d.right=g,h[f-2]=d,h[f-1]=a,u(g),u(d),f>=3)(y=h[f-3]).left===g?y.left=d:y.right=d;break}d._color=o,g.right=s(o,m),g._color=i,f-=1}else{if(!(m=g.right)||m._color!==i){if(d.right=a.left,g._color=i,g.left=a.right,a._color=o,a.left=d,a.right=g,h[f-2]=a,h[f-1]=d,u(g),u(d),u(a),f>=3)(y=h[f-3]).left===g?y.left=a:y.right=a;break}d._color=o,g.right=s(o,m),g._color=i,f-=1}else if(d.right===a){if(!(m=g.left)||m._color!==i){if(g._color=i,g.right=d.left,d._color=o,d.left=g,h[f-2]=d,h[f-1]=a,u(g),u(d),f>=3)(y=h[f-3]).right===g?y.right=d:y.left=d;break}d._color=o,g.left=s(o,m),g._color=i,f-=1}else{var m;if(!(m=g.left)||m._color!==i){var y;if(d.left=a.right,g._color=i,g.right=a.left,a._color=o,a.right=d,a.left=g,h[f-2]=a,h[f-1]=d,u(g),u(d),u(a),f>=3)(y=h[f-3]).right===g?y.right=a:y.left=a;break}d._color=o,g.left=s(o,m),g._color=i,f-=1}}return h[0]._color=o,new l(n,h[0])},h.forEach=function(t,e,n){if(this.root)switch(arguments.length){case 1:return function t(e,n){var i;if(n.left&&(i=t(e,n.left)))return i;return(i=e(n.key,n.value))||(n.right?t(e,n.right):void 0)}(t,this.root);case 2:return function t(e,n,i,o){if(n(e,o.key)<=0){var r;if(o.left&&(r=t(e,n,i,o.left)))return r;if(r=i(o.key,o.value))return r}if(o.right)return t(e,n,i,o.right)}(e,this._compare,t,this.root);case 3:if(this._compare(e,n)>=0)return;return function t(e,n,i,o,r){var a,s=i(e,r.key),u=i(n,r.key);if(s<=0){if(r.left&&(a=t(e,n,i,o,r.left)))return a;if(u>0&&(a=o(r.key,r.value)))return a}if(u>0&&r.right)return t(e,n,i,o,r.right)}(e,n,this._compare,t,this.root)}},Object.defineProperty(h,"begin",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.left;return new c(this,t)}}),Object.defineProperty(h,"end",{get:function(){for(var t=[],e=this.root;e;)t.push(e),e=e.right;return new c(this,t)}}),h.at=function(t){if(t<0)return new c(this,[]);for(var e=this.root,n=[];;){if(n.push(e),e.left){if(t<e.left._count){e=e.left;continue}t-=e.left._count}if(!t)return new c(this,n);if(t-=1,!e.right)break;if(t>=e.right._count)break;e=e.right}return new c(this,[])},h.ge=function(t){for(var e=this._compare,n=this.root,i=[],o=0;n;){var r=e(t,n.key);i.push(n),r<=0&&(o=i.length),n=r<=0?n.left:n.right}return i.length=o,new c(this,i)},h.gt=function(t){for(var e=this._compare,n=this.root,i=[],o=0;n;){var r=e(t,n.key);i.push(n),r<0&&(o=i.length),n=r<0?n.left:n.right}return i.length=o,new c(this,i)},h.lt=function(t){for(var e=this._compare,n=this.root,i=[],o=0;n;){var r=e(t,n.key);i.push(n),r>0&&(o=i.length),n=r<=0?n.left:n.right}return i.length=o,new c(this,i)},h.le=function(t){for(var e=this._compare,n=this.root,i=[],o=0;n;){var r=e(t,n.key);i.push(n),r>=0&&(o=i.length),n=r<0?n.left:n.right}return i.length=o,new c(this,i)},h.find=function(t){for(var e=this._compare,n=this.root,i=[];n;){var o=e(t,n.key);if(i.push(n),0===o)return new c(this,i);n=o<=0?n.left:n.right}return new c(this,[])},h.remove=function(t){var e=this.find(t);return e?e.remove():this},h.get=function(t){for(var e=this._compare,n=this.root;n;){var i=e(t,n.key);if(0===i)return n.value;n=i<=0?n.left:n.right}};var p=c.prototype;function f(t,e){t.key=e.key,t.value=e.value,t.left=e.left,t.right=e.right,t._color=e._color,t._count=e._count}function d(t,e){return t<e?-1:t>e?1:0}Object.defineProperty(p,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(p,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),p.clone=function(){return new c(this.tree,this._stack.slice())},p.remove=function(){var t=this._stack;if(0===t.length)return this.tree;var e=new Array(t.length),n=t[t.length-1];e[e.length-1]=new r(n._color,n.key,n.value,n.left,n.right,n._count);for(var h=t.length-2;h>=0;--h){(n=t[h]).left===t[h+1]?e[h]=new r(n._color,n.key,n.value,e[h+1],n.right,n._count):e[h]=new r(n._color,n.key,n.value,n.left,e[h+1],n._count)}if((n=e[e.length-1]).left&&n.right){var c=e.length;for(n=n.left;n.right;)e.push(n),n=n.right;var p=e[c-1];e.push(new r(n._color,p.key,p.value,n.left,n.right,n._count)),e[c-1].key=n.key,e[c-1].value=n.value;for(h=e.length-2;h>=c;--h)n=e[h],e[h]=new r(n._color,n.key,n.value,n.left,e[h+1],n._count);e[c-1].left=e[c]}if((n=e[e.length-1])._color===i){var d=e[e.length-2];d.left===n?d.left=null:d.right===n&&(d.right=null),e.pop();for(h=0;h<e.length;++h)e[h]._count--;return new l(this.tree._compare,e[0])}if(n.left||n.right){n.left?f(n,n.left):n.right&&f(n,n.right),n._color=o;for(h=0;h<e.length-1;++h)e[h]._count--;return new l(this.tree._compare,e[0])}if(1===e.length)return new l(this.tree._compare,null);for(h=0;h<e.length;++h)e[h]._count--;var g=e[e.length-2];return function(t){for(var e,n,r,l,h=t.length-1;h>=0;--h){if(e=t[h],0===h)return void(e._color=o);if((n=t[h-1]).left===e){if((r=n.right).right&&r.right._color===i)return l=(r=n.right=a(r)).right=a(r.right),n.right=r.left,r.left=n,r.right=l,r._color=n._color,e._color=o,n._color=o,l._color=o,u(n),u(r),h>1&&((c=t[h-2]).left===n?c.left=r:c.right=r),void(t[h-1]=r);if(r.left&&r.left._color===i)return l=(r=n.right=a(r)).left=a(r.left),n.right=l.left,r.left=l.right,l.left=n,l.right=r,l._color=n._color,n._color=o,r._color=o,e._color=o,u(n),u(r),u(l),h>1&&((c=t[h-2]).left===n?c.left=l:c.right=l),void(t[h-1]=l);if(r._color===o){if(n._color===i)return n._color=o,void(n.right=s(i,r));n.right=s(i,r);continue}r=a(r),n.right=r.left,r.left=n,r._color=n._color,n._color=i,u(n),u(r),h>1&&((c=t[h-2]).left===n?c.left=r:c.right=r),t[h-1]=r,t[h]=n,h+1<t.length?t[h+1]=e:t.push(e),h+=2}else{if((r=n.left).left&&r.left._color===i)return l=(r=n.left=a(r)).left=a(r.left),n.left=r.right,r.right=n,r.left=l,r._color=n._color,e._color=o,n._color=o,l._color=o,u(n),u(r),h>1&&((c=t[h-2]).right===n?c.right=r:c.left=r),void(t[h-1]=r);if(r.right&&r.right._color===i)return l=(r=n.left=a(r)).right=a(r.right),n.left=l.right,r.right=l.left,l.right=n,l.left=r,l._color=n._color,n._color=o,r._color=o,e._color=o,u(n),u(r),u(l),h>1&&((c=t[h-2]).right===n?c.right=l:c.left=l),void(t[h-1]=l);if(r._color===o){if(n._color===i)return n._color=o,void(n.left=s(i,r));n.left=s(i,r);continue}var c;r=a(r),n.left=r.right,r.right=n,r._color=n._color,n._color=i,u(n),u(r),h>1&&((c=t[h-2]).right===n?c.right=r:c.left=r),t[h-1]=r,t[h]=n,h+1<t.length?t[h+1]=e:t.push(e),h+=2}}}(e),g.left===n?g.left=null:g.right=null,new l(this.tree._compare,e[0])},Object.defineProperty(p,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(p,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(p,"index",{get:function(){var t=0,e=this._stack;if(0===e.length){var n=this.tree.root;return n?n._count:0}e[e.length-1].left&&(t=e[e.length-1].left._count);for(var i=e.length-2;i>=0;--i)e[i+1]===e[i].right&&(++t,e[i].left&&(t+=e[i].left._count));return t},enumerable:!0}),p.next=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.right)for(e=e.right;e;)t.push(e),e=e.left;else for(t.pop();t.length>0&&t[t.length-1].right===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(p,"hasNext",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].right)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].left===t[e])return!0;return!1}}),p.update=function(t){var e=this._stack;if(0===e.length)throw new Error("Can't update empty node!");var n=new Array(e.length),i=e[e.length-1];n[n.length-1]=new r(i._color,i.key,t,i.left,i.right,i._count);for(var o=e.length-2;o>=0;--o)(i=e[o]).left===e[o+1]?n[o]=new r(i._color,i.key,i.value,n[o+1],i.right,i._count):n[o]=new r(i._color,i.key,i.value,i.left,n[o+1],i._count);return new l(this.tree._compare,n[0])},p.prev=function(){var t=this._stack;if(0!==t.length){var e=t[t.length-1];if(e.left)for(e=e.left;e;)t.push(e),e=e.right;else for(t.pop();t.length>0&&t[t.length-1].left===e;)e=t[t.length-1],t.pop()}},Object.defineProperty(p,"hasPrev",{get:function(){var t=this._stack;if(0===t.length)return!1;if(t[t.length-1].left)return!0;for(var e=t.length-1;e>0;--e)if(t[e-1].right===t[e])return!0;return!1}})},function(t,e,n){!function(){"use strict";var e=Math.PI,n=Math.sin,i=Math.cos,o=Math.tan,r=Math.asin,a=Math.atan2,s=Math.acos,u=e/180,l=864e5,h=2440588,c=2451545;function p(t){return new Date((t+.5-h)*l)}function f(t){return function(t){return t.valueOf()/l-.5+h}(t)-c}var d=23.4397*u;function g(t,e){return a(n(t)*i(d)-o(e)*n(d),i(t))}function m(t,e){return r(n(e)*i(d)+i(e)*n(d)*n(t))}function y(t,e,r){return a(n(t),i(t)*n(e)-o(r)*i(e))}function v(t,e,o){return r(n(e)*n(o)+i(e)*i(o)*i(t))}function A(t,e){return u*(280.16+360.9856235*t)-e}function w(t){return u*(357.5291+.98560028*t)}function M(t){return t+u*(1.9148*n(t)+.02*n(2*t)+3e-4*n(3*t))+102.9372*u+e}function x(t){var e=M(w(t));return{dec:m(e,0),ra:g(e,0)}}var _={getPosition:function(t,e,n){var i=u*-n,o=u*e,r=f(t),a=x(r),s=A(r,i)-a.ra;return{azimuth:y(s,o,a.dec),altitude:v(s,o,a.dec)}}},b=_.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];_.addTime=function(t,e,n){b.push([t,e,n])};var T=9e-4;function S(t,n,i){return T+(t+n)/(2*e)+i}function E(t,e,i){return c+t+.0053*n(e)-.0069*n(2*i)}function C(t,e,o,r,a,u,l){return E(S(function(t,e,o){return s((n(t)-n(e)*n(o))/(i(e)*i(o)))}(t,o,r),e,a),u,l)}function I(t){var e=u*(134.963+13.064993*t),o=u*(93.272+13.22935*t),r=u*(218.316+13.176396*t)+6.289*u*n(e),a=5.128*u*n(o),s=385001-20905*i(e);return{ra:g(r,a),dec:m(r,a),dist:s}}function R(t,e){return new Date(t.valueOf()+e*l/24)}_.getTimes=function(t,n,i){var o,r,a,s,l,h=u*-i,c=u*n,d=function(t,n){return Math.round(t-T-n/(2*e))}(f(t),h),g=S(0,h,d),y=w(g),v=M(y),A=m(v,0),x=E(g,y,v),_={solarNoon:p(x),nadir:p(x-.5)};for(o=0,r=b.length;o<r;o+=1)l=x-((s=C((a=b[o])[0]*u,h,c,A,d,y,v))-x),_[a[1]]=p(l),_[a[2]]=p(s);return _},_.getMoonPosition=function(t,e,r){var s=u*-r,l=u*e,h=f(t),c=I(h),p=A(h,s)-c.ra,d=v(p,l,c.dec),g=a(n(p),o(l)*i(c.dec)-n(c.dec)*i(p));return d+=function(t){return t<0&&(t=0),2967e-7/Math.tan(t+.00312536/(t+.08901179))}(d),{azimuth:y(p,l,c.dec),altitude:d,distance:c.dist,parallacticAngle:g}},_.getMoonIllumination=function(t){var e=f(t||new Date),o=x(e),r=I(e),u=s(n(o.dec)*n(r.dec)+i(o.dec)*i(r.dec)*i(o.ra-r.ra)),l=a(149598e3*n(u),r.dist-149598e3*i(u)),h=a(i(o.dec)*n(o.ra-r.ra),n(o.dec)*i(r.dec)-i(o.dec)*n(r.dec)*i(o.ra-r.ra));return{fraction:(1+i(l))/2,phase:.5+.5*l*(h<0?-1:1)/Math.PI,angle:h}},_.getMoonTimes=function(t,e,n,i){var o=new Date(t);i?o.setUTCHours(0,0,0,0):o.setHours(0,0,0,0);for(var r,a,s,l,h,c,p,f,d,g,m,y,v,A=.133*u,w=_.getMoonPosition(o,e,n).altitude-A,M=1;M<=24&&(r=_.getMoonPosition(R(o,M),e,n).altitude-A,f=((h=(w+(a=_.getMoonPosition(R(o,M+1),e,n).altitude-A))/2-r)*(p=-(c=(a-w)/2)/(2*h))+c)*p+r,g=0,(d=c*c-4*h*r)>=0&&(m=p-(v=Math.sqrt(d)/(2*Math.abs(h))),y=p+v,Math.abs(m)<=1&&g++,Math.abs(y)<=1&&g++,m<-1&&(m=y)),1===g?w<0?s=M+m:l=M+m:2===g&&(s=M+(f<0?y:m),l=M+(f<0?m:y)),!s||!l);M+=2)w=a;var x={};return s&&(x.rise=R(o,s)),l&&(x.set=R(o,l)),s||l||(x[f>0?"alwaysUp":"alwaysDown"]=!0),x},t.exports=_}()},function(t,e,n){t.exports=function(){"use strict";function t(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function e(t,e){return t<e?-1:t>e?1:0}return function(n,i,o,r,a){!function e(n,i,o,r,a){for(;r>o;){if(r-o>600){var s=r-o+1,u=i-o+1,l=Math.log(s),h=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*h*(s-h)/s)*(u-s/2<0?-1:1),p=Math.max(o,Math.floor(i-u*h/s+c)),f=Math.min(r,Math.floor(i+(s-u)*h/s+c));e(n,i,p,f,a)}var d=n[i],g=o,m=r;for(t(n,o,i),a(n[r],d)>0&&t(n,o,r);g<m;){for(t(n,g,m),g++,m--;a(n[g],d)<0;)g++;for(;a(n[m],d)>0;)m--}0===a(n[o],d)?t(n,o,m):t(n,++m,r),m<=i&&(o=m+1),i<=m&&(r=m-1)}}(n,i,o||0,r||n.length-1,a||e)}}()},function(t,e,n){"use strict";var i=Math.PI/180,o=180/Math.PI;function r(t){var e=a(t[0]+1,t[2]);return[a(t[0],t[2]),s(t[1]+1,t[2]),e,s(t[1],t[2])]}function a(t,e){return t/Math.pow(2,e)*360-180}function s(t,e){var n=Math.PI-2*Math.PI*t/Math.pow(2,e);return o*Math.atan(.5*(Math.exp(n)-Math.exp(-n)))}function u(t,e,n){var i=d(t,e,n);return i[0]=Math.floor(i[0]),i[1]=Math.floor(i[1]),i}function l(t){return[[2*t[0],2*t[1],t[2]+1],[2*t[0]+1,2*t[1],t[2]+1],[2*t[0]+1,2*t[1]+1,t[2]+1],[2*t[0],2*t[1]+1,t[2]+1]]}function h(t){return t[0]%2==0&&t[1]%2==0?[t[0]/2,t[1]/2,t[2]-1]:t[0]%2==0&&!t[1]%2==0?[t[0]/2,(t[1]-1)/2,t[2]-1]:!t[0]%2==0&&t[1]%2==0?[(t[0]-1)/2,t[1]/2,t[2]-1]:[(t[0]-1)/2,(t[1]-1)/2,t[2]-1]}function c(t){return l(h(t))}function p(t,e){for(var n=0;n<t.length;n++)if(f(t[n],e))return!0;return!1}function f(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function d(t,e,n){var o=Math.sin(e*i),r=Math.pow(2,n);return[r*(t/360+.5),r*(.5-.25*Math.log((1+o)/(1-o))/Math.PI),n]}t.exports={tileToGeoJSON:function(t){var e=r(t);return{type:"Polygon",coordinates:[[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]],[e[0],e[1]]]]}},tileToBBOX:r,getChildren:l,getParent:h,getSiblings:c,hasTile:p,hasSiblings:function(t,e){for(var n=c(t),i=0;i<n.length;i++)if(!p(e,n[i]))return!1;return!0},tilesEqual:f,tileToQuadkey:function(t){for(var e="",n=t[2];n>0;n--){var i=0,o=1<<n-1;0!=(t[0]&o)&&i++,0!=(t[1]&o)&&(i+=2),e+=i.toString()}return e},quadkeyToTile:function(t){for(var e=0,n=0,i=t.length,o=i;o>0;o--){var r=1<<o-1,a=+t[i-o];1===a&&(e|=r),2===a&&(n|=r),3===a&&(e|=r,n|=r)}return[e,n,i]},pointToTile:u,bboxToTile:function(t){var e=u(t[0],t[1],32),n=u(t[2],t[3],32),i=[e[0],e[1],n[0],n[1]],o=function(t){for(var e=0;e<28;e++){var n=1<<32-(e+1);if((t[0]&n)!=(t[2]&n)||(t[1]&n)!=(t[3]&n))return e}return 28}(i);return 0===o?[0,0,0]:[i[0]>>>32-o,i[1]>>>32-o,o]},pointToTileFraction:d}},function(t,e,n){"use strict";n.r(e);var i,o=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.z=n}return t.prototype.clone=function(){return new t(this.x,this.y,this.z)},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.length,n=0,i=0,o=0;return e>0&&(n=this.x/e,i=this.y/e,o=this.z/e),new t(n,i,o)},t.prototype.set=function(t){this.x=t.x,this.y=t.y,this.z=t.z},t.prototype.invert=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.rotate90=function(){return new t(this.y,-this.x,this.z)},t.prototype.add=function(e){return new t(e.x+this.x,e.y+this.y,e.z+this.z)},t.prototype.subtract=function(e){return e?new t(this.x-e.x,this.y-e.y,this.z-e.z):this.clone()},t.prototype.multiply=function(e){return new t(e*this.x,e*this.y,e*this.z)},t.prototype.rotateBy=function(e){var n=Math.cos(e*Math.PI/180),i=Math.sin(e*Math.PI/180);return new t(this.x*n-this.y*i,this.x*i+this.y*n)},t.prototype.cross=function(e){return new t(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y+t.z*this.z},t.perp=function(e,n){return new t(n[1]-e[1],e[0]-n[0])},t.neg=function(e){return new t(-e.x,-e.y,-e.z)},t}(),r=function(){function t(t){void 0===t&&(t=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])),this.data=t}return t.translate=function(e,n,i){return void 0===i&&(i=0),new t(new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,e,n,i,1]))},Object.defineProperty(t.prototype,"position",{get:function(){return new o(this.data[12],this.data[13],this.data[14])},enumerable:!0,configurable:!0}),t.rotateX=function(e){e*=Math.PI/180;var n=Math.sin(e),i=Math.cos(e);return new t(new Float32Array([1,0,0,0,0,i,n,0,0,-n,i,0,0,0,0,1]))},t.rotateY=function(e){e*=Math.PI/180;var n=Math.sin(e),i=Math.cos(e);return new t(new Float32Array([i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1]))},t.rotateZ=function(e){e*=Math.PI/180;var n=Math.sin(e),i=Math.cos(e);return new t(new Float32Array([i,n,0,0,-n,i,0,0,0,0,1,0,0,0,0,1]))},t.scale=function(e,n,i){return null==n&&(n=e,i=e),new t(new Float32Array([e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1]))},t.prototype.concat=function(e){var n=new t(new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]));if(null==e)return n;for(var i=0;i<4;++i)for(var o=0;o<4;++o)for(var r=0;r<4;++r)n.data[4*i+r]+=this.data[4*i+o]*e.data[4*o+r];return n},t.ortho=function(e,n,i,o,r,a){return void 0===r&&(r=-100),void 0===a&&(a=100),new t(new Float32Array([2/(n-e),0,0,0,0,2/(o-i),0,0,0,0,-2/(a-r),0,-(e+n)/(n-e),-(o+i)/(o-i),-(r+a)/(r-a),1]))},t.perspective=function(e,n,i,o){var r=Math.tan(e/2)*i,a=r*n;return t.frustum(-a,a,-r,r,i,o)},t.frustum=function(e,n,i,o,r,a){return void 0===r&&(r=-100),void 0===a&&(a=100),new t(new Float32Array([2*r/(n-e),0,0,0,0,2*r/(o-i),0,0,(n+e)/(n-e),(o+i)/(o-i),-(a+r)/(a-r),-1,0,0,-2*r*a/(a-r),0]))},t.prototype.transform=function(t,e){void 0===e&&(e=0);var n=this.data[0]*t.x+this.data[4]*t.y+this.data[8]*t.z+this.data[12]*e,i=this.data[1]*t.x+this.data[5]*t.y+this.data[9]*t.z+this.data[13]*e,r=this.data[2]*t.x+this.data[6]*t.y+this.data[10]*t.z+this.data[14]*e;return 0==(e=this.data[3]*t.x+this.data[7]*t.y+this.data[11]*t.z+this.data[15]*e)&&(e=1),new o(n/e,i/e,r/e)},t.prototype.buffer=function(){return this.data},t.lookAt=function(e,n,i,r){void 0===i&&(i=1),void 0===r&&(r=new o(0,0,1));var a=e.subtract(n).normalize(),s=r.cross(a).normalize(),u=a.cross(s).normalize(),l=new t(new Float32Array([s.x,u.x,a.x,0,s.y,u.y,a.y,0,s.z,u.z,a.z,0,0,0,0,1])),h=t.translate(-e.x,-e.y,-e.z),c=t.scale(i);return h.concat(l).concat(c)},t.prototype.inverse=function(){for(var e=this.data.slice(),n=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=0;i<4;++i){for(var o=i;o<4&&0==e[4*o+i];)++o;if(4==o||0==e[4*o+i])return console.log("Cannot calculate inverse, determinant is zero"),this;if(o!=i){var r=e.slice(4*i,4*(i+1)),a=e.slice(4*o,4*(o+1));e.set(a,4*i),e.set(r,4*o);var s=n.slice(4*i,4*(i+1)),u=n.slice(4*o,4*(o+1));n.set(u,4*i),n.set(s,4*o)}var l=e.slice(4*i,4*(i+1)),h=n.slice(4*i,4*(i+1));for(o=0;o<4;++o){a=e.slice(4*o,4*(o+1)),u=n.slice(4*o,4*(o+1));if(o!=i){if(0!=a[i]){for(var c=-a[i]/l[i],p=i;p<4;++p)a[p]=a[p]+c*l[p];e.set(a,4*o);for(p=0;p<4;++p)u[p]=u[p]+c*h[p];n.set(u,4*o)}}else{if(0==(c=l[i]))return console.log("Cannot calculate inverse, determinant is zero"),this;for(p=i;p<4;++p)a[p]=a[p]/c;e.set(a,4*o);for(p=0;p<4;++p)u[p]=u[p]/c;n.set(u,4*o)}}}return new t(n)},t}(),a=function(){function t(){}return Object.defineProperty(t,"baseMapUrl",{get:function(){return"https://api.map4d.vn/v2/api/tile/{z}/{x}/{y}"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"baseModelRequestUrl",{get:function(){return"https://api.map4d.vn/v2/api/Model/objs/{s}?key={k}"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"baseTextureRequestUrl",{get:function(){return"https://api.map4d.vn/v2/api/Model/images/{s}?key={k}"},enumerable:!0,configurable:!0}),t.baseTileSize=256,t.minLatitude=-85.0511287798066,t.maxLatitude=85.0511287798066,t.maxLongitude=180,t.minLongitude=-180,t.maxDegrees=360,t.radiusEarthMeters=6378137,t.halfEarthCircumFerenceInMeter=t.radiusEarthMeters*Math.PI,t.earthCircumFerenceInMeter=2*t.halfEarthCircumFerenceInMeter,t.tileCacheSize=512,t.rasterLayerOrder=1,t.polygonAnnotationLayerOrder=100,t.circleAnnotationLayerOrder=101,t.polylineAnnotationLayerOrder=102,t.buildingLayerOrder=103,t.markerAnnotationLayerOrder=104,t.infoWindowPadding=2,t.flingMinVelocity=-1e4,t.flingMaxVelocity=1e4,t.flingTimeConstant=150,t.flingSpeedMultiply=15,t.zoomSpeedMouseWheel=15,t.minDurationFlyTo=1e3,t.maxDurationFlyTo=13e3,t.maxBearingAngle=720,t.defaultMinZoom=0,t.defaultMinZoom3d=17,t.defaultMaxZoom=22,t.defaultMaxNativeZoom=19,t.tileExtend=4096,t.defaultAnimationDuration=300,t.defaultFlyZoom=17,t.defaultMap2dUrl="2d/{z}/{x}/{y}.png",t.defaultMap3dUrl="3d/{z}/{x}/{y}.png",t.minTilt=0,t.maxTilt2D=40,t.maxTilt3D=87,t.maxTiltIntersectWithScreen=60,t.minTiltReduceFog=75,t.minTimeMoving=150,t.minTimeDoubleZoom=500,t.minTimeSpanTo=500,t.maxTimeSpanTo=4e3,t.skyboxMapBorderMinimum=.001,t.metersPerPixelAtLatitude=10,t.mapBackgroundColor2D="#f2efe9",t.mapBackgroundColor3D="#e1e1e1",t.mapBackgroundScaleRatio=2e4,t.biasMatrix=new r(new Float32Array([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1])),t}(),s=function(){function t(){}return t.rad2Deg=180/Math.PI,t.deg2Rad=Math.PI/180,t.epsilon=1e-6,t}(),u=function(){function t(){}return t.fov=30*s.deg2Rad,t.nearPlane=.1,t.farPlane=1e3,t.height=15.5,t}(),l=function(){function t(){}return t.numTrianglesOnRoundCap=6,t.numTrianglesOnRoundJoin=5,t.numTrianglesPerCircle=50,t}(),h=function(){function t(){}return t.vietNamlnglatBounds=[{lng:102.1234130859375,lat:22.405950148725722},{lng:102.74414062499999,lat:21.002471054356725},{lng:104.853515625,lat:20.3034175184893},{lng:103.84277343749999,lat:19.476950206488414},{lng:107.314453125,lat:15.623036831528264},{lng:107.4462890625,lat:12.382928338487396},{lng:106.69921875,lat:12.146745814539685},{lng:104.52392578125,lat:10.455401826918397},{lng:104.67773437499999,lat:9.96885060854611},{lng:104.6337890625,lat:8.450638800331001},{lng:108.720703125,lat:10.833305983642491},{lng:109.51171875,lat:12.768946439455956},{lng:108.78662109375,lat:15.580710739162123},{lng:105.732421875,lat:19.145168196205297},{lng:108.10546875,lat:21.47351753334985},{lng:105.27099609375,lat:23.165613663312595},{lng:102.1234130859375,lat:22.405950148725722}],t.targetOfCity=[{lat:21.025608,lng:105.851686},{lat:16.071825,lng:108.223533},{lat:10.769935,lng:106.709608}],t}(),c=function(){function t(){}return t.rainFrequency=.004,t.rainParticleRotation=-25,t.snowFrequency=.004,t}(),p=function(){function t(){}return t.refreshTime=6e4,t.refreshDistance=1e5,t}(),f=function(){function t(){}return t.getSkyColor=function(e){return t.skyColors[e]},t.getFogColor=function(e){return t.fogColors[e]},t.skyColors={Morning:new o(.26,.43,.7),Noon:new o(.6,.8,1),AfterNoon:new o(.96,.66,.6),Evening:new o(0,0,0)},t.fogColors={Morning:new o(.98,.85,.77),Noon:new o(.9,.9,.9),AfterNoon:new o(.96,.66,.6),Evening:new o(.2,.2,.2)},t}(),d=function(){function t(){}return t.morningTime=6,t.noonTime=12,t.afterNoonTime=16,t.eveningTime=18,t}(),g=function(){function t(t,e){this._lat=t,this._lng=e}return t.prototype.equals=function(t){return this._lat==t._lat&&this._lng==t._lng},t.prototype.lat=function(){return this._lat},t.prototype.lng=function(){return this._lng},t.prototype.toString=function(){return"("+this._lat+", "+this._lng+")"},t.convert=function(e){if(e instanceof t)return e;if(Array.isArray(e)&&2===e.length)return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e&&"lat"in e&&"lng"in e)return new t(Number(e.lat),Number(e.lng));throw new Error("`ILngLat` argument must be specified as a LngLat instance, an object {lat: <lat>, lng: <lng>}, or an array of [<lat>, <lng>]")},t.prototype.distanceTo=function(e){var n=t.convert(e),i=s.deg2Rad*this._lat,o=s.deg2Rad*this._lng,r=s.deg2Rad*n.lat(),u=s.deg2Rad*n.lng(),l=Math.sin((r-i)/2),h=Math.sin((u-o)/2);return 2*a.radiusEarthMeters*Math.asin(Math.sqrt(l*l+Math.cos(i)*Math.cos(r)*h*h))},t.prototype.normalize=function(){var e=this.lat()>0?-1:1,n=(this.lat()-90*e)%180+90*e;return e=this.lng()>0?-1:1,new t(n,(this.lng()-180*e)%380+180*e)},t}(),m=function(){function t(t,e,n,i){void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),this._target=null==t?null:g.convert(t),this._tilt=e,this._bearing=n,this._zoom=i}return t.prototype.setTarget=function(t){this._target=g.convert(t)},t.prototype.setTilt=function(t){this._tilt=t},t.prototype.setBearing=function(t){this._bearing=t,Math.abs(Math.abs(this._bearing)%180-90)<.1&&(this._bearing+=.2)},t.prototype.setZoom=function(t){this._zoom=t},t.prototype.getTarget=function(){return this._target},t.prototype.getTilt=function(){return this._tilt},t.prototype.getBearing=function(){return this._bearing},t.prototype.getZoom=function(){return this._zoom},t.convert=function(e){return e instanceof t?e:new t(e.target,e.tilt,e.bearing,e.zoom)},t}(),y=function(){function t(){}return t.clamp=function(t,e,n){return t<e?e:t>n?n:t},t}(),v=n(1),A=function(){function t(t,e){this.x=t,this.y=e}return t.convertPointToMBPoint=function(t){return new v(t.x,t.y)},t.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},t.prototype.toString=function(){return"("+String(this.x)+","+String(this.y)+")"},t.convert=function(e){if(e instanceof t)return e;if(Array.isArray(e)&&2===e.length)return new t(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e&&"x"in e&&"y"in e)return new t(Number(e.x),Number(e.y));throw new Error("`IPoint` argument must be specified as a Point instance, an object {x: <x>, y: <y>}, or an array of [<x>, <y>]")},t}(),w=function(){function t(t,e){this._min=new v(t.x,t.y),this._max=new v(e.x,e.y)}return Object.defineProperty(t.prototype,"min",{get:function(){return this._min},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},enumerable:!0,configurable:!0}),t}(),M=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){return this.x*this.x+this.y*this.y},enumerable:!0,configurable:!0}),t.prototype.normalize=function(){var e=this.length,n=0,i=0;return e>0&&(n=this.x/e,i=this.y/e),new t(n,i)},t.prototype.set=function(t){this.x=t.x,this.y=t.y},t.prototype.invert=function(){return new t(-this.x,-this.y)},t.prototype.rotate90=function(){return new t(this.y,-this.x)},t.prototype.add=function(e){return new t(e.x+this.x,e.y+this.y)},t.prototype.subtract=function(e){return e?new t(this.x-e.x,this.y-e.y):this.clone()},t.prototype.multiply=function(e){return new t(e*this.x,e*this.y)},t.prototype.rotateBy=function(e){var n=Math.cos(e*Math.PI/180),i=Math.sin(e*Math.PI/180);return new t(this.x*n-this.y*i,this.x*i+this.y*n)},t.prototype.rotateByRadian=function(e){var n=Math.cos(e),i=Math.sin(e);return new t(this.x*n-this.y*i,this.x*i+this.y*n)},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.dot=function(t){return t.x*this.x+t.y*this.y},t.perp=function(e,n){return new t(n[1]-e[1],e[0]-n[0])},t.neg=function(e){return new t(-e.x,-e.y)},t}(),x=function(){function t(){}return t.projectInternal=function(t,e){var n=y.clamp(t.lat(),a.minLatitude,a.maxLatitude);return new M(a.maxLongitude+t.lng(),a.maxLongitude-s.rad2Deg*Math.log(Math.tan(Math.PI/4+n*Math.PI/a.maxDegrees))).multiply(e/a.maxDegrees)},t.worldSize=function(t){return t*S.getTileSize()},t.getMetersPerPixelAtLatitude=function(t,e){var n=Math.pow(2,e),i=y.clamp(t,a.minLatitude,a.maxLatitude);return Math.cos(i*s.deg2Rad)*Math.PI*2*a.radiusEarthMeters/this.worldSize(n)},t.convertToMeterFromLatLng=function(t){var e=y.clamp(t.lat(),a.minLatitude,a.maxLatitude),n=t.lng(),i=1-1e-15,o=y.clamp(Math.sin(s.deg2Rad*e),-i,i),r=a.radiusEarthMeters*n*s.deg2Rad,u=.5*a.radiusEarthMeters*Math.log((1+o)/(1-o));return new M(u,r)},t.convertToLatLngFromMeter=function(t){var e=(2*Math.atan(Math.exp(t.x/a.radiusEarthMeters))-Math.PI/2)*s.rad2Deg,n=t.y*s.rad2Deg/a.radiusEarthMeters;return new g(e,n)},t.projectScale=function(t,e){return this.projectInternal(t,this.worldSize(e))},t.projectZoom=function(t,e){return this.projectInternal(t,1<<e)},t.unproject=function(t,e){var n=t.multiply(a.maxDegrees/this.worldSize(e));return new g(a.maxDegrees/Math.PI*Math.atan(Math.exp((a.maxLongitude-n.y)*s.deg2Rad))-90,n.x-a.maxLongitude)},t}(),_=function(){function t(t,e){t&&(e?(this.southwest=t instanceof g?new g(t.lat(),t.lng()):g.convert(t),this.northeast=e instanceof g?new g(e.lat(),e.lng()):g.convert(e)):4===t.length?(this.southwest=g.convert([t[0],t[1]]),this.northeast=g.convert([t[2],t[3]])):(this.southwest=t[0]instanceof g?new g(t[0].lat(),t[0].lng()):g.convert(t[0]),this.northeast=t[1]instanceof g?new g(t[1].lat(),t[1].lng()):g.convert(t[1])))}return t.prototype.extend=function(t){var e=g.convert(t);return this.southwest&&this.northeast?(this.southwest=new g(Math.min(e.lat(),this.southwest.lat()),Math.min(this.southwest.lng(),e.lng())),this.northeast=new g(Math.max(e.lat(),this.northeast.lat()),Math.max(this.northeast.lng(),e.lng()))):(this.southwest=new g(e.lat(),e.lng()),this.northeast=new g(e.lat(),e.lng())),this},t.prototype.getCenter=function(){return new g((this.northeast.lat()+this.southwest.lat())/2,(this.northeast.lng()+this.southwest.lng())/2)},t.prototype.getNortheast=function(){return this.northeast},t.prototype.getSouthwest=function(){return this.southwest},t.convert=function(e){return e instanceof t?e:new t(e)},t}(),b=function(){function t(){}return t.lat=function(t,e){var n=Math.PI-2*Math.PI*e/Math.pow(2,t);return s.rad2Deg*Math.atan(.5*(Math.exp(n)-Math.exp(-n)))},t.lon=function(t,e){return e/Math.pow(2,t)*a.maxDegrees-a.maxLongitude},t.screenCoordinateToNDC=function(t,e){var n=2*t.x/e.x-1,i=1-2*t.y/e.y;return new M(n,i)},t.NDCCoordinateToScreen=function(t,e){var n=e.x*(1+t.x)/2,i=e.y*(1-t.y)/2;return new M(n,i)},t.screenCoordinateToLatLng=function(t,e,n){return void 0===n&&(n=0),this.screenCoordinateToLatLngZoom(t,e,e.getZoom(),n)},t.screenCoordinateToLatLngZoom=function(e,n,i,r,a){void 0===r&&(r=0),void 0===a&&(a=!1),i<0&&(i=n.getZoom());var u=t.getElevationPixelFromMeter(r,n)*Math.sin(s.deg2Rad*-n.getTilt()),l=n.getScreenSize(),h=a?n.getInverseViewProjectionMatrixWithoutTilt():n.getInverseViewProjectionMatrix(),c=Math.pow(2,i),p=t.screenCoordinateToNDC(new M(e.x,e.y-u),l),f=h.transform(new o(p.x,p.y,-1),1),d=h.transform(new o(p.x,p.y,1),1),g=d.z-f.z,m=f.x-(d.x-f.x)*f.z/g,y=f.y-(d.y-f.y)*f.z/g,v=n.getTarget(),A=Math.pow(2,i),w=x.projectScale(v,A);return x.unproject(new M(m+w.x,w.y-y),c)},t.pixelCoordinateToCameraCoordinate=function(e,n){return t.pixelCoordinateToCameraCoordinateZoom(e,n,n.getZoom())},t.pixelCoordinateToCameraCoordinateZoom=function(t,e,n){var i=Math.pow(2,n),o=x.worldSize(i),r=x.projectScale(e.getTarget(),i);r.x=r.x-o/2,r.y=o/2-r.y;var a=t;return a.x=a.x-o/2,a.y=o/2-a.y,a.x-=r.x,a.y-=r.y,a},t.latLngToScreenCoordinate=function(t,e,n){return this.latLngToScreenCoordinateZoom(t,e,n,n.getZoom())},t.latLngToScreenCoordinateZoom=function(e,n,i,r,a){void 0===a&&(a=!1),r<0&&(r=i.getZoom());var s=Math.pow(2,r),u=x.projectScale(e,s),l=this.pixelCoordinateToCameraCoordinateZoom(u,i,r),h=t.getElevationPixelFromMeter(n,i),c=new o(l.x,l.y,h),p=a?i.getViewProjectionMatrixWithoutTilt().transform(c,1):i.getViewProjectionMatrix().transform(c,1),f=i.getScreenSize(),d=(p.x+1)*f.x/2,g=f.y-(p.y+1)*f.y/2;return new M(d,g)},t.tileCoordinateToLatLngBounds=function(e){var n=e.getX(),i=e.getY(),o=e.getZoom(),r=new g(t.lat(o,i+1),t.lon(o,n)),a=new g(t.lat(o,i),t.lon(o,n+1));return new _(r,a)},t.pixelCoordinateToVectorTileCoordinate=function(t,e,n,i){var o=S.getTileSize()*i,r=t.x-e*o,a=t.y-n*o;return new M(r=r/o-.5,a=.5-a/o)},t.getElevationPixelFromMeter=function(e,n){return n.is3dMode()?t.getPixelFromMeter(e,n.getTarget().lat(),n.getZoom()):0},t.getPixelFromMeter=function(t,e,n){return t/x.getMetersPerPixelAtLatitude(e,n)},t}(),T=function(){function t(){}return t.pointIntersectsSymbol=function(e,n,i){var o=n.getWidth()*S.pixelScale,r=n.getHeight()*S.pixelScale,a=n.getAnchor(),s=b.latLngToScreenCoordinate(n.getPosition(),n.getElevation(),i),u=new M(s.x+(.5-a.x)*o,s.y+(.5-a.y)*r),l=new w(new A(u.x-o/2,u.y-r/2),new A(u.x+o/2,u.y+r/2));return t.pointIntersectsBox(new A(e.x,e.y),l)},t.pointIntersectsBox=function(t,e){return t.x<=e.max.x&&t.y<=e.max.y&&t.x>=e.min.x&&t.y>=e.min.y},t.polygonIntersectsPolygon=function(e,n){for(var i=0;i<e.length;i++)if(t.polygonContainsPoint(n,e[i]))return!0;for(i=0;i<n.length;i++)if(t.polygonContainsPoint(e,n[i]))return!0;return!!t.lineIntersectsLine(e,n)},t.multiPolygonIntersectsBufferedPoint=function(e,n,i){for(var o=0;o<e.length;o++){var r=e[o];if(t.polygonContainsPoint(r,n))return!0;if(t.pointIntersectsBufferedLine(n,r,i))return!0}return!1},t.multiPolygonIntersectsBufferedMultiPoint=function(e,n,i){for(var o=0;o<n.length;o++)for(var r=n[o],a=0;a<r.length;a++)if(t.multiPolygonIntersectsBufferedPoint(e,r[a],i))return!0;return!1},t.multiPolygonIntersectsMultiPolygon=function(e,n){if(1===e.length&&1===e[0].length)return t.multiPolygonContainsPoint(n,e[0][0]);for(var i=0;i<n.length;i++)for(var o=n[i],r=0;r<o.length;r++)if(t.multiPolygonContainsPoint(e,o[r]))return!0;for(var a=0;a<e.length;a++){for(var s=e[a],u=0;u<s.length;u++)if(t.multiPolygonContainsPoint(n,s[u]))return!0;for(var l=0;l<n.length;l++)if(t.lineIntersectsLine(s,n[l]))return!0}return!1},t.multiPolygonIntersectsBufferedMultiLine=function(e,n,i){for(var o=0;o<n.length;o++)for(var r=n[o],a=0;a<e.length;a++){var s=e[a];if(s.length>=3)for(var u=0;u<r.length;u++)if(t.polygonContainsPoint(s,r[u]))return!0;if(t.lineIntersectsBufferedLine(s,r,i))return!0}return!1},t.lineIntersectsBufferedLine=function(e,n,i){if(e.length>1){if(t.lineIntersectsLine(e,n))return!0;for(var o=0;o<n.length;o++)if(t.pointIntersectsBufferedLine(n[o],e,i))return!0}for(var r=0;r<e.length;r++)if(t.pointIntersectsBufferedLine(e[r],n,i))return!0;return!1},t.lineIntersectsLine=function(e,n){if(0===e.length||0===n.length)return!1;for(var i=0;i<e.length-1;i++)for(var o=e[i],r=e[i+1],a=0;a<n.length-1;a++){var s=n[a],u=n[a+1];if(t.lineSegmentIntersectsLineSegment(o,r,s,u))return!0}return!1},t.lineSegmentIntersectsLineSegment=function(e,n,i,o){return t.isCounterClockwise(e,i,o)!==t.isCounterClockwise(n,i,o)&&t.isCounterClockwise(e,n,i)!==t.isCounterClockwise(e,n,o)},t.pointIntersectsBufferedMultiLine=function(e,n,i){return n.some(function(n){return t.pointIntersectsBufferedLine(e,n,i)})},t.pointIntersectsBufferedLine=function(e,n,i){var o=i*i,r=A.convertPointToMBPoint(e);if(1===n.length)return r.distSqr(n[0])<o;for(var a=1;a<n.length;a++){var s=n[a-1],u=n[a];if(t.distToSegmentSquared(e,s,u)<o)return!0}return!1},t.pointIntersectsCircle=function(t,e,n){return A.convertPointToMBPoint(t).distSqr(e)<=n*n},t.multiPolygonContainsPoint=function(t,e){for(var n,i,o,r=!1,a=0;a<t.length;a++)for(var s=0,u=(n=t[a]).length-1;s<n.length;u=s++)i=n[s],o=n[u],i.y>e.y!=o.y>e.y&&e.x<(o.x-i.x)*(e.y-i.y)/(o.y-i.y)+i.x&&(r=!r);return r},t.polygonContainsPoint=function(t,e){for(var n=!1,i=0,o=t.length-1;i<t.length;o=i++){var r=t[i],a=t[o];r.y>e.y!=a.y>e.y&&e.x<(a.x-r.x)*(e.y-r.y)/(a.y-r.y)+r.x&&(n=!n)}return n},t.isCounterClockwise=function(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)},t.distToSegmentSquared=function(t,e,n){var i=A.convertPointToMBPoint(e),o=A.convertPointToMBPoint(n),r=A.convertPointToMBPoint(t),a=i.distSqr(o);if(0===a)return r.distSqr(i);var s=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/a;return s<0?r.distSqr(i):s>1?r.distSqr(o):r.distSqr(o.sub(i)._mult(s)._add(i))},t}(),S=function(){function t(){}return Object.defineProperty(t,"pixelScale",{get:function(){return t._pixelScale},set:function(e){t._pixelScale=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"resourceScale",{get:function(){return Math.round(t._pixelScale)},enumerable:!0,configurable:!0}),t.getTileSize=function(){return a.baseTileSize*t.pixelScale},t.extendOptions=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0,o=e;i<o.length;i++){var r=o[i];for(var a in r)t[a]=r[a]}return t},t.pointToPixel=function(e){return new A(e.x*t.pixelScale,e.y*t.pixelScale)},t.pixelToPoint=function(e){return new A(e.x/t.pixelScale,e.y/t.pixelScale)},t.getTimePanTo=function(t,e,n){var i=t.distanceTo(e)/500;return i*=n<10?.01:n<14?.5:1.5,i=y.clamp(i,a.minTimeSpanTo,a.maxTimeSpanTo),Math.round(i)},t.getNearestByLocations=function(t){for(var e=[],n=h.targetOfCity,i=0;i<n.length;i++){var o=n[i];e.push(new g(o.lat,o.lng))}var r=e.length;if(null==e||r<=0)return t;var a=Number.POSITIVE_INFINITY,s=t;for(i=0;i<r;i++){var u=new g(e[i].lat(),e[i].lng()),l=u.distanceTo(t);l<=a&&(s=u,a=l)}return s},t.insideOfVietNam=function(t){if(null==t)return!1;for(var e=h.vietNamlnglatBounds,n=[],i=0;i<e.length;i++){var o=new A(e[i].lat,e[i].lng);n.push(o)}return this.isPolygonConstains(n,t)},t.isPolygonConstains=function(t,e){var n=new A(e.lat(),e.lng());return T.polygonIntersectsPolygon([n],t)},t.getCameraPositionForLatLngBounds=function(t,e,n,i){var o=t.getSouthwest(),r=t.getNortheast();if(Math.abs(o.lat()-r.lat())<s.epsilon&&Math.abs(o.lng()-r.lng())<s.epsilon){var u=n.getCamera();return new m(o,u.getTilt(),u.getBearing(),i.getMaxZoom())}var l=new g(r.lat(),o.lng()),h=new g(o.lat(),r.lng()),c=n.getScreenSize(),p=b.latLngToScreenCoordinateZoom(o,0,n,a.defaultMaxZoom,!0),f=b.latLngToScreenCoordinateZoom(r,0,n,a.defaultMaxZoom,!0),d=b.latLngToScreenCoordinateZoom(l,0,n,a.defaultMaxZoom,!0),v=b.latLngToScreenCoordinateZoom(h,0,n,a.defaultMaxZoom,!0),A=Math.min(p.x,f.x,d.x,v.x),w=Math.max(p.x,f.x,d.x,v.x),x=Math.min(p.y,f.y,d.y,v.y),_=Math.max(p.y,f.y,d.y,v.y),T=A+e.left||0,S=w-e.right||0,E=x-e.top||0,C=_+e.bottom||0,I=b.screenCoordinateToLatLngZoom(new M((T+S)/2,(E+C)/2),n,a.defaultMaxZoom,0,!0),R=S-T,D=C-E,L=c.x/(R<=0?1:R),B=c.y/(D<=0?1:D);L-=(e.left+e.right)/(R<=0?1:R),B-=(e.top+e.bottom)/(D<=0?1:D);var O=a.defaultMaxZoom+Math.log2(Math.min(L,B));O=y.clamp(O,i.getMinZoom(),i.getMaxZoom()),O=Math.floor(O);var P=n.getCamera();return new m(I,P.getTilt(),P.getBearing(),O)},t._pixelScale=1,t}(),E=function(){function t(){this._id=null,this._map=null}return t.prototype.getId=function(){return this._id},t.prototype.getMap=function(){return this._map},t}(),C=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),I=function(t){function e(e){var n=t.call(this)||this;n.defaultCircleOptions={radius:0,fillColor:"#0000ff",fillOpacity:1,visible:!0};var i={};return S.extendOptions(i,n.defaultCircleOptions,e),n._center=g.convert(i.center),n._radius=i.radius,n._fillColor=i.fillColor,n._fillOpacity=i.fillOpacity,n._visible=i.visible,n}return C(e,t),e.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&(this._map.mapView.removeAnnotation(this._id),this._id=-1),this._map=t,null!=this._map&&(this._id=this._map.mapView.addAnnotation(this)))},e.prototype.setCenter=function(t){var e=g.convert(t);this._center.equals(e)||(this._center=e,null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0))},e.prototype.setRadius=function(t){this._radius!=t&&(this._radius=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0))},e.prototype.setFillColor=function(t){this._fillColor!=t&&(this._fillColor=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setFillOpacity=function(t){this._fillOpacity!=t&&(this._fillOpacity=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setVisible=function(t){this._visible!==t&&(this._visible=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.getCenter=function(){return new g(this._center.lat(),this._center.lng())},e.prototype.getRadius=function(){return this._radius},e.prototype.getFillColor=function(){return this._fillColor},e.prototype.getFillOpacity=function(){return this._fillOpacity},e.prototype.isVisible=function(){return this._visible},e}(E),R=function(){function t(t,e,n){this.width=t,this.height=e,this.url=n}return t.prototype.clone=function(){return new t(this.width,this.height,this.url)},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getUrl=function(){return null==this.url?null:this.url.replace("@1x","@"+S.resourceScale+"x")},t.defaultMarker=new t(32,32,null),t}(),D=function(){function t(){}return t.get=function(e){var n=y.clamp(S.resourceScale,1,3);return t.images[e][n-1]},t.markerDefault="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAF8WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTIyVDE3OjI0OjUzKzA3OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTAxLTIyVDE3OjI0OjUzKzA3OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wMS0yMlQxNzoyNDo1MyswNzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxZDg1NGY4Yi1lYzEzLTQzZjktOWEwMC02OGYwYzRkNWYyODUiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpiODVkZWE1ZC0yYWNlLWExNDktYmI5MS01NjVjNGY5ZDdkZTAiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4M2MwZmJlYS1iODZjLTQwMDItYjcxOC1iYTI3M2MzMmY5NTgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjgzYzBmYmVhLWI4NmMtNDAwMi1iNzE4LWJhMjczYzMyZjk1OCIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0yMlQxNzoyNDo1MyswNzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDoxZDg1NGY4Yi1lYzEzLTQzZjktOWEwMC02OGYwYzRkNWYyODUiIHN0RXZ0OndoZW49IjIwMTktMDEtMjJUMTc6MjQ6NTMrMDc6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6UtMbgAAAC9UlEQVRYhcWXTYtcRRSGn7equ5OQheDCqBBcmJWoIEIMBoKMI6Kg/gFxI8YvBDWgLiKJ+UAiYsCFro0LxY2I4EdiJgYC0Y0wGDELESMEiVmIMmqc7qrXRZvEHqu67+0W5kAt+pzT5336nqrTt2Sb1bSwqupApxY4f+dmDCQlQgANAkEiw5zQPZJvN94EWgP+A8IZQjqBwxGZw9ngmMkZZOg7s3Hhq+YABbsV2C8xD47DxumfkK4AX0MOW4AdwDFgJ3ByUtGmLXiaoOMWdwNxQq4Mc4gjwDP/B8BzMceDgvVNSC9RwPqYw2vA87MAzHWIL017Tgx0iHuBO6YB6EnsB9ZOqX8RoxvQAWBdKVrdhClwXzRbqmXRr8BHOH8vsQl0F3BlKVfS5rXuzAMfNgaQfe/lXb4ihk8NiA9G8uJFX8Y3Cb0ruKEILO4vAVRbEOGWSmiQc3gcWFzh/zo6PQL8WaG+reSuAhhtrIQWbX0RknEaPqFOyvRSJmROYp8q63NtyT9uEJVj5pfQzQOl4QcHkQiAGPT6Dsvxt3Lj6Jac407Bz0WvuBmoPZ2rJW6sxH5qBWD720roKjL7+O8v6sV+91VgQ7Ee+qbkr7bADguSH6iEHzJcL3gdOA9sMDwMzFfrZZ1oBRCUDkP4ndoIFluNtmKwKl2/bEvgj4s6Y750WvbxSZWbmK0F4HQrgBxEChwE0qwAcn4zkIuxMXMADEcNn82o/6VD+NyhLDXp39BZPjCDeN/k3cCFWkKT94Fjtg5NJW/eAj4Zl1IF6CZfWtHpRSqDpK6tc3/lNfuW0zqWU4/l1GsHsMJ+NH6hJcAe4MykvDav5YfA7zUStz4A3miSO+YYji4Nz8Wz4B8m1PwO9KQMvdAfWa0AKnZWicds1Xb1hZzDU8DZpgWnuRl9atg7nBSjZrSLCbu+MUDOsbiSApiXbb09Im7eAV5pIw7tbkajejk8oZCvQ2yzOZpz3P4vmMY2y+V0KZvthvdNeBRYmqaIVvt6/je+DyExBbNQBQAAAABJRU5ErkJggg==",t.markerDefault2x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAF8WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDAgNzkuMTYwNDUxLCAyMDE3LzA1LzA2LTAxOjA4OjIxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiIHhtcDpDcmVhdGVEYXRlPSIyMDE5LTAxLTIyVDE3OjI1OjQ1KzA3OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE5LTAxLTIyVDE3OjI1OjQ1KzA3OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAxOS0wMS0yMlQxNzoyNTo0NSswNzowMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM2MyYjNmMC00NTM4LTRhM2YtOTNhMC1hNDEyNmZjNGNjMTQiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDo0MDZjOWM2Yy1jZDdjLWIyNDQtYTU3Mi0zNjQzOTllOWJkMTkiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpiMDNkZGZjNC1kNTE4LTQxN2YtYjUzNi0zZDJjOGUyZjY3ODEiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiPiA8eG1wTU06SGlzdG9yeT4gPHJkZjpTZXE+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJjcmVhdGVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmIwM2RkZmM0LWQ1MTgtNDE3Zi1iNTM2LTNkMmM4ZTJmNjc4MSIgc3RFdnQ6d2hlbj0iMjAxOS0wMS0yMlQxNzoyNTo0NSswNzowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDozM2MyYjNmMC00NTM4LTRhM2YtOTNhMC1hNDEyNmZjNGNjMTQiIHN0RXZ0OndoZW49IjIwMTktMDEtMjJUMTc6MjU6NDUrMDc6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAoTWFjaW50b3NoKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5Dm+KFAAAHV0lEQVR4nOWbXYxdVRXHf/91zp1pwUpDiDHSgKjBD2wVqdaPxAcVAkF84MUYCn4gNBGMogajoIEoMSRWsUpiLdqYEE0UtGnqR9FGCkUxRopofbCxEFpREpT2QdqZe87++3DbMm1n7pmz77lTE/6TlcmcWWvtdf77c+29j2zzQkbZ1uBfl5x/zN9FLSKVWEaIKfcpXFLPIDYEBQWCsyrqVYEukPRqo3OEXwK86LDqAeA/wBOyd1naqUgPW9pb9YEiEYi6hokiqMo+0Z8gDEbUqjlY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",t.myPosition="data:image/png;base64,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",t.myPosition2x="data:image/png;base64,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",t.zoomOutIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAQAAACR313BAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQfiCwEEOA6vGn99AAAAJElEQVQY02NgoCFgZGChSHcCfun/+KRZGH5QoJuA3TT1N2UAAKRCA8m04HhjAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTExLTAxVDA0OjU2OjE0LTA0OjAwAvm1FAAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMS0wMVQwNDo1NjoxNC0wNDowMHOkDagAAAAASUVORK5CYII=",t.zoomInIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAQAAACR313BAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAAAEgAAABIAEbJaz4AAAAHdElNRQfiCwEENCWvE8kxAAAAwElEQVQY033RPUoEQRAF4G+2mxUWBCNjTyBs4hkMzfQ8u5cxNJTFE2jmCQxM1kgRFIfubYMpcQZ/qoPiva5X1a+af6OLnFRnLjw7cOlKUsdlGWvNu2YdOFLSyYqGghZ8UzOTNqFSlC946kjxaomEpXP7sgfXsNEUbXKKZjOoe3yYydG6KHYW+uF6jj1pND+rA59x48Wb3oljVXLv1tzC3fTFq/C9+t13h11s8g/fs5++xaa2Hj05tA08+pIxat/EJ3JFQ3rCv00IAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTExLTAxVDA0OjUyOjM3LTA0OjAweN8IjgAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMS0wMVQwNDo1MjozNy0wNDowMAmCsDIAAAAodEVYdHN2ZzpiYXNlLXVyaQBmaWxlOi8vL3RtcC9tYWdpY2stSzZjb29QMEXVGp49AAAAAElFTkSuQmCC",t.tiltUpIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAJCAYAAAACTR1pAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACpSURBVHgBlZC9DcIwEIVfuChO6RE8AT9tJAoU0TMKmQAxAdnEJQ3IVKa0CPMYY1NEFooJedX5fN873QMSOisjrvqxT/1nKYgxUr4U1trNdr26fc/MhkDGchmgUBORDEajoNLdCXDLqMXDdqUMT4Lq/jw4YOgu4UqScaO/8aK7nXeR+CFv2tbVvOnBTxgFGf/iGJGDa+pq0WZxgvhTIem8LMBfDkdMUEbE3zxPNOjkuRmkAAAAAElFTkSuQmCC",t.tiltDownIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAKCAYAAACE2W/HAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAACrSURBVHgBrZGxDcIwEEXvzCKZgMglcRWC6DMCG8AEhBHYIGzAAKA0IEqcDTJCeuAOH5KlgAgKUV7l/61nWz6AnuDxXGaIuP5HIoBUJSbMiHjXVWLmzSwa75WE0Y2WrrIdpK1c9HqqL4vLNWBWhauCFs1Oo1D7pPwinujqzpQCQ/1FqhDdXgPVDHOjLcNj9e5A7aRYDm4VhcToXD7AZ0JYfEo/OZzKXEYFQ/MEPtI/ZDp7uSEAAAAASUVORK5CYII=",t.locationIcon="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAAQABAAD/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/hAytodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Nzg4QTJBMjVEMDI1MTFFN0EwQUVDODc5QjYyQkFCMUQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Nzg4QTJBMjZEMDI1MTFFN0EwQUVDODc5QjYyQkFCMUQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3ODhBMkEyM0QwMjUxMUU3QTBBRUM4NzlCNjJCQUIxRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3ODhBMkEyNEQwMjUxMUU3QTBBRUM4NzlCNjJCQUIxRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/bAEMABQMEBAQDBQQEBAUFBQYHDAgHBwcHDwsLCQwRDxISEQ8RERMWHBcTFBoVEREYIRgaHR0fHx8TFyIkIh4kHB4fHv/AAAsIABQAFAEBEQD/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/2gAIAQEAAD8A98+JHjbWrHxHZeCfBOn2N94mvLVr6aa/kKWemWitt+0T7fmbLZVUHUgnOBXmfhHxZ4x8LWeveINO8beF/ino0F7JqGu2emOyX2no+N7W+ZHUxIFJEZwCAdpr6D0fUrLV9Js9W024S5sb2BLi3mXpJG6hlYfUEV8++OvDtt4W+IPivT/EPiXU7bRviLobafZ67qVx5iafeK8p+zF8ARxFZMoCQMArmvOfhL8PLj4EXWueLPFviPRb+7vdNl0zRtG0m5NzPqk0pUIAmASuQvY4zk4xz9F/BD4fXvgv4Z6Poepa7rVxfJbxvcRy3nmJbSFFDQxcfLGpBwPXJ713mr6bp2r6dPpurWFrf2U67Zre5iWSOQejKwINcF8KPhX4G8F6lq+paHoNpHezalPLHcPChktkbH7mJgoKRjsOvJyTXpIr/9k=",t.logoIcon="data:image/png;base64,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",t.rainTexture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAACACAYAAAAhzrj3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFZSURBVHgBrVNBbsNACATiQ2+2f5D+pP8/tS9JD5UaKTZTYCG2ayenrKJ4BMMA4zXRi87l9/bhT6mAdNRhG5lo4v+pjNCTSJflNJXOVDqWugBDtBiI+qVq1SuroF0fYMZt3A7mf9cCb7tUA1pAdik7P9fpfYmcCsx0RH4AJJYwoLbTM/KUAMKD2AFBh/WobVaxB2/KOyeLMERVl5TOyg96yckLvEUIKsZGdtfl1IuLzdCxkY3XGYeJU9DcQmtBFhHi1CFwjLLp5TMd2sJIMorD/htCh8H9SpnNOony9BAoQU7AbaBMSUXunEjRLlUAcL/nUZhtUZY+dGxtIwebkyzlIaWgbu0FzgdjKK3LXVEbOS5IRMzhc7iRNG6XwQdzY9rdiE35PnPtnqEgr/bSSsX9xr3qbNH2mqyAWwvADLew2TD63XPkE8bqbUKmdRVRpkzs27F/lJ9G/PoD4CKlP3uMsAAAAAAASUVORK5CYII=",t.snowTexture="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAH1SURBVHgBpVPtbtswDDxSst0m6pqkzZphzSPs9x6/L7CH2I8NSLAldmAj8ZfEUW6dtR3WPxUgWCbE4/GOAt656HVARGIsLQpcWoskxvoe3WyGWo8NEcl/ATTZVhXmkjTz4NkxJZmmI1jbcEBFGXIH5ArSjzl2PHwTSY7AkjOsuja7BftrIX+hVwS9bwLLAUe52lGSaqHtCGJH2iVw3XVYSefviXDHoLkPYcocRM/H4JHrN7PSYVM1reb8ju2MDFI0WFDfL0H0USD3Aloy0VUQAQMlQSYBGhVqp0mi9RB3PQBEwSiFA9MHrbIIgqXyWuu+4YEi7UAsCDgJSyGcuQK4OANEtQMpC0I20NbKGl4QeB0GVySqXZChS41nyjSjxg4ODQWc0xrooyPE4Gc2KX0VhF9aR13/9+ephaJP01nTwddMqvVjf7tHCOUm2Ks2pfhwAofaGGr7Ft1zgPrm06zS64fhcpCJJmgtOtAAoiYRtrr3YD4wbLkrvtfnQYo2avatP2LNxn8OPqxAZmEIF0EZkPBRtcjZYGPY/Cyb6sedc7/ONsbDw4PkX76eUus1ZKhRFkVQwYIXUgNqa+TQe9kZbzaavB9H+p9R3lbVYpK4mWE4r2rHRo1IyyYpqaty59yLUX7zMTW2Sqdw8vSYThpvXz+md68/1R4Na0qbii0AAAAASUVORK5CYII=",t.skyTexture="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAQEBAQEBAQEBAQGBgUGBggHBwcHCAwJCQkJCQwTDA4MDA4MExEUEA8QFBEeFxUVFx4iHRsdIiolJSo0MjRERFwBBAQEBAQEBAQEBAYGBQYGCAcHBwcIDAkJCQkJDBMMDgwMDgwTERQQDxAUER4XFRUXHiIdGx0iKiUlKjQyNEREXP/CABEIAEAAQAMBIgACEQEDEQH/xAAbAAEAAgMBAQAAAAAAAAAAAAAEBQYBAgMHCP/aAAgBAQAAAAD5z6b3NQior6u6VLZavLkOudjwWS81k0TinWKc8wnFSuky9FSsacvkE70buxLJDoPz1rOmc51//8QAGAEBAQADAAAAAAAAAAAAAAAABAIDBQf/2gAIAQIQAAAA6xOKUg1Y5AUUFLH/xAAZAQACAwEAAAAAAAAAAAAAAAAEBQECAwf/2gAIAQMQAAAA5RO+obR2wqyLOwPJv//EADIQAAIBAwICBwcEAwAAAAAAAAECAwAEEQUSITETFSJBYXGBBiMyQlGRoRRDUmIkkrH/2gAIAQEAAT8ATcrkhFJP8hnGaNjcDBeCQZ/oaWDYe0uT41p13o5B63Z5TIgDEA9nyAyOFWns5olyu+y1ZZ2H7bgxuDjPJtualsDbkoYwmM8OVdAx7yR4VHA4BGOBpLZgQyggjljwpunkx0s0rkAAb3JwB51Dp7zjMfaI5r31HpchOOjpLQQEMCQ4+nA0RJOQZAWblk86jsZSNxjIX6ngK0Kw0qTd+qhuJ7gkBEQAIvic5zS25pLeoIzGwZVOR3g4qy06fVFCi8tnfYWIaTYwwORB5mtH9kLW9t5pbqSNNmNxzuA9R3+FDQrZJZbfT7czNHne8gLhfQYH+1Jo808gWSZjjh2jtjBH0Aq09nS6mZHKBX2drkfLHOksDnGzjUWiXBAZ4nRSMgsp4+VR6Ycno4nbbgMwGQCaOh3NiIZ1ljO8AhkOdufrnlSW19GvC9zGf4Odv2qGR4x7zpCSDllOCa0jWlsFdXstyN/UFvvWm6pameRnt+hjf4SqYIJq10C7l7UecDvSl0bVNqkpK6Lj43O0gfXNQ2F3v6FLRVViMpE5VeHqRUNpEsbLPpErsPnZ9xH3FLaLvGLDaARwwMnNQ2thISOqnRwANztkHHhj/gqGCK27a2NqN2NyGPdQBfpHihRCRjivMHuqKzWQrGskAx3+8B/NQW8tpGC+pbCV75Dk+WVNC7aRSguBKR8x2K33OM1E7uSDGwQjmJgD+MVFBeDb+nZ4l4k8nx6MxpUvk2qb8SFu6aDbgnyzSW+pR8WeORe/EQrazhXlISQN8o6M8PImo7IJu2lwQOaePliorMA9pNwP9SaFpEo4qVPiB+NwNJHDjGARjvAFAxAIDbA4+Hsg8/I1E7BQUiRefnRupFGDFn04VJKz5/xoOH1G6k1ROHvSPXNR6pFke8X1ApdXh7mUetDWIh+9+c11zEf3T9663jPJ1rrWP+a11pEfnFf/xAAnEQACAQMDAgYDAAAAAAAAAAABAgADBBESITEFQRMUMjNRgmFxgf/aAAgBAgEBPwDwjmPTQjDPj9HBioyn3dS/nmVrhKSFsasfEe4ReTiXNdGxpcK3bO8Y3Gpm8xqB4HYS4u7tNQFLYcEY3lx1KpnbBPYER72o3qpgfYgyr1DO2w+xzGvQTkkN/SY93V+Y1zVbnMd3bmKxXhJ//8QAJhEAAgEEAQMDBQAAAAAAAAAAAQIDAAQRIRIFMUETYXEUIjJRgf/aAAgBAwEBPwA3GtVFLKrBxHy+RkUXV1x6AWT2Jwat7N5pAmeJPk0lo7fijGrO2kXJaNmQdwNVGlrwjT6TiR3c7Jq1sbGT0yZPuPcHOqtelQkbBA8kMMVHYwoRxkJ+VBFQ9PCnyR7qMUtpjQBUfrAFQ20R45GP7SW0IOuNKqL2NEAjBev/2Q==",t.selectionIcon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFdSURBVHgB7ZRRSsNAEIYngTSLrRBvkCN4hAhN9NEj1BN4BOMJ9Ab1Br6KFjyCV+gNAho1IGTdybYhtElmd/rQl/2hsA0z833sZgPg4uJCpEii6DM7uQbLYE+RiJiq86mCSVB9+LJ+LlOxBMOUl2KJPZMA3qlaUkB67XJhIoFwqGGx08sX+PPhAjxYm0h04djT9BIxcFTvwZWIg1ptp4R48+hp9lbdUPCzl2pNzTYSoCS4cF1ukT6J5hCZcN1imR4J4MJ1GyN7Eky4bmWmlQB9Uzhwo5RZ+KCunvzOxJ1pz08a3pbzsMBeqpbcARwEnhc1xR7k09fqfqweRaWEfPtf3ZRRBvkhUiUtEAeP7cQuXK1HZY0EZqvfx+6gIYk++Omqyqn5xi/h11zk6ghacPc4uHArgSGJDTDnwK0F+iS6sYWzBIYkOPCDghL4fcAfruEYKdLpuYIn4OLickD+AQYhydWrI9CfAAAAAElFTkSuQmCC\n",t.selectionIcon2x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAWJAAAFiQFtaJ36AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAHaSURBVHgB7dnRTcJQGAXgcyuYGhXjBriBI9REjY9sIGwgkxgnECaQZzTKCI7ABiSaaINpr/0b8cHQ0nJvbwOe76VNm1x6TqDtHwAiIiIiIiIiIvpfFAzNAr/dbOI+2Q2SxaaR8vqt8ccIFXg/9wOl9G1y2afJdjSfq/7xJJzCgAdDuw25IASyr4G2p+OHz0v/GpbJmkrhRcKnn6VV56d4I8YFaKU6f49FGgObJchasuaSUwEMGReQVPC67KitEnLCyw94CkPm3wCt+lnnTEvIDQ/J7/VhyLiAw6dwEgO9rPPrlrAqPCL09i3cbI2fAgtvF343aTPzprSj0N0bh0MUUCT8wXM4gAXWChA2SnAZXlgtQJiU4Dq8sF6AWKeEOsKLSgoQZUqoK7yorABRpATZ1hVeVFqAWFVCrorDi8oLEGuV4CC8cDYNliohI/xGT4Otx3CQ98b4KyP8VkyDK0vICb8102BmCeXDb+40KCV87eBEQ92pGAOtcVY6POxMg1aeAjYHoQVXL0ecBmERp0FwGkxxGgSnwRSnQXAaTG31NFiUjWmwCs4KEIVKcBheOC1A5JbgOLxwXoBYWkIN4UUtBYjZld9uROrGi/VRrDCUv9hAREREREREbnwDA4SPLKLOD5kAAAAASUVORK5CYII=",t.selectionIcon3x="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAOHSURBVHgB7dtdThRBGIXhryEQNDFhdsASXAIkxnjpDmQHLoGwA5egO/DSGBNmCexAdsAkXjhxgLbOEIwXBPqvqr6qfp8bSBh+es6BaXrmmAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAI8ac+LXm4PjprEza9vX1jSH4Ue7NGsvNxs7XyzXV1ag6+PDw/399cfW7NRaOwrHtgrH9tXTMbkowO+3Bx9uW/v82MfCD3j1Z2MnpZXg+vjgaH/PLkL4R499fLex0xff118ss+wF0B21t2c/n7pNaSV4LvwHbWsnr36sl5bRjmUWwj977ja6I3WH6o4157qGL9uHvMyyFyD8GrzvdLMCStAn/HvhfCez/AXYnvB147kE/cOX7sceS/4ChMf3Pjf2WIJh4QdNe2mZZS9AOBHqfSbsqQSDw5e2oQA3N+tP4TT/ynryUIJR4Ydj3uzauWWWvQCLpa02O3ZSWglGhx+OefEt/7+1bq4EXr8L1wPu7GJ7xayn1NcJaglf3BRASihBTeGLqwKI5xLUFr64K4B4LEGN4YvLAoinEtQavrgtgHgoQc3hi+sCSM4S1B6+uC+A5CjBHMKXIgogKUswl/ClmAJIihLMKXwpqgASswRzC1+KK4DEKMEcw5ciCyBTlmCu4UuxBZApSqD35xq+FF0AGVsCvZ1r+FJ8AWRMCQapJHypogCSrAQVhS/VFECil6Cy8KW6bWC0EgwIn21gR1NvAycvwaDw2QZ2EmsbOFkJIoT/gG2gxdsGKrChrzb+J2L42y/PNtCibgNHlSBy+PfYBkbfBg4qQZLwt9+IbaAl2Ab2KkGy8I1toKTaBnYqQcrwhW1g2m3gQwnu7JHStbZMGr6TbaCL6wBZXvMXvufu5m57EnZ7+3K5WK5WvT6fbeC02Abm4eq5ALaB6bl7MohtYFounw1kG5iO26eD2Qam4fr1AGwD43P/ghC2gXG5L4CwDYyniAII28A4iimAsA2cXlEFELaB0yquAMI2cDpFFkDYBk6j2AII28Dxii6AsA0cp/gCCNvA4aoogLANHKaaAgjbwP6qKoB42gaWoLoCiIdtYCmqLIDk3AaWpNoCyOgSVB6+VF0AGVyCGYQv1RdAepdgJuHLLAognUswo/BlNgWQZ0sws/DFwzo4mam3gTWY1V+A/43dBgIAAAAAAAAAAAAAAAAAAAAAAABAPn8BXYb/amoY+58AAAAASUVORK5CYII=",t.images={markerDefault:[t.markerDefault,t.markerDefault2x,t.markerDefault2x],myPosition:[t.myPosition,t.myPosition2x,t.myPosition2x],zoomOutIcon:[t.zoomOutIcon,t.zoomOutIcon,t.zoomOutIcon],zoomInIcon:[t.zoomInIcon,t.zoomInIcon,t.zoomInIcon],tiltUpIcon:[t.tiltUpIcon,t.tiltUpIcon,t.tiltUpIcon],tiltDownIcon:[t.tiltDownIcon,t.tiltDownIcon,t.tiltDownIcon],locationIcon:[t.locationIcon,t.locationIcon,t.locationIcon],logoIcon:[t.logoIcon,t.logoIcon,t.logoIcon],rainTexture:[t.rainTexture,t.rainTexture,t.rainTexture],snowTexture:[t.snowTexture,t.snowTexture,t.snowTexture],skyTexture:[t.skyTexture,t.skyTexture,t.skyTexture],selectionIcon:[t.selectionIcon,t.selectionIcon2x,t.selectionIcon3x]},t.waterColor="data:image/jpeg;base64,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",t.waterDisplacement="data:image/jpeg;base64,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",t}();!function(t){t[t.TOP_LEFT=0]="TOP_LEFT",t[t.TOP_RIGHT=1]="TOP_RIGHT",t[t.BOTTOM_LEFT=2]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=3]="BOTTOM_RIGHT"}(i||(i={}));var L,B=function(){function t(){}return t.getStyleForControlOptions=function(t){switch(t){case i.TOP_LEFT:return"mf-ui-top-left";case i.TOP_RIGHT:return"mf-ui-top-right";case i.BOTTOM_LEFT:return"mf-ui-bottom-left";case i.BOTTOM_RIGHT:return"mf-ui-bottom-right"}},t.bgColor="rgba(255,255,255,1)",t.size="29px",t.content="\n.mf-mapgl {\n  overflow: hidden;\n  height: 100%;\n  width: 100%;\n  position: relative;\n  box-sizing: content-box;\n}\n\n.mf-mapgl canvas {\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  display: inherit;\n}\n\n.mf-mapgl .mf-ui {\n  position: fixed;\n  width: 25px;\n}\n\n.mf-ui.mf-ui-top-left {\n  top: 20px;\n  left: 20px;\n}\n.mf-ui.mf-ui-top-right {\n  top: 20px;\n  right: 20px;\n}\n.mf-ui.mf-ui-bottom-right {\n  right: 20px;\n  bottom: 20px;\n}\n.mf-ui.mf-ui-bottom-left {\n  left: 20px;\n  bottom: 20px;\n}\n\n\n.mf-mapgl .mf-ui .mf-button {\n  margin: 3px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: space-around;\n    width: "+t.size+";\n    height: "+t.size+";\n    border-radius: 2px;\n    border: 1px solid darken("+t.bgColor+", 5%);\n    background-color: "+t.bgColor+";\n    cursor: pointer;\n    user-select: none;\n    -moz-user-select: none;\n}\n\n.mf-mapgl .mf-ui .mf-button:hover {\n    background-color: darken("+t.bgColor+", 5%);\n  }\n\n.mf-mapgl .mf-ui .mf-button:active {\n    background-color: darken("+t.bgColor+", 10%);\n  }\n \n.mf-mapgl .mf-ui .mf-zoom-in-icon { \n  background-image: url("+D.zoomInIcon+");   \n  background-position: center !important;\n  background-repeat: no-repeat !important;\n  background-size: cover !important;\n  width: 12px;\n  height: 12px;  \n  opacity: 0.5;\n  z-index: 1;  \n    \n}\n\n.mf-mapgl .mf-ui .mf-zoom-out-icon { \n    background-image: url("+D.zoomOutIcon+"); \n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 12px;\n    height: 12px;  \n    opacity: 0.5;\n    z-index: 1;      \n}\n\n.mf-mapgl .mf-ui a:hover {\n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 12px;\n    height: 12px;\n    opacity: 1;\n    z-index: 1;\n    \n}\n\n.mf-mapgl .mf-ui .mf-location {\n    background-image: url("+D.locationIcon+");\n    background-position: center !important;\n    background-repeat: no-repeat !important;\n    background-size: cover !important;\n    width: 17px;\n    height: 17px;     \n    position: absolute;\n    opacity: 0.5;\n    z-index: 1;\n}\n\n.mf-logo-container {\n  position: fixed;\n  left: 10px;\n  bottom: 10px;\n  z-index: 1;\n}\n\n.mf-logo {\n  cursor: pointer;\n  width: 75px;\n  opacity: 1;\n  z-index: 1;\n}\n\n.mf-info-window-container {\n  position: relative;\n  display: inline-block;\n  z-index: 1;\n}\n\n.mf-info-window-content p, h4{\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n    padding: 5px;\n    margin-bottom: 0;\n    margin-top: 0;\n}\n\n.mf-info-window-content p:empty, h4:empty{\n  display: none;\n}\n\n.mf-info-window-content {\n  background-color: #ffffff;\n  max-width: 200px;\n  text-align: center;\n  padding: 5px;\n  border-radius: 13px;\n}\n\n.mf-mapgl .mf-ui .mf-button-mode {\n  position: fixed;\n  bottom: 130px;\n  right :13px;\n    display: inline-flex;\n    align-items: center;\n    justify-content: space-around;\n    width: "+t.size+";\n    height: "+t.size+";\n    border-radius: 2px;\n    border: 1px solid darken("+t.bgColor+", 5%);\n    background-color: "+t.bgColor+";\n    cursor: pointer;\n    user-select: none;\n    -moz-user-select: none;\n}\n",t}(),O=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),this.red=t,this.green=e,this.blue=n,this.alpha=i}return t.prototype.buffer=function(){return[this.red,this.green,this.blue,this.alpha]},Object.defineProperty(t.prototype,"rgba",{get:function(){return"rgba("+255*this.red+","+255*this.green+","+255*this.blue+",1)"},enumerable:!0,configurable:!0}),t.fromHex=function(e){void 0===e&&(e="000000"),7!=e.length&&9!=e.length||(e=e.substring(1,e.length));var n=parseInt(e,16);return 6==e.length?new t((n>>16)/255,(n>>8&255)/255,(255&n)/255):new t((n>>24&255)/255,(n>>16&255)/255,(n>>8&255)/255,(255&n)/255)},t.fromInt=function(e){return void 0===e&&(e=0),e<0&&(e=0),new t((e>>16&255)/255,(e>>8&255)/255,(255&e)/255)},t.fromVec3=function(e){return new t(e.x,e.y,e.z)},t.mix=function(e,n,i){return new t(e.red*i+n.red*(1-i),e.green*i+n.green*(1-i),e.blue*i+n.blue*(1-i),e.alpha*i+n.alpha*(1-i))},Object.defineProperty(t.prototype,"code",{get:function(){var t=function(t){var e=(255*t).toString(16);e=(e=1==e.length?"0"+e:e).length>2?e.substr(0,2):e};return"#"+t(this.red)+t(this.green)+t(this.blue)+t(this.alpha)},enumerable:!0,configurable:!0}),t.isValid=function(t){return/^[0-9A-F]{8}$/i.test(t)},t}();!function(t){t[t.cameraWillChange=0]="cameraWillChange",t[t.cameraChanging=1]="cameraChanging",t[t.idle=2]="idle",t[t.click=3]="click",t[t.dblClick=4]="dblClick",t[t.drag=5]="drag",t[t.dragEnd=6]="dragEnd",t[t.dragStart=7]="dragStart",t[t.mouseMove=8]="mouseMove",t[t.mouseOut=9]="mouseOut",t[t.mouseOver=10]="mouseOver",t[t.projectionChanged=11]="projectionChanged",t[t.rightClick=12]="rightClick",t[t.tilesLoaded=13]="tilesLoaded",t[t.markerClick=14]="markerClick",t[t.objectClick=15]="objectClick",t[t.polygonClick=16]="polygonClick",t[t.polylineClick=17]="polylineClick",t[t.circleClick=18]="circleClick",t[t.modeChanged=19]="modeChanged",t[t.markerHover=20]="markerHover",t[t.objectHover=21]="objectHover",t[t.polygonHover=22]="polygonHover",t[t.polylineHover=23]="polylineHover",t[t.circleHover=24]="circleHover"}(L||(L={}));var P=function(){function t(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by}return t.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},t.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},t.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},t.prototype.solveCurveX=function(t,e){var n,i,o,r,a,s;for(o=t,s=0;s<8;++s){if(r=this.sampleCurveX(o)-t,Math.abs(r)<e)return o;if(a=this.sampleCurveDerivativeX(o),Math.abs(a)<1e-6)break;o-=r/a}if(i=1,(o=t)<(n=0))return n;if(o>i)return i;for(;n<i;){if(r=this.sampleCurveX(o),Math.abs(r-t)<e)return o;t>r?n=o:i=o,o=.5*(i-n)+n}return o},t.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))},t}(),k=function(){function t(t,e){this.dx=0,this.dy=0,this.timeConstant=t,this.initialSpeedRate=0,this.velocityRatioX=0,this.velocityRatioY=0,this.cameraAnimationObserver=e}return t.prototype.getDisplacement=function(t,e,n){return t*e*-Math.expm1(-n/t)},t.prototype.getDuration=function(e,n){return-e*Math.log(t.minTrackSpeed/n)},t.prototype.startFling=function(e,n){return e=y.clamp(e,a.flingMinVelocity,a.flingMaxVelocity),n=y.clamp(n,a.flingMinVelocity,a.flingMaxVelocity),e*=t.secToMs,n*=t.secToMs,this.initialSpeedRate=Math.sqrt(e*e+n*n),this.initialSpeedRate<t.minTrackSpeed?(this.stopFling(),void this.cameraAnimationObserver.notifyCameraDidChange()):(this.flingDuration=this.getDuration(this.timeConstant,this.initialSpeedRate),this.getDisplacement(this.timeConstant,this.initialSpeedRate,this.flingDuration)<t.minDisplacement?(this.stopFling(),void this.cameraAnimationObserver.notifyCameraDidChange()):(this.velocityRatioX=e/this.initialSpeedRate,this.velocityRatioY=n/this.initialSpeedRate,this.previousPositionX=0,this.previousPositionY=0,void(this.flingStart=Date.now())))},t.prototype.stopFling=function(){this.initialSpeedRate=0},t.prototype.isFlingInProgress=function(){return this.initialSpeedRate>0},t.prototype.trackMovement=function(){if(!this.isFlingInProgress())return!1;var t=Date.now()-this.flingStart;if(t>this.flingDuration)return this.stopFling(),this.cameraAnimationObserver.notifyCameraDidChange(),!1;var e=this.getDisplacement(this.timeConstant,this.initialSpeedRate,t),n=e*this.velocityRatioX,i=e*this.velocityRatioY;return this.dx=n-this.previousPositionX,this.dy=i-this.previousPositionY,this.previousPositionX=n,this.previousPositionY=i,!0},t.secToMs=.001,t.minTrackSpeed=.01,t.minDisplacement=20,t}(),N=function(){return function(){}}(),F=function(){return function(){this.anchor=null,this.target=null,this.zoom=null,this.tilt=null,this.bearing=null}}();function j(t,e,n,i){var o=new P(t,e,n,i);return function(t){return o.solve(t,s.epsilon)}}var Z,V,W=j(0,0,.25,1),U=function(){function t(t,e,n){this.onUpdateTransitions=null,this.mapState=t,this.cameraAnimationObserver=e,this.mapSettings=n,this.flingTracker=new k(a.flingTimeConstant,e)}return t.prototype.moveBy=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var i=new F,o=this.mapState.getTarget(),r=x.getMetersPerPixelAtLatitude(a.metersPerPixelAtLatitude,this.mapState.getZoom()),s=new M(t.y,t.x).multiply(r);s=s.rotateBy(-this.mapState.cameraPosition.getBearing()),i.target=x.convertToLatLngFromMeter(x.convertToMeterFromLatLng(o).add(s)),null==e?e=new N:null==e.duration&&(e.duration=S.getTimePanTo(this.mapState.getTarget(),i.target,this.mapState.getZoom())),e.gesture=n,this.mapState.gesture=n,this.mapState.movingTo=!0,this.easeTo(i,e)},t.prototype.moveTo=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=!1),null==n&&(n=new N),n.gesture=i,this.mapState.gesture=i;var o=new F;o.target=t,e>=this.mapSettings.getPreferMinZoom()&&(e=y.clamp(e,this.mapSettings.getPreferMinZoom(),this.mapSettings.getMaxZoom()),o.zoom=e),this.mapState.movingTo=!0,this.easeTo(o,n)},t.prototype.zoom=function(t,e,n){this.mapState.startedZoom=!0,this.flingTracker.stopFling(),n.duration||(n.duration=a.defaultAnimationDuration);var i=new F;i.zoom=t,i.anchor=e,this.easeTo(i,n)},t.prototype.isAnimated=function(){return this.mapState.panning||this.mapState.zoomIn||this.mapState.zoomOut||this.mapState.flyingTo},t.prototype.moveByVelocity=function(t){this.flingTracker.startFling(t.x,t.y)},t.prototype.setTilt=function(t,e){void 0===e&&(e=!1);var n=new F,i=new N;i.gesture=e,this.mapState.gesture=e,t=y.clamp(t,this.mapSettings.getMinTilt(),this.mapSettings.getMaxTilt()),n.tilt=t,this.mapState.tilting=!0,this.easeTo(n,i)},t.prototype.setBearing=function(t,e,n){void 0===n&&(n=!1);var i=new F,o=new N;o.gesture=n,this.mapState.gesture=n,i.bearing=t,e&&e>0&&(o.duration=1e3*e),this.mapState.bearing=!0,this.easeTo(i,o)},t.prototype.easeTo=function(t,e){var n=this,i=this.mapState.getZoom(),o=null!=t.zoom?t.zoom:this.mapState.getZoom(),r=this.mapState.getBearing(),u=this.mapState.getTilt(),l=this.mapState.getTarget(),h=t.bearing,c=t.tilt,p=null!=t.target?t.target:this.mapState.getTarget(),f=t.anchor,d=new g(0,0);f&&(d=b.screenCoordinateToLatLng(f,this.mapState)),this.mapState.zoomIn=o>i&&o-i>s.epsilon,this.mapState.zoomOut=i>o&&i-o>s.epsilon,this.mapState.panning=l!=p;this.startTransition(e,function(t){var e=i*(1-t)+o*t;if(null!=h){for(var s=r+(h-r)*t;s>=360;)s-=360;for(;s<0;)s+=360;n.mapState.setBearing(s)}if(null!=c){var m=u+(c-u)*t;n.mapState.setTilt(m)}var y=l.lat()*(1-t)+p.lat()*t,v=l.lng()*(1-t)+p.lng()*t,A=new g(y,v);if(n.mapState.setZoom(e),n.mapState.setTarget(A),Math.round(n.mapState.getZoom())<=a.defaultMinZoom3d&&(n.mapState.isZoomIn()||n.mapState.isZoomOut())&&n.mapState.handleSwitchMode(),f){var w=Math.pow(2,e),M=x.projectScale(n.mapState.getTarget(),w),_=x.projectScale(d,w),T=x.projectScale(b.screenCoordinateToLatLng(f,n.mapState),Math.pow(2,e));n.mapState.setTarget(x.unproject(M.add(_).subtract(T),w))}})},t.prototype.startTransition=function(t,e){var n=this,i=t.duration?t.duration:0,o=t.easing?t.easing:W,r=0!=i;this.transitionStart=Date.now(),this.transitionDuration=i,this.mapState.isWillChange()||(this.mapState.willChange=!0,this.cameraAnimationObserver.notifyCameraWillChange(t.gesture)),this.onUpdateTransitions=function(i){var a=r?(i-n.transitionStart)/n.transitionDuration:1;return e(a>=1?1:o(a)),n.cameraAnimationObserver.notifyCameraIsChanging(),!(a<1)&&((n.mapState.isZoomIn()||n.mapState.isZoomOut()||(n.mapState.isMoving()||n.mapState.isBearing()||n.mapState.isTilting())&&!n.mapState.isGesture()||n.mapState.isFlyingTo()||n.mapState.isBearing()&&null!=t.duration)&&n.cameraAnimationObserver.notifyCameraDidChange(),!0)},r||(this.updateTransitions(),this.onUpdateTransitions=null)},t.prototype.stopAnimation=function(){this.mapState.isBearing()&&(this.mapState.bearing=!1,this.onUpdateTransitions=null,this.mapState.isWillChange()&&this.cameraAnimationObserver.notifyCameraDidChange()),this.mapState.gesture=!1},t.prototype.updateTransitions=function(){if(null!=this.onUpdateTransitions){var t=Date.now(),e=this.onUpdateTransitions;this.onUpdateTransitions=null,e&&e(t)?(this.mapState.zoomIn=!1,this.mapState.zoomOut=!1,this.mapState.panning=!1,this.mapState.flyingTo=!1,this.mapState.movingTo=!1,this.mapState.bearing=!1,this.mapState.tilting=!1,e=null,this.onUpdateTransitions=null):null==this.onUpdateTransitions&&(this.onUpdateTransitions=e)}else this.flingTracker.isFlingInProgress()&&this.flingTracker.trackMovement()&&this.moveBy(new A(this.flingTracker.dx,this.flingTracker.dy),null,!0)},t.prototype.flyTo=function(t,e){var n=this;if(this.flingTracker.stopFling(),!this.isAnimated()){var i=this.mapState.getZoom(),o=t.target,r="zoom"in t?y.clamp(+t.zoom,this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()):i,u=this.mapState.getTarget(),l=x.projectScale(u,this.mapState.getScale()),h=x.projectScale(o,this.mapState.getScale()),c=Math.max(this.mapState.getScreenSize().x,this.mapState.getScreenSize().y),p=c/Math.pow(2,r-i),f=Math.hypot(h.x-l.x,h.y-l.y),d=1.42;if("minZoom"in e){var g=y.clamp(Math.min(e.minZoom,i,r),this.mapSettings.getMinZoom(),this.mapSettings.getMaxZoom()),m=c/Math.pow(2,g-i);d=Math.sqrt(m/f*2)}var v=d*d,A=function(t){var e=(p*p-c*c+(t?-1:1)*v*v*f*f)/(2*(t?p:c)*v*f);return Math.log(Math.sqrt(e*e+1)-e)},w=A(0),_=function(t){return R(w)/R(w+d*t)},b=function(t){return c*(R(w)*function(t){return I(t)/R(t)}(w+d*t)-I(w))/v/f},T=(A(1)-w)/d;if(Math.abs(f)<s.epsilon||!isFinite(T)){if(Math.abs(c-p)<s.epsilon)return this.easeTo(t,e);var S=p<c?-1:1;T=Math.abs(Math.log(p/c))/d,b=function(){return 0},_=function(t){return Math.exp(S*d*t)}}if("duration"in e&&null!=e.duration)e.duration=+e.duration;else{var E="velocity"in e?+e.velocity/d:1.2;e.duration=1e3*T/E}e.duration>a.maxDurationFlyTo&&(e.duration=a.maxDurationFlyTo);var C=this.mapState.getScale();this.mapState.flyingTo=!0,this.startTransition(e,function(t){var e=t*T,o=1===t?1:b(e),u=new M(l.x*(1-o)+h.x*o,l.y*(1-o)+h.y*o),c=1/_(e),p=1===t?r:i+Math.log(c)/Math.LN2;p=y.clamp(p,n.mapSettings.getMinZoom(),n.mapSettings.getMaxZoom()),Math.abs(t-1)<s.epsilon&&(p=r),p!=p&&(p=r);var f=x.unproject(u,C);n.mapState.setZoom(p),n.mapState.setTarget(f),Math.round(n.mapState.getZoom())<=a.defaultMinZoom3d&&n.mapState.handleSwitchMode()})}function I(t){return(Math.exp(t)-Math.exp(-t))/2}function R(t){return(Math.exp(t)+Math.exp(-t))/2}},t}(),z=function(){function t(t){this._mapView=t,this._delta=0,this._enabled=!0,this.onTimeout=this.onTimeout.bind(this),this.onScrollFrame=this.onScrollFrame.bind(this)}return t.prototype.isEnabled=function(){return!!this._enabled},t.prototype.enable=function(t){this.isEnabled()||(this._enabled=!0)},t.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},t.prototype.isActive=function(){return!!this._active},t.prototype.onWheel=function(t,e){if(this.data=t,this.isEnabled()){var n=Date.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n;var o=t.dy;0!==o&&o%4.000244140625==0?this._type="wheel":0!==o&&Math.abs(o)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this.onTimeout,40,t)):this._type||(this._type=Math.abs(i*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),e.shiftKey&&o&&(o/=4),this._type&&(this._delta-=o,this.isActive()||this.start(t)),e.preventDefault()}},t.prototype.onTimeout=function(t){this._type="wheel",this._delta-=this._lastValue,this.isActive()||this.start(t)},t.prototype.start=function(t){this._delta&&(this._frameId&&(this._mapView.cancelRenderFrame(this._frameId),this._frameId=null),this._active=!0,this.isTrackpad()&&this._finishTrackpadTimeout&&clearTimeout(this._finishTrackpadTimeout),this.isWheel()&&this._finishTimeout&&clearTimeout(this._finishTimeout),this._anchor=new M(t.x,t.y),this._anchorLatLng=b.screenCoordinateToLatLng(this._anchor,this._mapView.mapState),this._frameId||(this._frameId=this._mapView.requestRenderFrame(this.onScrollFrame)))},t.prototype.onScrollFrame=function(){var t=this;if(this._frameId=null,this.isActive()){if(0!==this._delta){var e=this.isWheel()&&Math.abs(this._delta)>4.000244140625?1/450:.01,n=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==n&&(n=1/n);var i=null==this._targetZoom?this._mapView.mapState.scale:Math.pow(2,this._targetZoom);this._targetZoom=Math.min(this._mapView.mapSettings.getMaxZoom(),Math.max(this._mapView.mapSettings.getMinZoom(),Math.log2(i*n))),this.isWheel()&&(this._targetZoom>this._startZoom?this._targetZoom=Math.ceil(this._targetZoom):this._targetZoom<this._startZoom&&(this._targetZoom=Math.floor(this._targetZoom)),this._startZoom=this._mapView.mapState.getZoom(),this._easing=this.smoothOutEasing(200)),this._mapView.mapState.zoomIn=this._delta<0,this._mapView.mapState.zoomOut=this._delta>0,!this.isTrackpad||-1!=this._delta&&1!=this._delta||(this._mapView.mapState.zoomIn?this._targetZoom=Math.ceil(this._targetZoom):this._mapView.mapState.zoomOut&&(this._targetZoom=Math.round(this._targetZoom))),this._delta=0}var o=null==this._targetZoom?this._mapView.mapState.getZoom():this._targetZoom,r=this._startZoom,a=this._easing,s=!1;if(this.isWheel()&&r&&a){var u=Math.min((Date.now()-this._lastWheelEventTime)/200,1),l=a(u),h=r*(1-l)+o*l,c=new M(this.data.x,this.data.y);this.setZoom(h,c,200),u<1?this._frameId||(this._frameId=this._mapView.requestRenderFrame(this.onScrollFrame)):s=!0}else{c=new M(this.data.x,this.data.y);this.setZoom(o,c),s=!0}s&&(this._active=!1,this.isWheel()&&(this._finishTimeout=setTimeout(function(){t._finishTimeout=null,t._targetZoom=null},200)))}},t.prototype.isWheel=function(){return"wheel"===this._type},t.prototype.isTrackpad=function(){return"trackpad"===this._type},t.prototype.setZoom=function(t,e,n){void 0===n&&(n=0),Math.round(this._mapView.mapState.getZoom())<=a.defaultMinZoom3d&&(this._mapView.mapState.isZoomIn()||this._mapView.mapState.isZoomOut())&&this._mapView.mapState.handleSwitchMode(),this._mapView.setZoom(t,e,n),this._mapView.notifyCameraIsChanging()},t.prototype.smoothOutEasing=function(t){var e=j(.25,.1,.25,1);if(this._prevEase){var n=this._prevEase,i=(Date.now()-n.start)/n.duration,o=n.easing(i+.01)-n.easing(i),r=.27/Math.sqrt(o*o+1e-4)*.01;e=j(r,Math.sqrt(.0729-r*r),.25,1)}return this._prevEase={start:Date.now(),duration:t,easing:e},e},t}();!function(t){t[t.Down=0]="Down",t[t.Up=1]="Up",t[t.Drag=2]="Drag",t[t.DragEnd=3]="DragEnd",t[t.Wheel=4]="Wheel",t[t.Move=5]="Move",t[t.Over=6]="Over",t[t.Out=7]="Out",t[t.Double=8]="Double",t[t.None=9]="None"}(Z||(Z={})),function(t){t[t.Left=0]="Left",t[t.Wheel=1]="Wheel",t[t.Right=2]="Right",t[t.None=3]="None"}(V||(V={}));var Y,H=function(){function t(t,e){this.canvas=t,this.mapView=e,this.checkDragStart=!0,this.mouseOverTimeout=500,this.longClickTimeout=500,t.addEventListener("mousedown",this.mouseDown.bind(this)),t.addEventListener("mousemove",this.mouseMove.bind(this)),t.addEventListener("mouseup",this.mouseUp.bind(this)),t.addEventListener("wheel",this.mouseWheel.bind(this)),t.addEventListener("mouseover",this.mouseOver.bind(this)),t.addEventListener("mouseout",this.mouseOut.bind(this)),t.addEventListener("dblclick",this.doubleClick.bind(this)),t.addEventListener("contextmenu",function(t){return t.preventDefault()}),t.addEventListener("touchstart",this.touchStart.bind(this),!1),t.addEventListener("touchmove",this.touchMove.bind(this),!1),t.addEventListener("touchcancel",this.touchCancel.bind(this),!1),t.addEventListener("touchend",this.touchEnd.bind(this),!1),this.scrollZoomHandler=new z(this.mapView)}return t.prototype.touchStart=function(t){var e=t.touches.item(0);null!=e&&(e.button=0,this.mouseDown(e))},t.prototype.touchMove=function(t){var e=t.touches.item(0);null!=e&&(e.button=0,this.mouseMove(e))},t.prototype.touchCancel=function(t){console.log("touch cancel")},t.prototype.touchEnd=function(t){var e=t.touches.item(0);null!=e&&(e.button=0,this.mouseUp(e))},t.prototype.drainInertiaBuffer=function(){for(var t=this.inertia,e=Date.now();t.length>0&&e-t[0][0]>160;)t.shift()},t.prototype.doubleClick=function(t){var e=this.mapView.getCurrentMousePosition(t);this.mapView.mapsEventManager.notify(L.dblClick,t),this.dispatch({dx:0,dy:0,x:e.x,y:e.y,action:Z.Double,button:t.button})},t.prototype.mouseOut=function(t){this.mouseOutside=!0,clearTimeout(this.longClickTimeoutHandler),clearTimeout(this.mouseOverTimeoutHandler);var e=this.mapView.getCurrentMousePosition(t);this.mapView.mapsEventManager.notify(L.mouseOut,t),this.dispatch({dx:0,dy:0,x:e.x,y:e.y,action:Z.Out,button:t.button}),this.mousePosition=null},t.prototype.mouseWheel=function(t){if(0!=t.deltaY){var e=this.mapView.getCurrentMousePosition(t);this.dispatch({dx:t.deltaX,dy:1===t.deltaMode?40*t.deltaY:t.deltaY,x:e.x,y:e.y,action:Z.Wheel,button:t.button},t)}},t.prototype.mouseDown=function(t){return this.mapView.stopAnimation(),this.mousePosition=this.mapView.getCurrentMousePosition(t),this.mouseDownPosition=this.mousePosition,this.mouseDownTime=Date.now(),t.button==V.Right&&(this.lastDragRotatePosition=new M(this.mousePosition.x,this.mousePosition.y),this.inertia=[[Date.now(),this.mapView.mapState.getBearing()]]),this.dispatch({x:this.mousePosition.x,y:this.mousePosition.y,dx:0,dy:0,action:Z.Down,button:t.button}),this.mapView.mapState.isStill()&&(clearTimeout(this.longClickTimeoutHandler),this.longClickTimeoutHandler=setTimeout(function(){},this.longClickTimeout)),this.preMouseDown=t,!1},t.prototype.mouseMove=function(t){var e=this;clearTimeout(this.longClickTimeoutHandler);var n=this.mapView.getCurrentMousePosition(t),i=null!=this.preMouseDown?this.preMouseDown.button:t.button;if(this.mousePosition){var o=n.subtract(this.mousePosition);if(this.mousePosition=n,0==o.x&&0==o.y)return;this.checkDragStart&&(this.mapView.mapsEventManager.notify(L.dragStart,t),this.checkDragStart=!1),this.mapView.mapsEventManager.notify(L.drag,t),this.dispatch({x:n.x,y:n.y,dx:o.x,dy:o.y,action:Z.Drag,button:i})}else this.mapView.mapState.isStill()&&(clearTimeout(this.mouseOverTimeoutHandler),this.mouseOverTimeoutHandler=setTimeout(function(){var n=e.mapView.getCurrentMousePosition(t);e.mapView.mapsEventManager.onHoverEvent(n)},this.mouseOverTimeout)),this.mapView.mapsEventManager.notify(L.mouseMove,t),this.dispatch({x:n.x,y:n.y,dx:0,dy:0,action:Z.Move,button:i});return!1},t.prototype.mouseOver=function(t){this.mouseOutside=!1;var e=this.mapView.getCurrentMousePosition(t);this.mapView.mapsEventManager.notify(L.mouseOver,t),this.dispatch({x:e.x,y:e.y,dx:0,dy:0,action:Z.Over,button:t.button})},t.prototype.mouseUp=function(e){clearTimeout(this.longClickTimeoutHandler);var n=this.mapView.getCurrentMousePosition(e);this.mouseUpTime=Date.now();var i=n.subtract(this.mouseDownPosition),o=this.mouseUpTime-this.mouseDownTime;if(i.length<.01){if(this.dispatch({x:n.x,y:n.y,dx:0,dy:0,action:Z.Up,button:e.button}),this.mapView.mapState.isStill())if(e.button==V.Left){var r=this.mapView.getCurrentMousePosition(e);this.mapView.mapsEventManager.onClickEvent(r,e)||this.mapView.mapsEventManager.notify(L.click,e)}else e.button==V.Right&&this.mapView.mapsEventManager.notify(L.rightClick,e)}else this.dispatch({x:n.x,y:n.y,dx:o<t.TIME_DRAG_DETECT?i.x:0,dy:o<t.TIME_DRAG_DETECT?i.y:0,action:Z.DragEnd,button:e.button}),this.mapView.mapsEventManager.notify(L.dragEnd,e),this.checkDragStart=!0;return this.mousePosition=null,this.preMouseDown=null,!1},t.prototype.dispatch=function(t,e){this.mouseEventHandler(t,e)},t.prototype.mouseEventHandler=function(t,e){switch(t.action){case Z.Drag:if(t.button==V.Left){var n=new A(-t.dx*S.pixelScale,t.dy*S.pixelScale);this.mapView.moveBy(n)}if(t.button==V.Right){this.inertia.push([Date.now(),-t.x]);var i=.4*(this.lastDragRotatePosition.x-t.x),o=-.5*(this.lastDragRotatePosition.y-t.y);this.mapView.setBearing(this.mapView.mapState.getBearing()+i,0,!0),this.mapView.setTilt(this.mapView.mapState.cameraPosition.getTilt()-o,!0),this.lastDragRotatePosition=new M(t.x,t.y)}break;case Z.Wheel:this.scrollZoomHandler.onWheel(t,e);break;case Z.DragEnd:if(t.button==V.Left){n=new M(-t.dx,t.dy).multiply(S.pixelScale);this.mapView.moveByVelocity(new M(n.x,n.y).multiply(a.flingSpeedMultiply*S.pixelScale))}if(t.button==V.Right){if(this.drainInertiaBuffer(),this.inertia.length<2)return void this.mapView.notifyCameraDidChange();var r=this.inertia,s=r.length,u=r[s-1],l=r[s-2],h=u[1]-l[1]>0?1:-1,c=(i=u[1]-l[1],3*Math.abs(i));Math.abs(c)>360&&(c=360),c*=h;var p=Math.abs(c)/90;p=y.clamp(p,.5,1),this.mapView.setBearing(this.mapView.mapState.getBearing()+c,p,!0)}break;case Z.Double:if(t.button==V.Left){var f=this.mapView.mapState.getZoom()+1,d=new M(t.x,t.y);this.mapView.setZoom(f,d,0,!0)}}},t.TIME_DRAG_DETECT=300,t}(),G=function(){function t(){}return t.create=function(t,e,n){var i=window.document.createElement(t);return e&&(i.className=e),n&&n.appendChild(i),i},t.remove=function(t){t.parentNode&&t.parentNode.removeChild(t)},t}(),X=function(){function t(){}return t.prototype.onMapWillChange=function(t){},t.prototype.onMapIsChanging=function(t){},t.prototype.onMapDidChange=function(t){},t}(),Q=function(){function t(){}return t.prototype.notifyCameraWillChange=function(t){},t.prototype.notifyCameraIsChanging=function(){},t.prototype.notifyCameraDidChange=function(){},t}();!function(t){t[t.Auto2DTo3D=0]="Auto2DTo3D",t[t.Auto3DTo2D=1]="Auto3DTo2D",t[t.Auto=2]="Auto",t[t.Manual=3]="Manual",t[t.Default=4]="Default"}(Y||(Y={}));var q=function(){function t(t,e){this.prefered2d=!1,this.scale=1,this.willChange=!1,this.zoomIn=!1,this.zoomOut=!1,this.panning=!1,this.flyingTo=!1,this.tilting=!1,this.bearing=!1,this.gesture=!1,this.mapSettings=t,this.cameraPosition=new m([0,0],0,0,0),this._timeEffectManager=e}return t.prototype.setScreenSize=function(t,e){this.screenWidth=t,this.screenHeight=e,this.projectionMatrix=r.perspective(u.fov,this.screenWidth/this.screenHeight,u.nearPlane,u.farPlane),this.orthoProjectionMatrix=r.ortho(0,this.screenWidth,this.screenHeight,0),this.recalculateMatrices()},t.prototype.matrixFor=function(t){var e=1<<t.getTileCoordinate().getZoom(),n=x.worldSize(this.scale)/e,i=t.toVec2(),o=i.x*n+n/2,a=i.y*n+n/2,s=b.pixelCoordinateToCameraCoordinate(new M(o,a),this),u=r.translate(s.x,s.y,0);return u=r.scale(n/2,n/2,1).concat(u)},t.prototype.recalculateMatrices=function(){this.viewMatrix=this.updateViewMatrix(),this.viewProjectionMatrixWithoutTilt=this.updateViewMatrix(!1,!0).concat(this.projectionMatrix),this.inverseViewProjectionMatrixWithoutTilt=this.viewProjectionMatrixWithoutTilt.inverse(),this.viewProjectionMatrixWithoutBearing=this.updateViewMatrix(!0,!1).concat(this.projectionMatrix),this.viewProjectionMatrix=this.viewMatrix.concat(this.projectionMatrix),this.inverseViewProjectionMatrix=this.viewProjectionMatrix.inverse()},t.prototype.updateViewMatrix=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1);var n=S.getTileSize(),i=u.height*Math.tan(u.fov/2)*n/this.screenHeight/(n/2),a=r.rotateX(e?0:this.cameraPosition.getTilt()).transform(new o(0,0,u.height),0),s=r.rotateZ(t?0:this.cameraPosition.getBearing()).transform(a,0);a=r.rotateX(e?0:this.cameraPosition.getTilt()).transform(new o(0,1,0),0);var l=r.rotateZ(t?0:this.cameraPosition.getBearing()).transform(a,0),h=r.lookAt(s,new o(0,0,0),1,l);return h=r.scale(i,i,i).concat(h)},t.prototype.setTarget=function(t){this.cameraPosition.setTarget(t),this.recalculateMatrices()},t.prototype.setTilt=function(t){this.cameraPosition.setTilt(t),this.recalculateMatrices()},t.prototype.setBearing=function(t){this.cameraPosition.setBearing(t),this.recalculateMatrices()},t.prototype.setZoom=function(t){var e=this.getZoom();this.cameraPosition.setZoom(t),this.scale=Math.pow(2,t),e!=this.getZoom()&&(this.prefered2d=this.getZoom()>=a.defaultMinZoom3d&&!this.is3dMode()),this.recalculateMatrices()},t.prototype.enable3dMode=function(t){if(!t){var e=y.clamp(this.getTilt(),this.getMinTilt(),a.maxTilt2D);this.setTilt(e)}return this.mapSettings.enable3dMode(t)},t.prototype.getProjectionMatrix=function(){return this.projectionMatrix},t.prototype.getViewMatrix=function(){return this.viewMatrix},t.prototype.getViewProjectionMatrix=function(){return this.viewProjectionMatrix},t.prototype.getViewProjectionMatrixWithoutTilt=function(){return this.viewProjectionMatrixWithoutTilt},t.prototype.getViewProjectionMatrixWithoutBearing=function(){return this.viewProjectionMatrixWithoutBearing},t.prototype.getCameraPosition=function(){return this.cameraPosition},t.prototype.getInverseViewProjectionMatrixWithoutTilt=function(){return this.inverseViewProjectionMatrixWithoutTilt},t.prototype.getOrthoProjectionMatrix=function(){return this.orthoProjectionMatrix},t.prototype.getInverseViewProjectionMatrix=function(){return this.inverseViewProjectionMatrix},t.prototype.getScreenSize=function(){return new M(this.screenWidth,this.screenHeight)},t.prototype.getTilt=function(){return this.cameraPosition.getTilt()},t.prototype.getMinTilt=function(){return this.mapSettings.getMinTilt()},t.prototype.getMaxTilt=function(){return this.mapSettings.getMaxTilt()},t.prototype.getPixelHeight=function(){return this.pixelHeight},t.prototype.setPixelHeight=function(t){this.pixelHeight=t},t.prototype.getBearing=function(){return this.cameraPosition.getBearing()},t.prototype.getScale=function(){return this.scale},t.prototype.getZoom=function(){return this.cameraPosition.getZoom()},t.prototype.getTarget=function(){return this.cameraPosition.getTarget()},t.prototype.isGesture=function(){return this.gesture},t.prototype.isZoomIn=function(){return this.zoomIn},t.prototype.isZoomOut=function(){return this.zoomOut},t.prototype.isTilting=function(){return this.tilting},t.prototype.isBearing=function(){return this.bearing},t.prototype.isPanning=function(){return this.panning},t.prototype.isFlyingTo=function(){return this.flyingTo},t.prototype.isMoving=function(){return this.movingTo},t.prototype.isStill=function(){return!(this.isBearing()||this.isFlyingTo()||this.isMoving()||this.isPanning()||this.isTilting()||this.isZoomIn()||this.isZoomOut())},t.prototype.dirty=function(){return this.isFlyingTo()||this.isPanning()||this.isZoomIn()||this.isZoomOut()||this.isMoving()||this.isBearing()},t.prototype.getCamera=function(){return this.cameraPosition},t.prototype.isWillChange=function(){return this.willChange},t.prototype.setCamera=function(t){this.cameraPosition=t},t.prototype.getMaxNativeZoom=function(){return this.mapSettings.getMaxNativeZoom()},t.prototype.is3dMode=function(){return this.mapSettings.is3dMode()},t.prototype.setSwitchMode=function(t){this.mapSettings.setSwitchMode(t)},t.prototype.getMapBorder=function(){return this.mapBorder},t.prototype.setMapBorder=function(t){this.mapBorder=t},t.prototype.handleSwitchMode=function(){switch(this.mapSettings.getSwitchMode()){case Y.Auto3DTo2D:this.getZoom()<a.defaultMinZoom3d&&this.enable3dMode(!1);break;case Y.Auto2DTo3D:Math.round(this.getZoom())!=a.defaultMinZoom3d||this.prefered2d||this.enable3dMode(!0);break;case Y.Auto:case Y.Default:this.prefered2d||this.enable3dMode(Math.round(this.getZoom())==a.defaultMinZoom3d)}},Object.defineProperty(t.prototype,"timeEffectManager",{get:function(){return this._timeEffectManager},enumerable:!0,configurable:!0}),t}(),J=function(){function t(t){this.map2dUrl=a.baseMapUrl+"?tileUrl="+a.defaultMap2dUrl+"&key=",this.map3dUrl=a.baseMapUrl+"?tileUrl="+a.defaultMap3dUrl+"&mode=3d&key=",this.minZoom=a.defaultMinZoom,this.maxZoom=a.defaultMaxZoom,this.maxNativeZoom=a.defaultMaxNativeZoom,this._3dMode=!1,this._objectsEnabled=!0,this.switchMode=Y.Auto3DTo2D,this.onModeChanged=t}return t.prototype.setMapUrl=function(t,e){void 0===e&&(e=!1),e?this.map3dUrl=a.baseMapUrl+"?tileUrl="+t+"&mode=3d&key=":this.map2dUrl=a.baseMapUrl+"?tileUrl="+t+"&key="},t.prototype.setMinZoom=function(t){this.minZoom=t,this.minZoom>this.maxZoom&&(this.minZoom+=this.maxZoom,this.maxZoom=this.minZoom-this.maxZoom,this.minZoom-=this.maxZoom)},t.prototype.setMaxZoom=function(t){this.maxZoom=t,this.minZoom>this.maxZoom&&(this.minZoom+=this.maxZoom,this.maxZoom=this.minZoom-this.maxZoom,this.minZoom-=this.maxZoom)},t.prototype.getMapUrl=function(){return(this._3dMode?this.map3dUrl:this.map2dUrl)+t.accessKey},t.prototype.getPreferMinZoom=function(){var t=this.minZoom,e=0;switch(this.switchMode){case Y.Auto:case Y.Default:case Y.Auto3DTo2D:t=this.minZoom>a.defaultMinZoom?this.minZoom:a.defaultMinZoom;break;default:e=this.is3dMode()?a.defaultMinZoom3d:a.defaultMinZoom,t=this.minZoom>e?this.minZoom:e}return t},t.prototype.getMinZoom=function(){return this.minZoom},t.prototype.getMaxZoom=function(){return this.maxZoom},t.prototype.getMinTilt=function(){return a.minTilt},t.prototype.getMaxTilt=function(){return this._3dMode?a.maxTilt3D:a.maxTilt2D},t.prototype.getMaxNativeZoom=function(){return this.maxNativeZoom},t.prototype.setTime=function(t){this.time=t},t.prototype.getTime=function(){return this.time},t.prototype.setMaxNativeZoom=function(t){this.maxNativeZoom=t},t.getAccessKey=function(){return this.accessKey},t.setAccessKey=function(t){this.accessKey=t},t.prototype.enable3dMode=function(t){return t!=this._3dMode&&(this._3dMode=t,this.onModeChanged(),!0)},t.prototype.is3dMode=function(){return this._3dMode},t.prototype.setSwitchMode=function(t){this.switchMode=t},t.prototype.getSwitchMode=function(){return this.switchMode},Object.defineProperty(t.prototype,"objectsEnabled",{get:function(){return this._objectsEnabled},set:function(t){this._objectsEnabled=t},enumerable:!0,configurable:!0}),t.accessKey="98fd21346d83bee24dc734231f7609c9",t}(),K=function(){function t(t){this.orderedKeys=[],this.size=t,this.tiles=new Map}return t.prototype.setSize=function(t){for(this.size=t;this.orderedKeys.length>t;){var e=this.orderedKeys[0];this.orderedKeys.shift(),this.tiles.delete(e.toString())}},t.prototype.add=function(t,e){if(e.isRenderable()&&this.size){if(this.tiles.has(t)){var n=this.orderedKeys.indexOf(t,0);n>-1&&this.orderedKeys.splice(n,1);var i=this.tiles.get(t);i!=e&&i.destroy()}if(this.tiles.set(t,e),this.orderedKeys.push(t),this.orderedKeys.length>this.size-1)this.pop(this.orderedKeys[0]).destroy()}else e.destroy()},t.prototype.get=function(t){return this.tiles.get(t)},t.prototype.pop=function(t){var e=this.tiles.get(t);if(this.tiles.delete(t)){var n=this.orderedKeys.indexOf(t,0);n>-1&&this.orderedKeys.splice(n,1)}return e},t.prototype.has=function(t){return null!=this.tiles.get(t)},t.prototype.clear=function(){this.orderedKeys=[],this.tiles.forEach(function(t){t.destroy()}),this.tiles.clear()},t}(),$=function(){function t(t,e){this.unwrappedTileCoordinate=t,this.tile=e}return t.prototype.clone=function(){return new t(this.unwrappedTileCoordinate,this.tile)},t.prototype.getTile=function(){return this.tile},t.prototype.getUnwrappedTileCoordinate=function(){return this.unwrappedTileCoordinate},t}(),tt=function(){function t(t,e,n,i){void 0===i&&(i=!1),this.x=t,this.y=e,this.zoom=n,this.mode3D=i&&this.getZoom()>=a.defaultMinZoom3d}return t.fromLatLng=function(e,n,i){var o=x.projectScale(e,Math.pow(2,n)).multiply(1/S.getTileSize());return new t(Math.floor(o.x),Math.floor(o.y),n,i)},t.prototype.parent=function(){return new t(this.x/2,this.y/2,this.zoom-1,this.mode3D)},t.prototype.children=function(){var e=this.zoom+1,n=2*this.x,i=2*this.y;return[new t(n,i,e,this.mode3D),new t(n,i+1,e,this.mode3D),new t(n+1,i,e,this.mode3D),new t(n+1,i+1,e,this.mode3D)]},t.prototype.set3DMode=function(t){this.mode3D=t&&this.getZoom()>=a.defaultMinZoom3d},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getZoom=function(){return this.zoom},t.prototype.is3DMode=function(){return this.mode3D},t.prototype.equal=function(t){return this.x==t.x&&this.y==t.y&&this.zoom==t.zoom&&this.mode3D==t.mode3D},t.prototype.notEqual=function(t){return this.x!=t.x||this.y!=t.y||this.zoom!=t.zoom||this.mode3D!=t.mode3D},t.prototype.lessThan=function(t){return this.x==t.x?this.y==t.y?this.zoom==t.zoom?this.mode3D<t.mode3D:this.zoom<t.zoom:this.y<t.y:this.x<t.x},t.prototype.isChildOf=function(t){return this.mode3D==t.mode3D&&(0==t.zoom||t.zoom<this.zoom&&t.x==this.x>>this.zoom-t.zoom&&t.y==this.y>>this.zoom-t.zoom)},t.prototype.toString=function(){return this.getZoom()+"/"+this.getX()+"/"+this.getY()+"/"+(this.mode3D?"1":"0")},t}(),et=function(){function t(){}return t.createWithXYZoom=function(e,n,i,o){void 0===o&&(o=!1);var r=new t;return r.wrap=(e<0?e-(1<<i)+1:e)/(1<<i)>>0,r.tileCoordinate=new tt(e&(1<<i)-1,n<0?0:Math.min(n,(1<<i)-1),i,o),r},t.createWithWrapAndTileCoordinate=function(e,n){var i=new t;return i.wrap=e,i.tileCoordinate=n,i},t.fromLatLng=function(e,n){var i=x.projectScale(e,Math.pow(2,n)).multiply(1/S.getTileSize());return t.createWithXYZoom(Math.floor(i.x),Math.floor(i.y),n)},t.prototype.toVec2=function(){var t=this.tileCoordinate.getX()+this.wrap*(1<<this.tileCoordinate.getZoom());return new M(t,this.tileCoordinate.getY())},t.prototype.parent=function(){var e=this.tileCoordinate.zoom-1,n=this.tileCoordinate.x/2>>0,i=this.tileCoordinate.y/2>>0;return t.createWithWrapAndTileCoordinate(this.wrap,new tt(n,i,e,this.tileCoordinate.is3DMode()))},t.prototype.children=function(){var e=this.tileCoordinate.zoom+1,n=2*this.tileCoordinate.x,i=2*this.tileCoordinate.y;return[t.createWithWrapAndTileCoordinate(this.wrap,new tt(n,i,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new tt(n,i+1,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new tt(n+1,i,e,this.tileCoordinate.is3DMode())),t.createWithWrapAndTileCoordinate(this.wrap,new tt(n+1,i+1,e,this.tileCoordinate.is3DMode()))]},t.prototype.getWrap=function(){return this.wrap},t.prototype.getTileCoordinate=function(){return this.tileCoordinate},t.prototype.equal=function(t){return this.wrap==t.getWrap()&&this.tileCoordinate.equal(t.getTileCoordinate())},t.prototype.notEqual=function(t){return this.wrap!=t.getWrap()},t.prototype.lessThan=function(t){return this.wrap==t.getWrap()?this.tileCoordinate.lessThan(t.getTileCoordinate()):this.wrap<t.getWrap()},t}(),nt=function(){function t(){}return t.scanTriangle=function(t,e,n,i,o,r){var a=new it(t,e),s=new it(e,n),u=new it(n,t);if(a.dy>s.dy){var l=a;a=s,s=l}if(a.dy>u.dy){l=a;a=u,u=l}if(s.dy>u.dy){l=s;s=u,u=l}a.dy&&ot(u,a,i,o,r),s.dy&&ot(u,s,i,o,r)},t}(),it=function(){return function(t,e){if(this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.dx=0,this.dy=0,t.y>e.y){var n=t;t=e,e=n}this.x0=t.x,this.y0=t.y,this.x1=e.x,this.y1=e.y,this.dx=e.x-t.x,this.dy=e.y-t.y}}();function ot(t,e,n,i,o){var r=Math.max(n,Math.floor(e.y0)),a=Math.min(i,Math.ceil(e.y1));if(t.x0==e.x0&&t.y0==e.y0?t.x0+e.dy/t.dy*t.dx<e.x1:t.x1-e.dy/t.dy*t.dx<e.x0){var s=t;t=e,e=s}for(var u=t.dx/t.dy,l=e.dx/e.dy,h=t.dx>0?1:0,c=e.dx<0?1:0,p=r;p<a;++p){var f=u*Math.max(0,Math.min(t.dy,p+h-t.y0))+t.x0,d=l*Math.max(0,Math.min(e.dy,p+c-e.y0))+e.x0;o(Math.floor(d),Math.ceil(f),p)}}var rt,at=function(){function t(){}return t.getTileUrl=function(t,e,n,i){for(var o=0,r=0,a="";r<t.length;)if("{"==t[r]){switch(a+=t.substring(o,r),t[r+1]){case"x":a+=e.toString();break;case"y":a+=n.toString();break;case"z":a+=i.toString();break;default:console.log("Invalid map url pattern: "+t)}o=r+=3}else++r;return a+=t.substr(o)},t.getBuildingDataUrl=function(t,e,n){for(var i=0,o=0,r="";o<t.length;)if("{"==t[o]){switch(r+=t.substring(i,o),t[o+1]){case"s":r+=e;break;case"k":r+=n;break;default:console.log("Invalid Model url pattern: "+t)}i=o+=3}else++o;return r+=t.substr(i)},t.getWeatherDataUrl=function(t,e,n){return"https://api.map4d.vn/v2/api/weather?lat="+t.toString()+"&lon="+e.toString()+"&key="+n},t.isUrlRequest=function(t){return t.startsWith("http")},t}(),st=function(){function t(){}return t.generate=function(){return Math.random().toString(36).substring(2)+(new Date).getTime().toString(36)+this.count++},t.count=0,t}();!function(t){t[t.RasterTile=0]="RasterTile",t[t.Model=1]="Model",t[t.Texture=2]="Texture",t[t.MAX=3]="MAX"}(rt||(rt={}));var ut,lt=function(){return function(t){this.method="GET",this.params=null,this.id=st.generate(),this.type=t}}(),ht=function(){return function(t){this.id=t,this.success=!1,this.data=null}}(),ct=function(){function t(t,e,n,i,o,r){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i,this.minZoom=o,this.maxZoom=r}return t.fromLatLngBounds=function(e,n,i){var o=x.projectZoom(e.getSouthwest(),i),r=x.projectZoom(e.getNortheast(),i),a=Math.pow(2,i);return new t(Math.floor(o.x),Math.floor(r.x),y.clamp(Math.floor(r.y),0,a),y.clamp(Math.floor(o.y),0,a),n,i)},t.prototype.contains=function(t){var e=t.getX(),n=t.getY(),i=t.getZoom();if(i<=this.maxZoom&&i>=this.minZoom){if(0==i)return!0;var o=this.maxZoom-i,r=this.minX>>o,a=this.maxX>>o,s=this.minY>>o,u=this.maxY>>o;return(this.minX>this.maxX?e>=r||e<=a:e<=a&&e>=r)&&n<=u&&n>=s}return!1},t}();!function(t){t[t.Texture=0]="Texture",t[t.Color=1]="Color",t[t.Polygon=2]="Polygon",t[t.External=3]="External"}(ut||(ut={}));var pt=function(){function t(){this._reference=0}return t.prototype.retain=function(){++this._reference},t.prototype.release=function(){--this._reference,this._reference<=0&&this.destroy()},Object.defineProperty(t.prototype,"reference",{get:function(){return this._reference},enumerable:!0,configurable:!0}),t}(),ft=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),dt=function(t){function e(){return t.call(this)||this}return ft(e,t),e.prototype.setModel=function(t){this.model=t},e.prototype.setTexture=function(t){this.texture=t},e.prototype.getModel=function(){return this.model},e.prototype.getTexture=function(){return this.texture},e.prototype.hasTexture=function(){return null!=this.texture},e.prototype.getModelMatrix=function(){return this.modelMatrix},e.prototype.getMvpMatrix=function(){return this.mvpMatrix},e}(pt),gt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),mt=function(t){function e(e){var n=t.call(this)||this;return n.location=new g(0,0),n.scale=new o(1,1,1),n.bearing=0,n.name="Unknown name",n.elevation=0,n.selectionCode=0,n.objData=null,n.textureData=null,n.selected=!1,n.buildingIconSelectionManager=e,n}return gt(e,t),e.prototype.getId=function(){return this.id},e.prototype.setId=function(t){this.id=t},e.prototype.getName=function(){return this.name},e.prototype.setName=function(t){this.name=t},e.prototype.setPlaces=function(t){this.places=t},e.prototype.getPlaces=function(){return this.places},e.prototype.getScale=function(){return this.scale},e.prototype.setScale=function(t){this.scale=t},e.prototype.setBearing=function(t){this.bearing=t},e.prototype.getBearing=function(){return this.bearing},e.prototype.setLocation=function(t){this.location=g.convert(t)},e.prototype.getLocation=function(){return this.location},e.prototype.getElevation=function(){return this.elevation},e.prototype.setElevation=function(t){this.elevation=t},e.prototype.setHeightScale=function(t){this.heightScale=t},e.prototype.getHeightScale=function(){return this.heightScale},e.prototype.setCamera=function(t){this.camera=t},e.prototype.getCamera=function(){return this.camera},e.prototype.setTypes=function(t){this.types=t},e.prototype.getTypes=function(){return this.types},e.prototype.setVerified=function(t){this._isVerified=t},e.prototype.isVerified=function(){return this._isVerified},e.prototype.setMinZoom=function(t){this.minZoom=t},e.prototype.getMinZoom=function(){return this.minZoom},e.prototype.setMaxZoom=function(t){this.maxZoom=t},e.prototype.getMaxZoom=function(){return this.maxZoom},e.prototype.setStartDate=function(t){this.startDate=t},e.prototype.getStartDate=function(){return this.startDate},e.prototype.setEndDate=function(t){this.endDate=t},e.prototype.getEndDate=function(){return this.endDate},e.prototype.getTextureName=function(){return this.textureName},e.prototype.setTextureName=function(t){this.textureName=t},e.prototype.getTextureData=function(){return this.textureData},e.prototype.setTextureData=function(t){this.textureData=t},e.prototype.getObjName=function(){return this.objName},e.prototype.setObjName=function(t){this.objName=t},e.prototype.getObjData=function(){return this.objData},e.prototype.setObjData=function(t){this.objData=t},e.prototype.getDistance=function(){return this.distance},e.prototype.setDistance=function(t){this.distance=t},e.prototype.getBuildingType=function(){return this.buildingType},e.prototype.setBuildingType=function(t){this.buildingType=t},e.prototype.getSelectionCode=function(){return this.selectionCode},e.prototype.setSelectionCode=function(t){this.selectionCode=t},e.prototype.setHighestPosition=function(t){this.highestPosition=t},e.prototype.getHighestPosition=function(){return this.highestPosition},e.prototype.setHeight=function(t){this.height=t},e.prototype.getHeight=function(){return this.height},e.prototype.setSelected=function(t){t!=this.selected&&(t&&this.getHighestPosition()?this.buildingIconSelectionManager.addBuilding(this):!t&&this.selected&&this.getHighestPosition()&&this.buildingIconSelectionManager&&this.buildingIconSelectionManager.removeBuilding(this.id),this.selected=t)},e.prototype.isSelected=function(){return this.selected},e.prototype.notifyModelDownloaded=function(){this.selected&&this.buildingIconSelectionManager.addBuilding(this)},e.prototype.destroy=function(){this.buildingIconSelectionManager&&this.selected&&this.buildingIconSelectionManager.removeBuilding(this.id),this.buildingIconSelectionManager=null,this.buildingType==ut.Polygon&&this.model.destroy()},e.prototype.updateMatrices=function(t){var n=1/x.getMetersPerPixelAtLatitude(t.getTarget().lat(),t.getZoom()),i=x.projectScale(this.location,t.getScale()),o=b.pixelCoordinateToCameraCoordinate(new M(i.x,i.y),t),a=b.getElevationPixelFromMeter(this.getElevation(),t);this.modelMatrix=r.translate(o.x,o.y,a),this.modelMatrix=r.scale(this.scale.x*n,this.scale.y*n,this.scale.z*n).concat(this.modelMatrix),this.modelMatrix=r.rotateZ(this.bearing).concat(this.modelMatrix),this.modelMatrix=r.rotateX(e.buildingRotationX).concat(this.modelMatrix),this.mvpMatrix=this.modelMatrix.concat(t.getViewProjectionMatrix())},e.buildingRotationX=90,e}(dt),yt=n(2),vt=n.n(yt),At=function(){function t(){}return t.extrudePolygon=function(e,n){if(!(0==e.length||e[0].length<=2)){var i=[],r=[];t.convertToClockwise(e[0]);var a=[];e[0].forEach(function(t){a.push(t.x),a.push(t.y)});var s=vt()(a),u=e[0],l=u.length,h=l;s.length;6*(h-0)*1,2*(2*(h-0));for(var c=0,p=0;p<u.length;++p)i.push([-u[p].y,n,-u[p].x,0,0,0,0,0]);for(p=0;p<s.length;++p)r.push(c+s[p]);var f=h-0,d=2*f;c=i.length;for(var g=0;g<2;++g){var m=0==g?n:0;for(p=0;p<f;++p)for(var y=0;y<2;++y){var v=(p+y)%f+0;i.push([-u[v].y,m,-u[v].x,0,0,0,0,0])}}for(p=0;p<f;++p)for(var A=0;A<6;++A){y=(t.quadToTriangle[A][0]+2*p)%d;var w=t.quadToTriangle[A][1]+1;r.push((w-1)*d+y+c)}for(var M=0;M<r.length;){var x=r[M++],_=r[M++],b=r[M++],T=new o(i[x][0],i[x][1],i[x][2]),S=new o(i[_][0],i[_][1],i[_][2]),E=new o(i[b][0],i[b][1],i[b][2]),C=T.subtract(S),I=S.subtract(E);w=C.cross(I);i[x][5]=i[x][5]+w.x,i[x][6]=i[x][6]+w.y,i[x][7]=i[x][7]+w.z,i[_][5]=i[_][5]+w.x,i[_][6]=i[_][6]+w.y,i[_][7]=i[_][7]+w.z,i[b][5]=i[b][5]+w.x,i[b][6]=i[b][6]+w.y,i[b][7]=i[b][7]+w.z}for(p=0;p<i.length;++p){var R=new o(i[p][5],i[p][6],i[p][7]);R=R.normalize(),i[p][5]=R.x,i[p][6]=R.y,i[p][7]=R.z}return{vertices:i,indices:r}}},t.convertToClockwise=function(e){t.calculatePolygonArea(e)>0&&t.reversePoints(e)},t.calculatePolygonArea=function(t){var e=t.length;if(!(e<3)){for(var n=0,i=0,o=e-1;i<e;){var r=t[o].x,a=t[o].y,s=t[i].x,u=t[i].y;o=i,i+=1,n+=r*u-s*a}return n}},t.reversePoints=function(t){for(var e=t.length,n=e/2,i=0;i<n;++i){var o=t[i];t[i]=t[e-i-1],t[e-i-1]=o}},t.quadToTriangle=[[0,0],[1,0],[1,1],[0,0],[1,1],[0,1]],t}(),wt=function(){function t(){}return t.calculateDistanceBetweenPointToLineBy2Point=function(e,n,i){return Math.sqrt(t.distToSegmentSquared(e,n,i))},t.calculateDistanceBetweenPointToLine=function(e,n){return Math.sqrt(t.distToSegmentSquared(e,new M(n[0][0],n[0][1]),new M(n[1][0],n[1][1])))},t.distToSegmentSquared=function(e,n,i){var o=t.dist2(n,i);if(0==o)return t.dist2(e,n);var r=((e.x-n.x)*(i.x-n.x)+(e.y-n.y)*(i.y-n.y))/o;return r=Math.max(0,Math.min(1,r)),t.dist2(e,new M(n.x+r*(i.x-n.x),n.y+r*(i.y-n.y)))},t.dist2=function(e,n){return t.sqr(e.x-n.x)+t.sqr(e.y-n.y)},t.sqr=function(t){return t*t},t}(),Mt=function(){function t(t,e,n,i,o,r,s,u,l){this.renderTiles=[],this.visibleTiles=[],this.mapView=t,this.tileTaskManager=e,this.mapState=n,this.tileCache=new K(a.tileCacheSize),this.tiles=new Map,this.annotationTiles=new Map,this.finishedLoad=!0,this.mapSettings=i,this.lastZoom=this.mapState.getZoom(),this.tileAreas=new Map,this.tileRequestsMap=new Map,this.buildingResourceManager=o,this.buildingIconSelectionManager=r,this.customBuildingManager=s,this.createAnnotationTile=u,this.requestRender=l}return t.prototype.isDirty=function(){var t=this.mapState.getZoom(),e=!0;return(this.finishedLoad||this.mapState.isZoomIn()||this.mapState.isZoomOut()||!this.mapState.isFlyingTo()&&(Math.ceil(t-s.epsilon)>t||Math.floor(t+s.epsilon)<t))&&(e=!1),e},t.prototype.update=function(t){this.isDirty()&&(this.updateRenderableTiles(t),this.tileRequestsMap.size||(this.finishedLoad=!0,this.lastZoom=this.mapState.getZoom()))},t.prototype.reload=function(){var t=this;this.tiles.forEach(function(t){t.tile.destroy()}),this.annotationTiles.forEach(function(t){t.tile.destroy()}),this.tiles.clear(),this.annotationTiles.clear(),this.renderTiles=[],this.tileCache.clear(),this.finishedLoad=!1,this.mapView.dirty=!0,this.tileRequestsMap.forEach(function(e){t.tileTaskManager.cancelTask(e)}),this.tileRequestsMap.clear()},t.prototype.destroy=function(){this.reload(),this.visibleTiles=[],this.buildingResourceManager.removeAllResources()},t.prototype.getRenderTiles=function(){return this.renderTiles},t.prototype.getVisibleTiles=function(){return this.visibleTiles},t.prototype.updateVisibleTilesForZoom=function(t){var e=this;this.mapState.getZoom()>this.mapSettings.getMaxNativeZoom()&&(t=this.mapSettings.getMaxNativeZoom());var n=this.mapState.getScreenSize(),i=Math.pow(2,t),o=this.mapState.getTilt(),r=!1;o>a.maxTiltIntersectWithScreen&&(this.mapState.setTilt(a.maxTiltIntersectWithScreen),r=!0);var s=b.screenCoordinateToLatLngZoom(new M(0,0),this.mapState,t),u=x.projectScale(s,i).multiply(1/S.getTileSize()),l=b.screenCoordinateToLatLngZoom(new M(n.x,0),this.mapState,t),h=x.projectScale(l,i).multiply(1/S.getTileSize());r&&this.mapState.setTilt(o);var c=b.screenCoordinateToLatLngZoom(new M(n.x,n.y),this.mapState,t),p=x.projectScale(c,i).multiply(1/S.getTileSize()),f=b.screenCoordinateToLatLngZoom(new M(0,n.y),this.mapState,t),d=x.projectScale(f,i).multiply(1/S.getTileSize()),g=b.screenCoordinateToLatLngZoom(new M(n.x/2,n.y/2),this.mapState,t),m=x.projectScale(g,i).multiply(1/S.getTileSize());this.mapState.is3dMode()&&(this.mapState.setMapBorder(b.latLngToScreenCoordinate(s,0,this.mapState).y/n.y),this.mapState.setPixelHeight(wt.calculateDistanceBetweenPointToLineBy2Point(h,d,p)*S.getTileSize()));var y=1<<Math.floor(t),v=[],A=function(t,e,n){if(n>=0&&n<=y)for(var i=t;i<e;++i){var o=i+.5-m.x,r=n+.5-m.y,a={x:i,y:n,sqDist:o*o+r*r};v.push(a)}};nt.scanTriangle(u,h,p,0,y,A),nt.scanTriangle(p,d,u,0,y,A),v.sort(function(t,e){return t.sqDist==e.sqDist?t.x==e.x?t.y-e.y:t.x-e.x:t.sqDist-e.sqDist}),v.filter(function(t,e,n){return 0==e||t.x!=n[e-1].x||t.y!=n[e-1].y}).forEach(function(n){return e.visibleTiles.push(et.createWithXYZoom(n.x,n.y,t,e.mapState.is3dMode()))})},t.prototype.updateVisibleTiles=function(){this.finishedLoad=!1,this.visibleTiles=[];var t=this.mapState.getZoom();this.mapState.isFlyingTo()?(this.updateVisibleTilesForZoom(Math.floor(t)),this.updateVisibleTilesForZoom(Math.ceil(t))):this.mapState.isZoomIn()?this.updateVisibleTilesForZoom(Math.ceil(t-.5)):this.mapState.isZoomOut()?this.updateVisibleTilesForZoom(Math.floor(t+.5)):this.updateVisibleTilesForZoom(Math.round(t)),this.cancelOutdatedTasks()},t.prototype.cancelOutdatedTasks=function(){var t=this;this.tileRequestsMap.forEach(function(e,n,i){t.visibleTiles.some(function(t){return t.getTileCoordinate().toString()==n})||(i.delete(n),t.tileTaskManager.cancelTask(e))})},t.prototype.updateRenderableTiles=function(t){var e=this,n=[],i=[],o=[];if(this.mapState.getZoom()<this.lastZoom&&0!=this.visibleTiles.length){var r=this.visibleTiles[0].getTileCoordinate().getZoom();this.renderTiles.forEach(function(t){t.getUnwrappedTileCoordinate().getTileCoordinate().getZoom()>r&&o.push(t)})}this.renderTiles=[],this.visibleTiles.forEach(function(r){var a=r.getTileCoordinate();a.set3DMode(e.mapState.is3dMode());var s=e.getTile(a);if(null==s&&(s=e.createTile(a,t)),s.isRenderable())e.renderTiles.push(new $(r,s)),n.push(a);else{if(n.push(a),e.mapState.isFlyingTo())return;if(e.mapState.getZoom()>e.lastZoom)for(var u=r.parent();u.getTileCoordinate().getZoom()>=e.lastZoom;){if(a=u.getTileCoordinate(),null!=(s=e.getTile(a))&&s.isRenderable()){n.some(function(t){return t.equal(a)})||(n.push(a),i.push(new $(u,s)));break}u=u.parent()}else e.mapState.getZoom()<e.lastZoom&&o.forEach(function(t){var i=t.getUnwrappedTileCoordinate();i.getTileCoordinate().isChildOf(r.getTileCoordinate())&&(a=i.getTileCoordinate(),null!=(s=e.getTile(a))&&s.isRenderable()&&(n.some(function(t){return t.equal(a)})||(n.push(a),e.renderTiles.push(new $(i,s)))))})}}),0!=i.length&&(this.renderTiles.forEach(function(t){i.push(t)}),this.renderTiles=i),n.sort(function(t,e){return t.lessThan(e)?-1:t.lessThan(e)?0:1});for(var a=[],s=0;s<n.length-1;++s)n[s]!==n[s+1]&&a.push(n[s]);a.push(n[n.length-1]),n=a;var u=Array.from(this.tiles),l=Array.from(this.annotationTiles);u.sort(function(t,e){return t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?-1:t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?0:1}),l.sort(function(t,e){return t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?-1:t[1].tileCoordinate.lessThan(e[1].tileCoordinate)?0:1});for(var h=0,c=0,p=0;h<u.length;)if(c==n.length||u[h][1].tileCoordinate.lessThan(n[c])){u[h][1].tile.getBuildings().forEach(function(t){e.buildingResourceManager.decreaseBuildingReference(t.id)}),this.tileCache.add(u[h][0],u[h][1].tile),this.tiles.delete(u[h][0].toString());var f=l[p][1].tile;this.annotationTiles.delete(l[p][0]),f.destroy(),++h,++p}else n[c].lessThan(u[h][1].tileCoordinate)||(++h,++p),++c},t.prototype.getTile=function(t){if(!this.tiles.has(t.toString())){var e=this.tileCache.pop(t.toString());if(null!=e){var n=e;return this.addBuildings(n.getBuildings()),this.tiles.set(t.toString(),{tileCoordinate:t,tile:e}),this.annotationTiles.set(t.toString(),{tileCoordinate:t,tile:this.createAnnotationTile(t)}),e}return null}return this.tiles.get(t.toString()).tile},t.prototype.clearTileCache=function(){this.tileCache.clear()},t.prototype.createTile=function(t,e){var n=this,i=this.tileCache.pop(t.toString());if(null==i){var o=this.mapSettings.getMapUrl(),r=t.getZoom(),s=!1;this.tileAreas.forEach(function(e){s||r<=e.getMaxZoom()&&r>=e.getMinZoom()&&ct.fromLatLngBounds(e.getBounds(),r,r).contains(t)&&(o=a.baseMapUrl+"?tileUrl="+e.getUrl(),n.mapSettings.is3dMode()&&(o+="&mode=3d"),o+="&key="+J.getAccessKey(),s=!0)});var u=at.getTileUrl(o,t.getX(),t.getY(),t.getZoom());i=e(t);var l=new lt(rt.RasterTile);l.url=u,l.completion=function(e){if(null!=e.data){i.init(e.data.result,function(){n.requestRender(),n.tileRequestsMap.delete(t.toString())});var o=i,r=e.data.result.objects||[],a=n.mapView.mapSettings.getTime();null==a&&(a=Date.now());for(var s=r.length;s--;){var u=r[s],l=null!=u.startDate?u.startDate:Number.NEGATIVE_INFINITY,h=null!=u.endDate?u.endDate:Number.POSITIVE_INFINITY;(l>a||h<a)&&r.splice(s,1)}if(n.addBuildings(r),o.addBuildings(r),n.mapState.is3dMode()){var c=n.customBuildingManager.getObjectsForTile(i.getTileCoordinate());if(c&&0!=c.length){var p=[];c.forEach(function(t){var e=n.customBuildingManager.getJsonForMapObject(t);p.push(e),o.getBuildings().push(e)}),n.addBuildings(p)}}}},this.tileRequestsMap.set(t.toString(),l),this.tileTaskManager.postTask(l)}return null!=this.tiles&&this.tiles.set(t.toString(),{tileCoordinate:t,tile:i}),this.annotationTiles.set(t.toString(),{tileCoordinate:t,tile:this.createAnnotationTile(t)}),i},t.prototype.addTileArea=function(t,e){this.tileAreas.set(t,e),this.reload()},t.prototype.updateTileArea=function(t,e){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.addTileArea(t,e))},t.prototype.removeTileArea=function(t){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.reload())},t.prototype.readdBuildings=function(){var t=this;this.tiles.forEach(function(e){var n=e.tile;t.addBuildings(n.getBuildings(),!0)})},t.prototype.addBuildings=function(t,e){var n=this;void 0===e&&(e=!1),t.forEach(function(t){var i=n.getBuildingType(t.model);if((n.mapSettings.objectsEnabled||i==ut.External)&&(!e||i!=ut.External))if(n.buildingResourceManager.hasBuilding(t.id))n.buildingResourceManager.increaseBuildingReference(t.id);else{var r=new mt(n.buildingIconSelectionManager);if(r.setId(t.id),null==t.name?r.setName("Unknown name"):r.setName(t.name),r.setPlaces(t.places),r.setScale(new o(t.scale,t.scale,t.scale*t.heightScale)),r.setBearing(t.bearing),r.setLocation(t.location),r.setElevation(t.elevation),r.setHeightScale(t.heightScale),r.setCamera(t.camera),r.setTypes(t.types),r.setVerified(t.isVerified),r.setMinZoom(t.minZoom),r.setMaxZoom(t.maxZoom),r.setStartDate(t.startDate),r.setEndDate(t.endDate),r.setObjName(t.model.objName),null!=t.model.objData&&(r.setObjName(t.id),r.setObjData(t.model.objData)),r.setTextureName(t.model.textureName),null!=t.model.textureData&&(r.setTextureName(t.id),r.setTextureData(t.model.textureData)),r.setBuildingType(i),r.getBuildingType()==ut.Polygon){for(var a=x.convertToMeterFromLatLng(r.getLocation()),s=[],u=[],l=0;l<t.model.coordinates.length;++l){var h=t.model.coordinates[l],c=x.convertToMeterFromLatLng(g.convert(h));u.push(new A(c.x-a.x,a.y-c.y))}s.push(u);var p=At.extrudePolygon(s,1);n.buildingResourceManager.addBuildingWithData(t.id,r,p.vertices,p.indices)}else n.buildingResourceManager.addBuilding(t.id,r)}})},t.prototype.getBuildingType=function(t){var e=t.type;return"Object"==e?"boxtexture.png"==t.textureName?ut.Color:ut.Texture:"Polygon"==e?ut.Polygon:"External"==e?ut.External:void 0},t.prototype.getTiles=function(){return this.tiles},t.prototype.getTileCache=function(){return this.tileCache},t}(),xt=function(){function t(){}return Object.defineProperty(t,"isWorker",{get:function(){try{return!window.document}catch(t){return!0}},enumerable:!0,configurable:!0}),t}(),_t=function(){function t(t){this.maxTask=3,this.numberOfRunningTask=0,this.worker=t}return t.prototype.finishedTask=function(){this.numberOfRunningTask=Math.max(this.numberOfRunningTask-1,0)},t.prototype.canExecuteTask=function(){return this.numberOfRunningTask<this.maxTask},t.prototype.executeTask=function(t){if(this.canExecuteTask()){var e={execute:!0,payload:JSON.stringify(t)};this.worker.postMessage(e),this.numberOfRunningTask+=1}},t.prototype.cancel=function(t){var e={execute:!1,payload:JSON.stringify(t)};this.worker.postMessage(e),this.numberOfRunningTask=Math.max(this.numberOfRunningTask-1,0)},t}(),bt=function(){return function(){this.numberOfVertices=0,this.data=[]}}(),Tt=function(){function t(){}return t.loadModel=function(t){if(0==t.length)return null;for(var e=t.split("\n").map(function(t){return t.trim().toLowerCase().split(" ").filter(function(t){return""!==t})}),n=[new o],i=[new o],r=[new M],a=[],s=null,u=-1,l=null,h=0,c=e;h<c.length;h++){var p=c[h],f=p[0];if("v"==f){var d=+p[1]||0,g=+p[2]||0,m=+p[3]||0,y=new o(d,g,m);n.push(y),g>u&&(u=g,l=y)}else if("vn"==f){d=+p[1]||0,g=+p[2]||0,m=+p[3]||0;i.push(new o(d,g,m))}else if("vt"==f){d=+p[1]||0,g=+p[2]||0;r.push(new M(d,g))}else if("f"==f)for(var v=0;v<3;v++){var A=p[v+1].split("/"),w=(y=n[+A[0]||0],r[+A[1]||0]),x=i[+A[2]||0];s||(s=new bt,a.push(s)),s.data.push(y.x),s.data.push(y.y),s.data.push(y.z),s.data.push(w.x),s.data.push(w.y),s.data.push(x.x),s.data.push(x.y),s.data.push(x.z),s.numberOfVertices++}}return a[0].highestPosition=l,a},t}(),St=function(){function t(t){this.id=t}return t.prototype.abort=function(){null!=this.request&&this.request.abort()},t}(),Et=function(){function t(){}return t.createWorker=function(t){var e=this.workerUrl,n=new Worker(e),i=new _t(n);return n.onmessage=function(e){var n=e.data;i.finishedTask(),t(n)},i},Object.defineProperty(t,"workerUrl",{get:function(){for(var t=document.getElementsByTagName("script"),e=[],n=0;n<t.length;++n){var i=t[n];i.src.indexOf("map4dsdk@")>-1&&e.push(i.src)}var o="importScripts("+e.map(function(t){return'"'+t+'"'}).join(",")+");",r=new Blob([o],{type:"application/javascript"});return window.URL.createObjectURL(r)},enumerable:!0,configurable:!0}),t.setupWorkerThread=function(){var t=this;self.onmessage=function(e){var n=e.data;n.execute?t.execute(JSON.parse(n.payload)):t.cancel(JSON.parse(n.payload))}},t.execute=function(t){var e=new St(t.id);if(this.executeTasks.push(e),t.type==rt.Texture){var n=new XMLHttpRequest;return n.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE){var e=new ht(t.id);200==n.status&&(e.success=!0,e.data=this.response),postMessage(e)}},n.open("GET",t.url),n.responseType="blob",n.send(),void(e.request=n)}if(t.type==rt.Model){var i=new XMLHttpRequest;return i.onreadystatechange=function(){if(this.readyState==XMLHttpRequest.DONE){var e=new ht(t.id);200==i.status&&(e.success=!0,e.data=Tt.loadModel(this.responseText)),postMessage(e)}},i.open("GET",t.url),i.send(),void(e.request=i)}var o=new XMLHttpRequest;o.onreadystatechange=function(){if(o.readyState==XMLHttpRequest.DONE){var e=new ht(t.id);200==o.status&&(e.success=!0,e.data=JSON.parse(o.responseText)),postMessage(e)}},o.open(t.method,t.url,!0),null!=t.params&&o.setRequestHeader("Content-Type","application/json"),o.setRequestHeader("Accept","application/json"),o.send(t.params),e.request=o},t.cancel=function(t){var e=this.removeTask(t.id);null!=e&&e.abort()},t.removeTask=function(t){var e=this.executeTasks.findIndex(function(e){return e.id==t});if(e>=0){var n=this.executeTasks[e];return this.executeTasks.splice(e,1),n}return null},t.executeTasks=[],t}();xt.isWorker&&Et.setupWorkerThread();var Ct,It=function(){function t(){var t=this;this.maxConcurrentRequest=5,this.maxWorker=3,this.workers=[],this.pendingTasks=[],this.activedTasks=[];for(var e=0;e<this.maxWorker;++e){var n=Et.createWorker(function(e){t.onCompletionTask(e)});this.workers.push(n)}for(e=0;e<rt.MAX;e++)this.pendingTasks.push([])}return t.prototype.postTask=function(t){this.pendingTasks[t.type].unshift(t),this.executeTasks()},t.prototype.executeTasks=function(){if(!(this.activedTasks.length>this.maxConcurrentRequest))for(var t=0,e=this.workers;t<e.length;t++){var n=e[t];if(n.canExecuteTask()&&this.hasTask()){var i=this.getTask();this.activedTasks.push(i),i.worker=n,n.executeTask(i)}}},t.prototype.hasTask=function(){for(var t=0;t<rt.MAX;t++)if(this.pendingTasks[t].length>0)return!0;return!1},t.prototype.getTask=function(){for(var t=0;t<rt.MAX;t++)if(this.pendingTasks[t].length>0)return this.pendingTasks[t].pop();return null},t.prototype.cancelTask=function(t){var e=this.removeTask(t.id);null!=e&&(e.worker&&e.worker.cancel(e),e.completion&&e.completion(new ht(t.id)))},t.prototype.onCompletionTask=function(t){var e=this.activedTasks.findIndex(function(e){return e.id==t.id});if(e<0)this.executeTasks();else{var n=this.activedTasks[e];this.activedTasks.splice(e,1),n.completion&&n.completion(t),this.executeTasks()}},t.prototype.removeTask=function(t){for(var e=0;e<rt.MAX;e++){var n=this.pendingTasks[e].findIndex(function(e){return e.id==t});if(n>=0){var i=this.pendingTasks[e][n];return this.pendingTasks[e].splice(n,1),i}}var o=this.activedTasks.findIndex(function(e){return e.id==t});if(o>=0){i=this.activedTasks[o];return this.activedTasks.splice(o,1),i}return null},t}(),Rt=n(4);!function(t){t[t.RASTER=0]="RASTER",t[t.BUILDING=1]="BUILDING",t[t.ANNOTATION=2]="ANNOTATION",t[t.LINE=3]="LINE",t[t.FILL=4]="FILL",t[t.CIRCLE=5]="CIRCLE"}(Ct||(Ct={}));var Dt=function(){function t(t,e){void 0===e&&(e=0),this.id=t,this.order=e}return t.prototype.equal=function(t){return this.id==t.id},t.prototype.lessThan=function(t){return this.order==t.order?this.id<t.id:this.order<t.order},t}();function Lt(t,e){return t.order==e.order?t.id==e.id?0:t.id>e.id:t.order>e.order}var Bt,Ot,Pt=function(){function t(t,e,n,i){this.layerId=new Dt(t,e),this.layerType=n,this.tileManager=i}return t.prototype.getOrder=function(){return this.layerId.order},t.prototype.getLayerId=function(){return this.layerId.id},t.prototype.getLayerType=function(){return this.layerType},t}(),kt=function(){return function(t,e,n,i,o){void 0===i&&(i=0),void 0===o&&(o=0),this.name=t,this.buffer=e,this.size=n,this.offset=i,this.stride=o}}(),Nt=function(){return function(t,e,n){this.name=t,this.type=e,this.value=n}}(),Ft=function(){function t(t,e,n){this.gl=t,this.textureUnit=0,this.uniforms={},this.attributes={},this.program=t.createProgram(),this.fragmentShader=this.loadShader(t.FRAGMENT_SHADER,n),this.vertexShader=this.loadShader(t.VERTEX_SHADER,e),t.attachShader(this.program,this.vertexShader),t.attachShader(this.program,this.fragmentShader),t.linkProgram(this.program),t.getProgramParameter(this.program,t.LINK_STATUS)||(console.log("Error linking shader program"),console.log(t.getProgramInfoLog(this.program))),this.loadAttributes(),this.loadUniforms()}return t.prototype.loadAttributes=function(){for(var t=this.gl,e=t.getProgramParameter(this.program,t.ACTIVE_ATTRIBUTES),n=0;n<e;++n){var i=t.getActiveAttrib(this.program,n).name;this.attributes[i]=t.getAttribLocation(this.program,i)}},t.prototype.loadUniforms=function(){for(var t=this.gl,e=t.getProgramParameter(this.program,t.ACTIVE_UNIFORMS),n=0;n<e;++n){var i=t.getActiveUniform(this.program,n).name;this.uniforms[i]=t.getUniformLocation(this.program,i)}},t.prototype.loadShader=function(t,e){var n=this.gl,i=n.createShader(t);return n.shaderSource(i,e),n.compileShader(i),n.getShaderParameter(i,n.COMPILE_STATUS)||(console.log("Error loading shader"),console.log(e),console.log(n.getShaderInfoLog(i))),i},t.prototype.bind=function(){this.gl.useProgram(this.program),this.resetTextureUnit()},t.prototype.resetTextureUnit=function(){this.textureUnit=0},t.prototype.setAttributes=function(t){for(var e=this.gl,n=null,i=0,o=t;i<o.length;i++){var r=o[i],a=this.attributes[r.name];r.buffer!=n&&(n=r.buffer,e.bindBuffer(e.ARRAY_BUFFER,n)),null!=a&&(e.enableVertexAttribArray(a),e.vertexAttribPointer(a,r.size,e.FLOAT,!1,4*r.stride,4*r.offset))}},t.prototype.setUniforms=function(t){for(var e=this.gl,n=0,i=t;n<i.length;n++){var o=i[n],r=this.uniforms[o.name];null!==r&&("matrix"==o.type?e.uniformMatrix4fv(r,!1,o.value.buffer()):"texture"==o.type?(e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_2D,o.value.textureId),e.uniform1i(r,this.textureUnit),this.textureUnit+=1):"textureCube"==o.type?(e.activeTexture(e.TEXTURE0+this.textureUnit),e.bindTexture(e.TEXTURE_CUBE_MAP,o.value.textureId),e.uniform1i(r,this.textureUnit),this.textureUnit+=1):"3f"==o.type?e.uniform3f(r,o.value.x,o.value.y,o.value.z):"1f"==o.type?e.uniform1f(r,o.value):e["uniform"+o.type](r,o.value))}},t.prototype.disableAttributes=function(){for(var t in this.attributes)this.gl.disableVertexAttribArray(this.attributes[t])},t.prototype.destroy=function(){this.uniforms={},this.attributes={},this.gl.deleteProgram(this.program),this.gl.deleteShader(this.vertexShader),this.gl.deleteShader(this.fragmentShader)},t}(),jt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Zt=function(t){function e(e,n,i,o,r,a){void 0===i&&(i=null),void 0===o&&(o=null),void 0===r&&(r=null);var s=t.call(this)||this;if(s.gl=e,s.type=n,s.attributeInfos=[],s.uniformInfos=[],i){s.vertices=i.length;for(var u=[],l=0,h=i;l<h.length;l++)for(var c=h[l],p=0,f=o;p<f.length;p++)for(var d=0,g=c[w=f[p]];d<g.length;d++){var m=g[d];u.push(m)}s.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,s.buffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(u),e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);for(var y=i[0],v=0,A=0;A<o.length;++A){var w=o[A],M=r[A],x=y[w].length,_=new kt(M,s.buffer,x,v,0);s.attributeInfos.push(_),v+=x}for(var b=0,T=s.attributeInfos;b<T.length;b++){(_=T[b]).stride=v}null!=a&&s.setIndices(a)}return s}return jt(e,t),e.prototype.init=function(t,e,n){var i=this;if(void 0===t&&(t=null),void 0===e&&(e=null),void 0===n&&(n=null),null!=this.gl&&null!=t&&null!=n&&null!=e){this.type=this.gl.TRIANGLES;var o=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,o),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.setIndices(n),this.buffer=o,this.vertices=n.length,e.forEach(function(t){return t.buffer=i.buffer}),this.attributeInfos=e}else console.log("GL or data or dicies is missing")},e.prototype.init3dObject=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=null),null!=this.gl){this.type=this.gl.TRIANGLES;var n=this.gl.createBuffer();if(null!=t){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.buffer=n;null!=e?this.setIndices(e):this.vertices=t.length/8,this.attributeInfos=[new kt("a_position",n,3,0,8),new kt("a_uv",n,2,3,8),new kt("a_normal",n,3,5,8)]}else console.log("Vertices size can not be null")}else console.log("init model Building no data")},e.prototype.setIndices=function(t){if(t){var e=this.gl;this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Int16Array(t),e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.vertices=t.length}},e.prototype.render=function(){var t=this.gl;this.indexBuffer?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(this.type||t.TRIANGLES,this.vertices,t.UNSIGNED_SHORT,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindBuffer(t.ARRAY_BUFFER,null)):this.vertices>0&&(t.drawArrays(this.type||t.TRIANGLES,0,this.vertices),t.bindBuffer(t.ARRAY_BUFFER,null))},e.prototype.setUniform=function(t){this.uniformInfos.push(t)},e.prototype.destroy=function(){this.buffer&&(this.gl.deleteBuffer(this.buffer),this.buffer=null),this.indexBuffer&&(this.gl.deleteBuffer(this.indexBuffer),this.indexBuffer=null),this.attributeInfos=[],this.uniformInfos=[]},e.prototype.setHighestModelPosition=function(t){this.highestModelPosition=t},e.prototype.getHighestModelPosition=function(){return this.highestModelPosition},e}(pt),Vt=function(){function t(){}return t.waterFragment="\n    vec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time) {\n      float eps = 0.01;\n      if (abs(tileColor.x - 0.639) < eps && abs(tileColor.y - 0.8) < eps && abs(tileColor.z - 1.0) < eps) {\n        vec2 displacement = texture2D( waterDispl, 4.0 * vec2(uv.x, uv.y + time )).rg;\n        vec2 offset = (displacement * 2.0 - 1.0) * 0.2;\n        vec4 color = texture2D(waterColor, uv * 2.0 + offset);\n        return color;\n      } else {\n        return tileColor;\n      } \n    }\n  ",t.basicVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n\tgl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n\tv_uv = a_uv;\n}\n   ",t.basicFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nuniform sampler2D u_waterDisplacement;\nuniform sampler2D u_waterColor;\nuniform float u_time;\nuniform int u_enableWater;   \n \nvec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n\nvoid main() {\n    vec4 tileColor = texture2D(u_texture, v_uv);\n    vec4 vertexColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n    gl_FragColor = vertexColor;\n}  \n  "+t.waterFragment,t.rasterFogVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  v_uv = a_uv;\n}\n   ",t.rasterFogFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform float u_fogStart;\nuniform float u_fogRange;\nuniform vec3 u_fogColor;\n\nvarying vec2 v_uv;\n\nuniform sampler2D u_waterDisplacement;\nuniform sampler2D u_waterColor;\nuniform float u_time;   \nuniform int u_enableWater;\n \nvec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n\nvoid main() {\n    vec4 tileColor = texture2D(u_texture, v_uv);\n    vec4 vertexColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n    // fog\n    float dist = (gl_FragCoord.z / gl_FragCoord.w);\n    float visibility = (dist - u_fogStart) / u_fogRange;\n    visibility = clamp(visibility, 0.0, 1.0);\n    gl_FragColor = mix(vertexColor, vec4(u_fogColor, 1.0), visibility);\n} \n  "+t.waterFragment,t.polylineVS="\nattribute vec2 a_position;\nattribute vec2 a_extrude;\n\nuniform float u_lineWidth;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n\tvec2 delta = (u_lineWidth / 2.0) * a_extrude;\n\n\tgl_Position = u_mvpMatrix * vec4(a_position + delta, 0.0, 1.0);\n}\n  ",t.polylineFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}  \n  ",t.fillVS="\nattribute vec2 a_position;\n\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n\tgl_Position = u_mvpMatrix * vec4(a_position, 0.0, 1.0);\n}\n  ",t.fillFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n  ",t.circleVS="\nattribute vec2 a_extrude;\n\nuniform float u_radius;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(u_radius * a_extrude, 0.0, 1.0);\n}\n  ",t.circleFS="\nprecision mediump float;\n\nuniform vec4 u_color;\n\nvoid main() {\n    gl_FragColor = u_color;\n}\n  ",t.markerVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\n\nvoid main() {\n\tgl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n\tv_uv = a_uv;\n}\n  ",t.markerFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_FragColor = texture2D(u_texture, v_uv);\n}\n  ",t.buildingVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\nattribute vec3 a_normal;\n\nuniform mat4 u_modelMatrix;\nuniform mat4 u_mvpMatrix;\n\nvarying vec2 v_uv;\nvarying vec3 v_normal;\n\nvoid main() {\n    gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n    v_uv = a_uv;\n    // Convert normal vector to world space (make sure that we don't translate it)\n    v_normal = normalize(vec3((u_modelMatrix * vec4(a_normal, 0.0)).xyz));\n}\n  ",t.buildingFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\nuniform vec3 u_light_color;\nuniform vec3 u_light_position;\nuniform float u_distance;\nuniform float u_fogStart;\nuniform float u_fogRange;\nuniform vec3 u_fogColor;\n\nvarying vec2 v_uv;\nvarying vec3 v_normal;\n\nvoid main() {\n    float u_light_intensity = 1.0;\n\n    // initialize\n    vec3 diffuse = vec3(1.0, 1.0, 1.0);\n\n    vec3 normal = normalize(v_normal);\n    vec4 materialColor = texture2D(u_texture, v_uv);\n    vec3 light = normalize(u_light_position);\n\n    // diffuse\n    float diffuseCoefficient = max(0.0, dot(normal, light));\n    diffuseCoefficient = mix((1.0 - u_light_intensity), max((0.5 + u_light_intensity), 1.0), diffuseCoefficient);\n    diffuse = clamp(diffuseCoefficient * u_light_color, mix(vec3(0.0), vec3(0.3), 1.0 - u_light_color), vec3(1.0));\n    vec4 vertexColor = vec4(mix(materialColor.rgb, diffuseCoefficient * diffuse, 0.2), materialColor.a);\n\n    // fog\n    vec4 fogColor = vec4(u_fogColor, 1.0);\n    float visibility = (u_distance - u_fogStart) / u_fogRange;\n    visibility = clamp(visibility, 0.0, 1.0);\n    gl_FragColor = mix(vertexColor, fogColor, visibility);\n    \n    if (gl_FragColor.a < 0.3 || visibility > 0.6) {\n      discard;\n    }\n}\n  ",t.buildingSelectionVS="\nattribute vec3 a_position;\nuniform mat4 u_mvpMatrix;\n\nvoid main() {\n    gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n}\n  ",t.buildingSelectionFS="\nprecision mediump float;\nuniform vec3 u_color;\n\nvoid main() {\n    gl_FragColor = vec4(u_color, 1.0);\n}\n  ",t.debugSelectionVS="\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n    \n    varying vec2 v_uv;\n    \n    void main() {\n      gl_Position = vec4(a_position, 1.0);\n      v_uv = a_uv;\n    }\n  ",t.debugSelectionFS="\n    precision mediump float;\n    \n    uniform sampler2D u_texture;\n    varying vec2 v_uv;\n    \n    void main() {\n        gl_FragColor = texture2D(u_texture, vec2(v_uv.x , 1.0 - v_uv.y));\n    }\n\n  ",t.skyVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_viewMatrix;\nuniform mat4 u_mvpMatrix;\n\nvarying vec3 v_position;\nvarying float v_y;\nvarying vec2 v_uv;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  gl_Position.z = gl_Position.w - 0.000001;\n  v_position = a_position;\n  v_y = (u_viewMatrix * vec4(a_position, 1.0)).y;\n  v_uv = a_uv;\n}\n  ",t.skyFS="\nprecision mediump float;\n\nuniform float u_lowerLimit;\nuniform float u_upperLimit;\nuniform sampler2D u_texture;\nuniform vec3 u_vertexColor;\nuniform vec3 u_fogColor;\n\nvarying vec3 v_position;\nvarying float v_y;\nvarying vec2 v_uv;\n\nvoid main() {\n  float factor = (v_y - u_lowerLimit) / (u_upperLimit - u_lowerLimit);\n  vec4 vertexColor = vec4(u_vertexColor, 1.0);\n  vec4 fogColor = vec4(u_fogColor ,1.0);\n  vec4 textureColor = mix(texture2D(u_texture, v_uv), vertexColor, 0.5);\n  factor = clamp(factor, 0.0, 1.0);\n  gl_FragColor = mix(fogColor, textureColor, factor);\n  if (factor < 0.1) discard;\n}\n  ",t.shadowMappingVS="\n    attribute vec3 a_position;\n\n    uniform mat4 u_shadowMvpMatrix;\n    \n    varying vec4 v_position;\n\n    void main() {\n\t    gl_Position = u_shadowMvpMatrix * vec4(a_position, 1.0);\n\t    v_position = gl_Position;\n    }\n   ",t.shadowMappingFS="\n    precision mediump float;\n    \n    varying vec4 v_position;\n    \n    vec4 pack(float depth) {\n        depth *= (256.0 * 256.0 * 256.0 - 1.0) / (256.0 * 256.0 * 256.0);\n        vec4 encode = fract(depth * vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0) );\n        return vec4(encode.xyz - encode.yzw / 256.0, encode.w ) + 1.0 / 512.0;\n    }\n\n    void main() {\n      float depth = v_position.z / v_position.w;\n      depth = (depth + 1.0) / 2.0;\n\t    gl_FragColor = pack(depth);\n    }  \n  ",t.shadowFS="\n  \n    float unpack(vec4 pack) {\n      float depth = dot(pack, 1.0 / vec4(1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0));\n      return depth * (256.0 * 256.0 * 256.0) / (256.0 * 256.0 * 256.0 - 1.0);\n    }\n  \n    float calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias) {\n      float shadowFactor = 1.0;\n      vec4 shadowMapPosition = shadowCoord / shadowCoord.w;\n      bool inShadowArea = (shadowMapPosition.x >= 0.0 && shadowMapPosition.x <= 1.0) && \n\t    (shadowMapPosition.y >= 0.0 && shadowMapPosition.y <= 1.0) && \n\t    (shadowMapPosition.z >= 0.0 && shadowMapPosition.z <= 1.0);\n\t\t  if (inShadowArea) {\n    \t  float distanceFromLight = unpack(texture2D(shadowMap, shadowMapPosition.xy));\t\n    \t  if (distanceFromLight  + bias < shadowMapPosition.z  ) {\n    \t    shadowFactor = 0.7;   \n    \t  }\n      }\n      return shadowFactor;\n    }\n    \n  ",t.raster3DWithShadowVS="\nattribute vec3 a_position;\nattribute vec2 a_uv;\n\nuniform mat4 u_mvpMatrix;\nuniform mat4 u_shadowMvpMatrix;\n\nvarying vec2 v_uv;\nvarying vec4 v_shadowCoord;\n\nvoid main() {\n  gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n  v_uv = a_uv;\n  // Calculate shadow coordinate\n\tv_shadowCoord = u_shadowMvpMatrix * vec4(a_position, 1.0);\n}\n   ",t.raster3DWithShadowFS="\nprecision mediump float;\n\nuniform sampler2D u_texture;\n// The shadow map\nuniform sampler2D u_shadowMap;\nuniform float u_fogStart;\nuniform float u_fogRange;\n\nuniform sampler2D u_waterDisplacement;\nuniform sampler2D u_waterColor;\nuniform float u_time;\nuniform int u_enableWater;\n    \nvarying vec2 v_uv;\nvarying vec4 v_shadowCoord;\n    \nfloat calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias);\nvec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\nconst vec4 fogColor= vec4(0.90, 0.90, 0.90, 1.0);\n\nvoid main() {\n    vec4 tileColor = texture2D(u_texture, v_uv);\n    vec4 vertexColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n    // fog\n    float dist = (gl_FragCoord.z / gl_FragCoord.w);\n    float visibility = (dist - u_fogStart) / u_fogRange;\n    visibility = clamp(visibility, 0.0, 1.0);\n    float shadowFactor = calculateShadowFactor(u_shadowMap, v_shadowCoord, 0.0005);\n    vec4 vertexWithFogColor = mix(vertexColor, fogColor, visibility);\n    gl_FragColor = vec4(mix(vec3(0.4, 0.4, 0.4), vertexWithFogColor.rgb, shadowFactor), vertexWithFogColor.a);\n} \n  "+t.waterFragment,t.rasterWithShadowVS="\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n\n    uniform mat4 u_mvpMatrix;\n    uniform mat4 u_shadowMvpMatrix;\n\n    varying vec2 v_uv;\n    varying vec4 v_shadowCoord;\n\n    void main() {\n\t    gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n\t    v_uv = a_uv;\n\t    // Calculate shadow coordinate\n\t    v_shadowCoord = u_shadowMvpMatrix * vec4(a_position, 1.0);\n    }\n   ",t.rasterWithShadowFS="\n    precision mediump float;\n    \n    // The texture\n    uniform sampler2D u_texture;\n    // The shadow map\n    uniform sampler2D u_shadowMap;\n    \n    uniform sampler2D u_waterDisplacement;\n    uniform sampler2D u_waterColor;\n    uniform float u_time;\n    uniform int u_enableWater;\n \n    varying vec2 v_uv;\n    varying vec4 v_shadowCoord;\n    \n    float calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias);\n    vec4 calculateWaterColor(vec4 tileColor, sampler2D waterDispl, sampler2D waterColor, vec2 uv, float time);\n    \t\n    void main() {\n      vec4 tileColor = texture2D(u_texture, v_uv);\n      vec4 rasterColor = u_enableWater == 0 ? tileColor: calculateWaterColor(tileColor, u_waterDisplacement, u_waterColor, v_uv, u_time);\n      float shadowFactor = calculateShadowFactor(u_shadowMap, v_shadowCoord, 0.0005);\n      gl_FragColor = vec4(mix(vec3(0.4, 0.4, 0.4), rasterColor.rgb, shadowFactor), rasterColor.a);      \n    }\n  "+t.waterFragment,t.buildingWithShadowVS="\n    attribute vec3 a_position;\n    attribute vec2 a_uv;\n    attribute vec3 a_normal;\n\n    uniform mat4 u_modelMatrix;\n    uniform mat4 u_mvpMatrix;\n    uniform mat4 u_shadowMvpMatrix;\n    uniform vec3 u_light_color;\n    uniform vec3 u_light_position;\n\n    varying vec2 v_uv;\n    varying vec3 v_lighting;\n    varying vec4 v_shadowCoord;\n    varying vec3 v_normal;\n    varying vec3 v_light_position;\n\n    void main() {\n      float u_light_intensity = 1.0;  \n      gl_Position = u_mvpMatrix * vec4(a_position, 1.0);\n      v_uv = a_uv;\n      // Convert normal vector to world space (make sure that we don't translate it)\n      vec3 normal = normalize(vec3((u_modelMatrix * vec4(a_normal, 0.0)).xyz));\n      v_normal = normal;\n      \n      float directional = max(0.0, dot(normal, normalize(u_light_position)));\n      directional = mix((1.0 - u_light_intensity), max((0.5 + u_light_intensity), 1.0), directional);\n      v_lighting = clamp(directional * u_light_color, mix(vec3(0.0), vec3(0.3), 1.0 - u_light_color), vec3(1.0));\n      \n      // Calculate shadow coordinate\n\t    v_shadowCoord = u_shadowMvpMatrix * vec4(a_position, 1.0); \n      v_light_position = u_light_position;\n    }\n  ",t.buildingWithShadowFS="\n    precision mediump float;\n\n    uniform sampler2D u_texture;\n    uniform sampler2D u_shadowMap;\n    \n    varying vec2 v_uv;\n    varying vec3 v_lighting;\n    varying vec4 v_shadowCoord;\n    varying vec3 v_normal;\n    varying vec3 v_light_position;\n    \n    float calculateShadowFactor(sampler2D shadowMap, vec4 shadowCoord, float bias);\n\n    float calculateBias() {\n      float bias;\n      vec3 n = normalize(v_normal); \n      vec3 l = normalize(v_light_position);\n      float cosTheta = clamp( dot( n,l ), 0.0, 1.0 );\n \t    bias = 0.0001 * tan(acos(cosTheta));\n\t    bias = clamp(bias, 0.0, 0.01);\n    \treturn bias;\n    }\n    \n    void main() {\n        vec4 materialColor = texture2D(u_texture, v_uv);\n        if (materialColor.a < 0.3) {\n          discard;\n        }\n        float bias = calculateBias();\n        float shadowFactor = 1.0;\n        if (bias >= 0.01) {\n          shadowFactor = 0.7;\n        }\n        else {\n          shadowFactor = calculateShadowFactor(u_shadowMap, v_shadowCoord, bias);\n        }\n        gl_FragColor =\n        vec4(mix(vec3(0.4, 0.4, 0.4), mix(materialColor.rgb, v_lighting, 0.2), shadowFactor), materialColor.a);\n    }\n  ",t}();!function(t){t[t.Butt=0]="Butt",t[t.Square=1]="Square",t[t.Round=2]="Round"}(Bt||(Bt={})),function(t){t[t.Miter=0]="Miter",t[t.Bevel=1]="Bevel",t[t.Round=2]="Round"}(Ot||(Ot={}));var Wt=function(){return function(t){void 0===t&&(t=function(t){}),this.indices=[],this.addVertex=t}}();var Ut=function(){return function(t){void 0===t&&(t=function(t){}),this.indices=[],this.addVertex=t}}();function zt(t,e){var n=[],i=[];t.forEach(function(t,o){0!=o&&i.push(n.length/2),t.forEach(function(t){n.push(t.x),n.push(t.y),e.addVertex(t)})}),e.indices=vt()(n,i)}var Yt,Ht,Gt,Xt=function(){function t(t,e,n,i,o){void 0===t&&(t=function(t,e){}),void 0===e&&(e=Bt.Butt),void 0===n&&(n=Ot.Bevel),void 0===i&&(i=!1),void 0===o&&(o=3),this.indices=[],this.addVertex=t,this.lineCapType=e,this.lineJoinType=n,this.closedPolyline=i,this.miterLimit=o,this.numVertices=0}return t.prototype.buildPolyLine=function(t,e){void 0===e&&(e=null),this.buildPolyLineSegment(t,e)},t.prototype.clear=function(){this.indices=[],this.numVertices=0},t.prototype.buildPolyLineSegment=function(t,e){var n=this.closedPolyline?t.length+2:t.length,i=t.length,o=n-0;if(!(o<2)){var r,a,s,u=t[0],h=t[1];a=new M(h.y-u.y,u.x-h.x).normalize(),this.closedPolyline||this.addCap(u,a,!0),this.addPolyLineVertex(u,a),this.addPolyLineVertex(u,a.multiply(-1));for(var c=1;c<o-1;++c){if((u=h)!=(h=t[(c+0+1)%i])){r=a,a=new M(h.y-u.y,u.x-h.x).normalize();var p=1;0==(s=r.add(a)).x&&0==s.y?s=new M(r.y-a.y,a.x-r.x):p=2/s.dot(s),s=s.multiply(p);var f=this.lineJoinType==Ot.Bevel;if(s.length>this.miterLimit&&(f=!0,s=s.multiply(this.miterLimit/s.length)),this.lineJoinType!=Ot.Miter||f){var d=f||this.lineJoinType==Ot.Bevel?1:l.numTrianglesOnRoundJoin;a.x*r.y-a.y*r.x>0?(this.addPolyLineVertex(u,s),this.addPolyLineVertex(u,r.multiply(-1)),this.addIndices(),this.addFan(u,r.multiply(-1),a.multiply(-1),s,d),this.addPolyLineVertex(u,s),this.addPolyLineVertex(u,a.multiply(-1))):(this.addPolyLineVertex(u,r),this.addPolyLineVertex(u,s.multiply(-1)),this.addIndices(),this.addFan(u,r,a,s.multiply(-1),d),this.addPolyLineVertex(u,a),this.addPolyLineVertex(u,s.multiply(-1)))}else this.addPolyLineVertex(u,s),this.addPolyLineVertex(u,s.multiply(-1)),this.addIndices()}}this.addPolyLineVertex(h,a),this.addPolyLineVertex(h,a.multiply(-1)),this.addIndices(),this.closedPolyline||this.addCap(h,a,!1),e&&e()}},t.prototype.addCap=function(t,e,n){switch(this.lineCapType){case Bt.Butt:break;case Bt.Square:var i=new M(-e.y,e.x);this.addPolyLineVertex(t,e.add(i)),this.addPolyLineVertex(t,e.multiply(-1).add(i)),n||this.addIndices();break;case Bt.Round:var o=e,r=e.multiply(-1),a=new M(0,0);n&&(o=o.multiply(-1),r=r.multiply(-1)),this.addFan(t,o,r,a,l.numTrianglesOnRoundCap);break;default:console.log("Invalid line cap type")}},t.prototype.addPolyLineVertex=function(t,e){++this.numVertices,this.addVertex(t,e)},t.prototype.addIndices=function(){this.indices.push(this.numVertices-4),this.indices.push(this.numVertices-2),this.indices.push(this.numVertices-3),this.indices.push(this.numVertices-3),this.indices.push(this.numVertices-2),this.indices.push(this.numVertices-1)},t.prototype.addFan=function(t,e,n,i,o){var r=e.x*n.y-e.y*n.x,a=Math.atan2(r,e.dot(n)),s=this.numVertices;this.addPolyLineVertex(t,i),this.addPolyLineVertex(t,e);for(var u=e,l=0;l<o;l++){var h=(l+1)/o;u=e.rotateByRadian(a*h),this.addPolyLineVertex(t,u),this.indices.push(s),this.indices.push(s+l+(a>0?1:2)),this.indices.push(s+l+(a>0?2:1))}},t}(),Qt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),qt=function(){return function(t,e){this.min=t,this.mag=e}}(),Jt=function(){return function(t,e){this.wraps=t,this.wrapt=e}}(),Kt=function(){return function(t,e,n,i,o,r){this.target=t,this.internalFormat=e,this.format=n,this.type=i,this.filtering=o,this.wrapping=r}}(),$t=function(t){function e(e,n){void 0===n&&(n=null);var i=t.call(this)||this;return i.gl=e,i.options=n,null==n&&i.initDefaultTextureOptions(),i.isLoaded=!1,i.init(),i}return Qt(e,t),e.prototype.initDefaultTextureOptions=function(){var t=this.gl,e=new qt(t.LINEAR_MIPMAP_LINEAR,t.LINEAR),n=new Jt(t.CLAMP_TO_EDGE,t.CLAMP_TO_EDGE);this.options=new Kt(t.TEXTURE_2D,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e,n)},e.prototype.init=function(){var t=this.gl;this.textureId=t.createTexture(),t.bindTexture(this.options.target,this.textureId);var e=new Uint8Array([255,255,255,255]);this.width=1,this.height=1,t.texImage2D(this.options.target,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,e),t.texParameteri(this.options.target,t.TEXTURE_WRAP_S,this.options.wrapping.wraps),t.texParameteri(this.options.target,t.TEXTURE_WRAP_T,this.options.wrapping.wrapt),this.setTextureOptionsParameter(),t.bindTexture(this.options.target,null)},e.prototype.initFrameBufferTexture=function(t,e){var n=this.gl;this.width=t,this.height=e,this.textureId=n.createTexture(),n.bindTexture(this.options.target,this.textureId),n.texImage2D(this.options.target,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,null),n.texParameteri(this.options.target,n.TEXTURE_WRAP_S,this.options.wrapping.wraps),n.texParameteri(this.options.target,n.TEXTURE_WRAP_T,this.options.wrapping.wrapt),this.setTextureOptionsParameter(!1),n.bindTexture(n.TEXTURE_2D,null),this.isLoaded=!0},e.prototype.bind=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,this.textureId)},e.prototype.unbind=function(){this.gl.bindTexture(this.gl.TEXTURE_2D,null)},e.prototype.loadColor=function(t){var e=this.gl;this.width=1,this.height=1;var n=new Uint8Array([255*t.x,255*t.y,255*t.z,255]);null!=this.textureId&&(e.bindTexture(e.TEXTURE_2D,this.textureId),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.texImage2D(this.options.target,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,n),this.setTextureOptionsParameter(),e.bindTexture(e.TEXTURE_2D,null))},e.prototype.loadImage=function(t,e){var n=this;void 0===e&&(e=null);var i=this.gl,o=new Image;-1!=t.indexOf("data:image")?o.src=t:o.src="data:image;base64,"+t,o.onload=function(){n.width=o.width,n.height=o.height,null!=n.textureId&&(i.bindTexture(i.TEXTURE_2D,n.textureId),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,o),n.setTextureOptionsParameter(),i.bindTexture(i.TEXTURE_2D,null),n.isLoaded=!0),e&&e()}},e.prototype.loadImageFromBlob=function(t,e){var n=this;void 0===e&&(e=null);var i=this.gl,o=new Image;o.crossOrigin="*";var r=window.URL.createObjectURL(t);o.src=r,o.onload=function(){n.width=o.width,n.height=o.height,null!=n.textureId&&(i.bindTexture(i.TEXTURE_2D,n.textureId),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,o),n.setTextureOptionsParameter(),i.bindTexture(i.TEXTURE_2D,null),n.isLoaded=!0),e&&e(),window.URL.revokeObjectURL(r)}},e.prototype.loadImageFromUrl=function(t,e){var n=this;void 0===e&&(e=null);var i=this.gl,o=new Image;o.crossOrigin="*",o.src=t,o.onload=function(){n.width=o.width,n.height=o.height,null!=n.textureId&&(i.bindTexture(i.TEXTURE_2D,n.textureId),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,o),n.setTextureOptionsParameter(),i.bindTexture(i.TEXTURE_2D,null),n.isLoaded=!0),e&&e()}},e.prototype.isPowerOf2=function(t){return 0==(t&t-1)},e.prototype.setFilter=function(t){var e=this.gl;e.bindTexture(e.TEXTURE_2D,this.textureId),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t),e.bindTexture(e.TEXTURE_2D,null)},e.prototype.destroy=function(){this.textureId&&(this.gl.deleteTexture(this.textureId),this.textureId=null)},e.prototype.setTextureOptionsParameter=function(t){void 0===t&&(t=!0);var e=this.gl;if(e.texParameteri(this.options.target,e.TEXTURE_MAG_FILTER,this.options.filtering.mag),this.isPowerOf2(this.width)&&this.isPowerOf2(this.height)&&t)e.texParameteri(this.options.target,e.TEXTURE_MIN_FILTER,this.options.filtering.min),e.generateMipmap(this.options.target);else{var n=this.options.filtering.min;n==e.LINEAR_MIPMAP_LINEAR||n==e.LINEAR_MIPMAP_NEAREST?n=e.LINEAR:n!=e.NEAREST_MIPMAP_LINEAR&&n!=e.NEAREST_MIPMAP_NEAREST||(n=e.NEAREST),e.texParameteri(this.options.target,e.TEXTURE_MIN_FILTER,n)}},e.prototype.setTextureParameter=function(t,e){null!=t&&(this.gl.bindTexture(this.options.target,this.textureId),this.gl.texParameteri(this.options.target,t,e),this.gl.bindTexture(this.options.target,null))},e}(pt);!function(t){t[t.MARKER_SHADER=0]="MARKER_SHADER",t[t.POLYLINE_SHADER=1]="POLYLINE_SHADER",t[t.FILL_SHADER=2]="FILL_SHADER",t[t.RASTER_SHADER=3]="RASTER_SHADER",t[t.RASTER_WITH_SHADOW_SHADER=4]="RASTER_WITH_SHADOW_SHADER",t[t.RASTER_FOG_SHADER=5]="RASTER_FOG_SHADER",t[t.RASTER_3D_WITH_SHADOW_SHADER=6]="RASTER_3D_WITH_SHADOW_SHADER",t[t.CIRCLE_SHADER=7]="CIRCLE_SHADER",t[t.BUILDING_SHADER=8]="BUILDING_SHADER",t[t.BUILDING_SELECTION_SHADER=9]="BUILDING_SELECTION_SHADER",t[t.DEBUG_SELECTION_SHADER=10]="DEBUG_SELECTION_SHADER",t[t.PARTICLE_SHADER=11]="PARTICLE_SHADER",t[t.SHADOW_MAPPING_SHADER=12]="SHADOW_MAPPING_SHADER",t[t.BUILDING_WITH_SHADOW_SHADER=13]="BUILDING_WITH_SHADOW_SHADER",t[t.SKY_SHARDER=14]="SKY_SHARDER"}(Yt||(Yt={})),function(t){t[t.MARKER_MODEL=0]="MARKER_MODEL",t[t.RASTER_MODEL=1]="RASTER_MODEL",t[t.CIRCLE_MODEL=2]="CIRCLE_MODEL",t[t.POLYLINE_SHADER=3]="POLYLINE_SHADER",t[t.SKY_MODEL=4]="SKY_MODEL",t[t.SELECTION_DEBUG_MODEL=5]="SELECTION_DEBUG_MODEL",t[t.PARTICLE_QUAD_MODEL=6]="PARTICLE_QUAD_MODEL"}(Ht||(Ht={})),function(t){t[t.WHITE_TEXTURE=0]="WHITE_TEXTURE",t[t.RAIN_TEXTURE=1]="RAIN_TEXTURE",t[t.SNOW_TEXTURE=2]="SNOW_TEXTURE",t[t.SKY_TEXTURE=3]="SKY_TEXTURE",t[t.WATER_DISPLACEMENT=4]="WATER_DISPLACEMENT",t[t.WATER_COLOR=5]="WATER_COLOR"}(Gt||(Gt={}));var te,ee=function(){function t(){this.initialized=!1,this.shaders=new Map,this.models=new Map,this.textures=new Map}return Object.defineProperty(t,"Instance",{get:function(){return this.instance||(this.instance=new this)},enumerable:!0,configurable:!0}),t.prototype.createShader=function(t,e){return new Ft(this.gl,t,e)},t.prototype.createModel=function(t){var e=this.gl,n=new Zt(e,e.TRIANGLES),i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,null);var o=[new kt("a_position",i,3,0,5),new kt("a_uv",i,2,3,5)];return n.vertices=6,n.buffer=i,n.attributeInfos=o,n},t.prototype.init=function(t){if(this.gl=t,!this.initialized){this.initialized=!0;var e=this.createShader(Vt.basicVS,Vt.basicFS);this.shaders.set(Yt.RASTER_SHADER,e),this.shaders.set(Yt.RASTER_FOG_SHADER,this.createShader(Vt.rasterFogVS,Vt.rasterFogFS)),this.shaders.set(Yt.RASTER_WITH_SHADOW_SHADER,this.createShader(Vt.raster3DWithShadowVS,Vt.rasterWithShadowFS+Vt.shadowFS)),this.shaders.set(Yt.RASTER_3D_WITH_SHADOW_SHADER,this.createShader(Vt.raster3DWithShadowVS,Vt.raster3DWithShadowFS+Vt.shadowFS)),this.shaders.set(Yt.MARKER_SHADER,this.createShader(Vt.markerVS,Vt.markerFS)),this.shaders.set(Yt.POLYLINE_SHADER,this.createShader(Vt.polylineVS,Vt.polylineFS)),this.shaders.set(Yt.FILL_SHADER,this.createShader(Vt.fillVS,Vt.fillFS)),this.shaders.set(Yt.CIRCLE_SHADER,this.createShader(Vt.circleVS,Vt.circleFS)),this.shaders.set(Yt.BUILDING_SHADER,this.createShader(Vt.buildingVS,Vt.buildingFS)),this.shaders.set(Yt.BUILDING_SELECTION_SHADER,this.createShader(Vt.buildingSelectionVS,Vt.buildingSelectionFS)),this.shaders.set(Yt.SKY_SHARDER,this.createShader(Vt.skyVS,Vt.skyFS)),this.shaders.set(Yt.DEBUG_SELECTION_SHADER,this.createShader(Vt.debugSelectionVS,Vt.debugSelectionFS)),this.shaders.set(Yt.PARTICLE_SHADER,e),this.shaders.set(Yt.SHADOW_MAPPING_SHADER,this.createShader(Vt.shadowMappingVS,Vt.shadowMappingFS)),this.shaders.set(Yt.BUILDING_WITH_SHADOW_SHADER,this.createShader(Vt.buildingWithShadowVS,Vt.buildingWithShadowFS+Vt.shadowFS));var n=new Float32Array([-1,-1,0,0,1,-1,1,0,0,0,1,1,0,1,0,-1,-1,0,0,1,1,1,0,1,0,1,-1,0,1,1]),i=this.createModel(n),o=[],r=new Wt;r.addVertex=function(t){o.push(t.x,t.y)},function(t){var e=l.numTrianglesPerCircle,n=2*Math.PI;t.addVertex(new M(0,0));for(var i=0;i<e;++i)t.addVertex(new M(Math.cos(i*n/e),Math.sin(i*n/e)).normalize()),0!=i&&(t.indices.push(0),t.indices.push(0+i),t.indices.push(0+i+1));t.indices.push(0),t.indices.push(e),t.indices.push(1)}(r);var a=new Zt(this.gl,this.gl.TRIANGLES);a.init(o,[new kt("a_extrude",null,2,0,2)],r.indices),this.models.set(Ht.RASTER_MODEL,i),this.models.set(Ht.MARKER_MODEL,i),this.models.set(Ht.SKY_MODEL,i),this.models.set(Ht.CIRCLE_MODEL,a),this.models.set(Ht.SELECTION_DEBUG_MODEL,i),this.models.set(Ht.PARTICLE_QUAD_MODEL,i);var s=new $t(this.gl);this.textures.set(Gt.WHITE_TEXTURE,s);var u=new $t(this.gl);u.loadImageFromUrl(D.get("rainTexture"),null),this.textures.set(Gt.RAIN_TEXTURE,u);var h=new $t(this.gl);h.loadImageFromUrl(D.get("snowTexture"),null),this.textures.set(Gt.SNOW_TEXTURE,h);var c=new $t(this.gl);c.loadImageFromUrl(D.get("skyTexture"),null),this.textures.set(Gt.SKY_TEXTURE,c);var p=new $t(this.gl);p.setTextureParameter(t.TEXTURE_WRAP_S,t.REPEAT),p.setTextureParameter(t.TEXTURE_WRAP_T,t.REPEAT),p.loadImage(D.waterDisplacement,null),this.textures.set(Gt.WATER_DISPLACEMENT,p);var f=new $t(this.gl);f.setTextureParameter(t.TEXTURE_WRAP_S,t.REPEAT),f.setTextureParameter(t.TEXTURE_WRAP_T,t.REPEAT),f.loadImage(D.waterColor,null),this.textures.set(Gt.WATER_COLOR,f)}},t.prototype.getShader=function(t){return this.shaders.get(t)},t.prototype.getModel=function(t){return this.models.get(t)},t.prototype.getTexture=function(t){return this.textures.get(t)},t.instance=null,t}(),ne=function(){function t(t,e){this.mapState=t,this.layer=e,this.selectionCode=0}return t.prototype.renderSelection=function(){},t.prototype.renderShadowMapping=function(){},t.prototype.getRenderTiles=function(){return this.layer.tileManager.getRenderTiles()},t.prototype.getVisibleTiles=function(){return this.layer.tileManager.getVisibleTiles()},t.prototype.getSelectionCode=function(){return this.selectionCode++,(this.selectionCode<t.MIN_SELECTION_CODE||this.selectionCode>t.MAX_SELECTION_CODE)&&(this.selectionCode=t.MIN_SELECTION_CODE),this.selectionCode},t.prototype.resetSelectionCode=function(){this.selectionCode=0},t.MIN_SELECTION_CODE=1,t.MAX_SELECTION_CODE=16777215,t}();!function(t){t[t.RASTER=0]="RASTER",t[t.ANNOTAION=1]="ANNOTAION"}(te||(te={}));var ie,oe=function(){function t(t,e,n){this.renderable=!1,this.kind=t,this.tileCoordinate=e,this.gl=n}return t.prototype.isRenderable=function(){return this.renderable},t.prototype.getKind=function(){return this.kind},t.prototype.getTileCoordinate=function(){return this.tileCoordinate},t}(),re=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ae=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.time=0,i}return re(e,t),e.prototype.render=function(){var t=this,e=this.mapState.is3dMode()&&this.mapState.getMapBorder()>=a.skyboxMapBorderMinimum,n=ee.Instance.getModel(Ht.RASTER_MODEL),i=null,s=this.layer,u=s.effectManager,l=this.mapState.is3dMode()&&u.enableShadowEffect;if(e){(i=l?ee.Instance.getShader(Yt.RASTER_3D_WITH_SHADOW_SHADER):ee.Instance.getShader(Yt.RASTER_FOG_SHADER)).bind(),i.setAttributes(n.attributeInfos);var h=a.defaultMaxNativeZoom,c=this.mapState.timeEffectManager.getFogColor(),p=6*Math.max(this.mapState.getZoom()-h,0);i.setUniforms([new Nt("u_fogStart","1f",22+p),new Nt("u_fogRange","1f",10+p),new Nt("u_fogColor","3f",c)])}else(i=l?ee.Instance.getShader(Yt.RASTER_WITH_SHADOW_SHADER):ee.Instance.getShader(Yt.RASTER_SHADER)).bind(),i.setAttributes(n.attributeInfos);if(this.mapState.is3dMode()&&this.mapState.getMapBorder()>=a.skyboxMapBorderMinimum){var f=O.fromHex(a.mapBackgroundColor3D),d=ee.Instance.getTexture(Gt.WHITE_TEXTURE);d.loadColor(new o(f.red,f.green,f.blue));var g=this.mapState.getViewProjectionMatrixWithoutBearing(),m=x.projectScale(this.mapState.getTarget(),this.mapState.scale),y=b.pixelCoordinateToCameraCoordinate(new M(m.x,m.y),this.mapState),v=r.translate(y.x,y.y,0),A=r.scale(a.mapBackgroundScaleRatio,a.mapBackgroundScaleRatio,1),w=(v=v.concat(A)).concat(g);i.setUniforms([new Nt("u_texture","texture",d),new Nt("u_mvpMatrix","matrix",w)]),n.render(),i.resetTextureUnit()}this.getRenderTiles().forEach(function(e){var o=e.getTile();if(o.getKind()==te.RASTER){var r=t.mapState.getViewProjectionMatrix(),h=t.mapState.matrixFor(e.getUnwrappedTileCoordinate()),c=h.concat(r);i.setAttributes(n.attributeInfos);var p=o.getTexture();if(l){var f=u.shadowMap,d=h.concat(f.getLightViewProjectionMatrix()).concat(a.biasMatrix);i.setUniforms([new Nt("u_shadowMap","texture",f.getShadowMapTexture()),new Nt("u_shadowMvpMatrix","matrix",d)])}t.time+=12e-6;var g=ee.Instance.getTexture(Gt.WATER_DISPLACEMENT),m=ee.Instance.getTexture(Gt.WATER_COLOR),y=s.effectManager.enableWaterEffect?1:0;i.setUniforms([new Nt("u_texture","texture",p),new Nt("u_mvpMatrix","matrix",c),new Nt("u_waterDisplacement","texture",g),new Nt("u_waterColor","texture",m),new Nt("u_time","1f",t.time),new Nt("u_enableWater","1i",y)]),n.render(),i.resetTextureUnit()}else console.log("Tile is not raster tile")}),this.mapState.is3dMode()&&this.mapState.getMapBorder()>=a.skyboxMapBorderMinimum&&s.skyRenderer.render(s.skyObject,this.mapState)},e}(ne),se=function(){return function(){}}();!function(t){t[t.MARKER=0]="MARKER"}(ie||(ie={}));var ue,le=function(){function t(t){this.shapeType=t}return t.prototype.update=function(t){},t.prototype.getShapeType=function(){return this.shapeType},t}(),he=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ce=function(t){function e(e){var n=t.call(this)||this;return n.gl=e,n}return he(e,t),e.prototype.render=function(t,e){var n=ee.Instance.getShader(Yt.MARKER_SHADER),i=ee.Instance.getModel(Ht.MARKER_MODEL);if(t.getShapeType()==ie.MARKER){var o=t;if(o.isVisible()){var a=o.getTexture();if(a){n.bind(),n.setAttributes(i.attributeInfos);var s=o.getWidth()*S.pixelScale,u=o.getHeight()*S.pixelScale,l=b.latLngToScreenCoordinate(o.getPosition(),o.getElevation(),e),h=r.translate(l.x,l.y,0),c=o.getAnchor();h=r.translate((.5-c.x)*s,(.5-c.y)*u,0).concat(h);var p=(h=r.scale(s/2,u/2,1).concat(h)).concat(e.getOrthoProjectionMatrix());n.setUniforms([new Nt("u_mvpMatrix","matrix",p),new Nt("u_texture","texture",a)]),i.render()}}}else console.warn("Shape is not MARKER ...")},e.prototype.enableBlend=function(){this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA)},e.prototype.disableBlend=function(){this.gl.disable(this.gl.BLEND)},e}(se),pe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),fe=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.mapState=e,i.layer=n,i.markerRenderer=new ce(i.layer.tileManager.mapView.gl),i}return pe(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==Ct.ANNOTATION){var e=this.layer,n=e.markerAnnotations;n.size>0&&(this.markerRenderer.enableBlend(),n.forEach(function(t){switch(t.getShapeType()){case ie.MARKER:}}),e.getVisibleMarkers().forEach(function(e){return t.markerRenderer.render(e,t.mapState)}),e.getInfoWindowManager().render(e.getVisibleMarkers()),this.markerRenderer.disableBlend())}},e}(ne),de=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ge=function(t){function e(e,n){return t.call(this,e,n)||this}return de(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==Ct.LINE){var e=this.layer;if(0!=e.renderTiles.size&&e.isVisible()){var n=ee.Instance.getShader(Yt.POLYLINE_SHADER),i=this.layer.tileManager.mapView.gl;i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),n.bind();var o=x.worldSize(this.mapState.getScale()),a=this.layer.getLayerId();e.renderTiles.forEach(function(i){var s=i.getTile();if(s.getKind()==te.ANNOTAION){var u=s;if(u.hasData(a)){var l=u.getLayerData(a,Ct.LINE);if(l.getType()==Ct.LINE){var h=l.getModel();n.setAttributes(h.attributeInfos);var c=u.getTileCoordinate(),p=1<<c.getZoom(),f=o/p,d=f/S.getTileSize(),g=b.pixelCoordinateToCameraCoordinate(new M(c.getX()*f+f/2,c.getY()*f+f/2),t.mapState),m=r.translate(g.x,g.y,0);m=r.scale(d,d,1).concat(m);var y=1;t.mapState.getZoom()>t.mapState.getMaxNativeZoom()&&(y=Math.pow(2,Math.round(t.mapState.getZoom())-t.mapState.getMaxNativeZoom())),n.setUniforms([new Nt("u_lineWidth","1f",e.getStrokeWidth()/y),new Nt("u_color","4fv",e.getStrokeColor().buffer()),new Nt("u_mvpMatrix","matrix",m.concat(t.mapState.getViewProjectionMatrix()))]),h.render()}else console.warn("ERROR: layerData.getType() != LayerType.LINE .............")}}else console.warn("ERROR: tile.getKind() != Kind.ANNOTAION .............")})}}},e}(ne),me=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ye=function(t){function e(e,n){return t.call(this,e,n)||this}return me(e,t),e.prototype.render=function(){var t=this;if(this.layer.getLayerType()==Ct.FILL){var e=this.layer;if(0!=e.renderTiles.size&&e.visible){var n=ee.Instance.getShader(Yt.FILL_SHADER),i=this.layer.tileManager.mapView.gl;i.enable(i.BLEND),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),n.bind();var o=x.worldSize(this.mapState.getScale()),a=this.layer.getLayerId();e.renderTiles.forEach(function(i){var s=i.getTile();if(s.getKind()==te.ANNOTAION){var u=s;if(u.hasData(a)){var l=u.getLayerData(a,Ct.FILL);if(l.getType()==Ct.FILL){var h=l.getModel();n.setAttributes(h.attributeInfos);var c=u.getTileCoordinate(),p=1<<c.getZoom(),f=o/p,d=f/S.getTileSize(),g=b.pixelCoordinateToCameraCoordinate(new M(c.getX()*f+f/2,c.getY()*f+f/2),t.mapState),m=r.translate(g.x,g.y,0);m=r.scale(d,d,1).concat(m),n.setUniforms([new Nt("u_color","4fv",e.fillColor.buffer()),new Nt("u_mvpMatrix","matrix",m.concat(t.mapState.getViewProjectionMatrix()))]),h.render()}else console.warn("ERROR: layerData.getType() != LayerType.FILL .............")}}else console.warn("ERROR: tile.getKind() != Kind.Annotation.............")})}}else console.log("Invalid layer type")},e}(ne),ve=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ae=function(t){function e(e,n){return t.call(this,e,n)||this}return ve(e,t),e.prototype.render=function(){if(this.layer.getLayerType()==Ct.CIRCLE){var t=this.layer;if(0!=t.renderTiles.size&&t.visible){var e=ee.Instance.getShader(Yt.CIRCLE_SHADER),n=this.layer.tileManager.mapView.gl;n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),e.bind();var i=ee.Instance.getModel(Ht.CIRCLE_MODEL),o=this.mapState.cameraPosition.getTarget(),a=x.getMetersPerPixelAtLatitude(o.lat(),this.mapState.getZoom()),s=t.radius/a,u=b.pixelCoordinateToCameraCoordinate(x.projectScale(t.center,this.mapState.scale),this.mapState),l=r.translate(u.x,u.y,0);e.setUniforms([new Nt("u_color","4fv",t.fillColor.buffer()),new Nt("u_radius","1f",s),new Nt("u_mvpMatrix","matrix",l.concat(this.mapState.getViewProjectionMatrix()))]),e.setAttributes(i.attributeInfos),i.render()}}else console.log("Invalid layer type")},e}(ne),we=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();!function(t){t[t.Building=0]="Building",t[t.Selection=1]="Selection",t[t.Shadow=2]="Shadow"}(ue||(ue={}));var Me,xe=function(t){function e(e,n,i){var o=t.call(this,n,i)||this;return o.gl=e,o}return we(e,t),e.prototype.render=function(){this.renderInternal(ue.Building)},e.prototype.renderSelection=function(){this.renderInternal(ue.Selection)},e.prototype.renderShadowMapping=function(){this.renderInternal(ue.Shadow)},e.prototype.renderInternal=function(t){if(this.mapState.is3dMode())if(this.layer.getLayerType()==Ct.BUILDING){var e=this.layer;if(0!=e.colorBuildingGroups.size||0!=e.textureBuildingGroups.size||0!=e.extrudeBuildings.length){var n=ee.Instance;this.gl.enable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.CULL_FACE);var i=null;if(t===ue.Building){var o=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;if(this.mapState.getMapBorder()>=a.skyboxMapBorderMinimum&&this.mapState.getTilt()>a.maxTiltIntersectWithScreen){var s=a.defaultMaxNativeZoom,u=1.5*this.mapState.getScreenSize().y,l=Math.pow(2,Math.max(this.mapState.getZoom()-s,0));o=u*l+256,r=this.mapState.getPixelHeight()*l-u}(i=e.effectManager.enableShadowEffect?n.getShader(Yt.BUILDING_WITH_SHADOW_SHADER):n.getShader(Yt.BUILDING_SHADER)).bind();var h=e.lightManager.sunLight,c=this.mapState.timeEffectManager.getFogColor();i.setUniforms([new Nt("u_light_position","3f",h.lightPosition),new Nt("u_light_color","3f",h.lightColor),new Nt("u_fogStart","1f",o),new Nt("u_fogRange","1f",r),new Nt("u_fogColor","3f",c)])}else t===ue.Selection?((i=n.getShader(Yt.BUILDING_SELECTION_SHADER)).bind(),this.resetSelectionCode()):t===ue.Shadow&&(e.effectManager.shadowMap.bind(),(i=n.getShader(Yt.SHADOW_MAPPING_SHADER)).bind());this.renderTextureBuildings(t,e,i),this.renderColorBuildings(t,e,i),this.renderExtrudeBuildings(t,e,i),this.gl.disable(this.gl.DEPTH_TEST),this.gl.disable(this.gl.CULL_FACE),t==ue.Shadow&&e.effectManager.shadowMap.unbind(),i.disableAttributes()}}else console.warn("This layer is not building !")},e.prototype.renderTextureBuildings=function(t,e,n){var i=this;if(0!=e.textureBuildingGroups.size){var r=ee.Instance.getTexture(Gt.WHITE_TEXTURE);e.textureBuildingGroups.forEach(function(s){var u=s.getModel();0!=u.attributeInfos.length&&(n.setAttributes(u.attributeInfos),s.buildings.forEach(function(s){if(t===ue.Building){var l=s.getTexture();if(null==l&&(l=r),(d=e.effectManager).enableShadowEffect){var h=d.shadowMap,c=s.getModelMatrix().concat(h.getLightViewProjectionMatrix()).concat(a.biasMatrix);n.setUniforms([new Nt("u_shadowMap","texture",h.getShadowMapTexture()),new Nt("u_shadowMvpMatrix","matrix",c)])}n.setUniforms([new Nt("u_modelMatrix","matrix",s.getModelMatrix()),new Nt("u_mvpMatrix","matrix",s.getMvpMatrix()),new Nt("u_texture","texture",l),new Nt("u_distance","1f",s.getDistance())])}else if(t===ue.Selection){var p=i.getSelectionCode();s.setSelectionCode(p);var f=O.fromInt(p);n.setUniforms([new Nt("u_color","3f",new o(f.red,f.green,f.blue)),new Nt("u_mvpMatrix","matrix",s.getMvpMatrix())])}else if(t===ue.Shadow){var d;h=(d=e.effectManager).shadowMap,c=s.getModelMatrix().concat(h.getLightViewProjectionMatrix());n.setUniforms([new Nt("u_shadowMvpMatrix","matrix",c)])}u.render(),n.resetTextureUnit()}))})}},e.prototype.renderColorBuildings=function(t,e,n){var i=this;if(0!=e.colorBuildingGroups.size){if(t===ue.Building){var r=ee.Instance.getTexture(Gt.WHITE_TEXTURE);n.setUniforms([new Nt("u_texture","texture",r)]);var s=e.effectManager;if(s.enableShadowEffect){var u=s.shadowMap;n.setUniforms([new Nt("u_shadowMap","texture",u.getShadowMapTexture())])}}e.colorBuildingGroups.forEach(function(r){var s=r.getModel();0!=s.attributeInfos.length&&(n.setAttributes(s.attributeInfos),r.buildings.forEach(function(r){if(t===ue.Building){if((p=e.effectManager).enableShadowEffect){var u=p.shadowMap,l=r.getModelMatrix().concat(u.getLightViewProjectionMatrix()).concat(a.biasMatrix);n.setUniforms([new Nt("u_shadowMvpMatrix","matrix",l)])}n.setUniforms([new Nt("u_modelMatrix","matrix",r.getModelMatrix()),new Nt("u_mvpMatrix","matrix",r.getMvpMatrix()),new Nt("u_distance","1f",r.getDistance())])}else if(t===ue.Selection){var h=i.getSelectionCode();r.setSelectionCode(h);var c=O.fromInt(h);n.setUniforms([new Nt("u_color","3f",new o(c.red,c.green,c.blue)),new Nt("u_mvpMatrix","matrix",r.getMvpMatrix())])}else if(t===ue.Shadow){var p;u=(p=e.effectManager).shadowMap,l=r.getModelMatrix().concat(u.getLightViewProjectionMatrix());n.setUniforms([new Nt("u_shadowMvpMatrix","matrix",l)])}s.render()}))})}n.resetTextureUnit()},e.prototype.renderExtrudeBuildings=function(t,e,n){var i=this;if(0!=e.extrudeBuildings.length){if(t===ue.Building){var r=ee.Instance.getTexture(Gt.WHITE_TEXTURE);n.setUniforms([new Nt("u_texture","texture",r)]);var s=e.effectManager;if(s.enableShadowEffect){var u=s.shadowMap;n.setUniforms([new Nt("u_shadowMap","texture",u.getShadowMapTexture())])}}e.extrudeBuildings.forEach(function(r){if(t!==ue.Shadow){var s=r.getModel();if(null!=s){if(n.setAttributes(s.attributeInfos),t===ue.Building){if((p=e.effectManager).enableShadowEffect){var u=p.shadowMap,l=r.getModelMatrix().concat(u.getLightViewProjectionMatrix()).concat(a.biasMatrix);n.setUniforms([new Nt("u_shadowMvpMatrix","matrix",l)])}n.setUniforms([new Nt("u_modelMatrix","matrix",r.getModelMatrix()),new Nt("u_mvpMatrix","matrix",r.getMvpMatrix()),new Nt("u_distance","1f",r.getDistance())])}else if(t===ue.Selection){var h=i.getSelectionCode();r.setSelectionCode(h);var c=O.fromInt(h);n.setUniforms([new Nt("u_color","3f",new o(c.red,c.green,c.blue)),new Nt("u_mvpMatrix","matrix",r.getMvpMatrix())])}else if(t===ue.Shadow){var p;u=(p=e.effectManager).shadowMap,l=r.getModelMatrix().concat(u.getLightViewProjectionMatrix());n.setUniforms([new Nt("u_shadowMvpMatrix","matrix",l)])}s.render()}}})}n.resetTextureUnit()},e}(ne),_e=function(){function t(){}return t.create=function(t,e,n){switch(n.getLayerType()){case Ct.RASTER:return new ae(e,n);case Ct.BUILDING:return new xe(t,e,n);case Ct.ANNOTATION:return new fe(e,n);case Ct.LINE:return new ge(e,n);case Ct.FILL:return new ye(e,n);case Ct.CIRCLE:return new Ae(e,n);default:console.log("Invalid layer type")}},t}(),be=function(){function t(t,e){this.mapState=e,this.gl=t,this.layerRenderers=Rt(Lt)}return t.prototype.render=function(){this.mapState.is3dMode()&&this.effectManager.enableShadowEffect&&this.layerRenderers.forEach(function(t,e){e.renderShadowMapping()}),this.layerRenderers.forEach(function(t,e){e.render()})},t.prototype.renderSelection=function(){this.layerRenderers.forEach(function(t,e){e.renderSelection()})},t.prototype.addLayer=function(t){this.layerRenderers=this.layerRenderers.insert(new Dt(t.getLayerId(),t.getOrder()),_e.create(this.gl,this.mapState,t))},t.prototype.setEffectManager=function(t){this.effectManager=t},t.prototype.removeLayer=function(t,e){var n=new Dt(t,e);this.layerRenderers=this.layerRenderers.remove(n)},t}(),Te=n(0);!function(t){t[t.Unknown=0]="Unknown",t[t.Point=1]="Point",t[t.LineString=2]="LineString",t[t.Polygon=3]="Polygon"}(Me||(Me={}));var Se=function(){function t(t,e,n){this.properties=new Map,this.type=t,this.geometries=e,this.properties=n}return t.prototype.getType=function(){return this.type},t.prototype.getGeometries=function(){return this.geometries},t}(),Ee=function(){function t(t){this.features=[],this.name=t}return t.prototype.featureCount=function(){return this.features.length},t.prototype.getFeature=function(t){return this.features[t]},t.prototype.getName=function(){return this.name},t}(),Ce=function(){return function(){}}(),Ie=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Re=function(t){function e(e,n,i,o){var r=t.call(this,n,i,o)||this;return r._id=e,r}return Ie(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),e}(Se),De=function(t){function e(e){return t.call(this,e)||this}return Ie(e,t),e.prototype.addFeature=function(t,e,n,i){void 0===i&&(i=new Map),this.features.push(new Re(t,e,n,i))},e}(Ee),Le=function(t){function e(){var e=t.call(this)||this;return e.layerIds=[],e.layers=new Map,e}return Ie(e,t),e.prototype.addLayer=function(t){return this.layers.has(t)||(this.layerIds.push(t),this.layers.set(t,new De(t))),this.layers.get(t)},e.prototype.getLayerIds=function(){return this.layerIds},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e}(Ce),Be=function(){function t(t,e){this._id=t,this._layerId=Mn.annotationLayerId+t.toString(),this._circleAnnotation=e,this.updateBounds()}return t.prototype.updateLayer=function(t){var e=t.getLayer(this._layerId);null==e&&(e=t.createLayer(this._layerId,Ct.CIRCLE,a.circleAnnotationLayerOrder));var n=e;n.setCenter(this._circleAnnotation.getCenter()),n.setRadius(this._circleAnnotation.getRadius()),n.setFillColor(this._circleAnnotation.getFillColor()),n.setFillOpacity(this._circleAnnotation.getFillOpacity()),n.setVisible(this._circleAnnotation.isVisible())},t.prototype.updateBounds=function(){var t=this._circleAnnotation.getCenter(),e=this._circleAnnotation.getRadius(),n=x.convertToMeterFromLatLng(t),i=new M(n.x-e,n.y-e),o=new M(n.x+e,n.y+e),r=new _(x.convertToLatLngFromMeter(i),x.convertToLatLngFromMeter(o));this._minX=r.getSouthwest().lng(),this._minY=r.getSouthwest().lat(),this._maxX=r.getNortheast().lng(),this._maxY=r.getNortheast().lat()},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layerId",{get:function(){return this._layerId},enumerable:!0,configurable:!0}),t.prototype.getAnnotation=function(){return this._circleAnnotation},Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),t}(),Oe=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Pe=function(t){function e(e){var n=t.call(this)||this;n.defaultMarkerOptions={visible:!0,anchor:new A(.5,1),icon:new R(32,32,null),elevation:0,windowAnchor:new A(.5,0),title:"",snippet:""};var i={};return S.extendOptions(i,n.defaultMarkerOptions,e),n._position=g.convert(i.position),n._anchor=A.convert(i.anchor),n._visible=i.visible,n._icon=i.icon,n._elevation=i.elevation,n.title=i.title,n.snippet=i.snippet,n.windowAnchor=i.windowAnchor,n}return Oe(e,t),e.prototype.getTitle=function(){return this.title},e.prototype.getSnippet=function(){return this.snippet},e.prototype.getWindowAnchor=function(){return this.windowAnchor},e.prototype.hideInfoWindow=function(){null!=this._map&&this.isInfoWindowShown()&&this._map.mapView.hideInfoWindow(this._id)},e.prototype.isInfoWindowShown=function(){return null!=this._map&&this._map.mapView.isInfoWindowShown(this._id)},e.prototype.showInfoWindow=function(){null!=this._map&&this.isVisible()&&(this.isInfoWindowShown()||this._map.mapView.showInfoWindow(this._id))},e.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&(this._map.mapView.removeAnnotation(this._id),this._map.mapView.hideInfoWindow(this._id),this._id=-1),this._map=t,null!=this._map&&(this._id=this._map.mapView.addAnnotation(this)))},e.prototype.setPosition=function(t){var e=g.convert(t);this._position.equals(e)||(this._position=e,null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0))},e.prototype.setTitle=function(t){this.title!==t&&(this.title=t,null!=this._map&&this._map.mapView.updateInfoContents(this._id))},e.prototype.setSnippet=function(t){this.snippet!==t&&(this.snippet=t,null!=this._map&&this._map.mapView.updateInfoContents(this._id))},e.prototype.setWindowAnchor=function(t){var e=A.convert(t);this.windowAnchor.equals(e)||(this.windowAnchor=e)},e.prototype.setVisible=function(t){this._visible!==t&&(this._visible=t,null!=this._map&&(this._map.mapView.dirty=!0,t||this.isInfoWindowShown()&&this._map.mapView.hideInfoWindow(this._id)))},e.prototype.setAnchor=function(t){var e=A.convert(t);this._anchor.equals(e)||(this._anchor=e,null!=this._map&&(this._map.mapView.dirty=!0))},e.prototype.setIcon=function(t){this._icon=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id)},e.prototype.setElevation=function(t){this._elevation=t,null!=this._map&&(this._map.mapView.dirty=!0)},e.prototype.getPosition=function(){return new g(this._position.lat(),this._position.lng())},e.prototype.isVisible=function(){return this._visible},e.prototype.getAnchor=function(){return new A(this._anchor.x,this._anchor.y)},e.prototype.getIcon=function(){return this._icon instanceof R?new R(this._icon.width,this._icon.height,this._icon.url):this._icon},e.prototype.getElevation=function(){return this._elevation},e.prototype.getMap=function(){return this._map},e}(E),ke=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ne=function(t){function e(e){var n=t.call(this)||this;n.defaultPolygonOptions={fillColor:"#0000ff",fillOpacity:1,visible:!0};var i={};return S.extendOptions(i,n.defaultPolygonOptions,e),n._paths=i.paths.map(function(t){return t.map(function(t){return g.convert(t)})}),n._fillColor=i.fillColor,n._fillOpacity=i.fillOpacity,n._visible=i.visible,n}return ke(e,t),e.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&(this._map.mapView.removeAnnotation(this._id),this._id=-1),this._map=t,null!=this._map&&(this._id=this._map.mapView.addAnnotation(this)))},e.prototype.setPaths=function(t){this._paths=t.map(function(t){return t.map(function(t){return g.convert(t)})}),null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0)},e.prototype.setFillColor=function(t){this._fillColor!=t&&(this._fillColor=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setFillOpacity=function(t){this._fillOpacity!=t&&(this._fillOpacity=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setVisible=function(t){this._visible!==t&&(this._visible=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.getPaths=function(){return this._paths.slice(0)},e.prototype.getFillColor=function(){return this._fillColor},e.prototype.getFillOpacity=function(){return this._fillOpacity},e.prototype.isVisible=function(){return this._visible},e}(E);function Fe(t,e,n,i,o,r){var a=o-n,s=r-i;if(0!==a||0!==s){var u=((t-n)*a+(e-i)*s)/(a*a+s*s);u>1?(n=o,i=r):u>0&&(n+=a*u,i+=s*u)}return(a=t-n)*a+(s=e-i)*s}function je(t,e,n,i){var o={id:void 0===t?null:t,type:e,geometry:n,tags:i,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(t){var e=t.geometry,n=t.type;if("Point"===n||"MultiPoint"===n||"LineString"===n)Ze(t,e);else if("Polygon"===n||"MultiLineString"===n)for(var i=0;i<e.length;i++)Ze(t,e[i]);else if("MultiPolygon"===n)for(i=0;i<e.length;i++)for(var o=0;o<e[i].length;o++)Ze(t,e[i][o])}(o),o}function Ze(t,e){for(var n=0;n<e.length;n+=3)t.minX=Math.min(t.minX,e[n]),t.minY=Math.min(t.minY,e[n+1]),t.maxX=Math.max(t.maxX,e[n]),t.maxY=Math.max(t.maxY,e[n+1])}function Ve(t,e,n,i){if(e.geometry){var o=e.geometry.coordinates,r=e.geometry.type,a=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2),s=[],u=e.id;if(n.promoteId?u=e.properties[n.promoteId]:n.generateId&&(u=i||0),"Point"===r)We(o,s);else if("MultiPoint"===r)for(var l=0;l<o.length;l++)We(o[l],s);else if("LineString"===r)Ue(o,s,a,!1);else if("MultiLineString"===r){if(n.lineMetrics){for(l=0;l<o.length;l++)s=[],Ue(o[l],s,a,!1),t.push(je(u,"LineString",s,e.properties));return}ze(o,s,a,!1)}else if("Polygon"===r)ze(o,s,a,!0);else{if("MultiPolygon"!==r){if("GeometryCollection"===r){for(l=0;l<e.geometry.geometries.length;l++)Ve(t,{id:u,geometry:e.geometry.geometries[l],properties:e.properties},n,i);return}throw new Error("Input data is not a valid GeoJSON object.")}for(l=0;l<o.length;l++){var h=[];ze(o[l],h,a,!0),s.push(h)}}t.push(je(u,r,s,e.properties))}}function We(t,e){e.push(Ye(t[0])),e.push(He(t[1])),e.push(0)}function Ue(t,e,n,i){for(var o,r,a=0,s=0;s<t.length;s++){var u=Ye(t[s][0]),l=He(t[s][1]);e.push(u),e.push(l),e.push(0),s>0&&(a+=i?(o*l-u*r)/2:Math.sqrt(Math.pow(u-o,2)+Math.pow(l-r,2))),o=u,r=l}var h=e.length-3;e[2]=1,function t(e,n,i,o){for(var r,a=o,s=i-n>>1,u=i-n,l=e[n],h=e[n+1],c=e[i],p=e[i+1],f=n+3;f<i;f+=3){var d=Fe(e[f],e[f+1],l,h,c,p);if(d>a)r=f,a=d;else if(d===a){var g=Math.abs(f-s);g<u&&(r=f,u=g)}}a>o&&(r-n>3&&t(e,n,r,o),e[r+2]=a,i-r>3&&t(e,r,i,o))}(e,0,h,n),e[h+2]=1,e.size=Math.abs(a),e.start=0,e.end=e.size}function ze(t,e,n,i){for(var o=0;o<t.length;o++){var r=[];Ue(t[o],r,n,i),e.push(r)}}function Ye(t){return t/360+.5}function He(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Ge(t,e,n,i,o,r,a,s){if(i/=e,r>=(n/=e)&&a<i)return t;if(a<n||r>=i)return null;for(var u=[],l=0;l<t.length;l++){var h=t[l],c=h.geometry,p=h.type,f=0===o?h.minX:h.minY,d=0===o?h.maxX:h.maxY;if(f>=n&&d<i)u.push(h);else if(!(d<n||f>=i)){var g=[];if("Point"===p||"MultiPoint"===p)Xe(c,g,n,i,o);else if("LineString"===p)Qe(c,g,n,i,o,!1,s.lineMetrics);else if("MultiLineString"===p)Je(c,g,n,i,o,!1);else if("Polygon"===p)Je(c,g,n,i,o,!0);else if("MultiPolygon"===p)for(var m=0;m<c.length;m++){var y=[];Je(c[m],y,n,i,o,!0),y.length&&g.push(y)}if(g.length){if(s.lineMetrics&&"LineString"===p){for(m=0;m<g.length;m++)u.push(je(h.id,p,g[m],h.tags));continue}"LineString"!==p&&"MultiLineString"!==p||(1===g.length?(p="LineString",g=g[0]):p="MultiLineString"),"Point"!==p&&"MultiPoint"!==p||(p=3===g.length?"Point":"MultiPoint"),u.push(je(h.id,p,g,h.tags))}}}return u.length?u:null}function Xe(t,e,n,i,o){for(var r=0;r<t.length;r+=3){var a=t[r+o];a>=n&&a<=i&&(e.push(t[r]),e.push(t[r+1]),e.push(t[r+2]))}}function Qe(t,e,n,i,o,r,a){for(var s,u,l=qe(t),h=0===o?$e:tn,c=t.start,p=0;p<t.length-3;p+=3){var f=t[p],d=t[p+1],g=t[p+2],m=t[p+3],y=t[p+4],v=0===o?f:d,A=0===o?m:y,w=!1;a&&(s=Math.sqrt(Math.pow(f-m,2)+Math.pow(d-y,2))),v<n?A>n&&(u=h(l,f,d,m,y,n),a&&(l.start=c+s*u)):v>i?A<i&&(u=h(l,f,d,m,y,i),a&&(l.start=c+s*u)):Ke(l,f,d,g),A<n&&v>=n&&(u=h(l,f,d,m,y,n),w=!0),A>i&&v<=i&&(u=h(l,f,d,m,y,i),w=!0),!r&&w&&(a&&(l.end=c+s*u),e.push(l),l=qe(t)),a&&(c+=s)}var M=t.length-3;f=t[M],d=t[M+1],g=t[M+2],(v=0===o?f:d)>=n&&v<=i&&Ke(l,f,d,g),M=l.length-3,r&&M>=3&&(l[M]!==l[0]||l[M+1]!==l[1])&&Ke(l,l[0],l[1],l[2]),l.length&&e.push(l)}function qe(t){var e=[];return e.size=t.size,e.start=t.start,e.end=t.end,e}function Je(t,e,n,i,o,r){for(var a=0;a<t.length;a++)Qe(t[a],e,n,i,o,r,!1)}function Ke(t,e,n,i){t.push(e),t.push(n),t.push(i)}function $e(t,e,n,i,o,r){var a=(r-e)/(i-e);return t.push(r),t.push(n+(o-n)*a),t.push(1),a}function tn(t,e,n,i,o,r){var a=(r-n)/(o-n);return t.push(e+(i-e)*a),t.push(r),t.push(1),a}function en(t,e){for(var n=[],i=0;i<t.length;i++){var o,r=t[i],a=r.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)o=nn(r.geometry,e);else if("MultiLineString"===a||"Polygon"===a){o=[];for(var s=0;s<r.geometry.length;s++)o.push(nn(r.geometry[s],e))}else if("MultiPolygon"===a)for(o=[],s=0;s<r.geometry.length;s++){for(var u=[],l=0;l<r.geometry[s].length;l++)u.push(nn(r.geometry[s][l],e));o.push(u)}n.push(je(r.id,a,o,r.tags))}return n}function nn(t,e){var n=[];n.size=t.size,void 0!==t.start&&(n.start=t.start,n.end=t.end);for(var i=0;i<t.length;i+=3)n.push(t[i]+e,t[i+1],t[i+2]);return n}function on(t,e){if(t.transformed)return t;var n,i,o,r=1<<t.z,a=t.x,s=t.y;for(n=0;n<t.features.length;n++){var u=t.features[n],l=u.geometry,h=u.type;if(u.geometry=[],1===h)for(i=0;i<l.length;i+=2)u.geometry.push(rn(l[i],l[i+1],e,r,a,s));else for(i=0;i<l.length;i++){var c=[];for(o=0;o<l[i].length;o+=2)c.push(rn(l[i][o],l[i][o+1],e,r,a,s));u.geometry.push(c)}}return t.transformed=!0,t}function rn(t,e,n,i,o,r){return[Math.round(n*(t*i-o)),Math.round(n*(e*i-r))]}function an(t,e,n,i,o){for(var r=e===o.maxZoom?0:o.tolerance/((1<<e)*o.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:n,y:i,z:e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<t.length;s++){a.numFeatures++,sn(a,t[s],r,o);var u=t[s].minX,l=t[s].minY,h=t[s].maxX,c=t[s].maxY;u<a.minX&&(a.minX=u),l<a.minY&&(a.minY=l),h>a.maxX&&(a.maxX=h),c>a.maxY&&(a.maxY=c)}return a}function sn(t,e,n,i){var o=e.geometry,r=e.type,a=[];if("Point"===r||"MultiPoint"===r)for(var s=0;s<o.length;s+=3)a.push(o[s]),a.push(o[s+1]),t.numPoints++,t.numSimplified++;else if("LineString"===r)un(a,o,t,n,!1,!1);else if("MultiLineString"===r||"Polygon"===r)for(s=0;s<o.length;s++)un(a,o[s],t,n,"Polygon"===r,0===s);else if("MultiPolygon"===r)for(var u=0;u<o.length;u++){var l=o[u];for(s=0;s<l.length;s++)un(a,l[s],t,n,!0,0===s)}if(a.length){var h=e.tags||null;if("LineString"===r&&i.lineMetrics){for(var c in h={},e.tags)h[c]=e.tags[c];h.mapbox_clip_start=o.start/o.size,h.mapbox_clip_end=o.end/o.size}var p={geometry:a,type:"Polygon"===r||"MultiPolygon"===r?3:"LineString"===r||"MultiLineString"===r?2:1,tags:h};null!==e.id&&(p.id=e.id),t.features.push(p)}}function un(t,e,n,i,o,r){var a=i*i;if(i>0&&e.size<(o?a:i))n.numPoints+=e.length/3;else{for(var s=[],u=0;u<e.length;u+=3)(0===i||e[u+2]>a)&&(n.numSimplified++,s.push(e[u]),s.push(e[u+1])),n.numPoints++;o&&function(t,e){for(var n=0,i=0,o=t.length,r=o-2;i<o;r=i,i+=2)n+=(t[i]-t[r])*(t[i+1]+t[r+1]);if(n>0===e)for(i=0,o=t.length;i<o/2;i+=2){var a=t[i],s=t[i+1];t[i]=t[o-2-i],t[i+1]=t[o-1-i],t[o-2-i]=a,t[o-1-i]=s}}(s,r),t.push(s)}}function ln(t,e){var n=(e=this.options=function(t,e){for(var n in e)t[n]=e[n];return t}(Object.create(this.options),e)).debug;if(n&&console.time("preprocess data"),e.maxZoom<0||e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(e.promoteId&&e.generateId)throw new Error("promoteId and generateId cannot be used together.");var i=function(t,e){var n=[];if("FeatureCollection"===t.type)for(var i=0;i<t.features.length;i++)Ve(n,t.features[i],e,i);else"Feature"===t.type?Ve(n,t,e):Ve(n,{geometry:t},e);return n}(t,e);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",e.indexMaxZoom,e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(i=function(t,e){var n=e.buffer/e.extent,i=t,o=Ge(t,1,-1-n,n,0,-1,2,e),r=Ge(t,1,1-n,2+n,0,-1,2,e);return(o||r)&&(i=Ge(t,1,-n,1+n,0,-1,2,e)||[],o&&(i=en(o,1).concat(i)),r&&(i=i.concat(en(r,-1)))),i}(i,e)).length&&this.splitTile(i,0,0,0),n&&(i.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function hn(t,e,n){return 32*((1<<t)*n+e)+t}ln.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ln.prototype.splitTile=function(t,e,n,i,o,r,a){for(var s=[t,e,n,i],u=this.options,l=u.debug;s.length;){i=s.pop(),n=s.pop(),e=s.pop(),t=s.pop();var h=1<<e,c=hn(e,n,i),p=this.tiles[c];if(!p&&(l>1&&console.time("creation"),p=this.tiles[c]=an(t,e,n,i,u),this.tileCoords.push({z:e,x:n,y:i}),l)){l>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",e,n,i,p.numFeatures,p.numPoints,p.numSimplified),console.timeEnd("creation"));var f="z"+e;this.stats[f]=(this.stats[f]||0)+1,this.total++}if(p.source=t,o){if(e===u.maxZoom||e===o)continue;var d=1<<o-e;if(n!==Math.floor(r/d)||i!==Math.floor(a/d))continue}else if(e===u.indexMaxZoom||p.numPoints<=u.indexMaxPoints)continue;if(p.source=null,0!==t.length){l>1&&console.time("clipping");var g,m,y,v,A,w,M=.5*u.buffer/u.extent,x=.5-M,_=.5+M,b=1+M;g=m=y=v=null,A=Ge(t,h,n-M,n+_,0,p.minX,p.maxX,u),w=Ge(t,h,n+x,n+b,0,p.minX,p.maxX,u),t=null,A&&(g=Ge(A,h,i-M,i+_,1,p.minY,p.maxY,u),m=Ge(A,h,i+x,i+b,1,p.minY,p.maxY,u),A=null),w&&(y=Ge(w,h,i-M,i+_,1,p.minY,p.maxY,u),v=Ge(w,h,i+x,i+b,1,p.minY,p.maxY,u),w=null),l>1&&console.timeEnd("clipping"),s.push(g||[],e+1,2*n,2*i),s.push(m||[],e+1,2*n,2*i+1),s.push(y||[],e+1,2*n+1,2*i),s.push(v||[],e+1,2*n+1,2*i+1)}}},ln.prototype.getTile=function(t,e,n){var i=this.options,o=i.extent,r=i.debug;if(t<0||t>24)return null;var a=1<<t,s=hn(t,e=(e%a+a)%a,n);if(this.tiles[s])return on(this.tiles[s],o);r>1&&console.log("drilling down to z%d-%d-%d",t,e,n);for(var u,l=t,h=e,c=n;!u&&l>0;)l--,h=Math.floor(h/2),c=Math.floor(c/2),u=this.tiles[hn(l,h,c)];return u&&u.source?(r>1&&console.log("found parent tile z%d-%d-%d",l,h,c),r>1&&console.time("drilling down"),this.splitTile(u.source,l,h,c,t,e,n),r>1&&console.timeEnd("drilling down"),this.tiles[s]?on(this.tiles[s],o):null):null};var cn,pn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),fn=function(t){function e(e){var n=t.call(this,e)||this;return n.normalizeGeometryCoordinates(),n}return pn(e,t),e.prototype.normalizeGeometryCoordinates=function(){for(var t=[],e=0;e<this.geometryCoordinates.length;++e){for(var n=[],i=0;i<this.geometryCoordinates[e].length;++i)n.push([this.geometryCoordinates[e][i][0]/a.tileExtend-.5,.5-this.geometryCoordinates[e][i][1]/a.tileExtend]);t.push(n)}this.geometryCoordinates=t},e}(function(){return function(t){this.geometryCoordinates=[],this.geometryCoordinates=t}}()),dn=function(){function t(t){this.id=t,this.layerId=Mn.annotationLayerId+t.toString()}return t.prototype.reloadLayout=function(){this.geoJsonIndexer=null},t.prototype.updateTileData=function(t,e){var n=this;if(!this.geoJsonIndexer){var i={maxZoom:a.defaultMaxNativeZoom,buffer:0,extent:a.tileExtend,tolerance:4};this.geoJsonIndexer=function(t,e){return new ln(t,e)}(this.getFeatures(),i)}var o=this.geoJsonIndexer.getTile(t.getZoom(),t.getX(),t.getY());if(null!=o&&0!==o.features.length){var r=e.addLayer(this.layerId);o.features.forEach(function(t){var e=t.type,i=new fn(t.geometry);r.addFeature(n.id,e,i)})}},t.prototype.getLayerId=function(){return this.layerId},t}(),gn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),mn=function(t){function e(e,n){var i=t.call(this,e)||this;return i.polygonAnnotation=n,i}return gn(e,t),e.prototype.getAnnotation=function(){return this.polygonAnnotation},e.prototype.updateLayer=function(t){var e=this.getLayerId(),n=t.getLayer(e);null==n&&(n=t.createLayer(e,Ct.FILL,a.polygonAnnotationLayerOrder));var i=n;i.setFillColor(this.polygonAnnotation.getFillColor()),i.setFillOpacity(this.polygonAnnotation.getFillOpacity()),i.setVisible(this.polygonAnnotation.isVisible())},e.prototype.getFeatures=function(){var t,e=[];this.polygonAnnotation.getPaths().forEach(function(t){var n=[];t.forEach(function(t){return n.push([t.lng(),t.lat()])}),e.push(n)});var n={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:e}}]};return t=JSON.stringify(n,null,2),JSON.parse(t)},e}(dn),yn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),vn=function(t){function e(e){var n=t.call(this)||this;n.defaultPolylineOptions={strokeWidth:0,strokeColor:"#0000ff",strokeOpacity:1,visible:!0,closed:!1};var i={};return S.extendOptions(i,n.defaultPolylineOptions,e),n._path=i.path.map(function(t){return g.convert(t)}),n._strokeWidth=i.strokeWidth,n._strokeColor=i.strokeColor,n._strokeOpacity=i.strokeOpacity,n._visible=i.visible,n.setClosed(i.closed),n}return yn(e,t),e.prototype.setClosed=function(t){if(this._closed!=t){if(this._closed=t,this._closed){if(null!=this._path)if(1==this._path.length){var e=this._path[0];this._path.push(e)}else if(this._path.length>1){e=this._path[0];var n=this._path[this._path.length-1];e.equals(n)||this._path.push(e)}}else if(null!=this._path&&this._path.length>1){e=this._path[0],n=this._path[this._path.length-1];e.equals(n)&&this._path.splice(this._path.length-1,1)}null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0)}},e.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&(this._map.mapView.removeAnnotation(this._id),this._id=-1),this._map=t,null!=this._map&&(this._id=this._map.mapView.addAnnotation(this)))},e.prototype.setPath=function(t){this._path=t.map(function(t){return g.convert(t)}),null!=this._map&&this._map.mapView.updateAnnotation(this._id,!0)},e.prototype.setStrokeWidth=function(t){this._strokeWidth!=t&&(this._strokeWidth=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setStrokeColor=function(t){this._strokeColor!=t&&(this._strokeColor=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setStrokeOpacity=function(t){this._strokeOpacity!=t&&(this._strokeOpacity=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.setVisible=function(t){this._visible!=t&&(this._visible=t,null!=this._map&&this._map.mapView.updateAnnotation(this._id))},e.prototype.getPath=function(){return this._path.slice(0)},e.prototype.getStrokeWidth=function(){return this._strokeWidth},e.prototype.getStrokeColor=function(){return this._strokeColor},e.prototype.getStrokeOpacity=function(){return this._strokeOpacity},e.prototype.isVisible=function(){return this._visible},e.prototype.isClosed=function(){return this._closed},e}(E),An=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),wn=function(t){function e(e,n){var i=t.call(this,e)||this;return i.polylineAnnotation=n,i}return An(e,t),e.prototype.getAnnotation=function(){return this.polylineAnnotation},e.prototype.updateLayer=function(t){var e=this.getLayerId(),n=t.getLayer(e);null==n&&(n=t.createLayer(e,Ct.LINE,a.polylineAnnotationLayerOrder));var i=n;i.setStrokeColor(this.polylineAnnotation.getStrokeColor()),i.setStrokeOpacity(this.polylineAnnotation.getStrokeOpacity()),i.setStrokeWidth(this.polylineAnnotation.getStrokeWidth()),i.setVisible(this.polylineAnnotation.isVisible())},e.prototype.getFeatures=function(){var t,e=[];this.polylineAnnotation.getPath().forEach(function(t){e.push([t.lng(),t.lat()])});var n={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:e}}]};return t=JSON.stringify(n,null,2),JSON.parse(t)},e}(dn),Mn=function(){function t(t){this.idCounter=0,this.markerAnnotations=[],this.tiles=new Map,this.shapeAnnotations=new Map,this.map=t,this.dirty=!1;var e=t.createLayer("annotationLayer",Ct.ANNOTATION,a.markerAnnotationLayerOrder);this.annotationLayer=e,this.circleTree=Te(),this.circleAnnotations=new Map,this.annotationLayer.setMap(t)}return t.prototype.update=function(){var t=this;this.dirty&&(this.tiles.forEach(function(e){var n=t.getTileData(e.getTileCoordinate());t.updateRenderTile(n,e),e.setData(n)}),this.dirty=!1)},t.prototype.addTile=function(t){var e=t.getTileCoordinate(),n=this.getTileData(e);this.updateRenderTile(n,t),t.setData(n),this.tiles.set(e.toString(),t)},t.prototype.removeTile=function(t){var e=this,n=t.getTileData();if(null!=n){var i=n.getLayerIds(),o=t.getTileCoordinate().toString();i.forEach(function(t){var n=e.map.getLayer(t),i=n.getLayerType();if(i==Ct.LINE)n.removeRenderTile(o);else if(i==Ct.FILL){n.removeRenderTile(o)}else if(i==Ct.CIRCLE){n.removeRenderTile(o)}})}this.tiles.delete(t.getTileCoordinate().toString())},t.prototype.getTileData=function(t){if(0==this.markerAnnotations.length&&0==this.shapeAnnotations.size&&0==this.circleAnnotations.size)return null;var e=new Le;this.shapeAnnotations.forEach(function(n){n.updateTileData(t,e)});var n=b.tileCoordinateToLatLngBounds(t),i={minX:n.getSouthwest().lng(),minY:n.getSouthwest().lat(),maxX:n.getNortheast().lng(),maxY:n.getNortheast().lat()};return this.circleTree.search(i).forEach(function(t){return e.addLayer(t.layerId)}),e},t.prototype.addAnnotation=function(t){this.dirty=!0;var e=this.idCounter++;return this.idCounter<0&&(this.idCounter=0),this.addAnnotationInternal(e,t),e},t.prototype.addAnnotationInternal=function(t,e){if(e instanceof Pe)this.markerAnnotations.push(t),this.annotationLayer.addAnnotation(t,e);else if(e instanceof vn){var n=new wn(t,e);n.updateLayer(this.map),this.shapeAnnotations.set(t,n)}else if(e instanceof Ne){var i=new mn(t,e);i.updateLayer(this.map),this.shapeAnnotations.set(t,i)}else if(e instanceof I){var o=new Be(t,e);o.updateLayer(this.map),this.circleAnnotations.set(t,o),this.circleTree.insert(o)}},t.prototype.hideInfoWindow=function(t){this.annotationLayer.hideInfoWindow(t)},t.prototype.isInfoWindowShown=function(t){return this.annotationLayer.isInfoWindowShown(t)},t.prototype.showInfoWindow=function(t){this.annotationLayer.showInfoWindow(t)},t.prototype.deselectMarker=function(){this.annotationLayer.deselectMarker()},t.prototype.selectedMarker=function(t){this.annotationLayer.selectedMarker(t)},t.prototype.setInfoWindow=function(t){this.annotationLayer.setInfoWindow(t)},t.prototype.setInfoContents=function(t){this.annotationLayer.setInfoContents(t)},t.prototype.updateInfoContents=function(t){this.annotationLayer.updateInfoContents(t)},t.prototype.updateAnnotation=function(e,n){if(-1!=this.markerAnnotations.indexOf(e))this.annotationLayer.updateAnnotation(e,n);else if(this.shapeAnnotations.has(e)){var i=this.shapeAnnotations.get(e);if(n){var o=t.annotationLayerId+e.toString();i.reloadLayout(),this.tiles.forEach(function(t){return t.removeLayerData(o)}),this.dirty=!0}i.updateLayer(this.map)}else if(this.circleAnnotations.has(e)){var r=this.circleAnnotations.get(e);r.updateLayer(this.map),n&&(r.updateBounds(),this.circleTree.remove(r),this.circleTree.insert(r),this.dirty=!0)}},t.prototype.removeAnnotation=function(e){this.dirty=!0;var n=this.markerAnnotations.indexOf(e);if(-1!=n)this.markerAnnotations.splice(n,1),this.annotationLayer.removeAnnotation(e);else if(this.shapeAnnotations.has(e)){var i=-1,o=this.shapeAnnotations.get(e);o instanceof mn?i=a.polygonAnnotationLayerOrder:o instanceof wn&&(i=a.polylineAnnotationLayerOrder),this.shapeAnnotations.delete(e),this.map.removeLayer(t.annotationLayerId+e.toString(),i)}else this.circleAnnotations.has(e)?(this.circleTree.remove(this.circleAnnotations.get(e)),this.circleAnnotations.delete(e),this.map.removeLayer(t.annotationLayerId+e.toString(),a.circleAnnotationLayerOrder)):console.error("Invalid annotation's id: "+e)},t.prototype.updateRenderTile=function(t,e){var n=this;if(null!=t){var i=e.getTileCoordinate(),o=i.toString();t.getLayerIds().forEach(function(t){var r=n.map.getLayer(t),a=r.getLayerType(),s=new $(et.createWithXYZoom(i.getX(),i.getY(),i.getZoom()),e);if(a==Ct.LINE)r.addRenderTile(o,s);else if(a==Ct.FILL){r.addRenderTile(o,s)}else if(a==Ct.CIRCLE){r.addRenderTile(o,s)}})}},t.prototype.queryMarkerAnnotation=function(t){var e=this.annotationLayer.getVisibleMarkers();e=e.reverse();for(var n=0;n<e.length;++n){var i=e[n];if(T.pointIntersectsSymbol(new A(t.x,t.y),i,this.map.mapState))return i.getMarker()}return null},t.prototype.queryShapeAnnotation=function(t){var e=this.map.mapState,n=tt.fromLatLng(b.screenCoordinateToLatLng(t,e),e.getZoom(),e.is3dMode()),i=1,o=e.getMaxNativeZoom();if(e.getZoom()>o&&(n=tt.fromLatLng(b.screenCoordinateToLatLng(t,e),e.getMaxNativeZoom(),e.is3dMode()),i=Math.pow(2,Math.round(e.getZoom())-o)),this.tiles.has(n.toString())){var r=this.tiles.get(n.toString()).getTileData();if(null==r||0==r.getLayerIds().length)return null;var a=e.scale,s=n.getX(),u=n.getY(),l=b.pixelCoordinateToVectorTileCoordinate(x.projectScale(b.screenCoordinateToLatLng(t,e),a),s,u,i),h=this.queryShapeAnnotationInternal(new A(l.x,l.y),r),c=h.clickedAnnotation,p=h.clickedAnnotationId;if(null!=c&&c instanceof vn)return c;for(var f=b.tileCoordinateToLatLngBounds(n),d={minX:f.getSouthwest().lng(),minY:f.getSouthwest().lat(),maxX:f.getNortheast().lng(),maxY:f.getNortheast().lat()},g=this.circleTree.search(d),m=0;m<g.length;++m){var y=g[m],v=y.getAnnotation(),w=v.getCenter(),M=v.getRadius(),_=e.getScale(),S=M/x.getMetersPerPixelAtLatitude(e.getCamera().getTarget().lat(),e.getZoom()),E=x.projectScale(w,_),C=b.screenCoordinateToLatLng(t,e),I=x.projectScale(C,_);T.pointIntersectsCircle(new A(I.x,I.y),new A(E.x,E.y),S)&&(null==c||null!=c&&p<y.id)&&(c=this.circleAnnotations.get(y.id).getAnnotation(),p=y.id)}return c}return null},t.prototype.queryShapeAnnotationInternal=function(t,e){for(var n=S.getTileSize(),i=e.getLayerIds(),o=e.getLayerIds().length,r=null,a=null,s=!0,u=0;u<o;++u)for(var l=i[u],h=e.getLayer(l),c=function(e){var i=h.getFeature(e);if(!(i instanceof Re))return"continue";var o=i,u=o.getGeometries().geometryCoordinates,c=p.map.getLayer(l);if(null==c)return console.error("There is problem while querying shape annotation"),{value:null};var f=c.getLayerType();if(f==Ct.LINE){var d=c.getStrokeWidth()/2,g=p.map.mapState;g.getZoom()>g.getMaxNativeZoom()&&(d/=Math.pow(2,Math.round(g.getZoom())-g.getMaxNativeZoom()));var m=[];u.forEach(function(t){var e=[];t.forEach(function(t){return e.push(new A(t[0],t[1]))}),m.push(e)}),T.pointIntersectsBufferedMultiLine(t,m,d/n)&&(null==r||null!=r&&a<o.id)&&(s=!1,r=p.shapeAnnotations.get(o.id).getAnnotation(),a=o.id)}else if(f==Ct.FILL&&s){for(var y=!1,v=function(e){var n=[];if(u[e].forEach(function(t){return n.push(new A(t[0],t[1]))}),0==e){if(!(y=T.polygonIntersectsPolygon([t],n)))return"break"}else if(T.polygonIntersectsPolygon([t],n))return y=!1,"break"},w=0;w<u.length;++w){if("break"===v(w))break}y&&(null==r||null!=r&&a<o.id)&&(r=p.shapeAnnotations.get(o.id).getAnnotation(),a=o.id)}},p=this,f=0;f<h.featureCount();++f){var d=c(f);if("object"==typeof d)return d.value}return{clickedAnnotation:r,clickedAnnotationId:a}},t.annotationLayerId="maplink.annotation.layer.",t}(),xn=function(){function t(t){this.idCounter=0,this.tileManager=t,this.tileAreas=new Map}return t.prototype.addTileArea=function(t){var e=this.idCounter++;return this.tileAreas.set(e,t),this.tileManager.addTileArea(e,t),e},t.prototype.updateTileArea=function(t,e){this.tileAreas.has(t)&&(this.tileAreas.delete(t),this.tileAreas.set(t,e),this.tileManager.updateTileArea(t,e))},t.prototype.removeTileArea=function(t){this.tileAreas.delete(t),this.tileManager.removeTileArea(t)},t}(),_n=function(){function t(t){this.layerType=t}return t.prototype.getType=function(){return this.layerType},t}(),bn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Tn=function(t){function e(e){var n=t.call(this,Ct.RASTER)||this;return n.texture=e,n}return bn(e,t),e.prototype.destroy=function(){this.texture&&this.texture.destroy()},e}(_n),Sn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),En=function(t){function e(e,n){var i=t.call(this,te.RASTER,e,n)||this;return i.buildings=[],i.intialized=!1,i}return Sn(e,t),e.prototype.init=function(t,e){var n=this,i=new $t(this.gl);i.loadImage(t.rasterTile,function(){n.renderable=!0,e()}),this.rasterLayerData=new Tn(i),this.intialized=!0},e.prototype.isInitialized=function(){return this.intialized},e.prototype.getTexture=function(){return this.rasterLayerData?this.rasterLayerData.texture:null},e.prototype.addBuildings=function(t){this.buildings=t},e.prototype.getBuildings=function(){return this.buildings},e.prototype.destroy=function(){this.rasterLayerData&&this.rasterLayerData.destroy()},e}(oe),Cn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),In=function(t){function e(e,n,i){return t.call(this,e,n,Ct.RASTER,i)||this}return Cn(e,t),e.prototype.update=function(){var t=this;this.tileManager.update(function(e){return new En(e,t.tileManager.mapView.gl)})},Object.defineProperty(e.prototype,"effectManager",{get:function(){return this._effectManager},set:function(t){this._effectManager=t},enumerable:!0,configurable:!0}),e}(Pt),Rn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Dn=function(t){function e(e,n){var i=t.call(this,ie.MARKER)||this;return i.marker=e,i.symbolResourceManager=n,i.updateBounds(),i.updateIcon(!1),i}return Rn(e,t),e.prototype.updateIcon=function(t){var e=this;void 0===t&&(t=!0),t&&this.symbolResourceManager.release(this.url);var n=this.marker.getIcon();n instanceof R?(this.url=n.getUrl(),this.width=n.getWidth(),this.height=n.getHeight()):this.url=n,this.texture=this.symbolResourceManager.acquire(this.url,function(t){t&&(null!=e.width&&null!=e.height||(e.width=t.width,e.height=t.height))})},e.prototype.updateBounds=function(){var t=this.marker.getPosition();this.minX=t.lng(),this.minY=t.lat(),this.maxX=t.lng(),this.maxY=t.lat()},e.prototype.destroy=function(){this.symbolResourceManager.release(this.url),this.symbolResourceManager=null,this.texture=null,this.marker=null},e.prototype.getMarker=function(){return this.marker},e.prototype.getTexture=function(){return this.texture},e.prototype.isVisible=function(){return this.marker.isVisible()},e.prototype.getPosition=function(){return this.marker.getPosition()},e.prototype.getAnchor=function(){return this.marker.getAnchor()},e.prototype.getElevation=function(){return this.marker.getElevation()},e.prototype.getWidth=function(){return this.width},e.prototype.getHeight=function(){return this.height},e}(le),Ln=function(){function t(t,e){this.content=t,this.windowAnchor=e}return t.prototype.getContent=function(){return this.content},t.prototype.getPositionByMarker=function(t,e){if(null==this.content)return null;if(t.getShapeType()==ie.MARKER){var n=t,i=n.getMarker(),o=b.latLngToScreenCoordinate(i.getPosition(),i.getElevation(),e);return o.x/=S.pixelScale,o.y/=S.pixelScale,o.x-=this.content.offsetWidth/2,o.y-=this.content.offsetHeight,o.x+=(.5-i.getAnchor().x)*n.getWidth()-(.5-this.windowAnchor.x)*n.getWidth(),o.y+=(.5-i.getAnchor().y)*n.getHeight()-(.5-this.windowAnchor.y)*n.getHeight()-a.infoWindowPadding,new A(o.x,o.y)}return null},t.prototype.setContent=function(t){this.content=t},t}(),Bn=function(){function t(t){this.infoWindows=new Map,this.markerAnnotations=t}return t.prototype.createInfoWindowContainer=function(){this.infoWindowContainer||(this.infoWindowContainer=G.create("div","mf-info-window-container",this.map.getMapContainer()))},t.prototype.createInfoContentsContainer=function(){this.infoContentsContainer||(this.createInfoWindowContainer(),this.infoContentsContainer=G.create("div","mf-info-window-content",this.infoWindowContainer))},t.prototype.createInfoWindow=function(t){var e=this.getInfoWindow(t);return null!=e?(null==this.infoContentsContainer&&(this.infoContentsContainer=G.create("div",null,this.infoWindowContainer)),this.setContentsHTMLElement(e),this.infoContentsContainer):null},t.prototype.createInfoContents=function(t){var e=this.getInfoContents(t);return null!=e?(this.createInfoContentsContainer(),this.setContentsHTMLElement(e),this.infoContentsContainer):null},t.prototype.createDefaultInfoContents=function(t){if(!(""!==t.getTitle()&&null!=t.getTitle()||""!==t.getSnippet()&&null!=t.getSnippet()))return null;this.createInfoContentsContainer();var e=this.getDefaultContents(t);return this.setContentsHTMLElement(e),this.infoContentsContainer},t.prototype.deselectMarker=function(){null!=this.selectedMakerId&&this.hideInfoWindow(this.selectedMakerId)},t.prototype.getDefaultContents=function(t){return"<h4>"+t.getTitle()+"</h4><p>"+t.getSnippet()+"</p>"},t.prototype.getInfoContents=function(t){return null!=this.infoContentsCallback?this.infoContentsCallback(t):null},t.prototype.getInfoWindow=function(t){return null!=this.infoWindowCallback?this.infoWindowCallback(t):null},t.prototype.getInfoWindowHTMLElement=function(t){var e=this.createInfoWindow(t);if(null!=e)return e;var n=this.createInfoContents(t);return null!=n?n:this.createDefaultInfoContents(t)},t.prototype.getSelectedMarkerId=function(){return this.selectedMakerId},t.prototype.isInfoWindowShown=function(t){return null!=this.selectedMakerId&&this.selectedMakerId==t},t.prototype.removeContent=function(){this.infoContentsContainer&&(G.remove(this.infoContentsContainer),this.infoContentsContainer=null)},t.prototype.isValidToShowInfoWindow=function(t){if(this.isInfoWindowShown(t))return!1;var e=this.markerAnnotations.get(t);if(null!=e&&!e.isVisible())return!1;return!0},t.prototype.isMarkerOfInfoWindowVisible=function(t){var e=this,n=!1;return t.forEach(function(t){t.getMarker().getId()==e.getSelectedMarkerId()&&(n=!0)}),n},t.prototype.render=function(t){null!=this.selectedMakerId&&(this.isMarkerOfInfoWindowVisible(t)?this.update():this.infoWindowContainer.style.visibility="hidden")},t.prototype.selectMarker=function(t){this.isValidToShowInfoWindow(t)&&(this.deselectMarker(),this.showInfoWindow(t))},t.prototype.update=function(){var t=this.markerAnnotations.get(this.selectedMakerId);if(null!=t){var e=this.infoWindows.get(this.selectedMakerId).getPositionByMarker(t,this.map.mapState);if(null==e)return;var n=e.x,i=e.y,o=this.infoWindowContainer.style;o.top=i.toString()+"px",o.left=n.toString()+"px","hidden"==o.visibility&&(o.visibility="visible")}},t.prototype.hideInfoWindow=function(t){this.removeContent(),this.infoWindows.delete(t),this.selectedMakerId=null},t.prototype.showInfoWindow=function(t){this.deselectMarker();var e=this.markerAnnotations.get(t);if(null!=e&&e.getShapeType()==ie.MARKER){var n=e.getMarker(),i=this.getInfoWindowHTMLElement(n),o=new Ln(i,n.getWindowAnchor());this.infoWindows.clear(),this.infoWindows.set(t,o),this.selectedMakerId=t,this.update()}},t.prototype.setContentsHTMLElement=function(t){this.infoContentsContainer&&(this.infoContentsContainer.innerHTML=t.toString())},t.prototype.setInfoWindow=function(t){this.infoWindowCallback=t},t.prototype.setInfoContents=function(t){this.infoContentsCallback=t},t.prototype.setMap=function(t){this.map!==t&&(this.map=t,this.createInfoWindowContainer())},t.prototype.updateInfoContents=function(t){var e=this.markerAnnotations.get(t);if(e.getShapeType()==ie.MARKER){var n=e.getMarker(),i=this.getInfoWindowHTMLElement(n),o=this.infoWindows.get(t);null!=o&&(o.setContent(i),this.setContentsHTMLElement(i))}},t}(),On=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Pn=function(t){function e(e,n,i){var o=t.call(this,e,n,Ct.ANNOTATION,i)||this;return o.markerAnnotations=new Map,o.rBushTree=Te(),o.infoWindowManager=new Bn(o.markerAnnotations),o}return On(e,t),e.prototype.update=function(t){this.markerAnnotations.forEach(function(e){e.update(t)})},e.prototype.addAnnotation=function(t,e){if(e instanceof Pe){var n=new Dn(e,this.symbolTextureManager);this.markerAnnotations.set(t,n),this.rBushTree.insert(n)}else console.error("Invalid annotation type: "+e)},e.prototype.deselectMarker=function(){this.infoWindowManager.deselectMarker()},e.prototype.selectedMarker=function(t){this.infoWindowManager.selectMarker(t)},e.prototype.hideInfoWindow=function(t){this.infoWindowManager.hideInfoWindow(t)},e.prototype.isInfoWindowShown=function(t){return this.infoWindowManager.isInfoWindowShown(t)},e.prototype.showInfoWindow=function(t){this.infoWindowManager.showInfoWindow(t)},e.prototype.setInfoWindow=function(t){this.infoWindowManager.setInfoWindow(t)},e.prototype.setInfoContents=function(t){this.infoWindowManager.setInfoContents(t)},e.prototype.updateInfoContents=function(t){this.infoWindowManager.updateInfoContents(t)},e.prototype.setMap=function(t){this.infoWindowManager.setMap(t),this.symbolTextureManager=t.getSymbolResourceManager()},e.prototype.updateAnnotation=function(t,e){if(this.markerAnnotations.has(t)){var n=this.markerAnnotations.get(t);if(n.getShapeType()==ie.MARKER){var i=n;e?(i.updateBounds(),this.rBushTree.remove(i),this.rBushTree.insert(i)):i.updateIcon()}}},e.prototype.removeAnnotation=function(t,e){void 0===e&&(e=null);var n=this.markerAnnotations.get(t);if(n){if(n.getShapeType()==ie.MARKER){var i=n;this.rBushTree.remove(i),i.destroy()}this.markerAnnotations.delete(t)}},e.prototype.getInfoWindowManager=function(){return this.infoWindowManager},e.prototype.getVisibleMarkers=function(){var t=this,e=[];return this.tileManager.getVisibleTiles().forEach(function(n){var i=n.getTileCoordinate(),o=b.tileCoordinateToLatLngBounds(i),r={minX:o.getSouthwest().lng(),minY:o.getSouthwest().lat(),maxX:o.getNortheast().lng(),maxY:o.getNortheast().lat()};t.rBushTree.search(r).forEach(function(t){e.push(t)})}),e},e}(Pt),kn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Nn=function(t){function e(e,n,i){var o=t.call(this,e,n,Ct.LINE,i)||this;return o._strokeWidth=5,o._strokeColor=new O(0,0,0,1),o._strokeOpacity=1,o.renderTiles=new Map,o}return kn(e,t),e.prototype.update=function(t){},e.prototype.setStrokeWidth=function(t){this._strokeWidth=t},e.prototype.setStrokeColor=function(t){null!==t?(this._strokeColor=O.fromHex(t),this._strokeColor.alpha=this._strokeOpacity):this._strokeColor=new O(255,0,0,this._strokeOpacity)},e.prototype.setStrokeOpacity=function(t){this._strokeOpacity=t,this._strokeColor.alpha=this._strokeOpacity},e.prototype.setVisible=function(t){this._visible=t},e.prototype.getStrokeWidth=function(){return this._strokeWidth},e.prototype.getStrokeColor=function(){return this._strokeColor},e.prototype.getStrokeOpacity=function(){return this._strokeOpacity},e.prototype.isVisible=function(){return this._visible},e.prototype.addRenderTile=function(t,e){this.renderTiles.has(t)||this.renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this.renderTiles.delete(t)},e}(Pt),Fn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),jn=function(t){function e(e,n,i){var o=t.call(this,e,n,Ct.FILL,i)||this;return o._fillColor=new O(0,0,0,1),o._fillOpacity=1,o._visible=!0,o._renderTiles=new Map,o}return Fn(e,t),e.prototype.update=function(t){},e.prototype.setFillColor=function(t){null!==t?(this._fillColor=O.fromHex(t),this._fillColor.alpha=this._fillOpacity):this._fillColor=new O(255,0,0,this._fillOpacity)},e.prototype.setFillOpacity=function(t){this._fillOpacity=t,this._fillColor.alpha=this._fillOpacity},e.prototype.setVisible=function(t){this._visible=t},e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this._renderTiles.delete(t)},Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColor",{get:function(){return this._fillColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillOpacity",{get:function(){return this._fillOpacity},enumerable:!0,configurable:!0}),e}(Pt),Zn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Vn=function(t){function e(e,n,i){var o=t.call(this,e,n,Ct.CIRCLE,i)||this;return o._center=new g(0,0),o._radius=0,o._fillColor=new O(0,0,0,1),o._fillOpacity=1,o._visible=!0,o._renderTiles=new Map,o}return Zn(e,t),e.prototype.update=function(t){},e.prototype.setCenter=function(t){this._center=t},e.prototype.setRadius=function(t){this._radius=t},e.prototype.setFillColor=function(t){null!==t?(this._fillColor=O.fromHex(t),this.fillColor.alpha=this.fillOpacity):this._fillColor=new O(255,0,0,this.fillOpacity)},e.prototype.setFillOpacity=function(t){this._fillOpacity=t,this.fillColor.alpha=this.fillOpacity},e.prototype.setVisible=function(t){this._visible=t},Object.defineProperty(e.prototype,"center",{get:function(){return this._center},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"radius",{get:function(){return this._radius},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillColor",{get:function(){return this._fillColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillOpacity",{get:function(){return this._fillOpacity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderTiles",{get:function(){return this._renderTiles},enumerable:!0,configurable:!0}),e.prototype.addRenderTile=function(t,e){this._renderTiles.has(t)||this._renderTiles.set(t,e)},e.prototype.removeRenderTile=function(t){this._renderTiles.delete(t)},e}(Pt),Wn=function(){function t(t){this.buildings=[],this.id=t}return t.prototype.addBuilding=function(t){this.buildings.push(t)},t.prototype.getModel=function(){return 0==this.buildings.length?null:this.buildings[0].getModel()},t}(),Un=function(){function t(t){if(this.defaultMapObjectOptions={name:"object",scale:1,bearing:0,elevation:0,heightScale:1,objUrl:null,textureUrl:null,objData:null,textureData:null,objName:null,textureName:null},null!=t){var e={};S.extendOptions(e,this.defaultMapObjectOptions,t),this._id=e.id,this._location=g.convert(e.location),this._name=e.name,this._scale=e.scale,this._bearing=e.bearing,this._elevation=e.elevation,this._heightScale=e.heightScale,null!=e.objUrl?this._objUrl=e.objUrl:null!=e.objData?this._objData=e.objData:null!=e.objName&&(this._objUrl=e.objName),null!=e.textureUrl?this._textureUrl=e.textureUrl:null!=e.textureData?this._textureData=e.textureData:null!=e.textureName&&(this._textureUrl=e.textureName)}}return t.prototype.initWithBuilding=function(t){this._id=t.getId(),this._name=t.getName(),this._places=t.getPlaces(),this._scale=t.getScale(),this._bearing=t.getBearing(),this._location=t.getLocation(),this._elevation=t.getElevation(),this._heightScale=t.getHeightScale(),this._camera=t.getCamera(),this._types=t.getTypes(),this._minZoom=t.getMinZoom(),this._maxZoom=t.getMaxZoom(),this._startDate=new Date(t.getStartDate()),this._endDate=new Date(t.getEndDate())},t.prototype.getId=function(){return this._id},t.prototype.getName=function(){return this._name},t.prototype.getPlaces=function(){return this._places},t.prototype.getScale=function(){return this._scale},t.prototype.getBearing=function(){return this._bearing},t.prototype.getLocation=function(){return this._location},t.prototype.getElevation=function(){return this._elevation},t.prototype.getHeightScale=function(){return this._heightScale},t.prototype.getCamera=function(){return this._camera},t.prototype.getTypes=function(){return this._types},t.prototype.getMaxZoom=function(){return this._maxZoom},t.prototype.getStartDate=function(){return this._startDate},t.prototype.getEndDate=function(){return this._endDate},t.prototype.getTextureData=function(){return this._textureData},t.prototype.getTextureUrl=function(){return this._textureUrl},t.prototype.getObjData=function(){return this._objData},t.prototype.getObjUrl=function(){return this._objUrl},t.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&this._map.mapView.removeMapObject(this._id),this._map=t,null!=this._map&&this._map.mapView.addMapObject(this))},t}(),zn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Yn=function(t){function e(e,n,i){var o=t.call(this,e,n,Ct.BUILDING,i)||this;return o.extrudeBuildings=[],o.dirty=!0,o.colorBuildingGroups=new Map,o.textureBuildingGroups=new Map,o._selectedObjectMap=new Map,o}return zn(e,t),e.prototype.update=function(t){var e=this;if(t.is3dMode()&&(this.buildingResourceManager.update(),this.dirty)){this.dirty=!1;var n=t.getZoom(),i=t.getScale(),o=t.getScreenSize(),r=x.projectScale(b.screenCoordinateToLatLngZoom(new M(o.x,o.y),t,n),i),a=x.projectScale(b.screenCoordinateToLatLngZoom(new M(0,o.y),t,n),i);this.colorBuildingGroups.clear(),this.textureBuildingGroups.clear(),this.extrudeBuildings=[];var s=[];s.push([a.x,a.y]),s.push([r.x,r.y]),this.buildingResourceManager.buildings.forEach(function(n){if(e.isInFilterPlaceTypes(n.getTypes())){n.updateMatrices(t),n.setDistance(wt.calculateDistanceBetweenPointToLine(x.projectScale(n.getLocation(),i),s)),n.setSelected(e._selectedObjectMap.has(n.getId()));var o=n.getObjName();if(n.getBuildingType()==ut.Color){var r=e.colorBuildingGroups.get(o);if(null==r)(a=new Wn(o)).addBuilding(n),e.colorBuildingGroups.set(o,a);else r.addBuilding(n)}else if(n.getBuildingType()==ut.Polygon)e.extrudeBuildings.push(n);else{var a,u=e.textureBuildingGroups.get(o);if(null==u)(a=new Wn(o)).addBuilding(n),e.textureBuildingGroups.set(o,a);else u.addBuilding(n)}}}),this.lightManager.update(t.getCamera().getTarget())}},e.prototype.setDirty=function(){this.dirty=!0},e.prototype.getBuildingResourceManager=function(){return this.buildingResourceManager},e.prototype.setBuildingResourceManager=function(t){var e=this;this.buildingResourceManager=t,this.buildingResourceManager.setBuildingLayerDirty=function(){e.setDirty()}},e.prototype.setLightingManager=function(t){this.lightManager=t},e.prototype.getBuilding=function(t){if(t<0)return null;if(0==this.colorBuildingGroups.size&&0==this.textureBuildingGroups.size&&0==this.extrudeBuildings.length)return null;var e=null;if(0!=this.textureBuildingGroups.size&&this.textureBuildingGroups.forEach(function(n){n.buildings.forEach(function(n){n.getSelectionCode()!=t||(e=n)})}),null==e&&0!=this.colorBuildingGroups.size&&this.colorBuildingGroups.forEach(function(n){n.buildings.forEach(function(n){n.getSelectionCode()!=t||(e=n)})}),null==e&&0!=this.extrudeBuildings.length&&this.extrudeBuildings.forEach(function(n){n.getSelectionCode()!=t||(e=n)}),null!=e){var n=new Un;return n.initWithBuilding(e),n}return null},Object.defineProperty(e.prototype,"effectManager",{get:function(){return this._effectManager},set:function(t){this._effectManager=t},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.colorBuildingGroups.clear(),this.textureBuildingGroups.clear(),this.extrudeBuildings=[]},Object.defineProperty(e.prototype,"filterPlaceTypes",{get:function(){return this._filterPlaceTypes},set:function(t){this._filterPlaceTypes=t,this.dirty=!0},enumerable:!0,configurable:!0}),e.prototype.getSelectedObjectIds=function(){return Array.from(this._selectedObjectMap.keys())},e.prototype.setSelectedObjectIds=function(t){var e=this;this._selectedObjectMap.clear(),t&&(t.forEach(function(t){return e._selectedObjectMap.set(t,!0)}),this.dirty=!0)},e.prototype.isInFilterPlaceTypes=function(t){return!this._filterPlaceTypes||!!t&&this._filterPlaceTypes.some(function(e){return-1!==t.indexOf(e)})},e}(Pt),Hn=function(){function t(){}return t.createLayer=function(t,e,n,i){switch(e){case Ct.RASTER:return new In(t,i,n);case Ct.BUILDING:return new Yn(t,i,n);case Ct.ANNOTATION:return new Pn(t,i,n);case Ct.LINE:return new Nn(t,i,n);case Ct.FILL:return new jn(t,i,n);case Ct.CIRCLE:return new Vn(t,i,n);default:return console.log("Un-support layer type"),null}},t}(),Gn=function(){function t(t,e){var n=this;this.watchId=-1,this.userLocationDotId=-1,this.userLocationDot=null,this.lastKnownLocation=null,this.defaultPositionOptions={enableHighAccuracy:!0,maximumAge:0,timeout:6e3},this.mapView=e,null!=t&&(this.myLocationButton=G.create("div","mf-button",t),this.myLocationButton.innerHTML="<a class='mf-location'></a>",this.myLocationButton.addEventListener("click",function(){n.onMyLocationButtonClick()}))}return t.prototype.flyToMyLocation=function(t){void 0===t&&(t=!0),-1==this.watchId&&(this.watchId=window.navigator.geolocation.watchPosition(this.onGetCurrentPositionSuccess.bind(this),this.onGetCurrentPositionError.bind(this),this.defaultPositionOptions)),null!=this.lastKnownLocation&&this.mapView.flyTo(this.lastKnownLocation,16,{animate:t})},t.prototype.onMyLocationButtonClick=function(){this.flyToMyLocation()},t.prototype.onGetCurrentPositionSuccess=function(t){var e=new g(t.coords.latitude,t.coords.longitude);if(null==this.lastKnownLocation&&this.mapView.flyTo(e,16,{animate:!0}),this.lastKnownLocation=e,null==this.userLocationDot){var n=new R(32,32,D.get("myPosition"));this.userLocationDot=new Pe({position:e,visible:!0,anchor:new A(.5,.5),icon:n}),this.userLocationDotId=this.mapView.addAnnotation(this.userLocationDot)}else this.userLocationDot.setPosition(e),this.userLocationDot.setVisible(!0)},t.prototype.onGetCurrentPositionError=function(t){1===t.code&&(-1!=this.watchId&&(window.navigator.geolocation.clearWatch(this.watchId),this.watchId=-1),-1!=this.userLocationDotId&&(this.mapView.removeAnnotation(this.userLocationDotId),this.userLocationDotId=-1,this.userLocationDot=null))},t}(),Xn=function(){function t(t,e){this._id=t,this._eventCallback=e}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventCallBack",{get:function(){return this._eventCallback},enumerable:!0,configurable:!0}),t}(),Qn=function(){function t(t){this.eventIdCounter=0,this.events=new Map,this.mapView=t}return t.convertEventFromName=function(t){switch(t){case"cameraWillChange":return L.cameraWillChange;case"cameraChanging":return L.cameraChanging;case"idle":return L.idle;case"click":return L.click;case"dblClick":return L.dblClick;case"drag":return L.drag;case"dragEnd":return L.dragEnd;case"dragStart":return L.dragStart;case"mouseMove":return L.mouseMove;case"mouseOut":return L.mouseOut;case"mouseOver":return L.mouseOver;case"rightClick":return L.rightClick;case"markerClick":return L.markerClick;case"objectClick":return L.objectClick;case"polylineClick":return L.polylineClick;case"polygonClick":return L.polygonClick;case"circleClick":return L.circleClick;case"modeChanged":return L.modeChanged;case"markerHover":return L.markerHover;case"objectHover":return L.objectHover;case"polygonHover":return L.polygonHover;case"polylineHover":return L.polylineHover;case"circleHover":return L.circleHover;default:throw new Error("Event not supported: "+t)}},t.prototype.addEvent=function(e,n){var i="string"==typeof e?t.convertEventFromName(e):e,o=this.eventIdCounter++;this.events.has(i)?this.events.get(i).push(new Xn(o,n)):this.events.set(i,[new Xn(o,n)]);var r=this.events;return new(function(){function t(){}return t.prototype.remove=function(){if(r.has(i)){var t=r.get(i),e=t.findIndex(function(t){return t.id==o});e>=0&&t.splice(e,1),0===t.length&&r.delete(i)}},t}())},t.prototype.removeEvent=function(e){var n=t.convertEventFromName(e);this.events.has(n)&&this.events.delete(n)},t.prototype.onHoverEvent=function(t){if(!this.mapView.getBuildingSelectionIconManager().onHover(t)){var e=this.events.get(L.markerHover);if(null!=e&&0!=e.length){var n=this.mapView.queryMarkerAnnotation(t);if(null!=n&&null!=n.getMap())return e.forEach(function(t){return t.eventCallBack({marker:n})}),!0}var i=this.events.get(L.objectHover);if(null!=i&&0!=i.length&&this.mapView.mapState.is3dMode()){var o=this.mapView.queryBuildingInfo(t);if(null!=o)return i.forEach(function(t){return t.eventCallBack({object:o})}),!0}var r=this.events.get(L.polylineHover),a=this.events.get(L.polygonHover),s=this.events.get(L.circleHover);if(null!=r&&0!=r.length||null!=a&&0!=a.length||null!=s&&0!=s.length){var u=this.mapView.queryShapeAnnotation(t);if(null!=u)if(u instanceof vn){if(null!=r&&0!=r.length)return r.forEach(function(t){return t.eventCallBack({polyline:u})}),!0}else if(u instanceof Ne){if(null!=a&&0!=a.length)return a.forEach(function(t){return t.eventCallBack({polygon:u})}),!0}else if(u instanceof I&&null!=s&&0!=s.length)return s.forEach(function(t){return t.eventCallBack({circle:u})}),!0}return!1}this.mapView.deselectMarker()},t.prototype.onClickEvent=function(t,e){var n=this.events.get(L.markerClick),i=this.mapView.queryMarkerAnnotation(t);if(null!=n&&0!=n.length){if(null!=i&&null!=i.getMap())return n.forEach(function(t){return t.eventCallBack({marker:i,xa:e})}),this.mapView.selectedMarker(i.getId()),!0}else if(null!=i&&null!=i.getMap())return this.mapView.selectedMarker(i.getId()),!0;this.mapView.deselectMarker();var o=this.events.get(L.objectClick);if(null!=o&&0!=o.length&&this.mapView.mapState.is3dMode()){var r=this.mapView.queryBuildingInfo(t);if(null!=r)return o.forEach(function(t){return t.eventCallBack({object:r,xa:e})}),!0}var a=this.events.get(L.polylineClick),s=this.events.get(L.polygonClick),u=this.events.get(L.circleClick);if(null!=a&&0!=a.length||null!=s&&0!=s.length||null!=u&&0!=u.length){var l=this.mapView.queryShapeAnnotation(t);if(null!=l)if(l instanceof vn){if(null!=a&&0!=a.length)return a.forEach(function(t){return t.eventCallBack({polyline:l,xa:e})}),!0}else if(l instanceof Ne){if(null!=s&&0!=s.length)return s.forEach(function(t){return t.eventCallBack({polygon:l,xa:e})}),!0}else if(l instanceof I&&null!=u&&0!=u.length)return u.forEach(function(t){return t.eventCallBack({circle:l,xa:e})}),!0}return!1},t.prototype.notify=function(t,e,n){var i=this,o=this.events.get(t);if(o&&Array.isArray(o)&&0!==o.length)switch(t){case L.click:case L.rightClick:case L.dblClick:case L.dragStart:case L.drag:case L.dragEnd:case L.mouseMove:case L.mouseOut:case L.mouseOver:var r=this.mapView.getCurrentMousePosition(e),a=new A(r.x,r.y),s=S.pixelToPoint(a);o.forEach(function(t){return t.eventCallBack({location:b.screenCoordinateToLatLng(r,i.mapView.mapState),point:s,pixel:a,xa:e})});break;case L.cameraWillChange:var u=this.mapView.getCamera();o.forEach(function(t){return t.eventCallBack({camera:new m(u.getTarget(),u.getTilt(),u.getBearing(),u.getZoom()),gesture:n})});break;case L.cameraChanging:case L.idle:var l=this.mapView.getCamera();o.forEach(function(t){return t.eventCallBack({camera:new m(l.getTarget(),l.getTilt(),l.getBearing(),l.getZoom())})});break;case L.modeChanged:o.forEach(function(t){return t.eventCallBack({is3DMode:i.mapView.mapSettings.is3dMode()})});break;default:o.forEach(function(t){return t.eventCallBack()})}},t.prototype.destroy=function(){this.events.clear()},t}(),qn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Jn=function(t){function e(e,n){var i=t.call(this,Ct.LINE)||this;return i.gl=n,i.buildPolyline(e),i}return qn(e,t),e.prototype.getModel=function(){return this.lineModel},e.prototype.buildPolyline=function(t){var e=[],n=new Xt;n.addVertex=function(t,n){e.push(t.x,t.y,n.x,n.y)},n.lineCapType=Bt.Butt,n.lineJoinType=Ot.Round;for(var i=S.getTileSize(),o=t.featureCount(),r=0;r<o;++r){var a=t.getFeature(r);if(a.getType()!=Me.LineString)return void console.warn("# buildPolyline ----------- not GeometryType.LineString");for(var s=a.getGeometries().geometryCoordinates,u=0;u<s.length;++u){for(var l=[],h=0;h<s[u].length;++h){var c=new M(s[u][h][0],s[u][h][1]);c.x=c.x*i,c.y=c.y*i,l.push(c)}n.buildPolyLine(l)}return this.lineModel=new Zt(this.gl,this.gl.TRIANGLES),void this.lineModel.init(e,[new kt("a_position",null,2,0,4),new kt("a_extrude",null,2,2,4)],n.indices)}},e.prototype.destroy=function(){this.lineModel&&this.lineModel.destroy()},e}(_n),Kn=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),$n=function(t){function e(e,n){var i=t.call(this,Ct.FILL)||this;return i.gl=n,i.buildPolygon(e),i}return Kn(e,t),e.prototype.getModel=function(){return this.fillModel},e.prototype.buildPolygon=function(t){var e=[],n=new Ut;n.addVertex=function(t){e.push(t.x,t.y)};for(var i=S.getTileSize(),o=t.featureCount(),r=0;r<o;++r){var a=t.getFeature(r);if(a.getType()!=Me.Polygon)return void console.warn("# buildPolygon ----------- not GeometryType.Polygon");for(var s=a.getGeometries().geometryCoordinates,u=[],l=0;l<s.length;++l){for(var h=[],c=0;c<s[l].length;++c){var p=new M(s[l][c][0],s[l][c][1]);p.x=p.x*i,p.y=p.y*i,h.push(p)}u.push(h)}return zt(u,n),this.fillModel=new Zt(this.gl,this.gl.TRIANGLES),void this.fillModel.init(e,[new kt("a_position",null,2,0,2)],n.indices)}},e.prototype.destroy=function(){this.fillModel&&this.fillModel.destroy()},e}(_n),ti=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ei=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.gl=i,o.layerDatas=new Map,o.tileData=null,o}return ti(e,t),e.prototype.getTexture=function(){return null},e.prototype.init=function(t,e){},e.prototype.setData=function(t){this.tileData=t},e.prototype.hasData=function(t){return null!=this.tileData&&null!=this.tileData.getLayer(t)},e.prototype.removeLayerData=function(t){var e=this.layerDatas.get(t);e&&(e.destroy(),this.layerDatas.delete(t))},e.prototype.getLayerData=function(t,e){if(!this.layerDatas.has(t)){var n=this.tileData.getLayer(t);if(null==n)return console.error("getLayerData not reachable"),null;switch(e){case Ct.LINE:var i=new Jn(n,this.gl);return this.layerDatas.set(t,i),this.layerDatas.get(t);case Ct.FILL:var o=new $n(n,this.gl);return this.layerDatas.set(t,o),this.layerDatas.get(t);default:return console.error("getLayerData not reachable"),null}}return this.layerDatas.get(t)},e.prototype.getTileData=function(){return this.tileData},e}(oe),ni=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ii=function(t){function e(e,n,i){var o=t.call(this,te.ANNOTAION,e,i)||this;return o.annotationManager=n,o.annotationManager.addTile(o),o}return ni(e,t),e.prototype.destroy=function(){this.layerDatas.forEach(function(t){return t.destroy()}),this.annotationManager.removeTile(this)},e}(ei),oi=function(){function t(t,e,n){this.gl=t,this.buildings=new Map,this.models=new Map,this.textures=new Map,this.buildingTaskManager=e,this.modelRequestsMap=new Map,this.textureRequestsMap=new Map,this.setBuildingLayerDirty=function(){},this.requestRender=n,this.modelBuildingsMap=new Map}return t.prototype.hasBuilding=function(t){return this.buildings.has(t)},t.prototype.getBuilding=function(t){return this.buildings.has(t)?this.buildings.get(t):null},t.prototype.addBuildingWithData=function(t,e,n,i){if(e.getBuildingType()==ut.Polygon&&!this.buildings.has(t)){var o=new Zt(this.gl,this.gl.TRIANGLES),r=[].concat.apply([],n);o.init3dObject(r,i),e.setModel(o),e.setHeight(e.getScale().z+e.getElevation()),e.setHighestPosition(e.getLocation()),e.notifyModelDownloaded(),e.retain(),this.buildings.set(t,e),this.setBuildingLayerDirty()}},t.prototype.addBuilding=function(t,e){var n=this;if(e.getBuildingType()!=ut.Polygon&&!this.buildings.has(t)){e.retain();var i=e.getObjName(),o=this.models.get(i);if(null!=o){o.retain(),e.setModel(o);var r=this.modelBuildingsMap.get(i);r?r.push(e):this.updateSelectedBuildingInformation(e,o.getHighestModelPosition())}else{var s=e.getObjData();if(null!=s){var u=new Zt(this.gl,this.gl.TRIANGLES);u.retain(),this.models.set(i,u),e.setModel(u);var l=Tt.loadModel(s);if(null!=l&&l.length>0){var h=l[0].highestPosition;u.setHighestModelPosition(h),this.updateSelectedBuildingInformation(e,h),u.init3dObject(l[0].data),this.requestRender()}}else this.modelBuildingsMap.set(i,[e]),this.requestModel(i),e.setModel(this.models.get(i))}var c=e.getTextureName(),p=this.textures.get(c);if(null!=p)p.retain(),e.setTexture(p);else{var f=new $t(this.gl);f.retain(),this.textures.set(c,f),e.setTexture(f);var d=e.getTextureData();if(null!=d)f.loadImage(d);else{var g=null;if(null==c){console.warn("You do not set Url for custom Texture. Please set first !");var m=ee.Instance.getTexture(Gt.WHITE_TEXTURE);return f=m,void this.buildings.set(t,e)}g=at.isUrlRequest(c)?c:at.getBuildingDataUrl(a.baseTextureRequestUrl,c,J.getAccessKey());var y=new lt(rt.Texture);y.url=g,y.completion=function(t){if(null!=t.data){f.loadImageFromBlob(t.data,function(){n.textureRequestsMap.delete(c),n.requestRender()})}},this.textureRequestsMap.set(c,y),this.buildingTaskManager.postTask(y)}}this.buildings.set(t,e),this.setBuildingLayerDirty()}},t.prototype.removeAllResources=function(){var t=this;this.buildings.forEach(function(t){return t.destroy()}),this.models.forEach(function(t){return t.destroy()}),this.textures.forEach(function(t){return t.destroy()}),this.buildings.clear(),this.models.clear(),this.textures.clear(),this.modelRequestsMap.forEach(function(e){t.buildingTaskManager.cancelTask(e)}),this.modelRequestsMap.clear(),this.textureRequestsMap.forEach(function(e){t.buildingTaskManager.cancelTask(e)}),this.textureRequestsMap.clear()},t.prototype.increaseBuildingReference=function(t){var e=this.buildings.get(t);null!=e?e.retain():console.warn("Can not find any building with id: "+t+" to increase reference !")},t.prototype.decreaseBuildingReference=function(t){var e=this.buildings.get(t);if(null!=e){if(e.release(),!e.reference){if(e.getBuildingType()!=ut.Polygon){var n=e.getObjName();this.decreaseModelReference(n);var i=e.getTextureName();this.decreaseTextureReference(i)}this.buildings.delete(t)}this.setBuildingLayerDirty()}},t.prototype.decreaseTextureReference=function(t){var e=this.textures.get(t);if(null!=e){if(e.release(),!e.reference){var n=this.textureRequestsMap.get(t);n&&(this.buildingTaskManager.cancelTask(n),this.textureRequestsMap.delete(t)),this.textures.delete(t)}}else console.error("Can not find texture with id: "+t+" for building !")},t.prototype.decreaseModelReference=function(t){var e=this.models.get(t);if(null!=e){if(e.release(),!e.reference){var n=this.modelRequestsMap.get(t);null!=n&&(this.buildingTaskManager.cancelTask(n),this.modelRequestsMap.delete(t)),this.models.delete(t)}}else console.error("Can not find model with id: "+t+" for building !")},t.prototype.removeBuildings=function(t){var e=this;Array.from(this.buildings.values()).filter(function(e){return null==t||t(e)}).forEach(function(t){e.deleteBuilding(t.getId())})},t.prototype.update=function(){},t.prototype.deleteBuilding=function(t){var e=this.buildings.get(t);if(null!=e){if(e.getBuildingType()!=ut.Polygon){var n=e.getObjName();this.decreaseModelReference(n);var i=e.getTextureName();this.decreaseTextureReference(i)}e.destroy(),this.buildings.delete(t),this.setBuildingLayerDirty()}},t.prototype.requestModel=function(t){var e=this,n=new Zt(this.gl,this.gl.TRIANGLES);n.retain(),this.models.set(t,n);var i=null;if(null!=t){i=at.isUrlRequest(t)?t:at.getBuildingDataUrl(a.baseModelRequestUrl,t,J.getAccessKey());var o=new lt(rt.Model);o.url=i,o.completion=function(i){if(null!=i.data){var o=i.data[0].highestPosition;n.init3dObject(i.data[0].data),n.setHighestModelPosition(o);var r=e.modelBuildingsMap.get(t);r&&(r.forEach(function(t){e.updateSelectedBuildingInformation(t,o)}),e.modelBuildingsMap.delete(t)),e.modelRequestsMap.delete(t),e.requestRender()}},this.modelRequestsMap.set(t,o),this.buildingTaskManager.postTask(o)}else console.error("You do not set Url for Model. Please set first !")},t.prototype.updateSelectedBuildingInformation=function(t,e){if(e){var n=t.getLocation(),i=t.getBearing()*s.deg2Rad,o=t.getScale(),r=x.convertToMeterFromLatLng(n);r.x-=Math.cos(i)*e.z*o.y-Math.sin(i)*e.x*o.x,r.y+=Math.cos(i)*e.x*o.x+Math.sin(i)*e.z*o.y,t.setHighestPosition(x.convertToLatLngFromMeter(r)),t.setHeight(e.y*o.z+t.getElevation()),t.notifyModelDownloaded()}},t}(),ri=function(){function t(t,e,n){this.gl=t,this.width=e,this.height=n,this.init()}return t.prototype.init=function(){var t=this.gl,e=new qt(t.NEAREST,t.NEAREST),n=new Jt(t.CLAMP_TO_EDGE,t.CLAMP_TO_EDGE),i=new Kt(t.TEXTURE_2D,t.RGB,t.RGB,t.UNSIGNED_BYTE,e,n);this.colorTexture=new $t(t,i),this.colorTexture.initFrameBufferTexture(this.width,this.height),this.depthBuffer=this.gl.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this.depthBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.height),t.bindRenderbuffer(t.RENDERBUFFER,null),this.frameBufferId=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.frameBufferId),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.colorTexture.textureId,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,this.depthBuffer);var o=t.checkFramebufferStatus(t.FRAMEBUFFER);if(o!=t.FRAMEBUFFER_COMPLETE){switch(o){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.warn("FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.warn("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.warn("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case t.FRAMEBUFFER_UNSUPPORTED:console.warn("FRAMEBUFFER_UNSUPPORTED");break;default:console.warn("Unknown framebuffer issue")}return t.bindFramebuffer(t.FRAMEBUFFER,null),!1}return t.bindFramebuffer(t.FRAMEBUFFER,null),!0},t.prototype.bind=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.frameBufferId)},t.prototype.unbind=function(){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null)},t.prototype.drawDebug=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT);var t=ee.Instance.getShader(Yt.DEBUG_SELECTION_SHADER),e=ee.Instance.getModel(Ht.SELECTION_DEBUG_MODEL);t.bind(),t.setAttributes(e.attributeInfos),t.setUniforms([new Nt("u_texture","texture",this.colorTexture)]),e.render(),t.resetTextureUnit()},t.prototype.destroy=function(){this.colorTexture&&this.colorTexture.destroy(),this.gl.deleteRenderbuffer(this.depthBuffer),this.gl.deleteFramebuffer(this.frameBufferId),this.colorTexture=null,this.depthBuffer=null,this.frameBufferId=null},t}(),ai=function(){function t(t,e){this.defaultKey="markerDefault",this.gl=t,this.requestRender=e,this.textures=new Map}return t.prototype.acquire=function(t,e){var n=this;void 0===e&&(e=null),null==t&&(t=this.defaultKey);var i=this.textures.get(t);return null!=i?(i.retain(),e&&e(i),this.requestRender(),i):((i=new $t(this.gl)).loadImageFromUrl(t==this.defaultKey?D.get(t):t,function(){n.requestRender(),e&&e(i)}),i.retain(),this.textures.set(t,i),i)},t.prototype.release=function(t){null==t&&(t=this.defaultKey);var e=this.textures.get(t);null!=e?(e.release(),e.reference<=0&&this.textures.delete(t)):console.error("Can not find any texture with id: "+t+" to decrease reference !")},t}(),si=function(){function t(t){this._particlePool=t,this._acceleration=null,this._frequency=1,this._maxParticles=1e3,this._minSpeed=0,this._maxSpeed=0,this._minScale=1,this._maxScale=1,this._minLifetime=0,this._maxLifetime=0,this._minRotation=0,this._maxRotation=0,this._minRotationSpeed=0,this._maxRotationSpeed=0,this._lifetimeFunc=null,this._extraData=null,this._updateFunc=null,this._emitterPosition=new M(0,0),this._activeParticlesFirst=null,this._activeParticlesLast=null,this._spawnRect=null,this._spawnTimer=0,this._particleCount=0}return t.prototype.init=function(t){this.cleanup(),t.frequency&&(this._frequency=t.frequency),t.maxParticles&&(this._maxParticles=t.maxParticles>0?t.maxParticles:1e3);var e=t.acceleration;e&&(e.x||e.y)&&(this._acceleration=new M(e.x,e.y)),t.minSpeed&&(this._minSpeed=t.minSpeed),t.maxSpeed&&(this._maxSpeed=t.maxSpeed),t.minScale&&(this._minScale=t.minScale),t.maxScale&&(this._maxScale=t.maxScale),t.maxRotation&&(this._maxRotation=t.maxRotation),t.minRotation&&(this._minRotation=t.minRotation),t.minRotationSpeed&&(this._minRotationSpeed=t.minRotationSpeed),t.maxRotationSpeed&&(this._maxRotationSpeed=t.maxRotationSpeed),t.minLifetime&&(this._minLifetime=t.minLifetime),t.maxLifetime&&(this._maxLifetime=t.maxLifetime),t.extraData&&(this._extraData=t.extraData),t.updateFunc&&(this._updateFunc=t.updateFunc),t.lifetimeFunc&&(this._lifetimeFunc=t.lifetimeFunc),t.spawnRect&&(this._spawnRect=t.spawnRect),this._spawnTimer=0},t.prototype.update=function(e){var n,i;for(n=this._activeParticlesFirst;n;n=i)i=n.next,n.update(e);for(this._spawnTimer-=e<0?0:e;this._spawnTimer<=0;)if(this._particleCount>=this._maxParticles)this._spawnTimer+=this._frequency;else{var o=void 0;o=this._lifetimeFunc?0:Math.random()*(this._maxLifetime-this._minLifetime)+this._minLifetime;var r=this._emitterPosition.x,a=this._emitterPosition.y,s=this._particlePool.acquire(this);if(s.acceleration=this._acceleration?new M(this._acceleration.x,this._acceleration.y):null,s.scale=(this._maxScale-this._minScale)*Math.random()+this._minScale,s.maxLife=o,s.lifetimeFunc=this._lifetimeFunc,s.velocity=new M(0,(this._maxSpeed-this._minSpeed)*Math.random()+this._minSpeed),s.rotation=(this._maxRotation-this._minRotation)*Math.random()+this._minRotation,s.rotationSpeed=(this._maxRotationSpeed-this._minRotationSpeed)*Math.random()+this._minRotationSpeed,s.extraData=t.deepClone(this._extraData),s.updateFunc=this._updateFunc,this._spawnRect&&this._spawnRect.width&&this._spawnRect.height){var u=Math.random()*this._spawnRect.width,l=Math.random()*this._spawnRect.height;s.position=new M(r+u-this._spawnRect.width/2,a+l-this._spawnRect.height/2)}else s.position=new M(r,a);s.init(),this._activeParticlesLast?(this._activeParticlesLast.next=s,s.prev=this._activeParticlesLast,this._activeParticlesLast=s):this._activeParticlesLast=this._activeParticlesFirst=s,++this._particleCount,this._spawnTimer+=this._frequency}},t.prototype.recycle=function(t){t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t==this._activeParticlesLast&&(this._activeParticlesLast=t.prev),t==this._activeParticlesFirst&&(this._activeParticlesFirst=t.next),this._particlePool.release(t),--this._particleCount},t.prototype.cleanup=function(){var t,e;for(t=this._activeParticlesFirst;t;t=e)e=t.next,this.recycle(t);this._activeParticlesFirst=this._activeParticlesLast=null,this._particleCount=0},t.prototype.destroy=function(){this.cleanup(),this._particlePool=null,this._lifetimeFunc=null,this._spawnRect=null,this._extraData=null,this._updateFunc=null},Object.defineProperty(t.prototype,"particleCount",{get:function(){return this._particleCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"emitterPosition",{set:function(t){this._emitterPosition=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"spawnRect",{set:function(t){this._spawnRect=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lifetimeFunc",{set:function(t){this._lifetimeFunc=t},enumerable:!0,configurable:!0}),t.deepClone=function(t){var e={};for(var n in t)e[n]=t[n];return e},t}(),ui=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),li=function(t){function e(e,n,i){var o=t.call(this,i)||this;return o._shader=e,o._particleTexture=n,o}return ui(e,t),e.prototype.render=function(t){var e=ee.Instance.getModel(Ht.PARTICLE_QUAD_MODEL),n=t.getOrthoProjectionMatrix();this._shader.bind(),this._shader.setAttributes(e.attributeInfos),this._shader.setUniforms([new Nt("u_texture","texture",this._particleTexture)]);for(var i=this._activeParticlesFirst;i;i=i.next){var o=i.position,a=i.scale,s=i.rotation,u=r.translate(o.x,o.y,0),l=r.scale(this._particleTexture.width*a,this._particleTexture.height*a,1);u=r.rotateZ(s).concat(u);var h=(u=l.concat(u)).concat(n);this._shader.setUniforms([new Nt("u_mvpMatrix","matrix",h)]),e.render()}},e}(si),hi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ci=function(t){function e(e){var n=ee.Instance.getShader(Yt.PARTICLE_SHADER),i=ee.Instance.getTexture(Gt.RAIN_TEXTURE);return t.call(this,n,i,e)||this}return hi(e,t),e.prototype.init=function(){t.prototype.init.call(this,{frequency:c.rainFrequency,maxParticles:1e3,acceleration:new M(0,1e3).rotateBy(c.rainParticleRotation),minSpeed:0,maxSpeed:1e3,minScale:.35,maxScale:.35,maxRotation:c.rainParticleRotation,minRotation:c.rainParticleRotation})},e}(li),pi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),fi=function(t){function e(e){var n=ee.Instance.getShader(Yt.PARTICLE_SHADER),i=ee.Instance.getTexture(Gt.SNOW_TEXTURE);return t.call(this,n,i,e)||this}return pi(e,t),e.prototype.init=function(){t.prototype.init.call(this,{frequency:c.snowFrequency,maxParticles:1e3,acceleration:new M(0,50),minSpeed:50,maxSpeed:200,minScale:.25,maxScale:.35,maxRotation:0,minRotation:0,minRotationSpeed:0,maxRotationSpeed:200,extraData:{counter:0},updateFunc:function(t,e){t.acceleration&&(t.velocity.y+=t.acceleration.y*e),0!==t.rotationSpeed&&(t.rotation+=t.rotationSpeed*e),t.extraData.counter+=4,t.position.x+=2*Math.cos(t.extraData.counter*s.deg2Rad),t.position.y+=t.velocity.y*e}})},e}(li);!function(t){t[t.Rainy=0]="Rainy",t[t.Snowy=1]="Snowy",t[t.Sunny=2]="Sunny",t[t.Cloudy=3]="Cloudy",t[t.Live=4]="Live"}(cn||(cn={}));var di,gi=function(){function t(t){this._emitter=t,this._position=new M(0,0),this._scale=1,this._velocity=new M(0,0),this._rotation=0,this._rotationSpeed=0,this._acceleration=null,this._extraData=null,this._updateFunc=null,this._maxLife=0,this._age=0}return t.prototype.update=function(t){if(this._age+=t,this._lifetimeFunc){if(this._lifetimeFunc(this))return void this.kill()}else if(this._age>=this._maxLife||this._age<0)return void this.kill();this._updateFunc?this._updateFunc(this,t):(this._acceleration&&(this._velocity.x+=this._acceleration.x*t,this._velocity.y+=this._acceleration.y*t),0!==this._rotationSpeed&&(this._rotation+=this._rotationSpeed*t),this._position.x+=this._velocity.x*t,this._position.y+=this._velocity.y*t)},t.prototype.init=function(){this._age=0,this._velocity=this._velocity.rotateBy(this._rotation)},t.prototype.destroy=function(){this._emitter=null,this._lifetimeFunc=null,this._extraData=null,this._updateFunc=null,this._next=null,this._prev=null},t.prototype.kill=function(){this._emitter.recycle(this)},Object.defineProperty(t.prototype,"emitter",{set:function(t){this._emitter=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"velocity",{get:function(){return this._velocity},set:function(t){this._velocity=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rotationSpeed",{get:function(){return this._rotationSpeed},set:function(t){this._rotationSpeed=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxLife",{set:function(t){this._maxLife=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lifetimeFunc",{set:function(t){this._lifetimeFunc=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"updateFunc",{set:function(t){this._updateFunc=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"acceleration",{get:function(){return this._acceleration},set:function(t){this._acceleration=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraData",{get:function(){return this._extraData},set:function(t){this._extraData=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"next",{get:function(){return this._next},set:function(t){this._next=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prev",{get:function(){return this._prev},set:function(t){this._prev=t},enumerable:!0,configurable:!0}),t}(),mi=function(){function t(){}return t.prototype.acquire=function(t){var e;return this._poolFirst?(e=this._poolFirst,this._poolFirst=this._poolFirst.next,e.next=null,e.emitter=t):e=new gi(t),e},t.prototype.release=function(t){t.prev=null,t.next=this._poolFirst,this._poolFirst=t},t.prototype.destroy=function(){for(var t,e=this._poolFirst;e;e=t)t=e.next,e.destroy();this._poolFirst=null},t}(),yi=function(){function t(t,e){this._particleSystems=[],this.weatherTaskManager=e,this.mapState=t,this._liveMode=!1,this._weather=cn.Sunny,this._particlePool=new mi;var n=new ci(this._particlePool);n.init(),this._particleSystems.push(n);var i=new fi(this._particlePool);i.init(),this._particleSystems.push(i),this._lastTime=NaN}return t.prototype.setWeather=function(t){t===this._weather||this._liveMode&&t===cn.Live||(t==cn.Live?(this._liveMode=!0,this._lastTimeGetLive=Date.now(),this._lastLocationGetLive=this.mapState.getTarget(),this.getLiveInfomation()):this._liveMode=!1,t<cn.Sunny&&this._particleSystems[t].cleanup(),this._weather=t,this._lastTime=NaN)},t.prototype.setWeatherFromLive=function(t){t<cn.Sunny&&this._particleSystems[t].cleanup(),this._weather=t,this._lastTime=NaN},t.prototype.getWeather=function(){return this._weather},t.prototype.dirty=function(){return this.mapState.is3dMode()&&this.getWeather()!=cn.Sunny&&this.getWeather()!=cn.Cloudy},t.prototype.getLiveInfomation=function(){var e=this,n=at.getWeatherDataUrl(this.mapState.getTarget().lat(),this.mapState.getTarget().lng(),J.getAccessKey()),i=new lt(rt.RasterTile);i.url=n,i.completion=function(n){null!=n.data&&null!=n.data.result&&null!=n.data.result.type?e.setWeatherFromLive(t.convertToWeather(n.data.result.type)):console.error("Can not get weather from server because response data invalid !")},this.weatherTaskManager.postTask(i)},t.prototype.update=function(){if(this._weather<cn.Sunny){var t=Date.now(),e=isNaN(this._lastTime)?0:t-this._lastTime;this._lastTime=t,this._particleSystems[this._weather].update(e/1e3)}if(this._liveMode){t=Date.now();var n=this.mapState.getTarget();(n.distanceTo(this._lastLocationGetLive)>p.refreshDistance||t-this._lastTimeGetLive>p.refreshTime)&&(this._lastLocationGetLive=n,this._lastTimeGetLive=t,this.getLiveInfomation())}},t.prototype.render=function(t){this._weather<cn.Sunny&&this._particleSystems[this._weather].render(t)},t.prototype.resize=function(t,e){for(var n=0;n<cn.Sunny;++n){var i=0;n==cn.Rainy&&(i=Math.abs(Math.tan(c.rainParticleRotation*s.deg2Rad))*e);var o=t+i;this._particleSystems[n].spawnRect={width:o,height:2},this._particleSystems[n].emitterPosition=new M(t/2-i/2,0),this._particleSystems[n].lifetimeFunc=function(n){return n.position.y>e||n.position.x>t}}},t.convertToWeather=function(t){var e=NaN;switch(t){case 0:e=cn.Sunny;break;case 1:e=cn.Rainy;break;case 2:e=cn.Snowy;break;case 3:e=cn.Cloudy}return e},t.prototype.destroy=function(){for(var t=0;t<cn.Sunny;++t)this._particleSystems[t].destroy();for(;0!=this._particleSystems.length;)this._particleSystems.pop();this._particleSystems=null,this._particlePool.destroy(),this._particlePool=null},t}(),vi=n(5),Ai=function(){function t(t){this._lightColor=t}return Object.defineProperty(t.prototype,"lightColor",{get:function(){return this._lightColor},set:function(t){this._lightColor=t},enumerable:!0,configurable:!0}),t}(),wi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Mi=function(t){function e(e,n){var i=t.call(this,e)||this;return i._lightPosition=n,i}return wi(e,t),Object.defineProperty(e.prototype,"lightPosition",{get:function(){return this._lightPosition},set:function(t){this._lightPosition=t},enumerable:!0,configurable:!0}),e}(Ai),xi=function(){function t(t){this._lastUpdateTime=0,this._sunLight=new Mi(new o(1,1,1),new o(0,0,1)),this._timeEffectManager=t}return t.prototype.update=function(t){var e=(new Date).getTime();if(!(e-this._lastUpdateTime<6e4)){this._lastUpdateTime=e;var n=vi.getPosition(this._timeEffectManager.getTime(),t.lat(),t.lng()),i=-1*n.azimuth,r=y.clamp(Math.abs(n.altitude),Math.PI/6,Math.PI/2);this._sunLight.lightPosition=new o(Math.cos(r)*Math.sin(i),Math.cos(r)*Math.cos(i),Math.sin(r)),this._onLightPositionChanged&&this._onLightPositionChanged()}},t.prototype.setOnLightPositionChanged=function(t){this._onLightPositionChanged=t},Object.defineProperty(t.prototype,"sunLight",{get:function(){return this._sunLight},enumerable:!0,configurable:!0}),t}(),_i=function(){function t(t,e,n){this._gl=t,this._directionalLight=e,this._mapState=n,this._lightProjectionMatrix=r.ortho(-10,10,-10,10,-10,20),this.resize(n.screenWidth,n.screenHeight)}return t.prototype.bind=function(){this._frameBuffer.bind(),this._gl.viewport(0,0,this._width,this._height),this._gl.clearColor(1,1,1,1),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT);var t=O.fromHex(this._mapState.is3dMode()?a.mapBackgroundColor3D:a.mapBackgroundColor2D);this._gl.clearColor(t.red,t.green,t.blue,1)},t.prototype.unbind=function(){this._frameBuffer.unbind(),this._gl.viewport(0,0,this._mapState.screenWidth,this._mapState.screenHeight)},t.prototype.clear=function(){this.bind(),this.unbind()},t.prototype.getLightViewProjectionMatrix=function(){return this._lightViewProjectionMatrix},t.prototype.getShadowMapTexture=function(){return this._frameBuffer.colorTexture},t.prototype.resize=function(t,e){this._width=1.5*t,this._height=1.5*e,this._frameBuffer&&this._frameBuffer.destroy(),this._frameBuffer=new ri(this._gl,this._width,this._height),this.updateMatrices(),this.clear()},t.prototype.updateMatrices=function(){var t=S.getTileSize(),e=u.height*Math.tan(u.fov/2)*t/this._mapState.screenHeight/(t/2),n=r.lookAt(this._directionalLight.lightPosition,new o(0,0,0),1,new o(0,1,0));n=r.scale(e,e,e).concat(n),this._lightViewProjectionMatrix=n.concat(this._lightProjectionMatrix)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),t.prototype.renderDebug=function(){this._frameBuffer.drawDebug()},t.prototype.destroy=function(){this._frameBuffer.destroy(),this._frameBuffer=null,this._directionalLight=null,this._gl=null,this._mapState=null,this._lightViewProjectionMatrix=null,this._lightProjectionMatrix=null},t}();!function(t){t[t.Live=0]="Live",t[t.Morning=1]="Morning",t[t.Noon=2]="Noon",t[t.AfterNoon=3]="AfterNoon",t[t.Evening=4]="Evening"}(di||(di={}));var bi=function(){function t(){this._timeArray=[d.morningTime,d.noonTime,d.afterNoonTime,d.eveningTime],this.defaultTimeByString="Noon"}return t.prototype.getTimeEffect=function(){return this._timeEffect},t.prototype.getTime=function(){return this._timeEffect==di.Live||null==this._time?(new Date).getTime():this._time},t.prototype.setTimeEffect=function(t){null==t&&console.error("TimeEffect value is invalid, please set again !"),this._timeEffect=t;var e=new Date;switch(t){case di.Live:this._time=null;break;case di.Morning:this._time=e.setHours(d.morningTime,0,0,0);break;case di.Noon:this._time=e.setHours(d.noonTime,0,0,0);break;case di.AfterNoon:this._time=e.setHours(d.afterNoonTime,0,0,0);break;case di.Evening:this._time=e.setHours(d.eveningTime,0,0,0)}},t.prototype.getSkyColor=function(){var e=null,n=t.getStringByTimeEffect(this._timeEffect);switch(this._timeEffect){case di.Live:e=this.getSkyColorByTime();break;case di.Morning:case di.Noon:case di.AfterNoon:case di.Evening:e=f.getSkyColor(n);break;default:e=f.getSkyColor(this.defaultTimeByString)}return e},t.prototype.getFogColor=function(){var e=null,n=t.getStringByTimeEffect(this._timeEffect);switch(this._timeEffect){case di.Live:e=this.getFogColorByTime();break;case di.Morning:case di.Noon:case di.AfterNoon:case di.Evening:e=f.getFogColor(n);break;default:e=f.getFogColor(this.defaultTimeByString)}return e},t.prototype.getSkyColorByTime=function(){for(var e=new Date(this.getTime()).getHours(),n=null,i=0;i<this._timeArray.length-1;++i)if(e>this._timeArray[i]&&e<=this._timeArray[i+1]){n=O.mix(O.fromVec3(f.getSkyColor(t.getStringByTimeEffect(di.Morning+i))),O.fromVec3(f.getSkyColor(t.getStringByTimeEffect(di.Morning+i+1))),(this._timeArray[i+1]-e)/(this._timeArray[i+1]-this._timeArray[i]));break}if(null==n&&e>d.eveningTime||null==n&&e<=d.morningTime){var r=e;e<=d.morningTime&&(r+=24),n=O.mix(O.fromVec3(f.getSkyColor("Morning")),O.fromVec3(f.getSkyColor("Evening")),(r-d.eveningTime)/(24-(d.eveningTime-d.morningTime)))}return new o(n.red,n.green,n.blue)},t.prototype.getFogColorByTime=function(){for(var e=new Date(this.getTime()).getHours(),n=null,i=0;i<this._timeArray.length-1;++i)if(e>this._timeArray[i]&&e<=this._timeArray[i+1]){n=O.mix(O.fromVec3(f.getFogColor(t.getStringByTimeEffect(di.Morning+i))),O.fromVec3(f.getFogColor(t.getStringByTimeEffect(di.Morning+i+1))),(this._timeArray[i+1]-e)/(this._timeArray[i+1]-this._timeArray[i]));break}if(null==n&&e>d.eveningTime||null==n&&e<=d.morningTime){var r=e;e<=d.morningTime&&(r+=24),n=O.mix(O.fromVec3(f.getFogColor("Morning")),O.fromVec3(f.getFogColor("Evening")),(r-d.eveningTime)/(24-(d.eveningTime-d.morningTime)))}return new o(n.red,n.green,n.blue)},t.getStringByTimeEffect=function(t){switch(t){case di.Live:return"Live";case di.Morning:return"Morning";case di.Noon:return"Noon";case di.AfterNoon:return"AfterNoon";case di.Evening:return"Evening";default:return null}},t}(),Ti=function(){function t(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}return t.prototype.add=function(t){var e=++this._id;return this._queue.push({callback:t,id:e,cancelled:!1}),e},t.prototype.remove=function(t){for(var e=this._currentlyRunning,n=0,i=e?this._queue.concat(e):this._queue;n<i.length;n++){var o=i[n];if(o.id===t)return void(o.cancelled=!0)}},t.prototype.run=function(){this._currentlyRunning&&console.log("Task is currently running");var t=this._currentlyRunning=this._queue;this._queue=[];for(var e=0,n=t;e<n.length;e++){var i=n[e];if(!i.cancelled&&(i.callback(),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},t.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]},t}(),Si=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ei=function(t){function e(){return t.call(this)||this}return Si(e,t),e.prototype.getViewMatrix=function(){return this.viewMatrix},e.prototype.updateMatrices=function(t){var e=t.getCameraPosition();this.viewMatrix=r.translate(0,Math.cos(e.getTilt()*Math.PI/180)/1.75,-1),this.mvpMatrix=this.viewMatrix.concat(t.getProjectionMatrix())},e.prototype.destroy=function(){},e}(dt),Ci=function(){function t(t,e){this.gl=t,this.timeEffectManager=e}return t.prototype.render=function(t,e){if(this.gl.enable(this.gl.DEPTH_TEST),null!=t){var n=ee.Instance.getShader(Yt.SKY_SHARDER),i=ee.Instance.getModel(Ht.SKY_MODEL),o=ee.Instance.getTexture(Gt.SKY_TEXTURE);n.bind(),n.setAttributes(i.attributeInfos);var r=.01,s=e.getCamera().getTilt();s>a.minTiltReduceFog&&(r-=(s-a.minTiltReduceFog)*(r-.001)/(a.maxTilt3D-a.minTiltReduceFog));var u=-.54*e.getMapBorder()+.27+r,l=u+r,h=this.timeEffectManager.getSkyColor(),c=this.timeEffectManager.getFogColor();n.setUniforms([new Nt("u_lowerLimit","1f",u),new Nt("u_upperLimit","1f",l),new Nt("u_texture","texture",o),new Nt("u_viewMatrix","matrix",t.getViewMatrix()),new Nt("u_mvpMatrix","matrix",t.getMvpMatrix()),new Nt("u_vertexColor","3f",h),new Nt("u_fogColor","3f",c)]),i.render(),this.gl.disable(this.gl.DEPTH_TEST)}else console.warn("Can not render because skyObject is null !")},t}(),Ii=function(){function t(t){this._shadowMap=t,this._enableShadowEffect=!1,this._enableWaterEffect=!1}return Object.defineProperty(t.prototype,"enableWaterEffect",{get:function(){return this._enableWaterEffect},set:function(t){this._enableWaterEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"enableShadowEffect",{get:function(){return this._enableShadowEffect},set:function(t){this._enableShadowEffect=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shadowMap",{get:function(){return this._shadowMap},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,e){this._shadowMap.resize(t,e)},t.prototype.dirty=function(){return this.enableWaterEffect},t.prototype.destroy=function(){this._shadowMap.destroy(),this._shadowMap=null},t}(),Ri=function(){function t(t,e,n){this.selectionBuildingIdIconMap=new Map,this.symbolResourceManager=e,this.symbolRenderer=new ce(t),this.mapView=n}return t.prototype.addBuilding=function(t){var e=new R(32,32,D.get("selectionIcon")),n=new Dn(new Pe({position:t.getHighestPosition(),elevation:t.getHeight(),snippet:t.getName(),icon:e}),this.symbolResourceManager);this.selectionBuildingIdIconMap.set(t.getId(),n)},t.prototype.removeBuilding=function(t){var e=this.selectionBuildingIdIconMap.get(t);e?(e.destroy(),this.selectionBuildingIdIconMap.delete(t)):console.warn("selection symbol is null- buildingId: "+t)},t.prototype.onHover=function(t){var e=this,n=Array.from(this.selectionBuildingIdIconMap.values()).some(function(n){return!!T.pointIntersectsSymbol(new A(t.x,t.y),n,e.mapView.mapState)&&(e.showSelectionSymbolInfoWindow(n),!0)});return n||this.deselectInfoWindow(),n},t.prototype.deselectInfoWindow=function(){this.selectedSymbol=null,this.infoContentsContainer&&(this.infoWindowContainer.style.visibility="hidden")},t.prototype.render=function(t){var e=this;Array.from(this.selectionBuildingIdIconMap.values()).forEach(function(n){e.symbolRenderer.render(n,t)}),this.updateInfoWindowPosition()},t.prototype.destroy=function(){this.symbolResourceManager=null,this.selectionBuildingIdIconMap.clear(),this.selectionBuildingIdIconMap=null,this.symbolRenderer=null,this.mapView=null,this.selectedSymbolInfoWindow=null,this.infoWindowContainer=null,this.infoContentsContainer=null,this.selectedSymbol=null},t.prototype.updateInfoWindowPosition=function(){if(this.selectedSymbol){var t=this.selectedSymbolInfoWindow.getPositionByMarker(this.selectedSymbol,this.mapView.mapState),e=t.x,n=t.y,i=this.infoWindowContainer.style;i.top=n.toString()+"px",i.left=e.toString()+"px","hidden"==i.visibility&&(i.visibility="visible")}},t.prototype.showSelectionSymbolInfoWindow=function(t){this.selectedSymbol=t;var e=this.getInfoWindowHTMLElement(t.getMarker());this.selectedSymbolInfoWindow=new Ln(e,t.getMarker().getWindowAnchor()),this.updateInfoWindowPosition()},t.prototype.getInfoWindowHTMLElement=function(t){return this.infoContentsContainer||(this.infoContentsContainer||(this.infoWindowContainer=G.create("div","mf-info-window-container",this.mapView.getMapContainer())),this.infoContentsContainer=G.create("div","mf-info-window-content",this.infoWindowContainer)),this.infoContentsContainer.innerHTML="<p> "+t.getSnippet()+" </p>",this.infoContentsContainer},t}(),Di=n(3),Li=function(){function t(t){this._mapObject=t,this.updateBounds(),this._boundsUpdated=!1}return t.prototype.updateBounds=function(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0);var o=this._mapObject.getLocation(),r=x.convertToMeterFromLatLng(o),a=new M(r.x-t,r.y-i),s=new M(r.x+n,r.y-e),u=new _(x.convertToLatLngFromMeter(a),x.convertToLatLngFromMeter(s));this._minX=u.getSouthwest().lng(),this._minY=u.getSouthwest().lat(),this._maxX=u.getNortheast().lng(),this._maxY=u.getNortheast().lat(),this._boundsUpdated=!0},Object.defineProperty(t.prototype,"mapObject",{get:function(){return this._mapObject},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minX",{get:function(){return this._minX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this._minY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this._maxX},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this._maxY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boundsUpdated",{get:function(){return this._boundsUpdated},enumerable:!0,configurable:!0}),t}(),Bi=function(){function t(t,e,n,i){this.buildingResourceManager=t,this.mapState=e,this.modelTaskManager=n,this.mapObjectTree=Te(),this.mapObjects=new Map,this.modelRequestsMap=new Map,this.requestRender=i}return t.prototype.setTileManager=function(t){this.tileManager=t},t.prototype.addMapObject=function(t){if(this.mapObjects.get(t.getId()))console.warn("Can not add 2 map objects have the same id");else{var e=new Li(t);if(this.mapObjects.set(t.getId(),e),t.getObjData()){var n=Tt.loadModel(t.getObjData());null!=n&&n.length>0?(this.mapObjectTree.insert(e),this.onDataModelAvailable(n[0].data,t)):console.warn("Invalid object data for custom building id: "+t.getId())}else this.requestModel(e)}},t.prototype.removeMapObject=function(t){var e=this,n=this.mapObjects.get(t);if(n){if(n.boundsUpdated){var i=[];i.push([n.minX,n.minY]),i.push([n.minX,n.maxY]),i.push([n.maxX,n.maxY]),i.push([n.maxX,n.minY]),i.push([n.minX,n.minY]);for(var o={type:"Polygon",properties:{},coordinates:[i]},r=function(n){var i=Di.tiles(o,{min_zoom:n,max_zoom:n}),r=s.tileManager.getTiles(),a=s.tileManager.getTileCache();i&&i.forEach(function(n){var i=new tt(n[0],n[1],n[2],!0).toString(),o=r.get(i);o&&((s=o.tile).isInitialized()&&(s.addBuildings(s.getBuildings().filter(function(e){return e.id!=t})),e.buildingResourceManager.decreaseBuildingReference(t)));var s,u=a.get(i);u&&(s=u).addBuildings(s.getBuildings().filter(function(e){return e.id!=t}))})},s=this,u=a.defaultMinZoom3d;u<=this.mapState.getMaxNativeZoom();++u)r(u)}else{var l=n.mapObject.getObjUrl();this.buildingResourceManager.decreaseModelReference(l)}this.mapObjectTree.remove(n),this.mapObjects.delete(t)}else console.warn("Can not remove non exist map object- id: "+t)},t.prototype.getJsonForMapObject=function(t){return{id:t.getId(),name:t.getName(),location:t.getLocation(),scale:t.getScale(),bearing:t.getBearing(),elevation:t.getElevation(),heightScale:t.getHeightScale(),model:{type:"External",objName:t.getObjUrl(),objData:t.getObjData(),textureName:t.getTextureUrl(),textureData:t.getTextureData()}}},t.prototype.getObjectsForTile=function(t){var e=b.tileCoordinateToLatLngBounds(t),n={minX:e.getSouthwest().lng(),minY:e.getSouthwest().lat(),maxX:e.getNortheast().lng(),maxY:e.getNortheast().lat()},i=this.mapObjectTree.search(n);return i&&0!=i.length?i.map(function(t){return t.mapObject}):[]},t.prototype.destroy=function(){var t=this;this.modelRequestsMap.forEach(function(e){t.modelTaskManager.cancelTask(e)}),this.modelRequestsMap.clear(),this.mapObjects.clear(),this.mapObjectTree.clear(),this.mapObjects=null,this.buildingResourceManager=null,this.tileManager=null,this.mapState=null,this.modelRequestsMap=null,this.modelTaskManager=null},t.prototype.requestModel=function(t){var e=this,n=t.mapObject.getObjUrl();if(null!=n){var i=at.isUrlRequest(n)?n:at.getBuildingDataUrl(a.baseModelRequestUrl,n,J.getAccessKey()),o=new lt(rt.Model);o.url=i,o.completion=function(i){null!=i.data?(e.onDataModelAvailable(i.data[0].data,t.mapObject),e.mapObjectTree.insert(t),e.requestRender()):console.warn("Fail to load model for custom building: "+n),e.modelRequestsMap.delete(n)},this.modelRequestsMap.set(n,o),this.modelTaskManager.postTask(o)}else console.error("You do not set Url for Model. Please set it first!")},t.prototype.getBoundsFromModelData=function(t){for(var e=0,n=0,i=0,o=0,r=0;e<t.length;)n>t[e]&&(n=t[e]),o<t[e]&&(o=t[e]),i>t[e+2]&&(i=t[e+2]),r<t[e+2]&&(r=t[e+2]),e+=8;return{minX:n,minY:i,maxX:o,maxY:r}},t.prototype.onDataModelAvailable=function(t,e){var n=this,i=this.getBoundsFromModelData(t);if(0!=i.minX||0!=i.minY||0!=i.maxX||0!=i.maxY){var o=this.mapObjects.get(e.getId());o.updateBounds(i.minX,i.minY,i.maxX,i.maxY);var r=[];r.push([o.minX,o.minY]),r.push([o.minX,o.maxY]),r.push([o.maxX,o.maxY]),r.push([o.maxX,o.minY]),r.push([o.minX,o.minY]);for(var s={type:"Polygon",properties:{},coordinates:[r]},u=function(t){var i=Di.tiles(s,{min_zoom:t,max_zoom:t}),o=l.tileManager.getTiles(),r=l.tileManager.getTileCache();i&&i.forEach(function(t){var i=new tt(t[0],t[1],t[2],!0).toString(),a=o.get(i);if(a&&(l=a.tile).isInitialized()){var s=n.getJsonForMapObject(e);n.tileManager.addBuildings([s]),l.getBuildings().push(s)}var u=r.get(i);if(u){var l=u;s=n.getJsonForMapObject(e);l.getBuildings().push(s)}})},l=this,h=a.defaultMinZoom3d;h<=this.mapState.getMaxNativeZoom();++h)u(h)}},t}(),Oi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Pi=function(t){function e(e,n){var o=t.call(this)||this;o.container=e,o.gl=null,o.defaultMapOptions={center:[-1,-1],zoom:12,minZoom:a.defaultMinZoom,maxZoom:a.defaultMaxZoom,geolocate:!1,mapControls:!1,mapControlOptions:i.BOTTOM_RIGHT,tilt:0,bearing:0},o.defaultAnimationOptions={duration:null,easing:null,animate:!1},o.defaultPaddingOptions={top:0,bottom:0,left:0,right:0};var r={};return S.extendOptions(r,o.defaultMapOptions,n),o.options=r,o.init(),o}return Oi(e,t),e.prototype.init=function(){this.setupMapViews(this.container,this.options),this.setupComponents(this.options),this.createStyleNode(),this.renderTaskQueue=new Ti,this.loop()},e.prototype.requestRenderFrame=function(t){return this.dirty=!0,this.renderTaskQueue.add(t)},e.prototype.cancelRenderFrame=function(t){this.renderTaskQueue.remove(t)},e.prototype.loop=function(){this.resize(),this.dirty&&(this.dirty=!1,this.update(),this.render()),(this.weatherManager.dirty()||this.mapState.dirty()||this.effectManager.dirty())&&(this.dirty=!0),requestAnimationFrame(this.loop.bind(this))},e.prototype.update=function(){var t=this;this.cameraAnimation.updateTransitions(),this.annotationManager.update(),this.layers.forEach(function(e){e.update(t.mapState)}),this.mapSettings.is3dMode()&&(this.weatherManager.update(),this.mapState.getMapBorder()>=a.skyboxMapBorderMinimum&&this.skyObject.updateMatrices(this.mapState))},e.prototype.resize=function(){if(null!=this.canvas){S.pixelScale=window.devicePixelRatio||1;var t=this.canvas.offsetWidth*S.pixelScale,e=this.canvas.offsetHeight*S.pixelScale;this.width==t&&this.height==e||(null!=this.frameBuffer&&(this.frameBuffer.destroy(),this.frameBuffer=null),this.width=t,this.height=e,this.canvas.width=this.width,this.canvas.height=this.height,this.gl.viewport(0,0,this.width,this.height),this.mapState.setScreenSize(this.width,this.height),this.weatherManager.resize(t,e),this.effectManager.resize(t,e),this.frameBuffer=new ri(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.tileManager.updateVisibleTiles(),this.buildingLayer.setDirty(),this.dirty=!0)}},e.prototype.render=function(){var t=this.gl;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.mapRenderer.render(),this.renderTaskQueue.run(),this.mapSettings.is3dMode()&&(t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),this.buildingIconSelectionManager.render(this.mapState),this.weatherManager.render(this.mapState),t.disable(t.BLEND))},e.prototype.renderSelection=function(){var t=this.gl;t.clearColor(1,1,1,1),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.mapRenderer.renderSelection();var e=O.fromHex(this.mapState.is3dMode()?a.mapBackgroundColor3D:a.mapBackgroundColor2D);t.clearColor(e.red,e.green,e.blue,1)},e.prototype.getSelectionCode=function(t){if(null!=this.frameBuffer){this.frameBuffer.bind(),this.renderSelection();var e=new Uint8Array([0,0,0,0]);this.gl.readPixels(t.x,this.height-t.y,1,1,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);var n=e[0],i=e[1],o=e[2];return this.frameBuffer.unbind(),n<<16|i<<8|o}return-1},e.prototype.createLayer=function(t,e,n){if(this.layers.has(t))return console.log("Cannot create layer which layer id already exist"),null;var i=Hn.createLayer(t,e,this.tileManager,n);return null!=i?(this.mapRenderer.addLayer(i),this.layers.set(t,i),i):null},e.prototype.removeLayer=function(t,e){this.mapRenderer.removeLayer(t,e),this.layers.delete(t)},e.createCameraAnimationOptions=function(t){var e=new N;if(t.animate){if(null!=t.duration&&t.duration<0)throw new Error("Animation duration must be greater or equal to 0");e.easing=t.easing}return e.duration=t.duration,e.gesture=!1,e},e.prototype.panBy=function(t,n){n=S.extendOptions({},this.defaultAnimationOptions,n),this.cameraAnimation.moveBy(t,e.createCameraAnimationOptions(n))},e.prototype.panTo=function(t,n){null==(n=S.extendOptions({},this.defaultAnimationOptions,n)).duration&&(n.duration=S.getTimePanTo(this.mapState.getTarget(),t,this.mapState.getZoom())),this.cameraAnimation.moveTo(t,this.mapState.getZoom(),e.createCameraAnimationOptions(n))},e.prototype.flyTo=function(t,n,i){var o=new F;o.target=t,o.zoom=n,o.zoom<a.defaultMinZoom3d&&this.mapSettings.is3dMode()&&this.mapState.enable3dMode(!1)&&this.tileManager.clearTileCache(),i=S.extendOptions({},this.defaultAnimationOptions,i),this.cameraAnimation.flyTo(o,e.createCameraAnimationOptions(i))},e.prototype.moveTo=function(t,n,i){n<a.defaultMinZoom3d&&this.mapSettings.is3dMode()&&this.mapState.enable3dMode(!1)&&this.tileManager.clearTileCache(),i=S.extendOptions({},this.defaultAnimationOptions,i),this.cameraAnimation.moveTo(t,n,e.createCameraAnimationOptions(i))},e.prototype.fitBounds=function(t,e,n){if((e=S.extendOptions({},this.defaultPaddingOptions,e)).top<0||e.bottom<0||e.left<0||e.right<0)throw new Error("Padding value must be greater or equal to 0");var i=this.getCameraPositionForLatLngBounds(t,e.left,e.top,e.right,e.bottom);this.flyTo(i.getTarget(),i.getZoom(),n)},e.prototype.moveBy=function(t){this.cameraAnimation.moveBy(t,null,!0)},e.prototype.moveByVelocity=function(t){this.mapState.isPanning()||this.mapState.isZoomIn()||this.mapState.isZoomOut()||this.cameraAnimation.moveByVelocity(t)},e.prototype.getCameraPositionForLatLngBounds=function(t,e,n,i,o){var r={top:n,bottom:o,left:e,right:i};return S.getCameraPositionForLatLngBounds(t,r,this.mapState,this.mapSettings)},e.prototype.setZoom=function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=!1);var o=new N;o.duration=n,o.gesture=i,t=y.clamp(t,this.mapSettings.getPreferMinZoom(),this.mapSettings.getMaxZoom()),this.cameraAnimation.zoom(t,e,o)},e.prototype.setTilt=function(t,e){void 0===e&&(e=!1),this.cameraAnimation.setTilt(t,e)},e.prototype.setBearing=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=!1),this.cameraAnimation.setBearing(t,e,n)},e.prototype.stopAnimation=function(){this.cameraAnimation.stopAnimation()},e.prototype.setMapUrl=function(t,e){this.mapSettings.getMapUrl()!=t&&(this.mapSettings.setMapUrl(t,e),e&&this.mapSettings.is3dMode()&&(this.buildingResourceManager.removeAllResources(),this.buildingLayer.clear()),this.tileManager.reload())},e.prototype.setWeather=function(t){this.weatherManager.setWeather(t),this.dirty=!0},e.prototype.getWeather=function(){return this.weatherManager.getWeather()},e.prototype.enable3dMode=function(t){if(t!=this.mapState.is3dMode()){if(t&&!S.insideOfVietNam(this.mapState.getTarget())){var e=S.getNearestByLocations(this.mapState.getTarget());this.mapState.setTarget(e)}if(this.mapState.enable3dMode(t)){if(this.tileManager.reload(),t){var n=y.clamp(this.mapState.getZoom(),a.defaultMinZoom3d,this.mapSettings.getMaxZoom());this.moveTo(this.mapState.getTarget(),n)}else this.buildingResourceManager.removeAllResources(),this.buildingLayer.clear();var i=O.fromHex(this.mapState.is3dMode()?a.mapBackgroundColor3D:a.mapBackgroundColor2D);this.gl.clearColor(i.red,i.green,i.blue,1)}}},e.prototype.getBounds=function(){if(!this.getCamera().getTarget()||!this.mapState.getZoom())return null;var t=this.mapState.getScreenSize(),e=this.mapState.getTilt(),n=!1;e>a.maxTiltIntersectWithScreen&&(this.mapState.setTilt(a.maxTiltIntersectWithScreen),n=!0);var i=b.screenCoordinateToLatLng(new M(0,0),this.mapState).normalize(),o=b.screenCoordinateToLatLng(new M(t.x,0),this.mapState).normalize();n&&this.mapState.setTilt(e);var r=b.screenCoordinateToLatLng(new M(t.x,t.y),this.mapState).normalize(),s=b.screenCoordinateToLatLng(new M(0,t.y),this.mapState).normalize(),u=new _;return u.extend(i).extend(o).extend(r).extend(s),u},e.prototype.getCurrentMousePosition=function(t){return new M((t.clientX-this.canvas.getBoundingClientRect().left)*S.pixelScale,(t.clientY-this.canvas.getBoundingClientRect().top)*S.pixelScale)},e.prototype.getMapUrl=function(){return this.mapSettings.getMapUrl()},e.prototype.hideInfoWindow=function(t){this.annotationManager.hideInfoWindow(t)},e.prototype.isInfoWindowShown=function(t){return this.annotationManager.isInfoWindowShown(t)},e.prototype.showInfoWindow=function(t){this.annotationManager.showInfoWindow(t)},e.prototype.setMinZoom=function(t){this.mapSettings.setMinZoom(t)},e.prototype.setMaxZoom=function(t){this.mapSettings.setMaxZoom(t)},e.prototype.setMaxNativeZoom=function(t){t=y.clamp(t,a.defaultMinZoom,a.defaultMaxZoom),this.mapSettings.setMaxNativeZoom(t)},e.prototype.addTileArea=function(t){return this.tileAreaManager.addTileArea(t)},e.prototype.removeTileArea=function(t){this.tileAreaManager.removeTileArea(t)},e.prototype.addAnnotation=function(t){return this.dirty=!0,this.annotationManager.addAnnotation(t)},e.prototype.updateAnnotation=function(t,e){void 0===e&&(e=!1),this.annotationManager.updateAnnotation(t,e),this.dirty=!0},e.prototype.removeAnnotation=function(t){this.annotationManager.removeAnnotation(t),this.dirty=!0},e.prototype.addMapObject=function(t){this.customBuildingManager.addMapObject(t),this.dirty=!0},e.prototype.removeMapObject=function(t){this.customBuildingManager.removeMapObject(t),this.dirty=!0},e.prototype.screenCoordinateToLatLng=function(t,e){void 0===e&&(e=0);var n=this.mapState.getMapBorder();if(this.mapState.is3dMode()&&n>a.skyboxMapBorderMinimum){var i=this.mapState.getScreenSize().y;if(t.y/i+.025<n)return new g(1/0,1/0)}return b.screenCoordinateToLatLng(t,this.mapState,e)},e.prototype.latLngToScreenCoordinate=function(t,e){return void 0===e&&(e=0),b.latLngToScreenCoordinate(t,e,this.mapState)},e.prototype.getCamera=function(){return this.mapState.getCamera()},e.prototype.setCamera=function(t){var e=new F,n=new N;n.duration=0,e.bearing=t.getBearing(),e.tilt=t.getTilt(),e.target=t.getTarget(),e.zoom=t.getZoom(),this.mapState.movingTo=!t.getTarget().equals(this.mapState.getTarget()),this.mapState.zoomIn=t.getZoom()>this.mapState.getZoom(),this.mapState.zoomOut=t.getZoom()<this.mapState.getZoom(),this.mapState.tilting=t.getTilt()!=this.mapState.getTilt(),this.mapState.bearing=t.getBearing()!=this.mapState.getBearing(),(this.mapState.movingTo||this.mapState.zoomIn||this.mapState.zoomOut||this.mapState.tilting||this.mapState.bearing)&&this.cameraAnimation.easeTo(e,n)},e.prototype.setSwitchMode=function(t){this.mapState.setSwitchMode(t)},e.prototype.setShadowEffect=function(t){this.effectManager.enableShadowEffect=t,this.dirty=!0},e.prototype.setWaterEffect=function(t){this.effectManager.enableWaterEffect=t,this.dirty=!0},e.prototype.setObjectsEnabled=function(t){this.mapSettings.objectsEnabled!=t&&(this.mapSettings.objectsEnabled=t,this.mapState.is3dMode()&&(t?this.tileManager.readdBuildings():this.buildingResourceManager.removeBuildings(function(t){return t.getBuildingType()!=ut.External}),this.effectManager.shadowMap.clear(),this.dirty=!0))},e.prototype.isObjectsEnabled=function(){return this.mapSettings.objectsEnabled},e.prototype.reload=function(){this.tileManager.reload()},e.prototype.setupComponents=function(t){var e=this,n={};S.extendOptions(n,this.defaultMapOptions,t),ee.Instance.init(this.gl),this.frameBuffer=new ri(this.gl,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight),this.layers=new Map,this.httpTaskManager=new It,this.mapsEventManager=new Qn(this),this.mapSettings=new J(function(){e.mapsEventManager.notify(L.modeChanged),e.mapSettings.is3dMode()||e.effectManager.shadowMap.clear()}),this.timeEffectManager=new bi,this.mapState=new q(this.mapSettings,this.timeEffectManager),this.mapRenderer=new be(this.gl,this.mapState),this.skyRenderer=new Ci(this.gl,this.timeEffectManager),this.cameraAnimation=new U(this.mapState,this,this.mapSettings),this.dirty=!0,this.mapObserver=new X,y.clamp(n.tilt,a.minTilt,a.maxTilt3D),this.mapState.setScreenSize(this.width,this.height),this.mapState.setBearing(n.bearing),this.mapState.setTarget(g.convert(n.center)),this.mapState.setZoom(n.zoom),this.mapState.setTilt(n.tilt),this.mapSettings.setMinZoom(n.minZoom),this.mapSettings.setMaxZoom(n.maxZoom);var i=function(){e.dirty=!0};this.symbolResourceManager=new ai(this.gl,i),this.buildingIconSelectionManager=new Ri(this.gl,this.symbolResourceManager,this),this.buildingResourceManager=new oi(this.gl,this.httpTaskManager,i),this.customBuildingManager=new Bi(this.buildingResourceManager,this.mapState,this.httpTaskManager,i);this.tileManager=new Mt(this,this.httpTaskManager,this.mapState,this.mapSettings,this.buildingResourceManager,this.buildingIconSelectionManager,this.customBuildingManager,function(t){return new ii(t,e.annotationManager,e.gl)},i),this.tileAreaManager=new xn(this.tileManager),this.customBuildingManager.setTileManager(this.tileManager);var o=this.createLayer("1.rasterLayer",Ct.RASTER,a.rasterLayerOrder);this.buildingLayer=this.createLayer("2.buildingLayer",Ct.BUILDING,a.buildingLayerOrder),this.buildingLayer.setBuildingResourceManager(this.buildingResourceManager);var r=new xi(this.timeEffectManager);this.buildingLayer.setLightingManager(r);var s=new _i(this.gl,r.sunLight,this.mapState);this.effectManager=new Ii(s),this.mapRenderer.setEffectManager(this.effectManager),o.effectManager=this.effectManager,this.buildingLayer.effectManager=this.effectManager,this._annotationManager=new Mn(this),this.weatherManager=new yi(this.mapState,this.httpTaskManager),r.setOnLightPositionChanged(function(){s.updateMatrices()}),this.skyObject=new Ei,o.skyObject=this.skyObject,o.skyRenderer=this.skyRenderer},e.prototype.createStyleNode=function(){var t=document.createElement("style");t.innerHTML=B.content,document.getElementsByTagName("head")[0].appendChild(t)},e.prototype.setupMapViews=function(t,e){var n=G.create("div","mf-mapgl",t);this.mapContainer=n,this.canvas=G.create("canvas","",n),this.gl=this.canvas.getContext("experimental-webgl");var i=O.fromHex(a.mapBackgroundColor2D);this.gl.clearColor(i.red,i.green,i.blue,i.alpha),S.pixelScale=window.devicePixelRatio||1,this.width=this.canvas.offsetWidth*S.pixelScale,this.height=this.canvas.offsetHeight*S.pixelScale,this.createMapControlNode(n,e),this.createLogoNode(n)},e.prototype.createMapControlNode=function(t,e){var n=G.create("div","mf-ui",t),i=null;e.mapControls&&(i=G.create("div","mf-ui "+B.getStyleForControlOptions(e.mapControlOptions),n),this.zoomInButton=G.create("div","mf-button",i),this.zoomInButton.innerHTML="<a class='mf-zoom-in-icon'></a>",this.zoomOutButton=G.create("div","mf-button",i),this.zoomOutButton.innerHTML="<a class='mf-zoom-out-icon'></a>"),e.geolocate&&(this.geolocateControl=new Gn(i,this)),this.addEvents()},e.prototype.createLogoNode=function(t){var e=G.create("div","mf-logo-container",t),n=D.get("logoIcon");e.innerHTML="<a target='_blank' href='https://www.map4d.vn/' aria-label='Map4D Logo'>\n      <img src="+n+" class='mf-logo'/>\n      </a>"},e.prototype.addEvents=function(){var t=this;this.mouseEventHandler=new H(this.canvas,this),window.addEventListener("resize",this.resize,!1),this.options.mapControls&&(this.zoomInButton.addEventListener("click",function(){t.setZoom(t.mapState.getZoom()+1,new M(t.width/2,t.height/2),0,!1)}),this.zoomOutButton.addEventListener("click",function(){t.setZoom(t.mapState.getZoom()-1,new M(t.width/2,t.height/2),0,!1)}))},e.prototype.getSymbolResourceManager=function(){return this.symbolResourceManager},e.prototype.addListener=function(t,e){return this.mapsEventManager.addEvent(t,e)},e.prototype.setInfoWindow=function(t){this.annotationManager.setInfoWindow(t)},e.prototype.setInfoContents=function(t){this.annotationManager.setInfoContents(t)},e.prototype.updateInfoContents=function(t){this.annotationManager.updateInfoContents(t)},e.prototype.notifyCameraWillChange=function(t){this.dirty=!0,this.mapsEventManager.notify(L.cameraWillChange,null,t)},e.prototype.notifyCameraIsChanging=function(){this.dirty=!0,this.mapsEventManager.notify(L.cameraChanging),this.buildingLayer.setDirty(),this.tileManager.updateVisibleTiles()},e.prototype.notifyCameraDidChange=function(){this.dirty=!0,this.mapState.setZoom(Math.round(this.mapState.getZoom())),this.buildingLayer.setDirty(),this.tileManager.updateVisibleTiles(),this.mapsEventManager.notify(L.idle),this.mapState.willChange=!1},e.prototype.getLayer=function(t){return this.layers.has(t)?this.layers.get(t):null},e.prototype.queryMarkerAnnotation=function(t){return this.annotationManager.queryMarkerAnnotation(t)},e.prototype.queryShapeAnnotation=function(t){return this.annotationManager.queryShapeAnnotation(t)},e.prototype.queryBuildingInfo=function(t){var e=this.getSelectionCode(t);return this.buildingLayer.getBuilding(e)},e.prototype.setTime=function(t){this.mapSettings.setTime(t.getTime()),this.reload(),this.mapSettings.is3dMode()&&(this.buildingResourceManager.removeAllResources(),this.buildingLayer.clear())},e.prototype.getMapContainer=function(){return this.mapContainer},e.prototype.selectedMarker=function(t){this.annotationManager.selectedMarker(t)},e.prototype.deselectMarker=function(){this.annotationManager.deselectMarker()},e.prototype.destroy=function(){this.frameBuffer&&this.frameBuffer.destroy(),this.shader&&this.shader.destroy(),this.tileManager&&this.tileManager.destroy(),this.mapsEventManager&&this.mapsEventManager.destroy(),this.weatherManager&&this.weatherManager.destroy(),this.layers&&this.layers.clear(),this.buildingLayer&&this.buildingLayer.clear(),this.effectManager&&this.effectManager.destroy(),this.buildingIconSelectionManager&&this.buildingIconSelectionManager.destroy(),this.customBuildingManager&&this.customBuildingManager.destroy(),this.gl=null,this.frameBuffer=null,this.effectManager=null},Object.defineProperty(e.prototype,"annotationManager",{get:function(){return this._annotationManager},enumerable:!0,configurable:!0}),e.prototype.flyToMyLocation=function(t){void 0===t&&(t=!0),this.geolocateControl&&this.geolocateControl.flyToMyLocation(t)},e.prototype.setTimeEffect=function(t){this.dirty=!0,this.timeEffectManager.setTimeEffect(t)},e.prototype.getTimeEffect=function(){return this.timeEffectManager.getTimeEffect()},e.prototype.setFilterPlaceTypes=function(t){this.buildingLayer.filterPlaceTypes=t,this.effectManager.shadowMap.clear(),this.dirty=!0},e.prototype.getFilterPlaceTypes=function(){return this.buildingLayer.filterPlaceTypes},e.prototype.setSelectedObjects=function(t){this.buildingIconSelectionManager.deselectInfoWindow(),this.buildingLayer.setSelectedObjectIds(t),this.dirty=!0},e.prototype.getSelectedObjects=function(){return this.buildingLayer.getSelectedObjectIds()},e.prototype.getBuildingSelectionIconManager=function(){return this.buildingIconSelectionManager},e}(Q),ki=function(){function t(t,e){if(null==e.accessKey){var n="Map4D SDK: Missing access key!";throw alert(n),new Error(n)}this._mapView=new Pi(t,e)}return Object.defineProperty(t.prototype,"mapView",{get:function(){return this._mapView},enumerable:!0,configurable:!0}),t.prototype.enable3dMode=function(t){this.mapView.enable3dMode(t)},t.prototype.getBounds=function(){return this.mapView.getBounds()},t.prototype.setMapUrl=function(t,e){void 0===e&&(e=!1),this.mapView.setMapUrl(t,e)},t.prototype.getMapUrl=function(){return this.mapView.getMapUrl()},t.prototype.setMinZoom=function(t){this.mapView.setMinZoom(t)},t.prototype.setMaxZoom=function(t){this.mapView.setMaxZoom(t)},t.prototype.getCamera=function(){var t=this.mapView.getCamera();return new m(t.getTarget(),t.getTilt(),t.getBearing(),t.getZoom())},t.prototype.setCamera=function(t){var e=m.convert(t);null==e.getTarget()&&e.setTarget(this.mapView.mapState.getTarget()),null==e.getTilt()&&e.setTilt(this.mapView.mapState.getTilt()),null==e.getBearing()&&e.setBearing(this.mapView.mapState.getBearing()),null==e.getZoom()&&e.setZoom(this.mapView.mapState.getZoom()),e.setTilt(y.clamp(e.getTilt(),this.mapView.mapState.getMinTilt(),this.mapView.mapState.getMaxTilt()));for(var n=e.getBearing();n>=360;)n-=360;for(;n<0;)n+=360;e.setBearing(n);var i=Math.round(e.getZoom());e.setZoom(y.clamp(i,this.mapView.mapSettings.getMinZoom(),this.mapView.mapSettings.getMaxZoom())),e.getZoom()<a.defaultMinZoom3d&&this.mapView.mapState.is3dMode()&&this.mapView.enable3dMode(!1),this.mapView.setCamera(e)},t.prototype.setWeather=function(t){this.mapView.setWeather(t)},t.prototype.getWeather=function(){return this.mapView.getWeather()},t.prototype.panBy=function(t,e){var n=A.convert(t),i=S.pointToPixel(n);this.mapView.panBy(i,e)},t.prototype.panTo=function(t,e){this.mapView.panTo(g.convert(t),e)},t.prototype.flyTo=function(t,e,n){this.mapView.flyTo(g.convert(t),e,n)},t.prototype.fitBounds=function(t,e,n){this._mapView.fitBounds(_.convert(t),e,n)},t.prototype.setSwitchMode=function(t){this.mapView.setSwitchMode(t)},t.prototype.addListener=function(t,e){return this.mapView.addListener(t,e)},t.prototype.setTime=function(t){this.mapView.setTime(t)},t.prototype.setInfoWindow=function(t){this.mapView.setInfoWindow(t)},t.prototype.setInfoContents=function(t){this.mapView.setInfoContents(t)},t.prototype.flyToMyLocation=function(t){void 0===t&&(t=!0),this.mapView.flyToMyLocation(t)},t.prototype.is3DMode=function(){return this.mapView.mapState.is3dMode()},t.prototype.getMinZoom=function(){return this.mapView.mapSettings.getMinZoom()},t.prototype.getPreferMinZoom=function(){return this.mapView.mapSettings.getPreferMinZoom()},t.prototype.getMaxZoom=function(){return this.mapView.mapSettings.getMaxZoom()},t.prototype.getMaxNativeZoom=function(){return this.mapView.mapSettings.getMaxNativeZoom()},t.prototype.setTimeEffect=function(t){this.mapView.setTimeEffect(t)},t.prototype.getTimeEffect=function(){return this.mapView.getTimeEffect()},t.prototype.setShadowEffect=function(t){this.mapView.setShadowEffect(t)},t.prototype.setWaterEffect=function(t){this.mapView.setWaterEffect(t)},t.prototype.showMapObject=function(t){console.warn("This function is deprecated and will be removed in the future. Please use setObjectsEnabled(enabled: boolean) method instead"),this.mapView.setObjectsEnabled(t)},t.prototype.isShowMapObject=function(){return console.warn("This function is deprecated and will be removed in the future. Please use isObjectsEnabled() method instead"),this.mapView.isObjectsEnabled()},t.prototype.setObjectsEnabled=function(t){this.mapView.setObjectsEnabled(t)},t.prototype.isObjectsEnabled=function(){return this.mapView.isObjectsEnabled()},t.prototype.setFilterPlaceTypes=function(t){this.mapView.setFilterPlaceTypes(t)},t.prototype.getFilterPlaceTypes=function(){return this.mapView.getFilterPlaceTypes()},t.prototype.setSelectedObjects=function(t){this.mapView.setSelectedObjects(t)},t.prototype.getSelectedObjects=function(){return this.mapView.getSelectedObjects()},t}(),Ni=function(){function t(t){this.map=t}return t.prototype.fromLatLngToScreen=function(t,e){void 0===e&&(e=0);var n=this.map.mapView.latLngToScreenCoordinate(g.convert(t),e);return S.pixelToPoint(new A(n.x,n.y))},t.prototype.fromScreenToLatLng=function(t,e){void 0===e&&(e=0);var n=A.convert(t),i=S.pointToPixel(n);return this.map.mapView.screenCoordinateToLatLng(new M(i.x,i.y),e)},t}(),Fi=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),ji=function(t){function e(e){var n=t.call(this)||this;n.defaultTileArea={url:a.baseMapUrl,minZoom:a.defaultMinZoom,maxZoom:a.defaultMaxZoom};var i={};return S.extendOptions(i,n.defaultTileArea,e),n._bounds=_.convert(i.bounds),n._url=i.url,n._minZoom=i.minZoom,n._maxZoom=i.maxZoom,n}return Fi(e,t),e.prototype.getBounds=function(){return this._bounds},e.prototype.getUrl=function(){return this._url},e.prototype.getMinZoom=function(){return this._minZoom},e.prototype.getMaxZoom=function(){return this._maxZoom},e.prototype.setBounds=function(t){this._bounds=_.convert(t),null!=this._map&&this._map.mapView.reload()},e.prototype.setMinZoom=function(t){this._minZoom!=t&&(this._minZoom=t,null!=this._map&&this._map.mapView.reload())},e.prototype.setMaxZoom=function(t){this._maxZoom!=t&&(this._maxZoom=t,null!=this._map&&this._map.mapView.reload())},e.prototype.setUrl=function(t){this._url!=t&&(this._url=t,null!=this._map&&this._map.mapView.reload())},e.prototype.setMap=function(t){this._map!==t&&(null!=this._map&&(this._map.mapView.removeTileArea(this._id),this._id=-1),this._map=t,null!=this._map&&(this._id=this._map.mapView.addTileArea(this)))},e}(E);n.d(e,"CameraPosition",function(){return m}),n.d(e,"Circle",function(){return I}),n.d(e,"Icon",function(){return R}),n.d(e,"LatLng",function(){return g}),n.d(e,"LatLngBounds",function(){return _}),n.d(e,"Map",function(){return ki}),n.d(e,"MapEvent",function(){return L}),n.d(e,"MapObject",function(){return Un}),n.d(e,"Marker",function(){return Pe}),n.d(e,"Point",function(){return A}),n.d(e,"Polygon",function(){return Ne}),n.d(e,"Polyline",function(){return vn}),n.d(e,"Projection",function(){return Ni}),n.d(e,"SwitchMode",function(){return Y}),n.d(e,"TileArea",function(){return ji}),n.d(e,"TimeEffect",function(){return di}),n.d(e,"Weather",function(){return cn}),n.d(e,"ControlOptions",function(){return i})}]);
//# sourceMappingURL=map4dsdk@1.0.2.production.js.map